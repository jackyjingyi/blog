/*TMODJS:{"version":"1.0.0"}*/
!function () {

    function template (filename, content) {
        return (
            /string|function/.test(typeof content)
            ? compile : renderFile
        )(filename, content);
    };


    var cache = template.cache = {};
    var String = this.String;

    function toString (value, type) {

        if (typeof value !== 'string') {

            type = typeof value;
            if (type === 'number') {
                value += '';
            } else if (type === 'function') {
                value = toString(value.call(value));
            } else {
                value = '';
            }
        }

        return value;

    };


    var escapeMap = {
        "<": "&#60;",
        ">": "&#62;",
        '"': "&#34;",
        "'": "&#39;",
        "&": "&#38;"
    };


    function escapeFn (s) {
        return escapeMap[s];
    }


    function escapeHTML (content) {
        return toString(content)
        .replace(/&(?![\w#]+;)|[<>"']/g, escapeFn);
    };


    var isArray = Array.isArray || function(obj) {
        return ({}).toString.call(obj) === '[object Array]';
    };


    function each (data, callback) {
        if (isArray(data)) {
            for (var i = 0, len = data.length; i < len; i++) {
                callback.call(data, data[i], i, data);
            }
        } else {
            for (i in data) {
                callback.call(data, data[i], i);
            }
        }
    };


    function resolve (from, to) {
        var DOUBLE_DOT_RE = /(\/)[^/]+\1\.\.\1/;
        var dirname = ('./' + from).replace(/[^/]+$/, "");
        var filename = dirname + to;
        filename = filename.replace(/\/\.\//g, "/");
        while (filename.match(DOUBLE_DOT_RE)) {
            filename = filename.replace(DOUBLE_DOT_RE, "/");
        }
        return filename;
    };


    var utils = template.utils = {

        $helpers: {},

        $include: function (filename, data, from) {
            filename = resolve(from, filename);
            return renderFile(filename, data);
        },

        $string: toString,

        $escape: escapeHTML,

        $each: each
        
    };


    var helpers = template.helpers = utils.$helpers;


    function renderFile (filename, data) {
        var fn = template.get(filename) || showDebugInfo({
            filename: filename,
            name: 'Render Error',
            message: 'Template not found'
        });
        return data ? fn(data) : fn; 
    };


    function compile (filename, fn) {

        if (typeof fn === 'string') {
            var string = fn;
            fn = function () {
                return new String(string);
            };
        }

        var render = cache[filename] = function (data) {
            try {
                return new fn(data, filename) + '';
            } catch (e) {
                return showDebugInfo(e)();
            }
        };

        render.prototype = fn.prototype = utils;
        render.toString = function () {
            return fn + '';
        };

        return render;
    };


    function showDebugInfo (e) {

        var type = "{Template Error}";
        var message = e.stack || '';

        if (message) {
            // 利用报错堆栈信息
            message = message.split('\n').slice(0,2).join('\n');
        } else {
            // 调试版本，直接给出模板语句行
            for (var name in e) {
                message += "<" + name + ">\n" + e[name] + "\n\n";
            }  
        }

        return function () {
            if (typeof console === "object") {
                console.error(type + "\n\n" + message);
            }
            return type;
        };
    };


    template.get = function (filename) {
        return cache[filename.replace(/^\.\//, '')];
    };


    template.helper = function (name, helper) {
        helpers[name] = helper;
    };


    if (typeof define === 'function') {define(function() {return template;});} else if (typeof exports !== 'undefined') {module.exports = template;} else {this.template = template;}
    /**
 * Created by Wuwq on 2017/1/12.
 */


/*自动组合rootPath生成完整URL*/
template.helper('_url', function (url) {
    return window.rootPath + url;
});
template.helper('_serverUrl', function (url) {
    return window.serverPath + url;
});

/*自动组合rootPath生成完整URL*/
template.helper('_fastdfsUrl', function (url) {
    return window.fastdfsUrl + url;
});


/*语言化描述过滤日期*/
template.helper('_filterDateRangeToString', function (filterValue) {
    var split = filterValue.split(',');
    if (split[0] === split[1])
        return split[0];
    else {
        if (isNullOrBlank(split[0]) && !isNullOrBlank(split[1]))
            return split[1] + ' 及以前';
        else if (!isNullOrBlank(split[0]) && isNullOrBlank(split[1]))
            return split[0] + ' 及以后';
        else
            return split[0] + ' ~ ' + split[1];
    }
});

/*Join某个数组的指定字段*/
template.helper('_mapJoin', function (array, field, separator) {
    if (array === undefined || array === null || array.length === 0)
        return '';
    return _.map(array, function (o) {
        return o[field];
    }).join(separator);
});


/*判断是否为空字符串*/
template.helper('_isBlank', function (str) {
    return _.isBlank(str);
});

/*判断是否为空字符串*/
template.helper('_styleType', function (str,index) {
    var classStr = '';
    switch (str){
        case '1':
            switch (index) {
                case '1':
                    classStr = 'col-md-5 col-custom-5';
                    break;
                case '2':
                    classStr = 'col-md-7 col-custom-7';
                    break;
            }
            break;
        case '2':
            switch (index) {
                case '1':
                    classStr = 'col-md-7 col-custom-7';
                    break;
                case '2':
                    classStr = 'col-md-5 col-custom-5';
                    break;
            }
            break;
        default:
            classStr = 'col-md-5 col-custom-5';
            break;
    }
    return classStr;
});
/*判断是否为空字符串*/
template.helper('_styleTypeEdit', function (str,index) {
    var classStr = '';
    switch (str){
        case '1':
            switch (index) {
                case '1':
                    classStr = 'col-md-5';
                    break;
                case '2':
                    classStr = 'col-md-7';
                    break;
            }
            break;
        case '2':
            switch (index) {
                case '1':
                    classStr = 'col-md-7';
                    break;
                case '2':
                    classStr = 'col-md-5';
                    break;
            }
            break;
        default:
            classStr = 'col-md-5';
            break;
    }
    return classStr;
});
/*判断字符串是否为undefined、Null或空*/
template.helper('_isNullOrBlank', function (str) {
    return isNullOrBlank(str);
});
template.helper('_isNull', function (str) {
    return isNull(str);
});

/*字符串固定长度，不足位则左边补充指定字符*/
template.helper('_lpad', function (o, len, c) {
    if (len < 2) len = 2;
    return _.lpad(o, len, c);
});

/*生成唯一DOM元素唯一ID*/
template.helper('_uniqueId', function (prefix) {
    return _.uniqueId(prefix);
});

/*截断字符串*/
template.helper('_cutString', function (str, length, suffix) {
    return cutString(str, length, suffix)
});
/*TextArea文本转换为Html*/
template.helper('_text2Html', function (str) {
    if (str == null) {
        return '';
    }else if (str.length == 0) {
        return '';
    }
    str = str.replaceAll('\n', '<br />');
    str = str.replaceAll('\r', '<br />');
    return str;
});


/*短格式时间
 * 1：00
 * 2：00
 * */
template.helper('_shortTime', function (datetime) {
    return shortTime(datetime);
});

/*格式化日期*/
template.helper('_momentFormat', function (datetime, pattern) {

    if(datetime==null||datetime=='')
        return '';

    if(pattern == "A") {
        var date = new Date(Date.parse(datetime.replace(/-/g, "/")));
        if (date.getHours() <= 12) {
            return date.getFullYear().toString() + "/" + (date.getMonth() + 1).toString() + "/" + date.getDate().toString() + " 上午";

        } else {

            return date.getFullYear().toString() + "/" + (date.getMonth() + 1).toString() + "/" + date.getDate().toString() + " 下午";
        }
    }else if(pattern == "B"){//当YYYY/MM/DD 转为格式YYYY-MM-DD

        return new Date(Date.parse(datetime.replace(/\//g, "-")));

    }else {
        var m = moment(datetime);
        if(datetime.length>10 && !(pattern.indexOf('HH')>-1)){
            return moment(datetime.substring(0,10)).locale("zh-cn").format(pattern) + '' + datetime.substring(10,datetime.length);
        }else{
            if (m.isValid())
                return moment(datetime).locale("zh-cn").format(pattern);
        }
        return '';
    }

});

/*格式化日期
 * 今天 1：00
 * 昨天 2：00
 * 2017-01-01 2：00
 * */
template.helper('_dateSpecFormat', function (datetime, pattern) {
    return dateSpecFormat(datetime, pattern);
});

/**
 * 两日期天数差值
 */
template.helper('_timeDifference', function (time1,time2) {

    if(time1!=null && time1!='' && time2!=null && time2!=''){
        return diffDays(time1,time2)+1;
    }
    return '';
});
/**
 * 第N年后的日期
 */
template.helper('_dateAddByYears', function (date,years) {

    if(date!=undefined){
        return moment(date).add(years, 'years').format('YYYY/MM/DD');
    }else{
        return '';
    }
});

/**
 * 作用：财务相关金额的格式控制
 * 显示：项目相关的金额数字位数与小数点后面数字的控制，如：23456.13显示为23,456.13;且小数位控制在两位内
 */
template.helper('_expNumberFilter', function (value) {
    return expNumberFilter(value);
});

template.helper('_expNumberFilterPoint2', function (value) {
    if(isNullOrBlank(value)){
        value = 0;
    }else{
        value = Math.round(value*100)/100;
    }
    return expNumberFilter(value);
});
/**Number(-10000023).toFixed(2)
 * 当负数时，转为正数
 */
template.helper('_expPositiveNumberFilter', function (value) {
    value = value+'';
    if(value.indexOf('-')>-1){
        value = value.substring(1,value.length);
    }
    return expNumberFilter(value);
});
/**
 * Number(-10000023).toFixed(2)
 */
template.helper('_expNumberDecimalFilter', function (value) {

    value = Number(value).toFixed(2);
    return expNumberFilter(value);
});

/*格式化日期
 * 今天
 * 昨天
 * 2017-01-01
 * */
template.helper('_dateSpecShortFormat', function (datetime) {
    return dateSpecShortFormat(datetime);
});

template.helper('_ifPresent', function (s, presentVal, elseVal) {
    if (s !== null && s !== void 0)
        return presentVal;
    return elseVal;
});

template.helper('_include',function(tpl,obj){
   return template(tpl, obj);
});

template.helper('_jsonStringify',function(obj){
    return JSON.stringify(obj);
});
/**
 * 截取字符串
 * str:字符串
 * s:以此截取
 * i:下标
 */
template.helper('_subStr', function (str,s,i) {
    if(str!=null && s!=''){
        var strArr = str.split(s);
        return strArr[i];
    }else{
        return '';
    }
});
/**
 * 周几格式化
 * workDays: "1,2,3,4,5"
 */
template.helper('_daysFormat', function (workDays) {

    if(typeof workDays === 'string')
        workDays = workDays.split(',');

    var converTitle = function (item) {
        var title = '';
        switch (item){
            case '1':
                title = '周一';
                break;
            case '2':
                title = '周二';
                break;
            case '3':
                title = '周三';
                break;
            case '4':
                title = '周四';
                break;
            case '5':
                title = '周五';
                break;
            case '6':
                title = '周六';
                break;
            case '7':
                title = '周日';
                break;
        }
        return title;
    };
    var timeTitle = '';
    $.each(workDays,function (i,item) {
        var title = converTitle(item);
        timeTitle += '、' + title ;
    });
    timeTitle = timeTitle.substring(1,timeTitle.length);

    if(workDays.length>4){
        var interval = parseInt(workDays[workDays.length-1]) - parseInt(workDays[0]);
        if(interval==workDays.length-1)
            timeTitle = converTitle(workDays[0])+'至'+converTitle(workDays[workDays.length-1]);
    }
    return timeTitle;
});
/**
 * 日期转星期
 */
template.helper('_dateToWeekFormat', function (date) {

    var today = new Array('星期日','星期一','星期二','星期三','星期四','星期五','星期六');
    date = new Date(Date.parse(date));
    return today[date.getDay()];
});
/**
 * M转G
 */
template.helper('_storageMToG', function (data) {

    if(data>1024){

        return Math.round((math.divide(math.bignumber(data),math.bignumber(1024)))*100)/100 + 'G';

    }else{

        return data + 'M';
    }

});

/**
 * 数组转为字符串
 */
template.helper('_arrToString', function (data) {

    if(data && data.length>0){
        return JSON.stringify(data)
    }else{
        return '';
    }

});
/**
 * 获取图标颜色
 */
template.helper('_getIconColor', function (id) {

    if(isNullOrBlank(id))
        return '';

    var dataItem = getObjectInArray(window.icon_list_form,id);

    if(dataItem==null)
        return '';

    return dataItem.color;

});

/**
 * 文件大小单位自动转换
 */
template.helper('_fileSizeFormat', function (num) {

    if(isNullOrBlank(num))
        return '0';

    return WebUploader.Base.formatSize(num);

});
/**
 * 任务状态背景色
 */
template.helper('_getStatusColor', function (status) {

    var classStr = '';
    switch (status){
        case 'status_not_start':
            classStr = 'btn-green';
            break;
        case 'status_end':
            classStr = 'btn-grey';
            break;
        default:
            classStr = 'selected';
            break;
    }

    return classStr;

});
/**
 * 任务状态背景色
 */
template.helper('_getProjectTempIcon', function (name) {

    var iconStr = '';
    switch (name){
        case '企业模板':
            iconStr = 'icon-qiye';
            break;
        case '行政人事':
            iconStr = 'icon-xingzheng';
            break;
        case '销售服务':
            iconStr = 'icon-xiaoshouyuan';
            break;
        case '工程建筑':
            iconStr = 'icon-mingshandachuanfaxiandijiashouye';
            break;
        default:
            iconStr = 'icon-wangluo';
            break;
    }

    return iconStr;

});
/**
 * 计算百分比
 */
template.helper('_getPercentage', function (num1,num2) {

    if(isNullOrBlank(num1))
        num1 = 0;
    if(isNullOrBlank(num2))
        num2 = 0;

    var percentage = Math.round((math.divide(math.bignumber(num1),math.bignumber(num2)))*100);
    if(num1==0)
        percentage = 0;
    return percentage;
});
/**
 * 截取名字
 * name 名字
 * num 截取个数
 */
template.helper('_interceptName', function (name,num) {

    var newName = '';
    if(!isNullOrBlank(name)){

        var re=/^[a-zA-Z]+$/;
        var reName = function (name,num) {
            if(name.length>num){
                newName = name.substring(name.length-num,name.length);
            }else{
                newName = name;
            }
        };
        if(!re.test(name)){//中文
            reName(name,num);
        }else{//英文
            reName(name,num*2);
        }
    }
    return newName;
});
/**
 * 或取list下child的length
 * name 名字
 * num 截取个数
 */
template.helper('_allChildrenLen', function (child,childKey) {

    var len = 0;
    if(child && child.length>0){
        $.each(child,function(i,item){
            if(item[childKey] && item[childKey].length>0){
                len = len + item[childKey].length;
            }
        });
    }
    return len;
});
/**
 * 为空显示--
 */
template.helper('_emptyDisplay', function (value) {

    if(isNullOrBlank(value)){
        return '--';
    }
    return value;
});

/**
 * 相减
 */
template.helper('_mathSubtract', function (num1,num2) {

    if(isNullOrBlank(num1))
        num1 = 0;
    if(isNullOrBlank(num2))
        num2 = 0;

    var subtractNum = math.subtract(math.bignumber(num1),math.bignumber(num2))-0;
    return subtractNum;
});
/**
 * 转码
 */
template.helper('_encodeURI', function (value) {

    if(isNullOrBlank(value))
       return '';

    return encodeURI(value);
});

    /*v:1*/
template('m_alert/m_alert_error',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,_uniqueId=$helpers._uniqueId,content=$data.content,$out='';$out+='<div data-id="';
$out+=$escape(id||_uniqueId('m_alert_error_'));
$out+='" class="alert alert-danger fade in alert-dismissable"> <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button> ';
$out+=$escape(content);
$out+=' </div>';
return new String($out);
});/*v:1*/
template('m_approvalReport/m_approvalReport_cost',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,doType=$data.doType,$out='';$out+=' <div class="data-list-box ';
$out+=$escape(doType==2?'m':'');
$out+='"> ';
if(doType==2){
$out+=' <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> <div class="form-group z-index-1"> <label class="">审批类型：</label> <select class="form-control" name="expType"></select> </div> <div class="time-combination form-group"> </div> <button class="btn btn-white btn-sm" data-action="refreshBtn">刷新数据</button> </form> ';
}else{
$out+=' <form role="form" class="form-inline m-b-sm"> <div class="row"> <div class="col-md-12 m-b-sm"> <div class="z-index-1"> <label class="inline">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> </div> <div class="col-md-12"> <label class="">审批类型：</label>  <div class="dp-inline-block-1 m-l-sm" id="expTypeBox"></div> </div> <div class="col-md-12" id="timeSelect"> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"></div> </div> </form> ';
}
$out+=' <div class="data-list-container"></div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_approvalReport/m_approvalReport_cost_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,pageIndex=$data.pageIndex,_expNumberFilter=$helpers._expNumberFilter,_emptyDisplay=$helpers._emptyDisplay,_momentFormat=$helpers._momentFormat,doType=$data.doType,managerCompanyIds=$data.managerCompanyIds,selectedOrg=$data.selectedOrg,isFinance=$data.isFinance,_url=$helpers._url,expSumAmount=$data.expSumAmount,$out='';$out+='<style> .table-hover>tbody>tr.no-data:hover { background-color: transparent; } </style> <div class="row"> <div class="col-md-12 of-auto"> <table class="table table-hover table-bordered table-responsive dataTable" > <thead> <tr> <th>序号</th> <th> 编号 <a class="icon-filter pull-right" id="filter_expNo" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>金额（元）</th>  <th> 部门 <a class="icon-filter pull-right" id="filter_applyDepartName" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th> 经办人 <a class="icon-filter pull-right" id="filter_submitUserName" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th> 审批人 <a class="icon-filter pull-right" id="filter_auditPerson" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th> 收款方 <a class="icon-filter pull-right" id="filter_toCompanyName" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th> 付款方 <a class="icon-filter pull-right" id="filter_fromCompanyName" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>收支分类</th> <th>分类子项</th> <th class="sorting_desc w-100" data-action="sort" data-code="expDate"> 申请时间 </th> <th class="sorting_desc w-100" data-action="sort" data-code="approveDate">审批时间</th> <th class="sorting_desc w-100" data-action="sort" data-code="allocationDate"> 付款时间 <a class="icon-filter pull-right" id="filter_allocationStartDate_allocationEndDate" ><i class="icon iconfont icon-shaixuan"></i></a> </th> </tr> </thead> <tbody> ';
$each(dataList,function(p,$index){
$out+=' <tr class="curp" data-action="openShowExp" i="';
$out+=$escape($index);
$out+='" versionNum="';
$out+=$escape(p.versionNum);
$out+='" data-type="';
$out+=$escape(p.type);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='"> <td>';
$out+=$escape($index+1+pageIndex*10);
$out+='</td> <td>';
$out+=$escape(p.expNo);
$out+='</td> <td> <span class="">';
$out+=$escape(_expNumberFilter(p.expSumAmount));
$out+='</span> </td> <!--<td>';
$out+=$escape(p.companyName);
$out+='</td>--> <td>';
$out+=$escape(p.departName);
$out+='</td> <td>';
$out+=$escape(p.submitUserName);
$out+='</td> <td>';
$out+=$escape(p.auditPersonName);
$out+='</td> <td>';
$out+=$escape(_emptyDisplay(p.enterpriseId));
$out+='</td> <td>';
$out+=$escape(_emptyDisplay(p.fromCompanyId));
$out+='</td> <td>';
$out+=$escape(p.expParentName);
$out+='</td> <td>';
$out+=$escape(p.expName);
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.expDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.approveDate,'YYYY/MM/DD'));
$out+='</td> <td> ';
if(doType==2){
$out+=' ';
if(managerCompanyIds && managerCompanyIds.indexOf(selectedOrg.id)>-1){
$out+=' <button type="button" class="btn btn-primary btn-xs rounded" data-action="agreeToGrant" data-id="';
$out+=$escape(p.id);
$out+='">同意拨款</button> <button type="button" class="btn btn-default btn-xs rounded" data-action="sendBack" data-id="';
$out+=$escape(p.id);
$out+='">退回</button> ';
}
$out+=' ';
}else{
$out+=' ';
if(p.allocationDate!=null && p.allocationDate!=''){
$out+=' ';
$out+=$escape(_momentFormat(p.allocationDate,'YYYY/MM/DD'));
$out+=' ';
}else if(p.approveStatus==1 && p.financeFlag==1 && isFinance){
$out+=' <button type="button" class="btn btn-primary btn-xs rounded" data-action="agreeToGrant" data-id="';
$out+=$escape(p.id);
$out+='">同意拨款</button> ';
}else if(p.approveStatus==7){
$out+=' 已退回 ';
}else{
$out+=' 待拨款 ';
}
$out+=' ';
if(p.approveStatus==1 && p.financeFlag==1 && isFinance){
$out+=' <button type="button" class="btn btn-default btn-xs rounded" data-action="sendBack" data-id="';
$out+=$escape(p.id);
$out+='">退回</button> ';
}
$out+=' ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
if(dataList==null || dataList.length==0){
$out+=' <tr class="no-data"> <td colspan="13" align="center"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/default/without_exp.png'));
$out+='"> </div> <span style="color:#337b8e">暂无汇总内容</span> </td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
if(dataList!=null && dataList.length!=0){
$out+=' <div class="pt-absolute m-t-sm" id="totalAmount"> &nbsp;&nbsp;合计：<span class="">';
$out+=$escape(_expNumberFilter(expSumAmount));
$out+='</span>元 </div> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_approvalReport/m_approvalReport_menu','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right"> <ul class="secondary-menu-ul"> <li class="roleControl" roleCode="30000201" flag="2" id="cost"><a href="#/approvalReport/cost">财务审批统计</a></li> <li class="roleControl" roleCode="30000201" flag="2" id="nonAmount"><a href="#/approvalReport/nonAmount">行政审批统计</a></li> <li class="roleControl" roleCode="30000201" flag="2" id="projects"><a href="#/approvalReport/projects">项目审批统计</a></li>  </ul> </div> </div> </div> </div> <div class="ibox-content"> <div class="row"> <div class="col-md-12" id="content-box"> </div> </div> </div> </div>');/*v:1*/
template('m_approvalReport/m_approvalReport_non_amount',' <div class="data-list-box"> <form role="form" class="form-inline m-b-sm"> <div class="row"> <div class="col-md-12 m-b-sm"> <div class="z-index-1"> <label class="inline">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> </div> <div class="col-md-12"> <label class="">审批类型：</label>  <div class="dp-inline-block-1 m-l-sm" id="expTypeBox"></div> </div> <div class="col-md-12" id="timeSelect"> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"></div> </div> </form> <div class="data-list-container"></div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> ');/*v:1*/
template('m_approvalReport/m_approvalReport_non_amount_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,financeFlag=$data.financeFlag,expType=$data.expType,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,pageIndex=$data.pageIndex,_expNumberFilter=$helpers._expNumberFilter,_momentFormat=$helpers._momentFormat,_url=$helpers._url,expSumAmount=$data.expSumAmount,$out='';$out+='<table class="table table-hover table-bordered table-responsive dataTable" > <thead> <tr> <th width="6%">序号</th> <th width="12%"> 申请人 <a class="icon-filter pull-right" id="filter_userNameLike" ><i class="icon iconfont icon-shaixuan"></i></a> </th>  ';
if(financeFlag==3){
$out+=' <th> 关联项目  </th> ';
}else{
$out+=' <th> 所在部门 <a class="icon-filter pull-right" id="filter_applyDepartName" ><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+=' <th> 审批类型  </th> ';
if(expType=='收款计划审批' || expType=='付款计划审批' || expType=='付款审批'){
$out+=' <th>金额</th> ';
}
$out+=' <th width="12%"> 审批人 <a class="icon-filter pull-right" id="filter_auditPerson" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th width="12%" class="sorting_desc" data-action="sort" data-code="approveDate"> 审批时间 </th> <th width="12%" class="sorting_desc" data-action="sort" data-code="expDate"> 申请时间 <a class="icon-filter pull-right" id="filter_startDate_endDate" ><i class="icon iconfont icon-shaixuan"></i></a> </th> </tr> </thead> <tbody> ';
$each(dataList,function(p,$index){
$out+=' <tr class="curp" data-action="openShowExp" i="';
$out+=$escape($index);
$out+='" versionNum="';
$out+=$escape(p.versionNum);
$out+='" data-type="';
$out+=$escape(p.type);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='"> <td>';
$out+=$escape($index+1+pageIndex*10);
$out+='</td> <td>';
$out+=$escape(p.userName);
$out+='</td> <!--<td>';
$out+=$escape(p.companyName);
$out+='</td>--> ';
if(financeFlag==3){
$out+=' <td>';
$out+=$escape(p.projectName);
$out+='</td> ';
}else{
$out+=' <td>';
$out+=$escape(p.departName);
$out+='</td> ';
}
$out+=' <td>';
$out+=$escape(p.expTypeName);
$out+='</td> ';
if(expType=='收款计划审批' || expType=='付款计划审批' || expType=='付款审批'){
$out+=' <td>';
$out+=$escape(_expNumberFilter(p.expSumAmount));
$out+='</td> ';
}
$out+=' <td>';
$out+=$escape(p.auditPersonName);
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.approveDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.expDate,'YYYY/MM/DD'));
$out+='</td> </tr> ';
});
$out+=' ';
if(dataList==null || dataList.length==0){
$out+=' <tr class="no-data"> <td colspan="';
$out+=$escape(expType=='收款计划审批' || expType=='付款计划审批' || expType=='付款审批'?8:7);
$out+='" align="center"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/default/without_exp.png'));
$out+='"> </div> <span style="color:#337b8e">暂无汇总内容</span> </td> </tr> ';
}
$out+=' </tbody> </table> ';
if(dataList!=null && dataList.length!=0 && (expType=='收款计划审批' || expType=='付款计划审批' || expType=='付款审批')){
$out+=' <div class="pt-absolute m-t-sm" id="totalAmount"> &nbsp;&nbsp;合计：<span class="">';
$out+=$escape(_expNumberFilter(expSumAmount));
$out+='</span>元 </div> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_attendance/m_attendance','<style> canvas{ -moz-user-select: none; -webkit-user-select: none; -ms-user-select: none; } #chartjs-tooltip-barChart1,#chartjs-tooltip-barChart2 { opacity: 1; position: absolute; background: rgba(0, 0, 0, .7); color: white; border-radius: 3px; -webkit-transition: all .1s ease; transition: all .1s ease; pointer-events: none; -webkit-transform: translate(-50%, 0); transform: translate(-50%, 0); } .chartjs-tooltip-key { display: inline-block; width: 10px; height: 10px; margin-right: 10px; } .chart-wrapper{ position: relative; } </style> <div class="m"> <div class="row"> <div class="col-md-12"> <h4 class="title-line">打卡</h4> <p>在手机上轻松打卡，并结合审批单据自动生成出勤报表。支持固定时间上下班、灵活排班、自由上下班和外出打卡。</p> </div> </div> <div class="hr-line-dashed"></div> <div> <div class="col-md-3 border m-r-xs p-m fh-150"> <i class="icon iconfont icon-rili"></i>&nbsp;&nbsp;上下班打卡 <p>查看记录，设置打卡人员、时间和地点</p> <p>本月异常&nbsp;<span class="text-navy" id="abnormalNum">0</span>&nbsp;人</p> <a class="btn btn-link text-navy" href="#/backstageMgt/attendance/report?type=0">查看</a> <a class="btn btn-link text-navy roleControl" href="#/backstageMgt/attendance/settings" roleCode="10000501" flag="2">设置</a> </div> <div class="col-md-3 border m-r-xs p-m fh-150"> <i class="fa fa-calendar"></i>&nbsp;&nbsp;外出打卡 <p>查看记录，设置汇总提醒时间</p> <a class="btn btn-link text-navy" href="#/backstageMgt/attendance/report?type=1">查看</a> </div> <div class="clearfix"></div> </div> <div class="hr-line-dashed"></div> <h4 class="title-line">异常打卡趋势</h4> <form class="form-inline" id="filterTimeBox"> </form> <div class="chart-wrapper"> <div id="chart1" class="chartjs-render-monitor" style="display: block; width: 100%; height: 350px; cursor: pointer;"></div> </div> </div>');/*v:1*/
template('m_attendance/m_attendance_address_add','<style type="text/css"> form.m-attendance-address-add{min-height: 250px;} #l-map{height:300px;width:100%;} #r-result{width:100%;} .tangram-suggestion-main{z-index: 19891099;} </style> <form class="form-horizontal m-attendance-address-add"> <div id="l-map" style="display: none;"></div> <div class="form-group m-t-sm" id="r-result"> <div class="col-sm-8 col-sm-offset-2"> <div class="input-group"> <span class="input-group-addon"><i class="fa fa-search"></i></span> <input placeholder="请输入公司打卡地址，例如“卯丁大厦”" class="form-control" type="text" name="suggestId" id="suggestId" value=""> </div> </div> </div> <div id="searchResultPanel" style="border:1px solid #C0C0C0;width:150px;height:auto; display:none;"></div> <div class="p-m" id="addressInfo" style="display: none;"> <div class="form-group"> <label class="col-sm-2 control-label p-l-none p-r-none">打卡地点名称<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入打卡名称" class="form-control" type="text" name="punchCardName" value=""> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label p-l-none p-r-none">打卡范围<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <select class="form-control full-width" name="punchRange" > <option value="100">100米</option> <option value="200">200米</option> <option value="300">300米</option> </select> </div> </div> </div> </form>');/*v:1*/
template('m_attendance/m_attendance_arrange_work',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,month=$data.month,$each=$utils.$each,days=$data.days,d=$data.d,i=$data.i,_dateToWeekFormat=$helpers._dateToWeekFormat,userList=$data.userList,u=$data.u,$index=$data.$index,periodList=$data.periodList,p=$data.p,$out='';$out+='<form class="form-horizontal m-attendance-arrange-work"> <div class="p-m"> <div class="row"> <div class="col-sm-12 text-center"> <a href="javascript:void(0);" data-action="prevDate"><i class="fa fa-chevron-left"></i></a> <input name="selectDate" readonly value="';
$out+=$escape(month);
$out+='" style="border: none;color: #4D95D7;font-size: 16px;text-align: center;width: 84px;display: inline-block;cursor: pointer;"/> <a href="javascript:void(0);" data-action="nextDate"><i class="fa fa-chevron-right"></i></a> </div> </div> <div class="work-box pt-relative table-box"> <div class="table-head"> <div class="table-head-wrap"> <table class="grid table table-hover table-bordered table-responsive "> <colgroup> <col> </col> ';
$each(days,function(d,i){
$out+=' <col style="width:32px"> </col> ';
});
$out+=' </colgroup> <thead> <tr> <th></th> ';
$each(days,function(d,i){
$out+=' <th class="date-head" data-date="';
$out+=$escape(d.date);
$out+='"> <p>';
$out+=$escape(d.day);
$out+='</p> <p>';
$out+=$escape(_dateToWeekFormat(d.date));
$out+='</p> </th> ';
});
$out+=' </tr> </thead> </table> </div> </div> <div class="table-content" > <table class="grid table table-hover table-bordered table-responsive " style="margin: 0;"> <colgroup> <col> </col> ';
$each(days,function(d,i){
$out+=' <col style="width:32px"> </col> ';
});
$out+=' </colgroup> <tbody> ';
$each(userList,function(u,$index){
$out+=' <tr class="user-row" data-id="';
$out+=$escape(u.id);
$out+='"> <td class="user-name">';
$out+=$escape(u.text);
$out+='</td> ';
$each(days,function(d,i){
$out+=' <td class="no-padding" data-date="';
$out+=$escape(d.date);
$out+='"> </td> ';
});
$out+=' </tr> ';
});
$out+=' </tbody> </table> <div class="attendance-edit-border" style="display: none;border: 2px solid #4171AA;"></div> </div> <div class="table-foot " > <div class="table-foot-wrap"> <table class="grid table table-hover table-bordered table-responsive " style="margin: 0;"> <colgroup> <col> </col> ';
$each(days,function(d,i){
$out+=' <col style="width:32px"> </col> ';
});
$out+=' </colgroup> <tfoot> ';
$each(periodList,function(p,$index){
$out+=' <tr class="period-row" data-id="';
$out+=$escape(p.id?p.id:p.itemKey);
$out+='" data-color="';
$out+=$escape(p.color);
$out+='"> <td ><i class="fa fa-circle" style="color:';
$out+=$escape(p.color);
$out+='"></i>';
$out+=$escape(p.classesName);
$out+='</td> ';
$each(days,function(d,i){
$out+=' <td data-date="';
$out+=$escape(d.date);
$out+='"> </td> ';
});
$out+=' </tr> ';
});
$out+=' <tr class="period-row" data-id="rest" data-color="#dfdfdf"> <td><i class="fa fa-circle" style="color:#dfdfdf;"></i>休息</td> ';
$each(days,function(d,i){
$out+=' <td data-date="';
$out+=$escape(d.date);
$out+='"> </td> ';
});
$out+=' </tr> </tfoot> </table> </div> </div> <div class="attendance-edit-border1" style="display: none;border: 2px solid #4171AA;"></div> </div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_attendance/m_attendance_date_punched',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataItem=$data.dataItem,dataType=$data.dataType,$out='';$out+='<form class="form-horizontal m-attendance-time-add"> <div class="p-m"> <div class="form-group"> <label class="col-sm-2 control-label p-l-none p-r-none">日期<span class="fc-red">*</span>：</label> <div class="col-sm-6 p-r-lg"> <div class="input-group"> <input type="text" class="form-control" name="specialDate" onFocus="WdatePicker()" value="';
$out+=$escape(dataItem?dataItem.specialDate:'');
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> </div> ';
if(dataType==1){
$out+=' <div class="form-group attendance-time-box"> <label class="col-sm-2 control-label p-l-none p-r-none">打卡时间<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div class="row time-list-row"> <div class="col-sm-7 "> <span>上班</span> <div class="border out-hh-mm"> <span class="hh-mm"><select class="form-control input-sm" name="selectStaHH"></select></span> <span>:</span> <span class="hh-mm"><select class="form-control input-sm" name="selectStaMM" ></select></span> </div> <span> - 下班</span> <span class="border out-hh-mm"> <span class="hh-mm"><select class="form-control input-sm" name="selectEndHH" ></select></span> <span>:</span> <span class="hh-mm"><select class="form-control input-sm" name="selectEndMM" ></select></span> </span> </div> <div class="col-sm-5 no-padding"> <button class="btn btn-link hide p-l-none" data-action="delTimeField">删除</button> <button class="btn btn-link p-l-none" data-action="addTimeField">新增字段</button> </div> </div> </div> </div> ';
}
$out+=' <div class="form-group " > <label class="col-sm-2 control-label p-l-none p-r-none">事由<span class="fc-red">*</span>：</label> <div class="col-sm-6 p-r-lg"> <textarea class="form-control" rows="3" name="reason">';
$out+=$escape(dataItem?dataItem.reason:'');
$out+='</textarea> </div> </div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_attendance/m_attendance_punch_record',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$escape=$utils.$escape,_url=$helpers._url,dataInfo=$data.dataInfo,$each=$utils.$each,p=$data.p,i=$data.i,_momentFormat=$helpers._momentFormat,ccCompanyUserList=$data.ccCompanyUserList,u=$data.u,ui=$data.ui,_isNullOrBlank=$helpers._isNullOrBlank,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <div class="col-md-2 p-l-lg"> ';
if(dataList.headImg==null || dataList.headImg==''){
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block" src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="50"/> ';
}else{
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block" src="';
$out+=$escape(dataList.headImg);
$out+='" width="50"/> ';
}
$out+=' </div> <div class="col-md-10"> <h4>';
$out+=$escape(dataInfo.userName);
$out+='</h4> <span class="fc-v1-grey">部门：';
$out+=$escape(dataInfo.departName);
$out+='</span> <span>&nbsp;|&nbsp;</span> <span class="fc-v1-grey">所属规则：';
$out+=$escape(dataInfo.ruleName);
$out+='</span> </div> </div> <div class="form-group"> <div class="col-sm-12 p-w-md"> <table class="table table-hover table-bordered m-b-xs" > <thead> <tr> <th width="15%">类型</th> <th width="15%">状态</th> <th width="20%">时间</th> <th width="25%">地点</th> <th width="25%">备注</th> </tr> </thead> <tbody> ';
if(dataList.statementList!=null && dataList.statementList.length>0){
$out+=' ';
$each(dataList.statementList,function(p,i){
$out+=' <tr> <td> ';
if(p.clockType==1){
$out+=' 上班打卡 ';
}else if(p.clockType==2){
$out+=' 下班打卡 ';
}else if(p.clockType==3){
$out+=' 外出打卡 ';
}
$out+=' </td> <td> ';
if(p.clockConditionType==0){
$out+=' 未打卡 ';
}else if(p.clockConditionType==1){
$out+=' 正常打卡 ';
}else if(p.clockConditionType==2){
$out+=' 迟到 ';
}else if(p.clockConditionType==3){
$out+=' 早退 ';
}else if(p.clockConditionType==4){
$out+=' 地点异常 ';
}else if(p.clockConditionType==5){
$out+=' 超时打卡 ';
}
$out+=' </td> <td>';
$out+=$escape(_momentFormat(p.clockTime,'HH:mm'));
$out+='</td> <td>';
$out+=$escape(p.clockAddress);
$out+='</td> <td>';
$out+=$escape(p.remark);
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr> <td colspan="5" class="text-center">暂无数据</td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
if(ccCompanyUserList!=null && ccCompanyUserList.length>0){
$out+=' <h4 class="title-line m-l-sm">抄送人</h4> <div class="hr-line-dashed m-t-none m-b-sm"></div> <div class="form-group"> <div class="col-sm-12 p-w-md approval-out-box"> ';
$each(ccCompanyUserList,function(u,ui){
$out+=' <div class="approver-outbox"> <div class="approver-box "> <div class="img-circle"> <img alt="image" class="img-circle" src="';
$out+=$escape(_isNullOrBlank(u.fileFullPath)?_url('/img/head_default.png'):u.fileFullPath);
$out+='" width="30" height="30"> </div> <div class="m-t-xs">';
$out+=$escape(u.userName);
$out+='</div> </div> </div> ';
});
$out+=' </div> </div> ';
}
$out+=' </form> ';
return new String($out);
});/*v:1*/
template('m_attendance/m_attendance_report',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,startDate=$data.startDate,endDate=$data.endDate,startMonth=$data.startMonth,endMonth=$data.endMonth,$out='';$out+='<div class="m"> <div class="tabs-container"> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="true">按日统计</a></li> <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">按月统计</a></li> </ul> <div class="tab-content"> <div id="tab-1" class="tab-pane active"> <div class="panel-body"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg1"> </div> </div> <div class="form-group time-box"> <label class="m-t-xs">时间：</label> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm " name="startDate" placeholder="开始时间" value="';
$out+=$escape(startDate);
$out+='" readonly style="width: 110px;" > <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm " name="endDate" placeholder="结束时间" value="';
$out+=$escape(endDate);
$out+='" readonly style="width: 110px;" > <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> </div> <div class="form-group pull-right"> <button class="btn btn-primary btn-sm pull-right roleControl" data-action="exportDetailsByDay">导出日报</button> </div> <div class="clearfix"></div> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container-day" class="m-pagination pull-right "></div> </div> </div> </div> </div> <div id="tab-2" class="tab-pane"> <div class="panel-body"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg2"> </div> </div> <div class="form-group time-box"> <label class="m-t-xs">时间：</label> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm " name="startDate" placeholder="开始时间" value="';
$out+=$escape(startMonth);
$out+='" readonly style="width: 110px;" > <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm " name="endDate" placeholder="结束时间" value="';
$out+=$escape(endMonth);
$out+='" readonly style="width: 110px;" > <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> </div> <div class="form-group pull-right"> <button class="btn btn-primary btn-sm pull-right roleControl" data-action="exportDetailsByMonth">导出月报</button> </div> <div class="clearfix"></div> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container-month" class="m-pagination pull-right "></div> </div> </div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_attendance/m_attendance_report_list_day',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,_momentFormat=$helpers._momentFormat,type=$data.type,$each=$utils.$each,dataList=$data.dataList,p=$data.p,i=$data.i,_url=$helpers._url,$out='';$out+='<div class="';
$out+=$escape(dataInfo?'m':'');
$out+='"> ';
if(dataInfo){
$out+=' <div class="row m-b-xs"> <div class="col-md-6"> <h4>';
$out+=$escape(dataInfo.userName);
$out+='&nbsp;';
$out+=$escape(_momentFormat(dataInfo.workDate,'YYYY/MM'));
$out+='打卡记录</h4> </div> <div class="col-md-6 text-right"> <button class="btn btn-primary btn-sm roleControl" data-action="exportDetailsByMonthOfUser">导出个人月报</button> <a class="btn btn-default btn-" href="javascript:void(0);" data-action="backToReportByMonth">返回</a> </div> </div> ';
}
$out+=' <table class="table table-hover table-bordered table-responsive " > <thead> <tr> <th>时间</th> <th>姓名</th> <th>部门</th> ';
if(type==0){
$out+=' <th>所属规则</th> ';
}
$out+=' <th>最早</th> <th>最晚</th> <th>次数</th> ';
if(type==0){
$out+=' <th>工作时长</th> <th>审批单</th> <th>状态</th> <th>校对状态</th> <th>异常信息</th> <th>早退</th> <th>迟到</th> <th>加班</th> ';
}
$out+=' </tr> </thead> <tbody> ';
$each(dataList,function(p,i){
$out+=' <tr class="curp" data-i="';
$out+=$escape(i);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='" data-company-id="';
$out+=$escape(p.companyId);
$out+='"> <td>';
$out+=$escape(_momentFormat(p.workDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(p.userName);
$out+='</td> <td>';
$out+=$escape(p.departName);
$out+='</td> ';
if(type==0){
$out+=' <td>';
$out+=$escape(p.ruleName);
$out+='</td> ';
}
$out+=' <td>';
$out+=$escape(p.startClockTime?p.startClockTime:'--');
$out+='</td> <td>';
$out+=$escape(p.endClockTime?p.endClockTime:'--');
$out+='</td> <td>';
$out+=$escape(p.clockNum);
$out+='</td> ';
if(type==0){
$out+=' <td>';
$out+=$escape(p.workingHours);
$out+='</td> <td> ';
$out+=$escape(p.approveNum);
$out+=' ';
if(p.expMainList && p.expMainList.length>0){
$out+=' <a href="javascript:void(0);" data-action="viewApproval" data-exp-ids="';
$out+=$escape(p.expMain);
$out+='"><i class="fa fa-info-circle"></i></a> ';
}
$out+=' </td> <td>';
$out+=$escape(p.clockStatus);
$out+='</td> <td>';
$out+=$escape(p.correctStatus);
$out+='</td> <td>';
$out+=$escape(p.exceptionRemark);
$out+='</td> <td>';
$out+=$escape(p.earlyTime);
$out+='</td> <td>';
$out+=$escape(p.lateTime);
$out+='</td> <td>';
$out+=$escape(p.overTime);
$out+='</td> ';
}
$out+=' </tr> ';
});
$out+=' ';
if(dataList==null || dataList.length==0){
$out+=' <tr class="no-data"> <td colspan="';
$out+=$escape(type==0?'15':'6');
$out+='" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_attendance/m_attendance_report_list_month',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,type=$data.type,$each=$utils.$each,dataList=$data.dataList,p=$data.p,i=$data.i,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<table class="table table-hover table-bordered table-responsive " > <thead> <tr> <th>时间</th> <th>姓名</th> <th>部门</th> ';
if(type==0){
$out+=' <th>所属规则</th> <th>应打卡天数</th> <th>正常天数</th> <th>异常天数</th> <th>补卡</th> ';
}else{
$out+=' <th>外出打卡天数</th> <th>外出打卡次数</th> ';
}
$out+=' </tr> </thead> <tbody> ';
$each(dataList,function(p,i){
$out+=' <tr class="curp" data-i="';
$out+=$escape(i);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='"> <td>';
$out+=$escape(_momentFormat(p.workDate,'YYYY/MM'));
$out+='</td> <td>';
$out+=$escape(p.userName);
$out+='</td> <td>';
$out+=$escape(p.departName);
$out+='</td> ';
if(type==0){
$out+=' <td>';
$out+=$escape(p.ruleName);
$out+='</td> <td>';
$out+=$escape(p.clockNumDue);
$out+='</td> <td>';
$out+=$escape(p.clockNumNormal);
$out+='</td> <td>';
$out+=$escape(p.clockNumAbnormal);
$out+='</td> <td>';
$out+=$escape(p.correctClock);
$out+='</td> ';
}else{
$out+=' <td>';
$out+=$escape(p.clockNumNormal);
$out+='</td> <td>';
$out+=$escape(p.clockNumDue);
$out+='</td> ';
}
$out+=' </tr> ';
});
$out+=' ';
if(dataList==null || dataList.length==0){
$out+=' <tr class="no-data"> <td colspan="';
$out+=$escape(type==0?'8':'5');
$out+='" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_attendance/m_attendance_settings',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,i=$data.i,$escape=$utils.$escape,t=$data.t,ti=$data.ti,_daysFormat=$helpers._daysFormat,time=$data.time,$index=$data.$index,address=$data.address,wifi=$data.wifi,_url=$helpers._url,$out='';$out+='<div class="m"> <div class="row m-b-xs"> <div class="col-md-12 text-right"> <button class="btn btn-primary" data-action="add">添加规则</button> <a class="btn btn-default" href="#/backstageMgt/attendance">返回</a> </div> </div> <table class="table table-hover table-bordered table-responsive dataTable" > <thead> <tr> <th>规则名称</th> <th>打卡时间</th> <th>打卡地点</th> <th width="">操作</th> </tr> </thead> <tbody> ';
$each(dataList,function(p,i){
$out+=' <tr data-id="';
$out+=$escape(p.id);
$out+='"> <td>';
$out+=$escape(p.ruleName);
$out+='</td> <td> ';
if(p.periodList!=null && p.periodList.length>0){
$out+=' ';
$each(p.periodList,function(t,ti){
$out+=' <p> ';
if(p.ruleType==2){
$out+=' ';
$out+=$escape(t.classesName);
$out+=' ';
}else{
$out+=' ';
$out+=$escape(_daysFormat(t.workDays));
$out+=' ';
}
$out+=' </p> ';
if(t.timeList!=null && t.timeList.length>0){
$out+=' ';
$each(t.timeList,function(time,$index){
$out+=' <p>上班 ';
$out+=$escape(time.startTime);
$out+=' — 下班 ';
$out+=$escape(time.endTime);
$out+='</p> ';
});
$out+=' ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </td> <td> ';
if(p.addressList!=null && p.addressList.length>0){
$out+=' ';
$each(p.addressList,function(address,$index){
$out+=' <p>';
$out+=$escape(address.address);
$out+='</p> ';
});
$out+=' ';
}
$out+=' ';
if(p.wifiList!=null && p.wifiList.length>0){
$out+=' ';
$each(p.wifiList,function(wifi,$index){
$out+=' <p>';
$out+=$escape(wifi.address);
$out+='</p> ';
});
$out+=' ';
}
$out+=' </td> <td> <button class="btn btn-primary btn-xs" data-action="edit">编辑</button> <button class="btn btn-danger btn-xs" data-action="del">删除</button> </td> </tr> ';
});
$out+=' ';
if(dataList==null || dataList.length==0){
$out+=' <tr class="no-data"> <td colspan="4" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_attendance/m_attendance_settings_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<form class="form-horizontal m-attendance-settings-add m "> <div class="row"> <div class="col-md-6"> <h4 class="title-line">添加打卡规则</h4> </div> <div class="col-md-6 text-right"> <button data-action="back" class="btn btn-default">返回</button> </div> </div> <div class="hr-line-dashed space-10"></div> <div class="col-md-8 p-l-none"> <div class="form-group"> <label class="col-sm-2 control-label">规则名称<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入规则名称" class="form-control" type="text" name="ruleName" value="';
$out+=$escape(dataInfo?dataInfo.ruleName:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 text-right">规则类型<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div class="col-xs-12 p-l-none m-b-xs"> <label class="i-checks i-checks-label fw-normal dp-block"> ';
if(dataInfo==null || (dataInfo && dataInfo.ruleType==1)){
$out+=' <input type="radio" name="ruleType" value="1" checked/> ';
}else{
$out+=' <input type="radio" name="ruleType" value="1"/> ';
}
$out+=' <span class="i-checks-span">固定时间上下班 <span class="fc-v1-grey">所有人按照相同时间打卡</span></span> </label> </div> <div class="col-xs-12 p-l-none m-b-xs"> <label class="i-checks i-checks-label fw-normal dp-block"> ';
if(dataInfo && dataInfo.ruleType==2){
$out+=' <input type="radio" name="ruleType" value="2" checked/> ';
}else{
$out+=' <input type="radio" name="ruleType" value="2"/> ';
}
$out+=' <span class="i-checks-span">按班次上下班 <span class="fc-v1-grey">不同人员按照各自排班打卡</span></span> </label> </div> <div class="col-xs-12 p-l-none m-b-xs"> <label class="i-checks i-checks-label fw-normal dp-block"> ';
if(dataInfo && dataInfo.ruleType==3){
$out+=' <input type="radio" name="ruleType" value="3" checked/> ';
}else{
$out+=' <input type="radio" name="ruleType" value="3"/> ';
}
$out+=' <span class="i-checks-span">自由上下班 <span class="fc-v1-grey">所有人无时间限制，可随时打卡，只统计旷工</span></span> </label> </div> </div> </div> <div class="hr-line-dashed space-10"></div> <div class="form-group"> <label class="col-sm-2 text-right">打卡人员<span class="fc-red">*</span>：</label> <div class="col-sm-10">  <button class="btn btn-default btn-xs" data-action="addAttendanceUser" data-type="1">添加</button> </div> </div> <div class="form-group"> <label class="col-sm-2 text-right">白名单：</label> <div class="col-sm-10"> <button class="btn btn-default btn-xs" data-action="addAttendanceUser" data-type="2">添加</button> </div> </div> <div class="form-group"> <label class="col-sm-2 text-right">汇报对象：</label> <div class="col-sm-10"> <button class="btn btn-default btn-xs" data-action="addAttendanceUser" data-type="3">添加</button> </div> </div> <div class="hr-line-dashed space-10"></div> <div class="form-group"> <label class="col-sm-2 text-right">打卡方式<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div class="col-xs-12 p-l-none m-b-xs"> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="radio" name="clockWay" value="1" checked/> <span class="i-checks-span">手机 <span class="fc-v1-grey">可通过位置或WiFi打卡</span></span> </label> </div>  </div> </div> <div class="hr-line-dashed space-10"></div> <div class="form-group"> <label class="col-sm-2 text-right">打卡地点<span class="fc-red">*</span>：</label> <div class="col-sm-10"> 位置和WiFi满足任意一项即可打卡 </div> </div> <div class="form-group"> <label class="col-sm-2 text-right">位置：</label> <div class="col-sm-10"> <button class="btn btn-default btn-xs" data-action="addPosition">添加</button> <span class="fc-v1-grey">可添加多个打卡地点，并设置有效打卡范围</span>  </div> </div> <div class="form-group"> <label class="col-sm-2 text-right">WiFi：</label> <div class="col-sm-10"> <button class="btn btn-default btn-xs" data-action="addWiFi">添加</button> <span class="fc-v1-grey">可添加多个WiFi，连上指定的WiFi即可打卡</span> </div> </div> <div class="hr-line-dashed space-10"></div> <div class="form-group" data-rule-type="1"> <label class="col-sm-2 text-right">打卡时间：</label> <div class="col-sm-10"> <button class="btn btn-default btn-xs" data-action="addTime">添加</button> </div> </div> <div class="form-group" data-rule-type="2" style="display: none;"> <label class="col-sm-2 text-right">班次：</label> <div class="col-sm-10"> <button class="btn btn-default btn-xs" data-action="addScheduling">添加</button> </div> </div> <div class="form-group" data-rule-type="3" style="display: none;"> <label class="col-sm-2 text-right">打卡时间：</label> <div class="col-sm-10"> <div class="row p-t-7 p-l"> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="1"/> <span class="i-checks-span">星期一</span> </label> </div> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="2"/> <span class="i-checks-span">星期二</span> </label> </div> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="3"/> <span class="i-checks-span">星期三</span> </label> </div> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="4"/> <span class="i-checks-span">星期四</span> </label> </div> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="5"/> <span class="i-checks-span">星期五</span> </label> </div> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="6"/> <span class="i-checks-span">星期六</span> </label> </div> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="7"/> <span class="i-checks-span">星期日</span> </label> </div> </div> </div> </div> <div class="form-group" data-rule-type="2" style="display: none;"> <label class="col-sm-2 text-right">排班设置：</label> <div class="col-sm-10"> <button class="btn btn-default btn-xs" data-action="editScheduling">编辑排班</button> </div> </div> <div class="form-group"> <label class="col-sm-2 text-right">特殊日期：</label> <div class="col-sm-10"> <div class="col-xs-12 p-l-none m-b-xs" data-rule-type="1"> <button class="btn btn-default btn-xs" data-action="dateMustBePunched">添加</button><span class="fc-v1-grey">必须打卡的日期</span> </div> <div class="col-xs-12 p-l-none m-b-xs"> <button class="btn btn-default btn-xs" data-action="dateNotMustBePunched">添加</button><span class="fc-v1-grey">不用打卡的日期</span> </div> <div class="col-xs-12 p-l-none m-b-xs"> <label class="i-checks i-checks-label fw-normal dp-block"> ';
if(dataInfo && dataInfo.isOpenClock==1){
$out+=' <input type="checkbox" name="isOpenClock" value="1" checked/> ';
}else{
$out+=' <input type="checkbox" name="isOpenClock" value="1"/> ';
}
$out+=' <span class="i-checks-span">非工作日允许打卡</span> </label> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 text-right">节假日：</label> <div class="col-sm-10"> <div class="col-xs-12 p-l-none m-b-xs"> <label class="i-checks i-checks-label fw-normal dp-block"> ';
if(dataInfo && dataInfo.isSyncHoliday==1){
$out+=' <input type="checkbox" name="isSyncHoliday" value="1" checked/> ';
}else{
$out+=' <input type="checkbox" name="isSyncHoliday" value="1"/> ';
}
$out+=' <span class="i-checks-span">同步中国节假日 <span class="fc-v1-grey">节假日期间不用打卡</span></span> </label> </div> </div> </div> <div class="hr-line-dashed space-10"></div> <div class="form-group"> <label class="col-sm-2 text-right">手机提醒<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div class="pull-left">上班</div> <div class="pull-left width-150" style="margin: -5px 5px;"> <select class="form-control select-control input-sm" name="remindTime"> <option value="0">准点</option> <option value="5">提前5分钟</option> <option value="10">提前10分钟</option> <option value="15">提前15分钟</option> </select> </div> <div class="pull-left">－ 下班 准点</div> <div class="clearfix"></div> </div> </div> <div class="form-group"> <label class="col-sm-2 text-right">补卡申请：</label> <div class="col-sm-10"> <div class="col-xs-12 p-l-none m-b-xs"> <label class="i-checks i-checks-label fw-normal dp-block"> ';
if(dataInfo && dataInfo.isAnomalyApply==1){
$out+=' <input type="checkbox" name="isAnomalyApply" value="1" checked/> ';
}else{
$out+=' <input type="checkbox" name="isAnomalyApply" value="1"/> ';
}
$out+=' <span class="i-checks-span">员工异常打卡时可提交申请，审批通过后修正异常</span> </label> </div> </div> </div> <div class="hr-line-dashed space-10"></div> <div class="form-group"> <label class="col-sm-2 text-right">规则生效时间：</label> <div class="col-sm-10"> <div class="col-xs-12 p-l-none m-b-xs"> <label class="i-checks i-checks-label fw-normal dp-block"> ';
if(dataInfo && dataInfo.effectWay==1){
$out+=' <input type="radio" name="effectWay" value="1" checked/> ';
}else{
$out+=' <input type="radio" name="effectWay" value="1"/> ';
}
$out+=' <span class="i-checks-span">明日生效</span> </label> </div> <div class="col-xs-12 p-l-none m-b-xs"> <label class="i-checks i-checks-label fw-normal dp-block"> ';
if(dataInfo && dataInfo.effectWay==2){
$out+=' <input type="radio" name="effectWay" value="2" checked/> ';
}else{
$out+=' <input type="radio" name="effectWay" value="2"/> ';
}
$out+=' <span class="i-checks-span">立即生效</span> </label> </div> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-sm-10"> <button class="btn btn-primary" data-action="save">保存</button> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_attendance/m_attendance_time_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,ruleType=$data.ruleType,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<form class="form-horizontal m-attendance-time-add"> <div class="p-m"> ';
if(ruleType==1){
$out+=' <div class="form-group"> <label class="col-sm-2 control-label p-l-none p-r-none">工作日<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div class="row p-t-7 p-l"> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="1"/> <span class="i-checks-span">星期一</span> </label> </div> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="2"/> <span class="i-checks-span">星期二</span> </label> </div> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="3"/> <span class="i-checks-span">星期三</span> </label> </div> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="4"/> <span class="i-checks-span">星期四</span> </label> </div> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="5"/> <span class="i-checks-span">星期五</span> </label> </div> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="6"/> <span class="i-checks-span">星期六</span> </label> </div> <div class="col-24-xs-3 no-padding "> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="workDays" value="7"/> <span class="i-checks-span">星期日</span> </label> </div> </div> </div> </div> ';
}else if(ruleType==2){
$out+=' <div class="form-group"> <label class="col-sm-2 control-label p-l-none p-r-none">班次名称<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入班次名称" class="form-control" type="text" name="classesName" value="';
$out+=$escape(dataInfo?dataInfo.classesName:'');
$out+='"> </div> </div> ';
}
$out+=' <div class="form-group attendance-time-box"> <label class="col-sm-2 control-label p-l-none p-r-none">打卡时间<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div class="row time-list-row"> <div class="col-sm-7 "> <span>上班</span> <div class="border out-hh-mm"> <span class="hh-mm"><select class="form-control input-sm" name="selectStaHH"></select></span> <span>:</span> <span class="hh-mm"><select class="form-control input-sm" name="selectStaMM" ></select></span> </div> <span> - 下班</span> <span class="border out-hh-mm"> <span class="hh-mm"><select class="form-control input-sm" name="selectEndHH" ></select></span> <span>:</span> <span class="hh-mm"><select class="form-control input-sm" name="selectEndMM" ></select></span> </span> </div> <div class="col-sm-5 no-padding"> <button class="btn btn-link hide p-l-none" data-action="delTimeField">删除</button> <button class="btn btn-link p-l-none" data-action="addTimeField">新增字段</button> </div> </div> </div> </div> <div class="form-group"> <div class="col-sm-2"><button class="btn btn-link" data-action="advancedSettings" >高级设置</button></div> </div> <div class="form-group hide" data-type="advancedSettings"> <label class="col-sm-2 control-label p-l-none p-r-none">弹性时间：</label> <div class="col-sm-10"> <div class="row"> <div class="col-24-xs-7"> <select class="form-control select-control width-150" name="elasticTime"> <option value="0">0分钟</option> <option value="5">5分钟</option> <option value="10">10分钟</option> <option value="20">20分钟</option> <option value="30">30分钟</option> <option value="40">40分钟</option> <option value="50">50分钟</option> <option value="60">60分钟</option> </select> </div> <div class="col-24-xs-17 p-t-7"> <span class="fc-v1-grey">允许迟到、早退的分钟数</span> </div> </div> </div> </div> <div class="form-group hide" data-type="advancedSettings"> <label class="col-sm-2 control-label p-l-none p-r-none">打卡时间限制：</label> <div class="col-sm-10"> <div class="row"> <div class="col-24-xs-7"> <select class="form-control select-control width-150" name="limitClock"> <option value="1">凌晨4点以后</option> <option value="2">上班前3小时内</option> <option value="3">上班前2小时内</option> <option value="4">上班前1小时内</option> <option value="5">上班前30分钟内</option> <option value="6">上班前15分钟内</option> </select> </div> <div class="col-24-xs-17"> </div> </div> </div> </div> <div class="form-group hide" data-type="advancedSettings"> <label class="col-sm-2 control-label p-l-none p-r-none">下班：</label> <div class="col-sm-10 p-t-7"> <label class="i-checks i-checks-label fw-normal dp-block"> <input type="checkbox" name="isNotClockOff" value="1"/> <span class="i-checks-span">下班不需要打卡</span> </label> </div> </div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_attendance/m_attendance_wifi_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<form class="form-horizontal m-attendance-wifi-add"> <div class="p-m"> <div class="form-group"> <label class="col-sm-2 control-label p-l-none p-r-none">wifi名称<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入wifi名称" class="form-control" type="text" name="wifiName" value=""> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label p-l-none p-r-none">BSSID<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input class="form-control" type="text" name="wifiAddress" maxlength="2"/><span class="mao-hao"> ：</span> <input class="form-control" type="text" name="wifiAddress" maxlength="2"/><span class="mao-hao"> ：</span> <input class="form-control" type="text" name="wifiAddress" maxlength="2"/><span class="mao-hao"> ：</span> <input class="form-control" type="text" name="wifiAddress" maxlength="2"/><span class="mao-hao"> ：</span> <input class="form-control" type="text" name="wifiAddress" maxlength="2"/><span class="mao-hao"> ：</span> <input class="form-control" type="text" name="wifiAddress" maxlength="2"/> </div> </div> <div class="row"> <div class="col-sm-12 m-b-sm p-l-xl">获取方式：</div> <div class="col-sm-8 p-l-xl"> <p>1.可以向公司IT部门询问公司WiFi的BSSID</p>  </div> <!--<div class="col-sm-4 border-left"> <img src="';
$out+=$escape(_url('/img/website/code.png'));
$out+='" width="120"/> </div>--> </div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_backstage/m_backstage_apply_billing',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<form class="form-horizontal m form-invoice"> <div class="form-group"> <div class="col-sm-12"><h4 class="title-line fc-dark-grey">发票信息</h4></div> </div> <div class="form-group"> <label class="col-sm-2 control-label">单位名称<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入单位名称" class="form-control" type="text" name="relationCompanyName" value="';
$out+=$escape(dataInfo?dataInfo.relationCompanyName:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">纳税人识别号<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入纳税人识别号" class="form-control" type="text" name="taxIdNumber" value="';
$out+=$escape(dataInfo?dataInfo.taxIdNumber:'');
$out+='"> </div> </div> <div class="form-group"> <div class="col-sm-12"><h4 class="title-line fc-dark-grey">收件人信息</h4></div> </div> <div class="form-group"> <label class="col-sm-2 control-label">姓名<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入姓名" class="form-control" type="text" name="recipients" value="';
$out+=$escape(dataInfo?dataInfo.recipients:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">联系电话<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入联系电话" class="form-control" type="text" name="cellphone" value="';
$out+=$escape(dataInfo?dataInfo.cellphone:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">收件地址<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入收件地址" class="form-control" type="text" name="receiveAddress" value="';
$out+=$escape(dataInfo?dataInfo.receiveAddress:'');
$out+='"> </div> </div> </form> <form class="form-horizontal m form-express" > ';
if(dataInfo.status==3){
$out+=' <div class="form-group"> <div class="col-sm-12"><h4 class="title-line fc-dark-grey">快递信息</h4></div> </div> <div class="form-group"> <label class="col-sm-2 control-label">快递公司<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入快递公司名称" class="form-control" type="text" name="express" value="';
$out+=$escape(dataInfo?dataInfo.express:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">快递号码<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入快递号码" class="form-control" type="text" name="expressNumber" value="';
$out+=$escape(dataInfo?dataInfo.expressNumber:'');
$out+='"> </div> </div> ';
}
$out+=' </form> ';
return new String($out);
});/*v:1*/
template('m_backstage/m_backstage_index',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,userName=$data.userName,companyName=$data.companyName,companyVersion=$data.companyVersion,usableCount=$data.usableCount,accountCount=$data.accountCount,useCount=$data.useCount,subsidiaryOrgUsedCount=$data.subsidiaryOrgUsedCount,_isNullOrBlank=$helpers._isNullOrBlank,accountEffectStartTime=$data.accountEffectStartTime,accountEffectEndTime=$data.accountEffectEndTime,_momentFormat=$helpers._momentFormat,isRootCompany=$data.isRootCompany,_storageMToG=$helpers._storageMToG,freeSize=$data.freeSize,totalSize=$data.totalSize,useSize=$data.useSize,subsidiaryOrgUsedSize=$data.subsidiaryOrgUsedSize,spaceEffectStartTime=$data.spaceEffectStartTime,spaceEffectEndTime=$data.spaceEffectEndTime,$out='';$out+='<div class="m m-backstage-index"> <h4>';
$out+=$escape(userName);
$out+=',欢迎使用卯丁，您所在的是“';
$out+=$escape(companyName);
$out+='”的管理后台。</h4> <div class="row"> <div class="col-24-md-12 "> <div class="panel panel-default box-shadow-1"> <div class="panel-body"> <div class="col-xs-6"> <div id="chartArea1" class="chartjs-render-monitor m-t-lg" ></div> <div class="chart-content" > <p class="font-bold">剩余可用</p> <p class="m-t-md"><span class="font-bold">';
$out+=$escape(companyVersion=='03'?'--':usableCount+'个');
$out+='</span></p> </div> <p class="text-center">当前版本：';
if(companyVersion=='01'){
$out+='企业版';
}else if(companyVersion=='02'){
$out+='专业版';
}else{
$out+='免费版';
}
$out+='</p> </div> <div class="col-xs-6 chart-info-content"> <a href="javascript:void(0);" class="absolute-top-right" data-action="viewAccountChart" ><i class="fa fa-bar-chart-o"></i></a> <h4 class="fc-dark-grey">账号使用概览</h4> <p>账号总数：';
$out+=$escape(companyVersion=='03'?'--':accountCount);
$out+='</p> <p>已使用数量：';
$out+=$escape(useCount);
$out+='</p> ';
if(companyVersion!='03'){
$out+=' <p>下属组织使用数量：';
$out+=$escape(companyVersion=='03'?'--':subsidiaryOrgUsedCount);
$out+='</p> ';
}
$out+=' <p>剩余可用数量：';
$out+=$escape(companyVersion=='03'?'--':usableCount);
$out+='</p> <p> 有效时间: ';
if(_isNullOrBlank(accountEffectStartTime) && _isNullOrBlank(accountEffectEndTime)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(accountEffectStartTime,'YYYY/MM/DD'));
$out+='-';
$out+=$escape(_momentFormat(accountEffectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </p> </div> <div class="col-xs-12 text-center btn-purchase-col"> ';
if(isRootCompany == 1){
$out+=' <a href="#/backstageMgt/purchase?type=1" class="btn btn-primary roleControl" roleCode="10000101" flag="2" data-action="purchaseVersionSpace">版本及账号购买</a> ';
}
$out+=' </div> <div class="clearfix"></div> </div> </div> </div> <div class="col-24-md-12 p-l-none"> <div class="panel panel-default box-shadow-1"> <div class="panel-body"> <div class="col-xs-6"> <div id="chartArea2" class="chartjs-render-monitor m-t-lg" style="display: block; width: 100%; height: 200px;"></div> <div class="chart-content" > <p class="font-bold">剩余可用</p> <p class="m-t-md"><span class="font-bold">';
$out+=$escape(_storageMToG(freeSize));
$out+='</span></p> </div> </div> <div class="col-xs-6 chart-info-content"> <a href="javascript:void(0);" class="absolute-top-right" data-action="viewSpaceChart" ><i class="fa fa-bar-chart-o"></i></a> <h4 class="fc-dark-grey">存储空间使用概览</h4> <p>存储空间总容量：';
$out+=$escape(_storageMToG(totalSize));
$out+='</p> <p>免费空间：5G</p> <p>付费空间：';
$out+=$escape(_storageMToG(totalSize-5));
$out+='</p> <p>已使用空间：';
$out+=$escape(_storageMToG(useSize));
$out+='</p> ';
if(companyVersion!='03'){
$out+=' <p>下属组织使用空间容量：';
$out+=$escape(_storageMToG(subsidiaryOrgUsedSize));
$out+='</p> ';
}
$out+=' <p>剩余空间容量：';
$out+=$escape(_storageMToG(freeSize));
$out+='</p> <p> 付费空间有效时间: ';
if(_isNullOrBlank(spaceEffectStartTime) && _isNullOrBlank(spaceEffectEndTime)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(spaceEffectStartTime,'YYYY/MM/DD'));
$out+='-';
$out+=$escape(_momentFormat(spaceEffectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </p> </div> <div class="col-xs-12 text-center btn-purchase-col"> ';
if(isRootCompany == 1){
$out+=' <a href="#/backstageMgt/purchase?type=3" class="btn btn-primary roleControl" roleCode="10000101" flag="2" data-action="purchaseVersionSpace">存储空间购买</a> ';
}
$out+=' </div> <div class="clearfix"></div> </div> </div> </div> </div> <div class="row"> <div class="col-24-md-24"> <h4 class="title-line fc-dark-grey">购买记录</h4> <div class="data-list-box"> <div class="data-list-container"></div> <div> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_backstage/m_backstage_index_chart','<div class="row m"> <div class="col-md-12 m-b-md"> <div id="barChart" style="width: 900px;height: 400px;"></div> </div> </div>');/*v:1*/
template('m_backstage/m_backstage_menu',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,role=$data.role,$out='';$out+='<div class="ibox no-margins"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right"> <ul class="secondary-menu-ul">  ';
if(role.isRootCompany==1){
$out+=' <li class="roleControl" id="orgInfo" roleCode="100007,10000301" flag="2"> <a href="#/backstageMgt/orgInfo">组织信息</a> </li> ';
}
$out+=' <li id="organizational" class="roleControl" roleCode="100001,10000101" flag="2"> <a href="#/backstageMgt/organizational">组织架构</a> </li> <li id="permissionSettings" class="roleControl" roleCode="100004,10000401" flag="2"> <a href="#/backstageMgt/permissionSettings">权限配置</a> </li>  <li id="projectSettings" class="roleControl" roleCode="10000601,10000602" flag="2"> <a href="#/backstageMgt/projectSettings">项目设置</a> </li>  </ul> </div> </div> </div> </div> <div class="ibox-content no-padding" id="content-box"> </div> </div>';
return new String($out);
});/*v:1*/
template('m_backstage/m_backstage_order_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_isNullOrBlank=$helpers._isNullOrBlank,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="table table-hover" > <thead> <tr> <th width="12%">订购时间</th> <th width="10%">订单内容</th> <th width="8%">单价</th> <th width="8%">数量</th> <th width="20%">有效时间</th> <th width="10%">开通状态</th> <th width="12%">小计(元)</th> <th width="10">发票</th> <th width="10">操作</th> </tr> </thead> <tbody> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <tr class="curp" data-i="';
$out+=$escape(i);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='"> <td>';
$out+=$escape(_momentFormat(p.createDate,'YYYY/MM/DD'));
$out+='</td> <td> <!--';
$out+=$escape(p.productName);
$out+='--> ';
if(p.productContentType=='2'){
$out+=' 账号扩充・';
$out+=$escape(p.productName);
$out+=' ';
}else if(p.productContentType=='3'){
$out+=' 版本续费・';
$out+=$escape(p.productName);
$out+=' ';
}else if(p.productContentType=='4'){
$out+=' 存储空间扩容 ';
}else if(p.productContentType=='5'){
$out+=' 存储空间续费 ';
}else{
$out+=' 版本升级・';
$out+=$escape(p.productName);
$out+=' ';
}
$out+=' </td> <td> ';
$out+=$escape(p.costPerUnit);
$out+=$escape(p.productType=='0'?'元/G/年':'/人/年');
$out+=' </td> <td> ';
if(p.orderCount){
$out+=' ';
$out+=$escape(p.orderCount);
$out+=$escape(p.productType=='0'?'G':'');
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </td> <td> ';
if(_isNullOrBlank(p.effectStartTime) && _isNullOrBlank(p.effectEndTime)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(p.effectStartTime,'YYYY/MM/DD'));
$out+='-';
$out+=$escape(_momentFormat(p.effectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </td> <td> ';
if(p.isPayment==0){
$out+=' <!--<a href="javascript:void(0);" data-action="payOrder" data-value="';
$out+=$escape(p.isPayment);
$out+='">未支付</a>--> 未开通 ';
}else{
$out+=' 已开通 ';
}
$out+=' </td> <td>';
$out+=$escape(_expNumberFilter(p.orderAmount));
$out+='</td> <td> ';
if(p.status==1){
$out+=' <a href="javascript:void(0);" data-action="applyBilling" data-status="';
$out+=$escape(p.status);
$out+='" data-invoice-id="';
$out+=$escape(p.invoiceId);
$out+='" class="roleControl" roleCode="10000101" flag="2">申请开票</a> ';
}else if(p.status==2){
$out+=' <a href="javascript:void(0);" data-action="applyBilling" data-status="';
$out+=$escape(p.status);
$out+='" data-invoice-id="';
$out+=$escape(p.invoiceId);
$out+='" class="roleControl" roleCode="10000101" flag="2">待开票</a> ';
}else if(p.status==3){
$out+=' <a href="javascript:void(0);" data-action="applyBilling" data-status="';
$out+=$escape(p.status);
$out+='" data-invoice-id="';
$out+=$escape(p.invoiceId);
$out+='" class="roleControl" roleCode="10000101" flag="2">已开票</a> ';
}else{
$out+=' -- ';
}
$out+=' </td> <td> ';
if(p.isPayment!=1){
$out+=' <a href="javascript:void(0);" data-action="delOrder" class="roleControl" roleCode="10000101" flag="2">删除</a> ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="9" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无购买记录</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_backstage/m_backstage_purchase','<div class="ibox ibox-shadow m-backstage-purchase"> <div class="ibox-title border-no-t"> <div class="ibox-tools"> <div class="mt-element-step-new m-b-lg" > <div class="row step-line"> <div class="mt-step-desc"> </div> <div class="col-md-4 mt-step-col first active" data-step="1"> <div class="mt-step-number bg-white">1</div> <div class="mt-step-title uppercase font-grey-cascade">提交订单</div> <div class="mt-step-content font-grey-cascade"></div> </div> <div class="col-md-4 mt-step-col" data-step="2"> <div class="mt-step-number bg-white">2</div> <div class="mt-step-title uppercase font-grey-cascade">等待付款</div> <div class="mt-step-content font-grey-cascade"></div> </div> <div class="col-md-4 mt-step-col last" data-step="3"> <div class="mt-step-number bg-white">3</div> <div class="mt-step-title uppercase font-grey-cascade">完成支付</div> <div class="mt-step-content font-grey-cascade"></div> </div> </div> </div> </div> </div> <div class="ibox-content"> <div class="col-24-xs-18 col-24-xs-offset-3 step-container"> </div> </div> </div>');/*v:1*/
template('m_backstage/m_backstage_purchase_confirm',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,title=$data.title,productContentType=$data.productContentType,orderCount=$data.orderCount,version=$data.version,oldPurchasedNum=$data.oldPurchasedNum,purchasedNum=$data.purchasedNum,currentEffectTimeStr=$data.currentEffectTimeStr,serviceTime=$data.serviceTime,serviceTimeStr=$data.serviceTimeStr,oldSpaceCapacity=$data.oldSpaceCapacity,productCode=$data.productCode,purchaseTime=$data.purchaseTime,purchaseTimeStr=$data.purchaseTimeStr,orderAmount=$data.orderAmount,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-sm-3 text-right">订单内容：</label> <div class="col-sm-9"> ';
$out+=$escape(title);
$out+=' </div> </div> ';
if(productContentType==2){
$out+=' <div class="form-group"> <label class="col-sm-3 text-right">扩充账号数：</label> <div class="col-sm-9"> ';
$out+=$escape(orderCount);
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">当前版本：</label> <div class="col-sm-9"> ';
if(version=='03'){
$out+=' 基础版 ';
}else if(version=='02'){
$out+=' 专业版 ';
}else if(version=='01'){
$out+=' 企业版 ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">当前版本购买账号数：</label> <div class="col-sm-9"> ';
$out+=$escape(oldPurchasedNum);
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">扩充后版本账号数：</label> <div class="col-sm-9"> ';
$out+=$escape(purchasedNum);
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">当前有效时间：</label> <div class="col-sm-9"> ';
$out+=$escape(currentEffectTimeStr);
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">扩充后有效时间：</label> <div class="col-sm-9"> ';
$out+=$escape(currentEffectTimeStr);
$out+=' </div> </div> ';
}else if(productContentType==3){
$out+=' <div class="form-group"> <label class="col-sm-3 text-right">续费版本：</label> <div class="col-sm-9"> ';
if(version=='03'){
$out+=' 基础版 ';
}else if(version=='02'){
$out+=' 专业版 ';
}else if(version=='01'){
$out+=' 企业版 ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">续费时长：</label> <div class="col-sm-9"> ';
$out+=$escape(serviceTime);
$out+='年 </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">续费账号数：</label> <div class="col-sm-9"> ';
$out+=$escape(oldPurchasedNum);
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">当前有效时间：</label> <div class="col-sm-9"> ';
$out+=$escape(currentEffectTimeStr);
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">续费后有效时间：</label> <div class="col-sm-9"> ';
$out+=$escape(serviceTimeStr);
$out+=' </div> </div> ';
}else if(productContentType==4){
$out+=' <div class="form-group"> <label class="col-sm-3 text-right">购买存储空间：</label> <div class="col-sm-9"> ';
$out+=$escape(orderCount);
$out+='G </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">当前存储空间：</label> <div class="col-sm-9"> ';
$out+=$escape(oldSpaceCapacity);
$out+='G </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">扩充后存储空间：</label> <div class="col-sm-9"> ';
$out+=$escape(purchasedNum);
$out+='G </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">存储空间有效时间：</label> <div class="col-sm-9"> ';
$out+=$escape(currentEffectTimeStr);
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">扩充后有效时间：</label> <div class="col-sm-9"> ';
$out+=$escape(currentEffectTimeStr);
$out+=' </div> </div> ';
}else if(productContentType==5){
$out+=' <div class="form-group"> <label class="col-sm-3 text-right">续费时长：</label> <div class="col-sm-9"> ';
$out+=$escape(serviceTime);
$out+='年 </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">当前存储空间：</label> <div class="col-sm-9"> ';
$out+=$escape(oldSpaceCapacity);
$out+='G </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">当前有效时间：</label> <div class="col-sm-9"> ';
$out+=$escape(currentEffectTimeStr);
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">续费后有效时间：</label> <div class="col-sm-9"> ';
$out+=$escape(serviceTimeStr);
$out+=' </div> </div> ';
}else{
$out+=' <div class="form-group"> <label class="col-sm-3 text-right">购买账号数：</label> <div class="col-sm-9"> ';
$out+=$escape(orderCount?orderCount:oldPurchasedNum);
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">当前版本：</label> <div class="col-sm-9"> ';
if(version=='03'){
$out+=' 基础版 ';
}else if(version=='02'){
$out+=' 专业版 ';
}else if(version=='01'){
$out+=' 企业版 ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">购买版本：</label> <div class="col-sm-9"> ';
if(productCode=='02'){
$out+=' 专业版 ';
}else if(productCode=='01'){
$out+=' 企业版 ';
}
$out+=' </div> </div> ';
if(purchaseTime){
$out+=' <div class="form-group"> <label class="col-sm-3 text-right">购买时长：</label> <div class="col-sm-9"> ';
$out+=$escape(purchaseTime);
$out+='年 </div> </div> ';
}
$out+=' <div class="form-group"> <label class="col-sm-3 text-right">当前版本有效时间：</label> <div class="col-sm-9"> ';
$out+=$escape(currentEffectTimeStr);
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 text-right">购买后有版本效时间：</label> <div class="col-sm-9"> ';
$out+=$escape(purchaseTimeStr);
$out+=' </div> </div> ';
}
$out+=' <div class="form-group"> <label class="col-sm-3 text-right">订单价格合计：</label> <div class="col-sm-9"> ';
$out+=$escape(orderAmount);
$out+='元 </div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_backstage/m_backstage_purchase_old_step1',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,version=$data.version,_isNullOrBlank=$helpers._isNullOrBlank,_momentFormat=$helpers._momentFormat,$out='';$out+='<div class="panel panel-default "> <div class="panel-heading"> <h4>填写订单</h4> </div> <div class="panel-body"> <form class="form-horizontal col-md-10 col-md-offset-1"> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">组织名称：</label> <div class="col-md-9 col-xl-10"> ';
$out+=$escape(dataInfo?dataInfo.companyName:'');
$out+=' </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">当前版本：</label> <div class="col-md-3 col-xl-4"> ';
if(version=='03'){
$out+=' 基础版 ';
}else if(version=='02'){
$out+=' 专业版 ';
}else if(version=='01'){
$out+=' 企业版 ';
}
$out+=' </div> <label class="col-md-3 col-xl-2 text-right">当前容量：</label> <div class="col-md-3 col-xl-4"> ';
$out+=$escape(dataInfo?dataInfo.totalSize:'0');
$out+='G </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">使用/购买(名额)：</label> <div class="col-md-3 col-xl-4"> ';
$out+=$escape(dataInfo?dataInfo.useCount:'0');
$out+='人/';
$out+=$escape(dataInfo?dataInfo.accountCount:'0');
$out+='人 </div> <label class="col-md-3 col-xl-2 text-right">剩余容量：</label> <div class="col-md-3 col-xl-4"> ';
$out+=$escape(dataInfo?dataInfo.freeSize:'0');
$out+='G </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">有效时间：</label> <div class="col-md-3 col-xl-4" id="accountEffectTime"> ';
if(_isNullOrBlank(dataInfo) || (_isNullOrBlank(dataInfo.accountEffectStartTime) && _isNullOrBlank(dataInfo.accountEffectEndTime))){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.accountEffectStartTime,'YYYY/MM/DD'));
$out+='-';
$out+=$escape(_momentFormat(dataInfo.accountEffectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> <label class="col-md-3 col-xl-2 text-right">有效时间：</label> <div class="col-md-3 col-xl-4" id="spaceEffectTime"> ';
if(_isNullOrBlank(dataInfo) || (_isNullOrBlank(dataInfo.spaceEffectStartTime) && _isNullOrBlank(dataInfo.spaceEffectEndTime))){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.spaceEffectStartTime,'YYYY/MM/DD'));
$out+='-';
$out+=$escape(_momentFormat(dataInfo.spaceEffectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> </form> ';
if(version=='03'){
$out+=' <form class="form-horizontal col-md-10 col-md-offset-1" id="baseVersion"> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">版本类型：</label> <div class="col-md-9 col-xl-10"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="productCode" value="02" checked/> <span class="i-checks-span">专业版</span> </label> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="productCode" value="01"/> <span class="i-checks-span">企业版</span> </label> </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 control-label">成员名额：</label> <div class="col-md-9 col-xl-10"> <div class="input-group"> <input placeholder="请输入成员名额" class="form-control" type="text" name="orderCount" value=""> <span class="input-group-addon">人</span> </div> </div> <div class="fc-v1-grey col-md-offset-3 col-xl-offset-2 p-l">当前组织总人数为“';
$out+=$escape(dataInfo?dataInfo.accountCount:'0');
$out+='人”进行版本升级时，成员名额需>=';
$out+=$escape(dataInfo?dataInfo.accountCount:'0');
$out+='人。</div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">购买时长：</label> <div class="col-md-9 col-xl-10"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="serviceTime" value="1" checked/> <span class="i-checks-span">1年</span> </label> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="serviceTime" value="2"/> <span class="i-checks-span">2年</span> </label> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="serviceTime" value="3"/> <span class="i-checks-span">3年</span> </label> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="serviceTime" value="4"/> <span class="i-checks-span">4年</span> </label> </div> </div> </form> <form class="form-horizontal col-md-10 col-md-offset-1" id="baseSpace"> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">空间购买：</label> <div class="col-md-9 col-xl-10"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="productContentType" value="4" checked/> <span class="i-checks-span">容量扩充</span> </label> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="productContentType" value="5"/> <span class="i-checks-span">续费使用</span> </label> </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 control-label">空间容量：</label> <div class="col-md-9 col-xl-10"> <div class="input-group"> <input placeholder="请输入空间容量" class="form-control" type="text" name="orderCount" value=""> <span class="input-group-addon">G</span> </div> </div> </div> <div class="form-group service-time hide" data-type="1"> <label class="col-md-3 col-xl-2 text-right">购买时长：</label> <div class="col-md-9 col-xl-10"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="serviceTime" value="1" checked/> <span class="i-checks-span">1年</span> </label>  </div> </div> <div class="form-group service-time" data-type="2"> <label class="col-md-3 col-xl-2 text-right">购买时长：</label> <div class="col-md-9 col-xl-10"> ';
if(_isNullOrBlank(dataInfo) || (_isNullOrBlank(dataInfo.spaceEffectStartTime) && _isNullOrBlank(dataInfo.spaceEffectEndTime))){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.spaceEffectStartTime,'YYYY/MM/DD'));
$out+='-';
$out+=$escape(_momentFormat(dataInfo.spaceEffectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> </form> ';
}
$out+=' ';
if(version=='02' || version=='01'){
$out+=' <form class="form-horizontal col-md-10 col-md-offset-1" id="professionalVersion"> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">购买内容：</label> <div class="col-md-9 col-xl-10"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="productType" value="1" checked/> <span class="i-checks-span">版本购买</span> </label> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="productType" value="0"/> <span class="i-checks-span">容量购买</span> </label> </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">相关内容：</label> <div class="col-md-9 col-xl-10 product-content-type"> ';
if(version=='02'){
$out+=' <label class="i-checks i-checks-label fw-normal" data-type="1"> <input type="radio" name="productContentType" value="1" checked/> <span class="i-checks-span">版本升级</span> </label> ';
}
$out+=' <label class="i-checks i-checks-label fw-normal" data-type="1"> <input type="radio" name="productContentType" value="2"/> <span class="i-checks-span">人员扩充</span> </label> <label class="i-checks i-checks-label fw-normal" data-type="1"> <input type="radio" name="productContentType" value="3"/> <span class="i-checks-span">续费使用</span> </label> <label class="i-checks i-checks-label fw-normal hide" data-type="2"> <input type="radio" name="productContentType" value="4"/> <span class="i-checks-span">容量扩充</span> </label> <label class="i-checks i-checks-label fw-normal hide" data-type="2"> <input type="radio" name="productContentType" value="5"/> <span class="i-checks-span">续费使用</span> </label> </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">版本类型：</label> <div class="col-md-9 col-xl-10"> 企业版 </div> </div> <div class="form-group order-count hide"> <label class="col-md-3 col-xl-2 control-label">购买人数：</label> <div class="col-md-9 col-xl-10"> <div class="input-group"> <input placeholder="请输入成员名额" class="form-control" type="text" name="orderCount" value=""> <span class="input-group-addon">人</span> </div> </div> <div class="fc-v1-grey col-md-offset-3 col-xl-offset-2 p-l">购买人数不得小于当前实际人数“';
$out+=$escape(dataInfo?dataInfo.accountCount:'0');
$out+='”人。</div> </div> <div class="form-group service-time" data-type="1"> <label class="col-md-3 col-xl-2 text-right">购买时长：</label> <div class="col-md-9 col-xl-10" id="serviceTimeBox"> ';
if(_isNullOrBlank(dataInfo) || (_isNullOrBlank(dataInfo.accountEffectStartTime) && _isNullOrBlank(dataInfo.accountEffectEndTime))){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.accountEffectStartTime,'YYYY/MM/DD'));
$out+='-';
$out+=$escape(_momentFormat(dataInfo.accountEffectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="form-group service-time hide" data-type="2"> <label class="col-md-3 col-xl-2 text-right">购买时长：</label> <div class="col-md-9 col-xl-10"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="serviceTime" value="1" checked/> <span class="i-checks-span">1年</span> </label> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="serviceTime" value="2"/> <span class="i-checks-span">2年</span> </label> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="serviceTime" value="3"/> <span class="i-checks-span">3年</span> </label> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="serviceTime" value="4"/> <span class="i-checks-span">4年</span> </label> </div> </div> </form> ';
}
$out+=' <div class="row"> <label class="col-md-3 col-xl-2 "></label> <div class="col-md-9 col-xl-10 text-right"> <span class="font-bold f-s-xl v-middle m-r-xs">总计：<span class="fc-red"><span id="orderAmount">';
$out+=$escape(dataInfo?dataInfo.orderAmount:'0');
$out+='</span> &nbsp;元&nbsp;</span></span> <button class="btn btn-primary" data-action="submitOrders">提交订单</button> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_backstage/m_backstage_purchase_step1',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,version=$data.version,_isNullOrBlank=$helpers._isNullOrBlank,_momentFormat=$helpers._momentFormat,nowDate=$data.nowDate,_dateAddByYears=$helpers._dateAddByYears,$out='';$out+='<div class="m-backstage-purchase-step1 m"> <h4 class="text-center">填写订单</h4> <p>当前组织： ';
$out+=$escape(dataInfo?dataInfo.companyName:'');
$out+='</p> <div class="tabs-container" data-version=';
$out+=$escape(version);
$out+='> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="true">版本购买及续费</a></li> ';
if(version=='02' || version=='01'){
$out+=' <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">账号扩充</a></li> ';
}
$out+=' <li class=""><a data-toggle="tab" href="#tab-3" aria-expanded="false">存储空间购买及续费</a></li> </ul> <div class="tab-content"> <div id="tab-1" class="tab-pane active" data-type="versionPurchase"> <div class="panel-body"> <form class="form-horizontal"> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">当前版本：</label> <div class="col-md-9 col-xl-10"> ';
if(version=='03'){
$out+=' 基础版 ';
}else if(version=='02'){
$out+=' 专业版 ';
}else if(version=='01'){
$out+=' 企业版 ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">当前使用账号数：</label> <div class="col-md-9 col-xl-10"> ';
$out+=$escape(dataInfo?dataInfo.useCount:'0');
$out+=' </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">当前已购买账号数：</label> <div class="col-md-9 col-xl-10" data-account-count="';
$out+=$escape(dataInfo?dataInfo.accountCount:'0');
$out+='"> ';
$out+=$escape(dataInfo?dataInfo.accountCount:'0');
$out+=' </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">版本有效时间：</label> <div class="col-md-9 col-xl-10 current-effect-time"> ';
if(_isNullOrBlank(dataInfo) || (_isNullOrBlank(dataInfo.accountEffectStartTime) && _isNullOrBlank(dataInfo.accountEffectEndTime))){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.accountEffectStartTime,'YYYY/MM/DD'));
$out+=' - ';
$out+=$escape(_momentFormat(dataInfo.accountEffectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">购买内容：</label> <div class="col-md-9 col-xl-10"> ';
if(version=='03' || version=='02'){
$out+=' <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="productContentType" value="1" checked/> <span class="i-checks-span">版本购买</span> </label> ';
}
$out+=' ';
if(version=='02' || version=='01'){
$out+=' <label class="i-checks i-checks-label fw-normal"> ';
if(version=='01'){
$out+=' <input type="radio" name="productContentType" value="3" checked/> ';
}else{
$out+=' <input type="radio" name="productContentType" value="3"/> ';
}
$out+=' <span class="i-checks-span">续费使用</span> </label> ';
}
$out+=' </div> </div> <div class="content-box ';
$out+=$escape(version=='01'?'hide':'');
$out+='" data-type="1"> ';
if(version=='03' || version=='02'){
$out+=' <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">购买版本：</label> <div class="col-md-9 col-xl-10"> ';
if(version=='03'){
$out+=' <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="productCode" value="02" checked/> <span class="i-checks-span">专业版</span> </label> ';
}
$out+=' <label class="i-checks i-checks-label fw-normal"> ';
if(version=='02'){
$out+=' <input type="radio" name="productCode" value="01" checked/> ';
}else{
$out+=' <input type="radio" name="productCode" value="01"/> ';
}
$out+=' <span class="i-checks-span">企业版</span> </label> </div> </div> ';
}
$out+=' ';
if(version=='03'){
$out+=' <div class="form-group"> <label class="col-md-3 col-xl-2 control-label">购买名额：</label> <div class="col-md-9 col-xl-10"> <div class="input-group width-225"> <input placeholder="请输入账号数" class="form-control" type="text" name="orderCount" value="" data-type="1" data-min-value="';
$out+=$escape(version=='03'?dataInfo.useCount:dataInfo.accountCount);
$out+='"> </div> </div> </div> ';
}
$out+=' <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">购买后已购账号数：</label> <div class="col-md-9 col-xl-10"> <span class="purchased-num">';
$out+=$escape(version=='03'?dataInfo.useCount:dataInfo.accountCount);
$out+='</span> </div> </div> ';
if(version=='03'){
$out+=' <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">购买时长：</label> <div class="col-md-9 col-xl-10" data-start-time="';
$out+=$escape(_momentFormat(dataInfo.accountEffectStartTime,'YYYY-MM-DD'));
$out+='" data-end-time="';
$out+=$escape(_momentFormat(dataInfo.accountEffectEndTime,'YYYY-MM-DD'));
$out+='"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="purchaseTime" value="1" checked/> <span class="i-checks-span">1年</span> </label>  </div> </div> ';
}
$out+=' <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">购买后有效时间：</label> <div class="col-md-9 col-xl-10 purchase-time-show"> ';
if(_isNullOrBlank(dataInfo) || (_isNullOrBlank(dataInfo.accountEffectStartTime) && _isNullOrBlank(dataInfo.accountEffectEndTime))){
$out+=' ';
$out+=$escape(_momentFormat(nowDate,'YYYY/MM/DD'));
$out+=' - ';
$out+=$escape(_dateAddByYears(nowDate,1));
$out+=' ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.accountEffectStartTime,'YYYY/MM/DD'));
$out+=' - ';
$out+=$escape(version=='02'?_momentFormat(dataInfo.accountEffectEndTime,'YYYY/MM/DD'):_dateAddByYears(dataInfo.accountEffectEndTime,1));
$out+=' ';
}
$out+=' </div> </div> </div> <div class="content-box ';
$out+=$escape(version=='01'?'':'hide');
$out+='" data-type="3"> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">续费时长：</label> <div class="col-md-9 col-xl-10" data-start-time="';
$out+=$escape(_momentFormat(dataInfo.accountEffectStartTime,'YYYY-MM-DD'));
$out+='" data-end-time="';
$out+=$escape(_momentFormat(dataInfo.accountEffectEndTime,'YYYY-MM-DD'));
$out+='"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="serviceTime" value="1" checked/> <span class="i-checks-span">1年</span> </label>  </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">续费后有效时间：</label> <div class="col-md-9 col-xl-10 service-time-show" > ';
if(_isNullOrBlank(dataInfo) || (_isNullOrBlank(dataInfo.accountEffectStartTime) && _isNullOrBlank(dataInfo.accountEffectEndTime))){
$out+=' ';
$out+=$escape(_momentFormat(nowDate,'YYYY/MM/DD'));
$out+=' - ';
$out+=$escape(_dateAddByYears(nowDate,1));
$out+=' ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.accountEffectStartTime,'YYYY/MM/DD'));
$out+=' - ';
$out+=$escape(_dateAddByYears(dataInfo.accountEffectEndTime,1));
$out+=' ';
}
$out+=' </div> </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2"></label> <div class="col-md-9 col-xl-10 text-right"> <span class="font-bold f-s-xl v-middle m-r-xs">总计：<span class="fc-red"><span class="order-amount">';
$out+=$escape(dataInfo?dataInfo.orderAmount:'0');
$out+='</span> &nbsp;元&nbsp;</span></span> <button class="btn btn-primary" data-action="submitOrders">提交订单</button> </div> </div> </form> </div> </div> <div id="tab-2" class="tab-pane" data-type="personnelPurchase"> <div class="panel-body"> <form class="form-horizontal"> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">当前版本：</label> <div class="col-md-9 col-xl-10"> ';
if(version=='03'){
$out+=' 基础版 ';
}else if(version=='02'){
$out+=' 专业版 ';
}else if(version=='01'){
$out+=' 企业版 ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">当前使用账号：</label> <div class="col-md-9 col-xl-10"> ';
$out+=$escape(dataInfo?dataInfo.useCount:'0');
$out+=' </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">当前已购买账号数：</label> <div class="col-md-9 col-xl-10" data-account-count="';
$out+=$escape(dataInfo?dataInfo.accountCount:'0');
$out+='"> ';
$out+=$escape(dataInfo?dataInfo.accountCount:'0');
$out+=' </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">版本有效时间：</label> <div class="col-md-9 col-xl-10 current-effect-time" data-end-time="';
$out+=$escape(_momentFormat(dataInfo.accountEffectEndTime,'YYYY-MM-DD'));
$out+='"> ';
if(_isNullOrBlank(dataInfo) || (_isNullOrBlank(dataInfo.accountEffectStartTime) && _isNullOrBlank(dataInfo.accountEffectEndTime))){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.accountEffectStartTime,'YYYY/MM/DD'));
$out+=' - ';
$out+=$escape(_momentFormat(dataInfo.accountEffectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="form-group order-count"> <label class="col-md-3 col-xl-2 control-label">扩充数量：</label> <div class="col-md-9 col-xl-10"> <div class="input-group width-225"> <input placeholder="请输入账号数" class="form-control" type="text" name="orderCount" value="" data-type="2"> </div> </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">扩充后账号总数：</label> <div class="col-md-9 col-xl-10"> <span class="purchased-num">';
$out+=$escape(dataInfo?dataInfo.accountCount:'0');
$out+='</span> </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">扩充后有效时间：</label> <div class="col-md-9 col-xl-10"> ';
if(_isNullOrBlank(dataInfo) || (_isNullOrBlank(dataInfo.accountEffectStartTime) && _isNullOrBlank(dataInfo.accountEffectEndTime))){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.accountEffectStartTime,'YYYY/MM/DD'));
$out+=' - ';
$out+=$escape(_momentFormat(dataInfo.accountEffectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 "></label> <div class="col-md-9 col-xl-10 text-right"> <span class="font-bold f-s-xl v-middle m-r-xs">总计：<span class="fc-red"><span class="order-amount">0</span> &nbsp;元&nbsp;</span></span> <button class="btn btn-primary" data-action="submitOrders">提交订单</button> </div> </div> </form> </div> </div> <div id="tab-3" class="tab-pane" data-type="spacePurchase"> <div class="panel-body"> <form class="form-horizontal"> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">当前存储空间：</label> <div class="col-md-9 col-xl-10" data-space-capacity="';
$out+=$escape(dataInfo?dataInfo.totalSize:'0');
$out+='"> ';
$out+=$escape(dataInfo?dataInfo.totalSize:'0');
$out+='G </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">免费存储空间：</label> <div class="col-md-9 col-xl-10"> 5G </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">付费存储空间：</label> <div class="col-md-9 col-xl-10"> ';
$out+=$escape(dataInfo?dataInfo.totalSize-5:'0');
$out+='G </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">剩余存储空间：</label> <div class="col-md-9 col-xl-10"> ';
$out+=$escape(dataInfo?dataInfo.freeSize:'0');
$out+='G </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">付费空间有效时间：</label> <div class="col-md-9 col-xl-10 current-effect-time" data-start-time="';
$out+=$escape(_momentFormat(dataInfo.spaceEffectStartTime,'YYYY-MM-DD'));
$out+='" data-end-time="';
$out+=$escape(_momentFormat(dataInfo.spaceEffectEndTime,'YYYY-MM-DD'));
$out+='"> ';
if(_isNullOrBlank(dataInfo) || (_isNullOrBlank(dataInfo.spaceEffectStartTime) && _isNullOrBlank(dataInfo.spaceEffectEndTime))){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.spaceEffectStartTime,'YYYY/MM/DD'));
$out+=' - ';
$out+=$escape(_momentFormat(dataInfo.spaceEffectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">购买内容：</label> <div class="col-md-9 col-xl-10"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="productContentType" value="4" checked/> <span class="i-checks-span">存储空间扩充</span> </label> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="productContentType" value="5"/> <span class="i-checks-span">续费使用</span> </label> </div> </div> <div class="content-box" data-type="4"> <div class="form-group"> <label class="col-md-3 col-xl-2 control-label">存储空间容量：</label> <div class="col-md-9 col-xl-10"> <div class="input-group width-225"> <input placeholder="请输入存储空间容量" class="form-control" type="text" name="orderCount" value="" data-type="3"> <span class="input-group-addon">G</span> </div> </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">购买后存储空间：</label> <div class="col-md-9 col-xl-10"> <span class="purchased-num">';
$out+=$escape(dataInfo?dataInfo.totalSize:'0');
$out+='</span>G </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">扩充后付费空间有效时间：</label> <div class="col-md-9 col-xl-10"> ';
if(_isNullOrBlank(dataInfo) || (_isNullOrBlank(dataInfo.spaceEffectStartTime) && _isNullOrBlank(dataInfo.spaceEffectEndTime))){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.spaceEffectStartTime,'YYYY/MM/DD'));
$out+=' - ';
$out+=$escape(_momentFormat(dataInfo.spaceEffectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> </div> <div class="content-box hide" data-type="5"> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">续费时长：</label> <div class="col-md-9 col-xl-10"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="serviceTime" value="1" checked/> <span class="i-checks-span">1年</span> </label> </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 text-right">续费后有效时间：</label> <div class="col-md-9 col-xl-10 service-time-show"> ';
if(_isNullOrBlank(dataInfo) || (_isNullOrBlank(dataInfo.spaceEffectStartTime) && _isNullOrBlank(dataInfo.spaceEffectEndTime))){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.spaceEffectStartTime,'YYYY/MM/DD'));
$out+=' - ';
$out+=$escape(_dateAddByYears(dataInfo.spaceEffectEndTime,1));
$out+=' ';
}
$out+=' </div> </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 "></label> <div class="col-md-9 col-xl-10 text-right"> <span class="font-bold f-s-xl v-middle m-r-xs">总计：<span class="fc-red"><span class="order-amount">0</span> &nbsp;元&nbsp;</span></span> <button class="btn btn-primary" data-action="submitOrders">提交订单</button> </div> </div> </form> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_backstage/m_backstage_purchase_step2',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,companyName=$data.companyName,list=$data.list,$each=$utils.$each,p=$data.p,i=$data.i,_isNullOrBlank=$helpers._isNullOrBlank,_momentFormat=$helpers._momentFormat,total=$data.total,_url=$helpers._url,$out='';$out+='<div class="panel panel-default "> <div class="panel-heading"> <h4>订单详情</h4> </div> <div class="panel-body"> <form class="form-horizontal col-md-10 col-md-offset-1"> <div class="form-group"> <label class="col-md-3 col-xl-2 ">组织名称：</label> <div class="col-md-9 col-xl-10"> ';
$out+=$escape(companyName);
$out+=' </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 ">手机号码：</label> <div class="col-md-9 col-xl-10"> <span class="order-cellphone">';
$out+=$escape(list && list.length>0?list[0].cellphone:'');
$out+='</span> <a href="javascript:void(0);" class="editable-click" data-action="editCellphone" data-key="cellphone" data-placeholder="请输入手机号" data-type="1" data-valid="1" data-max-length="11" title="更改联系人手机号码"> <i class="icon iconfont icon-bianji"></i> </a> </div> </div> <div class="form-group"> <div class="col-md-12"> <table class="table table-hover border m-b-none" > <thead> <tr> <th>订单编号</th> <th>订单内容</th> <th>单价</th> <th>数量</th> <th>有效时间</th> <th>小计</th> </tr> </thead> <tbody> ';
$each(list,function(p,i){
$out+=' <tr> <td>';
$out+=$escape(p.orderNo);
$out+='</td> <td> <!--';
$out+=$escape(p.productName);
$out+='--> ';
if(p.productContentType=='2'){
$out+=' 账号扩充・';
$out+=$escape(p.productName);
$out+=' ';
}else if(p.productContentType=='3'){
$out+=' 版本续费・';
$out+=$escape(p.productName);
$out+=' ';
}else if(p.productContentType=='4'){
$out+=' 存储空间扩容 ';
}else if(p.productContentType=='5'){
$out+=' 存储空间续费 ';
}else{
$out+=' 版本升级・';
$out+=$escape(p.productName);
$out+=' ';
}
$out+=' </td> <td>';
$out+=$escape(p.costPerUnit);
$out+=$escape(p.productType=='0'?'元/G/年':'/人/年');
$out+='</td> <td>';
$out+=$escape(p.orderCount);
$out+=$escape(p.productType=='0'?'G':'');
$out+='</td> <td> ';
if(_isNullOrBlank(p.effectStartTime) && _isNullOrBlank(p.effectEndTime)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(p.effectStartTime,'YYYY/MM/DD'));
$out+='-';
$out+=$escape(_momentFormat(p.effectEndTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </td> <td>';
$out+=$escape(p.orderAmount);
$out+='</td> </tr> ';
});
$out+=' <tr> <td colspan="5"></td> <td>总计：<span class="fc-red">';
$out+=$escape(total);
$out+='</span>元</td> </tr> </tbody> </table> </div> </div> <div class="form-group"> <p class="m-l m-r fc-v2-grey">目前仅支持对公转账，您当前待支付的金额为<span class="fc-red">';
$out+=$escape(total);
$out+='</span>元,请将费用付款至以下银行账户，在订单支付完成后，请联系在线客服开通。</p> </div> <div class="form-group"> <label class="col-md-12">开户名称：深圳市卯丁技术有限公司</label> <label class="col-md-12">开户银行：中国工商银行深圳益田支行</label> <label class="col-md-12">账&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;号：4000032309200182427</label> </div> <div class="hr-line-dashed"></div> <div class="form-group"> <div class="col-md-12 fc-v2-grey m-b-xs">在线客服QQ：1915772554</div> <div class="col-md-12 fc-v2-grey m-b-xs">联系电话：400-900-6299</div> <div class="col-md-12 fc-v2-grey m-b-xs">办公时间：法定工作日 09:00 - 18:00</div> </div> <!--<div class="form-group"> <label class="col-md-12">选择支付方式：</label> </div> <div class="form-group"> <div class="col-sm-12"> <div class="payment-option active"> <img class="m-t-sm" src="';
$out+=$escape(_url('/img/common/zhifubao.png'));
$out+='" width="110"> <div class="checked"><span class="fa fa-check "></span></div> </div> <div class="payment-option"> <img class="m-t-sm" src="';
$out+=$escape(_url('/img/common/yinlian.png'));
$out+='" width="110"> <div class="checked"><span class="fa fa-check "></span></div> </div> </div> </div> <div class="form-group"> <label class="col-md-3 col-xl-2 "></label> <div class="col-md-9 col-xl-10 text-right"> <span class="font-bold f-s-xl v-middle m-r-xs">总计：<span class="fc-red">7978</span></span> <button class="btn btn-primary">立即支付</button> </div> </div>--> </form> </div> </div>';
return new String($out);
});/*v:1*/
template('m_browser_tips/m_browser_tips',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="m-browser-tips"> <div class="tips-head"> <img src="';
$out+=$escape(_url('/img/logo_white.png'));
$out+='" style="width:200px"> </div> <div class="tips-content"> <p>由于你当前使用的浏览器版本过低，若继续访问可能会导致部分功能展示不正常，我们推荐你使用以下浏览器进行访问。</p> <p style="margin: 50px 0 30px 0;"><a href="javascript:void(0)" data-action="continue">&gt;&gt;&gt;&nbsp;继续访问</a></p> <ul> <li> <img src="';
$out+=$escape(_url('/img/browser/chrome.png'));
$out+='"> <p>Chrome（推荐）</p> </li> <li> <img src="';
$out+=$escape(_url('/img/browser/firefox.png'));
$out+='"> <p>Firefox</p> </li> <li> <img src="';
$out+=$escape(_url('/img/browser/360.png'));
$out+='"> <p>360极速</p> </li> <li> <img src="';
$out+=$escape(_url('/img/browser/ie.png'));
$out+='"> <p>IE 10+</p> </li> </ul> </div> <div> <span style="font-size: 12px;bottom: 10px;right:15px;position: absolute;"><input id="m-browser-never-tips" type="checkbox" />&nbsp;不再提示</span> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_common/m_attach',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,netFileId=$data.netFileId,fullPath=$data.fullPath,fileName=$data.fileName,type=$data.type,$out='';$out+='<span class="label m-r-xs m-b-xs" style="background: #ecf0f1;padding: 5px 10px;display: inline-block;"> <a href="javascript:void(0)" data-action="preview" data-net-file-id="';
$out+=$escape(netFileId);
$out+='" data-src="';
$out+=$escape(fullPath);
$out+='" data-name="';
$out+=$escape(fileName);
$out+='" data-type="';
$out+=$escape(type);
$out+='">';
$out+=$escape(fileName);
$out+='</a> <a class="curp m-l-xs" href="javascript:void(0)" data-action="deleteAttach" data-net-file-id="';
$out+=$escape(netFileId);
$out+='" data-type="';
$out+=$escape(type);
$out+='"> <i class="fa fa-times fc-red"></i> </a> </span>';
return new String($out);
});/*v:1*/
template('m_common/m_attach_no_delete',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,netFileId=$data.netFileId,fullPath=$data.fullPath,fileName=$data.fileName,type=$data.type,$out='';$out+='<span class="label m-r-xs m-b-xs" style="background: #ecf0f1;padding: 5px 10px;display: inline-block;"> <a href="javascript:void(0)" data-action="preview" data-net-file-id="';
$out+=$escape(netFileId);
$out+='" data-src="';
$out+=$escape(fullPath);
$out+='" data-name="';
$out+=$escape(fileName);
$out+='" data-type="';
$out+=$escape(type);
$out+='">';
$out+=$escape(fileName);
$out+='</a> <a class="curp m-l-xs" href="javascript:void(0)" data-action="deleteAttach" data-net-file-id="';
$out+=$escape(netFileId);
$out+='" data-type="';
$out+=$escape(type);
$out+='"> </a> </span> ';
return new String($out);
});/*v:1*/
template('m_common/m_bottom',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_serverUrl=$helpers._serverUrl,$out='';$out+='<div class="pull-right"> </div> <div> <a href="';
$out+=$escape(_serverUrl('/'));
$out+='" target="_blank" style="color: #676a6c"><strong>Copyright</strong>&nbsp;imaoding.com&nbsp;&copy;&nbsp;2015-2017</a> <span class="pull-right" id="footDiskInfo">已使用：0B&nbsp;&nbsp;总容量：5.0GB</span> </div>';
return new String($out);
});/*v:1*/
template('m_common/m_breadcrumb',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,i=$data.i,$escape=$utils.$escape,$out='';$out+=' <div class="no-margins p-h-sm breadcrumb-box" > <ol class="breadcrumb"> ';
$each(dataList,function(p,i){
$out+=' <li class="';
$out+=$escape(i>0?'fa fa-angle-right':'');
$out+=' ';
$out+=$escape(i+1==dataList.length?'active fw-bold':'');
$out+='"> ';
if(p.url){
$out+=' <a href="';
$out+=$escape(p.url);
$out+='">';
$out+=$escape(p.name);
$out+='</a> ';
}else{
$out+=' ';
$out+=$escape(p.name);
$out+=' ';
}
$out+=' </li> ';
});
$out+=' </ol> </div>';
return new String($out);
});/*v:1*/
template('m_common/m_date_range_picker','<style> .quickDatePicker{ height: 241px; border: solid 1px #ccc; } .quickDatePicker iframe{ height: 225px;box-shadow: none !important;} </style> <div class="m-date-range-picker"> <div class="row"> <div class="col-sm-6"> <span class="dp-inline-block p-xxs f-s-xs">开始时间</span> </div> <div class="col-sm-6 p-l-none"> <span class="dp-inline-block p-xxs f-s-xs">截止时间</span> </div> </div> <div class="row"> <div class="col-sm-6 p-r-none"> <div id=\'quickDatePicker1\' class="quickDatePicker"></div> </div> <div class="col-sm-6 p-l-none"> <div id=\'quickDatePicker2\' class="quickDatePicker"></div> </div> </div> <div class="row m-t-xs"> <div class="col-sm-12 text-right p-r-md"> <button class="btn btn-default btn-sm" data-action="cancel">取消</button> <button class="btn btn-primary btn-sm" data-action="ok">确定</button> </div> </div> </div> ');/*v:1*/
template('m_common/m_display_by_role_value',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,role=$data.role,_isNullOrBlank=$helpers._isNullOrBlank,value=$data.value,type=$data.type,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,$out='';$out+=' ';
if(role==1){
$out+=' ';
if(_isNullOrBlank(value)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
if(type==1){
$out+=' ';
$out+=$escape(_momentFormat(value,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' ';
$out+=$escape(value);
$out+=' ';
}
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(value)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
if(type==1){
$out+=' ';
$out+=$escape(_momentFormat(value,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' ';
$out+=$escape(value);
$out+=' ';
}
$out+=' ';
}
$out+=' ';
}
return new String($out);
});/*v:1*/
template('m_common/m_error_404','<div class="middle-box text-center animated fadeInDown p-h-sm"> <h1>404</h1> <h3 class="font-bold">页面没找到</h3> <div class="error-desc"> 抱歉，您找到的页面没找到。 尝试检查网址是否有错误，然后点击浏览器上的刷新按钮或尝试在我们的应用中找到其他内容。 </div> </div>');/*v:1*/
template('m_common/m_inputProcessTime',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,appointmentStartTime=$data.appointmentStartTime,timeInfo=$data.timeInfo,appointmentEndTime=$data.appointmentEndTime,isHaveMemo=$data.isHaveMemo,$out='';$out+='<style> .form-horizontal .m-r-xs{margin:5px -5px;} /*label.error{position: absolute;top:30px;left: -5px;}*/ </style> <form class="form-horizontal rounded-bottom inputTimeOBox p-m"> <div class="col-md-4"> <div class="form-group m-r-xs"> <label>开始时间</label> <div class="input-group"> <input type="text" class="form-control timeInput startTime input-sm" id="ipt_startTime" name="startTime" data-appointmentStartTime = "';
$out+=$escape(appointmentStartTime);
$out+='" placeholder="开始日期" readonly onFocus="startTimeFun(this,m_inputProcessTime_onpicked)" value="';
$out+=$escape(timeInfo.startTime);
$out+='" style="width: 110px"> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().focus();"> <i class="icon-sm icon-append fa fa-calendar" style="height: 28px;line-height: 28px;"></i> </span> </div> </div> </div> <div class="col-md-4"> <div class="form-group m-r-xs"> <label>结束时间</label> <div class="input-group"> <input type="text" class="form-control timeInput endTime input-sm" id="ipt_endTime" name="endTime" data-appointmentEndTime = "';
$out+=$escape(appointmentEndTime);
$out+='" placeholder="结束日期" readonly onFocus="endTimeFun(this,m_inputProcessTime_onpicked)" value="';
$out+=$escape(timeInfo.endTime);
$out+='" style="width: 110px"> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().focus();"> <i class="icon-sm icon-append fa fa-calendar" style="height: 28px;line-height: 28px;"></i> </span> </div> </div> </div> <div class="col-md-4"> <div class="form-group m-r-xs"> <label>总天数</label> <div class="input-group spinner dayCountSpinner" data-trigger="spinner"> <input type="text" class="form-control text-center input-sm dayCount" value="0" data-rule="quantity"> <div class="input-group-addon"> <a href="javascript:void(0);" class="spin-up" style="height: 8px;width: 8px;" data-spin="up"><i class="fa fa-caret-up"></i></a> <a href="javascript:void(0);" class="spin-down" style="height: 8px;width: 8px;" data-spin="down"><i class="fa fa-caret-down"></i></a> </div> </div> </div> </div> ';
if(isHaveMemo){
$out+=' <div class="col-md-12"> <div class="form-group m-r-xs"> <label>变更原因</label> <textarea name="memo" class="form-control">';
$out+=$escape(timeInfo.memo);
$out+='</textarea> </div> </div> ';
}
$out+=' <div class="clearfix"></div> </form>';
return new String($out);
});/*v:1*/
template('m_common/m_input_save',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,fieldName=$data.fieldName,fieldValue=$data.fieldValue,isDialog=$data.isDialog,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <div class="col-md-12"> <input type="text" class="form-control" name="name" autocomplete="off" placeholder="请输入';
$out+=$escape(fieldName?fieldName:'流程名称');
$out+='" value="';
$out+=$escape(fieldValue?fieldValue:'');
$out+='"> </div> ';
if(isDialog==false){
$out+=' <div class="col-md-12 text-right m-t-sm"> <button class="btn btn-default btn-sm" data-action="cancel">取消</button> <button class="btn btn-primary btn-sm" data-action="save">确定</button> </div> ';
}
$out+=' </div> </form>';
return new String($out);
});/*v:1*/
template('m_common/m_metismenu',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,companyVersion=$data.companyVersion,$out='';$out+='<nav class="navbar-default navbar-static-side m-metismenu" role="navigation" > <div class="sidebar-collapse"> <ul class="nav metismenu" id="side-menu" style="display: block;"> <li class="navbar-minimalize"> <a href="javascript:void(0);" class="workbench" style=""> <i class="pull-left icon iconfont icon-pc"></i> <span class="nav-label pull-left">&nbsp;</span> <div class="clearfix"></div> </a>  </li> <li class="roleControl" roleCode="20000101" flag="2"> <a id="addProject" class="svg" href="#/addProject"> <i class="pull-left icon iconfont icon-tianjia1"></i> <span class="nav-label pull-left">立项</span> <div class="clearfix"></div> </a> </li>                   <li class="parentProject" roleCode="" flag="2"> <a class="svg" href="javascript:void(0);"> <i class="pull-left font-style-normal text-bold m-metismenu-icon">P</i> <span class="nav-label pull-left">课题项目</span> <span class="fa arrow"></span> <div class="clearfix"></div> </a> <ul class="nav nav-second-level collapse" >  <li class="liProjectList"> <a href="#/projectOverview" id="projectList" class = "projectList"><span>项目总览</span> <div class="clearfix"></div></a> </li> <li> <a href="#/studyProjectSection?businessType=2" id="studyProjectSection"><span>研究组</span></a> </li> </ul> </li> ';
if(companyVersion!='03'){
$out+=' <li class="roleControl" roleCode="20200101" flag="2" > <a id="myTask" class="svg" href="#/myTask"> <i class="pull-left font-style-normal text-bold m-metismenu-icon">T</i> <span class="nav-label pull-left">我的任务</span> <div class="clearfix"></div> </a> </li> ';
}
$out+=' <li class="roleControl" flag="2" > <a class="svg" href="javascript:void(0);"> <i class="pull-left font-style-normal text-bold m-metismenu-icon">I</i> <span class="nav-label pull-left">信息动态</span> <span class="fa arrow"></span> <div class="clearfix"></div> </a> <ul class="nav nav-second-level collapse" > <li class="roleControl" roleCode="10-10-01" flag="2"> <a href="#/projectDynamics" id="projectDynamics"><span>动态快讯</span></a> </li> <li class="roleControl" roleCode="10-10-02" flag="2"> <a href="#/projectDynamicsAll" id="projectDynamicsAll"><span>动态总览</span></a> </li> <li class="roleControl" roleCode="10-10-03" flag="2"> <a href="#/technologySync" id="technologySync"><span>技术协同</span></a> </li> <li class="roleControl" roleCode="10-10-04" flag="2"> <a href="#/partyBuild" id="partyBuild"><span>党史学习教育</span></a> </li> </ul> </li> <li class="roleControl" roleCode="" flag="2"> <a class="svg" href="javascript:void(0);"> <i class="pull-left font-style-normal text-bold m-metismenu-icon">R</i> <span class="nav-label pull-left">统计管理</span> <span class="fa arrow"></span> <div class="clearfix"></div> </a> <ul class="nav nav-second-level collapse" > <li class="roleControl" roleCode="40001301" flag="2"> <a href="#/proProgressStats" id="proProgressStats"><span>进度总览</span></a> </li> <li class="roleControl" roleCode="47000101,47000105" flag="2"> <a href="#/userOutputStats" id="userOutputStats"><span>个人效能</span></a> </li>  <li class="roleControl" roleCode="450010102" flag="2"> <a href="#/theaterRanking" id="theaterRanking"><span>服务公司</span></a> </li> <li class="roleControl" roleCode="400012" flag="2"> <a href="#/projectCostDetail" id="projectCostDetail"><span>收支汇总</span></a> </li>  <li class="roleControl" roleCode="47000103" flag="2"> <a href="#/deanBillStatistic" id="deanBillStatistic"><span>经营收入</span></a> </li> </ul> </li>                 <li class="roleControl" roleCode="20210101" flag="2"> <a class="svg" a href="#/addressBook" id="addressBook"> <i class="pull-left font-style-normal text-bold m-metismenu-icon">A</i> <span class="nav-label pull-left">通讯录</span> <div class="clearfix"></div> </a> </li> </ul> </div> </nav> <div class="clearfix"></div> ';
return new String($out);
});/*v:1*/
template('m_common/m_popover',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,popoverStyle=$data.popoverStyle,$string=$utils.$string,titleHtml=$data.titleHtml,contentStyle=$data.contentStyle,content=$data.content,$out='';$out+='<div class="popover m-popover box-shadow" role="tooltip" style="';
$out+=$escape(popoverStyle);
$out+='"> <div class="arrow" style="left: 50%;"></div>  ';
$out+=$string(titleHtml);
$out+=' <div class="popover-content" style="';
$out+=$escape(contentStyle);
$out+='"> ';
$out+=$string(content);
$out+=' </div> </div>';
return new String($out);
});/*v:1*/
template('m_common/m_popover_confirm',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$string=$utils.$string,confirmMsg=$data.confirmMsg,$out='';$out+='<div> <p class="f-s-sm">';
$out+=$string(confirmMsg);
$out+='</p> <p class="pull-right" > <button type="button" class="popover-btn-no btn-u btn-u-default btn-u-xs rounded m-popover-close left m-r-4" style="line-height:22px;">取消 </button> <button type="button" class="popover-btn-yes btn-u btn-u-red btn-u-xs rounded m-popover-submit m-l-sm left" style="line-height:22px;">确定</button> </p> </div>';
return new String($out);
});/*v:1*/
template('m_common/m_quickDatePicker',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,isClear=$data.isClear,$out='';$out+='<style> #quickDatePicker iframe{box-shadow: none !important;} </style> <div id=\'quickDatePicker\' class="quickDatePicker" style="width: 245px;height: 240px"> &nbsp; </div> <div class="row"> <div class="col-md-12 text-right m-b-sm"> ';
if(isClear){
$out+=' <button type="button" class="btn btn-primary btn-sm m-popover-clear m-r-xs">清空</button> ';
}
$out+=' </div> </div> ';
return new String($out);
});/*v:1*/
template('m_common/m_select2_for_companybid',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,value=$data.value,$out='';$out+='<div> <span class="new-input"> <input type="text" name="companyBid" class="form-control input-sm p-r-md" placeholder="请输入或选择乙方名称，多个请用“/”隔开" value="';
$out+=$escape(value);
$out+='" name="constructCompany"> </span> <span class="select2-results"> <ul class="select2-results__options" role="tree" id="select2-29ob-results" aria-expanded="true" aria-hidden="false"> <li class="select2-results__option select2-results__option--highlighted" role="treeitem" aria-selected="false">深圳华侨城创新研究院有限公司</li> </ul> </span> </div> ';
return new String($out);
});/*v:1*/
template('m_common/m_select_field_by_check',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,type=$data.type,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$out='';$out+='<div class="m-select-field-by-check m" data-type="';
$out+=$escape(type);
$out+='"> <div class="row no-margin dp-box m-b-sm"> <div class="col-md-6 no-padding"> <div class="">选择项</div> </div> <div class="col-space"></div> <div class="col-md-6 no-padding"> <div class="">已选择项</div> </div> </div> <div class="row no-margin dp-box field-content"> <div class="col-md-6 border border-darker-grey"> <div class="m-b-sm m-t-sm"> <label class="i-checks i-checks-label fw-normal"> <input name="allItemCK" type="checkbox" value="0"/> <span class="i-checks-span">全选</span> </label> </div> <div class="row"> ';
$each(dataList,function(p,$index){
$out+=' <div class="col-md-4 p-r-none"> <label class="i-checks i-checks-label fw-normal"> <input name="itemCk" type="checkbox" value="';
$out+=$escape(p.fieldName);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='" data-relation-id="';
$out+=$escape(p.relationId);
$out+='"/> <span class="i-checks-span text-ellipsis" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(p.fieldName);
$out+='"> ';
$out+=$escape(p.fieldName);
$out+=' </span> </label> </div> ';
});
$out+=' </div> </div> <div class="col-space"></div> <div class="col-md-6 border border-darker-grey"> <div class="row list-group no-margin p-t-sm" id="selectItemBox"> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_common/m_text_editor','<div class="summernote"></div>');/*v:1*/
template('m_common/m_top',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_serverUrl=$helpers._serverUrl,_url=$helpers._url,companyInfo=$data.companyInfo,userInfo=$data.userInfo,_isNullOrBlank=$helpers._isNullOrBlank,unReadNotice=$data.unReadNotice,unReadMessage=$data.unReadMessage,unReadTodoCount=$data.unReadTodoCount,$out='';$out+='<nav class="navbar navbar-static-top m-top" role="navigation" style="margin-bottom: 0px;">  <div class="navbar-header"> <a href="';
$out+=$escape(_serverUrl('/'));
$out+='" class="navbar-brand svg" target="_blank"> <img class="maoding-logo pt-relative max-h-80" src="';
$out+=$escape(_url('/img/logo_white.png'));
$out+='"></img> </a> </div>  <div id="navbar" class="navbar-collapse collapse"> <ul class="nav navbar-top-links navbar-left" style="padding: 0 25px 0 5px;"> <li class="pull-left roleControl" roleCode="100007,10000301,100001,10000101,100004,10000401,10000601,10000602" flag="2"> <a data-action="backstageMgt" title="后台管理" style="padding: 65px 10px 0px 0px; "> <i class="fa fa-cog" style="margin-right: 9px;margin-left: 2px; color:black"></i> </a> </li> </ul>  <ul class="nav navbar-top-links navbar-right ';
$out+=$escape(companyInfo?'':'m-r-xxl');
$out+='"> <li class="pull-left"> <div class="dropdown l-h-80 no-padding m-t"> ';
if(userInfo){
$out+=' ';
if(!_isNullOrBlank(userInfo.imgUrl)){
$out+=' <img alt="image" class="img-circle" src="';
$out+=$escape(userInfo.imgUrl);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" style="width: 40px;height: 40px;margin-right:5px;"> ';
}else{
$out+=' <img alt="image" class="img-circle" src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" style="width: 40px;height: 40px;margin-right:5px;"> ';
}
$out+=' <a class="userInfo" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-type="textUserName" href="javascript:void(0)"> ';
$out+=$escape(userInfo.userName);
$out+=' <span class="caret"></span> </a> ';
}
$out+=' <ul class="dropdown-menu dropdown-menu-left dropdown-menu-new" style="z-index: 99999"> ';
if(companyInfo){
$out+=' <li><a href="javascript:void(0)" data-action="personalSettings">个人设置</a></li>  <li class="divider"></li> <li><a href="javascript:void(0)" data-action="companyUserSettings">个人信息编辑</a></li>  <li class="divider"></li> ';
}
$out+=' <li><a href="';
$out+=$escape(_serverUrl('/iWork/sys/logout'));
$out+='">退出登录</a></li> </ul> </div> </li> ';
if(companyInfo){
$out+=' <!-- <li class="pull-left"> <a class="messageInfo" href="javascript:void(0);" data-action="announcement"> <i class="fa fa-bell"></i> <span id="unReadNoticeCount" class="label label-warning">';
$out+=$escape(_isNullOrBlank(unReadNotice) || unReadNotice === 0?'':unReadNotice);
$out+='</span> </a> </li>--> <li class="pull-left"> <a class="messageInfo" href="javascript:void(0);" data-action="messageCenter"> <i class="fa fa-envelope"></i> <span id="unReadMessageCount" class="label label-warning">';
$out+=$escape(_isNullOrBlank(unReadMessage) || unReadMessage === 0?'':unReadMessage);
$out+='</span> </a> </li> <li class="pull-left"> <a class="messageInfo" href="javascript:void(0);" data-action="myTodoList" style="padding-left: 0px;"> <button class="btn btn-sm btn-outline no-padding btn-warning" >我的待办 <span id="unReadTodoCount" class=" label-warning " >';
$out+=$escape(_isNullOrBlank(unReadTodoCount) || unReadTodoCount === 0?'':unReadTodoCount);
$out+='</span> </button> </a> </li> ';
}
$out+=' </ul> </div> </nav> ';
return new String($out);
});/*v:1*/
template('m_docmgr/m_docmgr','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-6" id="breadcrumb"></div> <div class="col-md-6 text-right"> <a class="btn btn-primary btn-sm m-t-sm btn-flag" data-action="uploadFile">上传文件</a> <a class="btn btn-primary btn-sm m-t-sm btn-flag" data-action="createFolder">新建文件夹</a> <a class="btn btn-primary btn-sm m-t-sm" data-action="sendArchiveNotice" style="display: none;">发送归档通知</a> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content no-padding"> <div class="col-24-sm-8 col-24-md-8 col-24-lg-6 of-auto border-right" id="documentTreeBox" style="height: 500px;"> <div class="m-t-md" id="documentDirectoryTree"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </div> <div class="col-24-sm-16 col-24-md-16 col-24-lg-18 no-padding" > <div class="docmgr panel panel-default tag-box-v4 no-borders p-b-none" id="fileItems"> </div> </div> </div> </div> ');/*v:1*/
template('m_docmgr/m_docmgr_createFolder',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,fileTypeStr=$data.fileTypeStr,itemData=$data.itemData,$out='';$out+='<div class="ibox"> <div class="ibox-content"> <form class="createFolder"> <div class="row"> <div class="form-group col-md-12"> <label for="folderName"> ';
$out+=$escape(fileTypeStr);
$out+='名称 <span class="fc-red">*</span> </label> <input type="text" id="folderName" class="form-control" name="folderName" value="';
$out+=$escape(itemData!=null?itemData.fileName:'');
$out+='"> </div> </div> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_docmgr/m_docmgr_fileItem',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,item=$data.item,_momentFormat=$helpers._momentFormat,$out='';$out+='<tr class="file-list-row"> <td> <div class="file-icon ';
$out+=$escape(item.type===0?'file-icon-dir-small':'file-icon-file-small');
$out+='"></div> <div class="file-name"> <div class="text"> <a id=';
$out+=$escape(item.id);
$out+=' data-pid="';
$out+=$escape(item.pid);
$out+='" data-fileType="';
$out+=$escape(item.type);
$out+='" data-download="';
$out+=$escape(item.fileGroup);
$out+='/';
$out+=$escape(item.filePath);
$out+='" data-fileName="';
$out+=$escape(item.fileName);
$out+='" href="javascript:void(0);" title="';
$out+=$escape(item.fileName);
$out+='">';
$out+=$escape(item.fileName);
$out+='</a> </div> </div> </td> <td class="file-operate"> <div class="file-operate-list"> ';
if(item.type===1){
$out+=' <a class="file-operate-download f-s-md" href="javascript:void(0);" title="下载"><i class="glyphicon glyphicon-save text-success"></i></a> ';
}
$out+=' ';
if(item.isCustomize!==1&&item.editFlag===1){
$out+=' <a class="file-operate-delete f-s-md" href="javascript:void(0);" ><i class="glyphicon glyphicon-trash fc-red"></i></a> ';
}
$out+=' </div> </td> <td class="file-size">';
$out+=$escape(item.fileSize);
$out+=' </td> <td class="file-user"><span data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(item.companyName);
$out+='">';
$out+=$escape(item.createBy);
$out+='</span></td> <td class="file-date">';
$out+=$escape(_momentFormat(item.createDate,'YYYY/MM/DD'));
$out+='</td> </tr>';
return new String($out);
});/*v:1*/
template('m_docmgr/m_docmgr_fileItems',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fileItems=$data.fileItems,$escape=$utils.$escape,rootPath=$data.rootPath,$each=$utils.$each,item=$data.item,index=$data.index,_momentFormat=$helpers._momentFormat,$out='';if((fileItems===void 0 || fileItems===null || fileItems.length===0) ){
$out+=' <tr class="file-list-row no-data"> <td colspan="5" class="file-not-found text-center"> <div> <img src="';
$out+=$escape(rootPath);
$out+='/img/default/without_file.png"> </div> <span class="fc-dark-blue">当前目录不存在任何文件</span> </td> </tr> ';
}else{
$out+=' ';
$each(fileItems,function(item,index){
$out+=' <tr class="file-list-row"> <td style="max-width: 200px;"> <a id=';
$out+=$escape(item.id);
$out+=' data-pid="';
$out+=$escape(item.pid);
$out+='" data-fileType="';
$out+=$escape(item.type);
$out+='" data-download="';
$out+=$escape(item.fileGroup);
$out+='/';
$out+=$escape(item.filePath);
$out+='" data-fileName="';
$out+=$escape(item.fileName);
$out+='" href="javascript:void(0);" title="';
$out+=$escape(item.fileName);
$out+='"> <div class="file-icon ';
$out+=$escape(item.type===0?'file-icon-dir-small':'file-icon-file-small');
$out+='"></div> <div class="file-name"> <div class="text">';
$out+=$escape(item.fileName);
$out+='</div> </div> </a> </td> <td class="file-operate"> <div class="file-operate-list"> ';
if(item.type===1){
$out+=' <a class="file-operate-download f-s-md" href="javascript:void(0);" title="下载"><i class="glyphicon glyphicon-save text-warning"></i></a> ';
}
$out+=' ';
if(item.isCustomize!==1&&item.editFlag===1){
$out+=' <a class="file-operate-rename f-s-md" href="javascript:void(0);" title="重命名"><i class="glyphicon glyphicon-edit text-success" ></i></a> <a class="file-operate-delete f-s-md" href="javascript:void(0);"><i class="glyphicon glyphicon-trash fc-red" ></i></a> ';
}
$out+=' </div> </td> <td class="file-size">';
$out+=$escape(item.fileSize);
$out+=' </td> <td class="file-user"><span data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(item.companyName);
$out+='">';
$out+=$escape(item.createBy);
$out+='</span></td> <td class="file-date">';
$out+=$escape(_momentFormat(item.createDate,'YYYY/MM/DD'));
$out+='</td> </tr> ';
});
$out+=' ';
}
return new String($out);
});/*v:1*/
template('m_docmgr/m_docmgr_fileItems_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fileItems=$data.fileItems,$escape=$utils.$escape,_url=$helpers._url,$each=$utils.$each,item=$data.item,index=$data.index,_fastdfsUrl=$helpers._fastdfsUrl,_momentFormat=$helpers._momentFormat,$out='';$out+='<table class="table file-list"> <thead> <tr class="file-list-row">  <th width="5%">  </th> <th width="45%">文件名</th> <th width="15%">大小</th> <th width="15%">创建人</th> <th width="15%">创建时间</th> </tr> </thead> <tbody class="file-list-items" > ';
if((fileItems===void 0 || fileItems===null || fileItems.length===0) ){
$out+=' <tr class="file-list-row no-data"> <td colspan="5" class="file-not-found text-center"> <div> <img src="';
$out+=$escape(_url('/img/default/without_file.png'));
$out+='"> </div> <span class="fc-dark-blue">当前目录不存在任何文件</span> </td> </tr> ';
}else{
$out+=' ';
$each(fileItems,function(item,index){
$out+=' <tr class="file-list-row" data-i="';
$out+=$escape(index);
$out+='" data-id="';
$out+=$escape(item.id);
$out+='" data-type="';
$out+=$escape(item.type);
$out+='" id="box';
$out+=$escape(item.id);
$out+='" unselectable="on" onselectstart="return false;" style="-moz-user-select:none;-webkit-user-select:none; cursor: default;">  <td> <div class="list-action-box"> ';
if(item.editFlag==1 || item.type==1 || item.type==50 || (item.sendResults==1 && item.type==30)){
$out+=' <div class="btn-group singleOperation" style="display: none;"> <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <span class="fa fa-angle-down"></span> </button> <ul class="dropdown-menu" id="menu';
$out+=$escape(item.id);
$out+='"> ';
if(item.editFlag==1){
$out+=' <li> <a href="javascript:void(0);" data-action="editFileName">修改名称</a> </li> ';
}
$out+=' ';
if(item.type==1){
$out+=' <li> <a href="javascript:void(0);" data-action="downloadFile">下载文件</a> </li> ';
}
$out+='  ';
if(item.editFlag==1){
$out+=' <li> <a href="javascript:void(0);" data-action="delFile">删除文件</a> </li> ';
}
$out+=' ';
if(item.type==50){
$out+=' <li> <a href="javascript:void(0);" data-action="submitDocResults">提交成果</a> </li> ';
}
$out+=' ';
if(item.sendResults==1 && item.type==30){
$out+=' <li> <a href="javascript:void(0);" data-action="sendDocResults">发送成果</a> </li> ';
}
$out+=' </ul> </div> ';
}
$out+=' </div> </td> <td style="max-width: 200px;"> <a href="javascript:void(0);" id=';
$out+=$escape(item.id);
$out+=' data-pid="';
$out+=$escape(item.pid);
$out+='" data-fileType="';
$out+=$escape(item.type);
$out+='" data-download="';
$out+=$escape(item.fileGroup);
$out+='/';
$out+=$escape(item.filePath);
$out+='" data-fileName="';
$out+=$escape(item.fileName);
$out+='" title="';
$out+=$escape(item.fileName);
$out+='" data-action="intoSubDirectory"> ';
if(item.type===0 || item.type===40 || item.type===30 || item.type===2 || item.type === 41){
$out+=' <div class="file-icon file-icon-dir-small"></div> ';
}else if(item.type===50){
$out+=' <div class="fa fa-steam-square"></div> ';
}else{
$out+=' <div class="file-icon file-icon-file-small"></div> ';
}
$out+=' <div class="file-name"> <div class="text"> ';
if(item.type==1){
$out+=' <a href="';
$out+=$escape(_fastdfsUrl(item.fileGroup+'/'+item.filePath));
$out+='" target="_blank"> ';
$out+=$escape(item.fileName);
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(item.fileName);
$out+=' ';
}
$out+=' </div> </div> </a> </td> <!--<td class="file-operate"> <div class="file-operate-list"> ';
if(item.type===1){
$out+=' <a class="file-operate-download f-s-md" href="javascript:void(0);" title="下载"><i class="glyphicon glyphicon-save text-warning"></i></a> ';
}
$out+=' ';
if(item.isCustomize!==1&&item.editFlag===1){
$out+=' <a class="file-operate-rename f-s-md" href="javascript:void(0);" title="重命名"><i class="glyphicon glyphicon-edit text-success" ></i></a> <a class="file-operate-delete f-s-md" href="javascript:void(0);"><i class="glyphicon glyphicon-trash fc-red" ></i></a> ';
}
$out+=' </div> </td>--> <td class="file-size">';
$out+=$escape(item.fileSize);
$out+=' </td> <td class="file-user"><span data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(item.companyName);
$out+='">';
$out+=$escape(item.createBy);
$out+='</span></td> <td class="file-date">';
$out+=$escape(_momentFormat(item.createDate,'YYYY/MM/DD'));
$out+='</td> </tr> ';
});
$out+=' ';
}
$out+=' </tbody> </table> <iframe class="iframeDown dp-none"></iframe>';
return new String($out);
});/*v:1*/
template('m_docmgr/m_docmgr_fileUpload','<style> .uploadmgrContainer .tag-box{ margin-bottom: 0; } </style> <div class="ibox"> <div class="ibox-content"> <div class="uploadmgrContainer"> </div> </div> </div> ');/*v:1*/
template('m_docmgr/m_docmgr_sendArchiveNotice',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,selectedNodeObj=$data.selectedNodeObj,nowDate=$data.nowDate,$out='';$out+='<div class="ibox"> <div class="ibox-content"> <form class="sendArchiveNotice"> <div class="row"> <div class="form-group col-md-12"> <label class="col-24-md-5 text-right m-t-sm">归档任务<span class="fc-red">*</span>：</label> <div class="col-24-md-19"> <input type="text" class="form-control" name="taskName" maxlength="50" value="';
$out+=$escape(selectedNodeObj.text);
$out+='"> </div> </div> <div class="form-group col-md-12"> <label class="col-24-md-5 text-right m-t-sm">通知人员<span class="fc-red">*</span>：</label> <div class="col-24-md-19"> <select class="js-example-disabled-results form-control" name="users" disabled> </select> </div> </div> <div class="form-group col-md-12"> <label class="col-24-md-5 text-right m-t-sm">归档截止时间<span class="fc-red">*</span>：</label> <div class="col-24-md-19"> <input type="text" class="form-control" name="deadline" onFocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" readonly value="';
$out+=$escape(nowDate);
$out+='"> </div> </div> <div class="form-group col-md-12"> <label class="col-24-md-5 text-right m-t-sm">备注：</label> <div class="col-24-md-19"> <textarea class="form-control" name="remarks"> </textarea> </div> </div> </div> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_docmgr/m_docmgr_sendDocResults',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,companyData=$data.companyData,$out='';$out+='<div class="ibox"> <div class="ibox-content"> <form class="sendArchiveNotice"> <div class="row"> <div class="form-group col-md-12"> <label class="col-24-md-5 text-right m-t-sm">甲方：</label> <div class="col-24-md-19 m-t-sm"> ';
$out+=$escape(companyData.companyName);
$out+=' </div> </div> </div> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_docmgr/m_projectArchiving','<div class="ibox m_projectArchiving"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-6"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li class="active fw-bold">项目文档</li> </ol> </div> </div> <div class="col-md-6 text-right"> <a class="btn btn-primary btn-sm m-t-sm pull-right m-l-xs" data-action="sendArchiveNotice" style="display: none;">发送归档通知</a> <a class="btn btn-primary btn-sm m-t-sm btn-flag pull-right m-l-xs" data-action="uploadFile" style="display: none;">上传文件</a> <a class="btn btn-primary btn-sm m-t-sm btn-flag pull-right m-l-xs" data-action="createFolder" style="display: none;">新建文件夹</a>  </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content no-padding"> <div class="col-24-sm-8 col-24-md-8 col-24-lg-6 of-auto border-right" id="documentTreeBox" style="height: 500px;"> <div class="row m-t-sm"> <div class="col-md-3 p-r-none select-search-box" > <select class="select-search-by" name="selectSearchBy"> <option value="0" selected>项目名称</option> <option value="1">文件名称</option> </select> </div> <div class="col-md-9"> <div class="input-group "> <input class="form-control" type="text" name="projectName" placeholder="请输入项目名称"> <span class="input-group-btn"> <button type="button" class="btn btn-primary" data-action="searchByProjectName">搜索</button> </span> </div> </div> </div> <div class="m-t-md" id="documentDirectoryTree"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </div> <div class="col-24-sm-16 col-24-md-16 col-24-lg-18 no-padding"> <div class="docmgr panel panel-default tag-box-v4 no-borders" id="fileItems" > </div> <div class="col-md-12 p-w-m"> <div id="data-pagination-container" class="m-pagination pull-right " style="display: none;"></div> </div> </div> </div> </div> ');/*v:1*/
template('m_docmgr/m_uploadmgr',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,boxClass=$data.boxClass,isShowBtnClose=$data.isShowBtnClose,$out='';$out+='<div class="uploadmgr ';
$out+=$escape(boxClass==null?'tag-box tag-box-v1 box-shadow shadow-effect-1':boxClass);
$out+='"> <div class="alertmgr"></div> <a href="javascript:void(0)" class="btn-select btn btn-primary btn-xs web-uploader rounded" type="button"><i class="fa fa-plus"></i>&nbsp;选择文件</a>  ';
if(isShowBtnClose){
$out+=' <a href="javascript:void(0)" type="button" class="btn-close close">×</a> ';
}
$out+=' <div class="upload-item-list"> </div> <p class="pull-right"></p> </div>';
return new String($out);
});/*v:1*/
template('m_docmgr/m_uploadmgr_uploadItem',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,file=$data.file,pid=$data.pid,$out='';$out+='<div class="uploadItem uploadItem_';
$out+=$escape(file.id);
$out+='" data-fileId="';
$out+=$escape(file.id);
$out+='" data-pid="';
$out+=$escape(pid);
$out+='">  <h3 class="heading-xs"> <span class="file-name">';
$out+=$escape(file.name);
$out+='</span> <span style="padding-left:5px;" class="span_progress"></span> <a class="pull-right btn-link " data-action="removeFile"> <i class="glyphicon glyphicon-remove"></i> </a> <a class="pull-right btn-link m-r-xs" data-action="pauseUpload" style="display: none;"> <i class="glyphicon glyphicon-pause"></i> </a> <a class="pull-right btn-link m-r-xs" data-action="continueUpload" style="display: none;"> <i class="glyphicon glyphicon-play"></i> </a> <span class="span_status pull-right m-r-sm"></span> <div class="clearfix"></div> </h3> <div class="progress progress-u progress-xs"> <div class="progress-bar progress-bar-u" role="progressbar" name="div_progress" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%" > </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_docmgr/m_yun_file_preview',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,url=$data.url,$out='';$out+='<style> .layui-layer .layui-layer-setwin .layui-layer-close2{ right: -20px; top: -20px; } </style> <iframe src="';
$out+=$escape(url);
$out+='" style="width: 100%;height: 100%;border: 0;"> </iframe>';
return new String($out);
});/*v:1*/
template('m_docmgr/m_yun_upload',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,boxClass=$data.boxClass,isShowBtnClose=$data.isShowBtnClose,$out='';$out+='<div class="uploadmgr ';
$out+=$escape(boxClass==null?'tag-box tag-box-v1 box-shadow shadow-effect-1':boxClass);
$out+='"> <div class="alertmgr"></div> <a href="javascript:void(0)" class="btn-select btn btn-primary btn-xs web-uploader rounded" type="button"><i class="fa fa-plus"></i>&nbsp;选择文件</a>  ';
if(isShowBtnClose){
$out+=' <a href="javascript:void(0)" type="button" class="btn-close close">×</a> ';
}
$out+=' <div class="upload-item-list"> </div> <p class="pull-right"></p> </div>';
return new String($out);
});/*v:1*/
template('m_cost/m_cost_addNode','<div class="m-contractPayment-add p-sm overflow-y-auto m-dialog-resize"> <div class="row m-b-sm"> <div class="col-sm-12"> <div class="panel panel-default panel-item"> <div class="panel-body"> <h4 class="title-line"> 明细(<span>1</span>) <a class="curp pull-right hide" href="javascript:void(0)" data-action="delItem" title="删除明细"> <i class="glyphicon glyphicon-remove fc-red"></i> </a> </h4> <form class="form-horizontal"> <div class="form-group"> <label class="col-md-2 control-label p-r-none">节点描述：<span class="fc-red">*</span></label> <div class="col-md-10"> <input placeholder="描述" class="form-control" type="text" name="feeDescription"> </div> </div> <div class="form-group"> <label class="col-md-2 control-label p-r-none">比例：<span class="fc-red">*</span></label> <div class="col-md-10"> <div class="input-group"> <input placeholder="比例" class="form-control" type="text" data-action="feeCalculation" name="feeProportion"> <span class="input-group-addon">%</span> </div> </div> </div> <div class="form-group"> <label class="col-md-2 control-label p-r-none">金额：<span class="fc-red">*</span></label> <div class="col-md-10"> <div class="input-group"> <input placeholder="金额" class="form-control" type="text" data-action="feeCalculation" name="fee"> <span class="input-group-addon">元</span> </div> </div> </div> </form> </div> </div> <button class="btn btn-primary btn-sm" data-action="addItem" title="添加明细"><i class="fa fa-plus"></i>&nbsp;添加明细</button> </div> </div> </div> ');/*v:1*/
template('m_cost/m_cost_addPaidFee',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,doType=$data.doType,$out='';$out+='<form class="form feeForm width-270"> <div class="form-group m-b-xs"> <label class="col-24-md-8 control-label p-l-none m-t-xs">';
$out+=$escape(doType==2?'付款':'到账');
$out+='金额</label> <div class="col-24-md-16 no-padding"> <div class="input-group"> <input placeholder="金额" class="form-control pay-input" type="text" name="fee" > <span class="input-group-addon">元</span> </div> </div> <div class="clearfix"></div> </div> <div class="form-group m-b-xs"> <label class="col-24-md-8 control-label p-l-none m-t-xs">';
$out+=$escape(doType==2?'付款':'到账');
$out+='日期</label> <div class="col-24-md-16 inpt-group p-l-none"> <div class="input-group"> <input class="form-control pay-input" type="text" name="paidDate" onFocus="WdatePicker({maxDate:new Date().toLocaleDateString()})" readonly /> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> <div class="clearfix"></div> </div> <div class="form-group m-b-xs p-r-none col-md-12"> <button type="button" class="btn btn-default btn-sm m-popover-close pull-right m-b-sm"> <i class="glyphicon glyphicon-remove"></i> </button> <button type="button" class="btn btn-primary btn-sm m-popover-submit pull-right m-b-sm m-r-xs"> <i class="fa fa-check"></i> </button> </div> </form>';
return new String($out);
});/*v:1*/
template('m_cost/m_cost_addPayment',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,doType=$data.doType,$escape=$utils.$escape,pointDetail=$data.pointDetail,currentDate=$data.currentDate,invoiceInfo=$data.invoiceInfo,$out='';$out+='<form class="form-horizontal p-sm"> <div class="form-group"> ';
if(doType==1){
$out+=' <label class="col-sm-2 control-label">金额：</label> <div class="col-sm-10"> <div class="input-group"> <input placeholder="请输入发起金额" class="form-control" type="text" name="fee"> <span class="input-group-addon">元</span> </div> </div> ';
}else{
$out+=' <label class="col-sm-2 text-right">金额：</label> <div class="col-sm-10"> ';
$out+=$escape(pointDetail.fee);
$out+='元 </div> ';
}
$out+=' </div> <div class="form-group invoiceTypeForm"> <label class="col-sm-2 control-label">开票：</label> <div class="col-sm-10 m-t-xs"> ';
if(doType==1){
$out+=' <label class="i-checks"> <input class="ck" type="radio" name="invoiceType" value="0" checked/> <span class="v-middle fw-normal">不开票</span> </label> ';
}
$out+=' <label class="i-checks"> <input class="ck" type="radio" name="invoiceType" value="1"/> <span class="v-middle fw-normal">普票</span> </label> <label class="i-checks"> <input class="ck" type="radio" name="invoiceType" value="2"/> <span class="v-middle fw-normal">专票</span> </label> <label class="i-checks"> <input class="ck" type="radio" name="invoiceType" value="3"/> <span class="v-middle fw-normal">收据</span> </label> </div> </div> <div class="hr-line-dashed m-t-none"></div> <div class="invoice-box" style="display: none;"> <div class="form-group"> <label class="col-sm-2 control-label">申请日期：</label> <div class="col-sm-10"> <div class="input-group"> <input type="text" class="form-control date-picker" name="applyDate" placeholder="申请日期" readonly onfocus="WdatePicker()" value="';
$out+=$escape(currentDate);
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">收票方名称：</label> <div class="col-sm-10"> <input placeholder="请输入收票方名称" class="form-control" type="text" name="invoiceName" id="invoiceName" value="';
$out+=$escape(invoiceInfo?invoiceInfo.relationCompanyName:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">纳税识别号：</label> <div class="col-sm-10"> <input placeholder="请输入纳税识别号" class="form-control" type="text" name="taxIdNumber" value="';
$out+=$escape(invoiceInfo?invoiceInfo.taxIdNumber:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">开票内容：</label> <div class="col-sm-10"> <input placeholder="请输入开票内容" class="form-control" type="text" name="invoiceContent" value="';
$out+=$escape(invoiceInfo?invoiceInfo.invoiceContent:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">备注：</label> <div class="col-sm-10"> <textarea placeholder="请输入备注" class="form-control" type="text" name="invoiceRemark" >';
$out+=$escape(invoiceInfo?invoiceInfo.invoiceRemark:'');
$out+='</textarea> </div> </div> </div> <div class="invoice-box1" style="display: none;"> <div class="form-group"> <label class="col-sm-2 control-label">地址：</label> <div class="col-sm-10"> <input placeholder="请输入地址" class="form-control" type="text" name="address" value="';
$out+=$escape(invoiceInfo?invoiceInfo.address:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">电话：</label> <div class="col-sm-10"> <input placeholder="请输入电话" class="form-control" type="text" name="cellphone" value="';
$out+=$escape(invoiceInfo?invoiceInfo.cellphone:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">开户行：</label> <div class="col-sm-10"> <input placeholder="请输入开户行" class="form-control" type="text" name="accountBank" value="';
$out+=$escape(invoiceInfo?invoiceInfo.accountBank:'');
$out+='"/> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">账号：</label> <div class="col-sm-10"> <input placeholder="请输入账号" class="form-control" type="text" name="bankNo" value="';
$out+=$escape(invoiceInfo?invoiceInfo.bankNo:'');
$out+='"/> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_cost/m_cost_approval_submit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,isShowTips=$data.isShowTips,auditFlag=$data.auditFlag,$escape=$utils.$escape,title=$data.title,projectName=$data.projectName,pageText=$data.pageText,_expNumberFilter=$helpers._expNumberFilter,totalCost=$data.totalCost,companyName=$data.companyName,attachList=$data.attachList,$each=$utils.$each,a=$data.a,$index=$data.$index,pointList=$data.pointList,d=$data.d,i=$data.i,$out='';$out+='<form class="form-horizontal p-sm overflow-y-auto m-dialog-resize"> ';
if(isShowTips){
$out+=' <div class="alert alert-danger alert-dismissable m-l m-r"> <button aria-hidden="true" data-dismiss="alert" class="close" type="button">×</button>  ';
if(auditFlag==0){
$out+=' 确定发布';
$out+=$escape(title);
$out+='计划后，';
$out+=$escape(title);
$out+='中的节点、比例、金额将不能被新增、修改、删除。 ';
}else{
$out+='  确定提交';
$out+=$escape(title);
$out+='计划后，';
$out+=$escape(title);
$out+='中的节点、比例、金额将不能被新增、修改、删除。 ';
}
$out+=' </div> ';
}
$out+=' <div class="p-w-sm"> <div class="form-group "> <label class="col-24-xs-3 text-right p-l-none">关联项目：</label> <div class="col-24-xs-21"> ';
$out+=$escape(projectName);
$out+=' </div> </div> <div class="form-group "> <label class="col-24-xs-3 text-right p-l-none">收款类型：</label> <div class="col-24-xs-21"> ';
$out+=$escape(pageText.title);
$out+=' </div> </div> <div class="form-group "> <label class="col-24-xs-3 text-right p-l-none">计划收款金额：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_expNumberFilter(totalCost));
$out+=' 元 </div> </div> <div class="form-group "> <label class="col-24-xs-3 text-right p-l-none">付款方：</label> <div class="col-24-xs-21"> ';
$out+=$escape(companyName);
$out+=' </div> </div> <div class="form-group "> <label class="col-24-xs-3 text-right p-l-none">附件：</label> <div class="col-24-xs-21"> ';
if(attachList!=null && attachList.length>0){
$out+=' ';
$each(attachList,function(a,$index){
$out+=' <span class="bg-v1-grey b-r-sm p-xxs m-r-xs f-s-xs pull-left"> <a href="javascript:void(0)" data-action="preview" data-file-ext="';
$out+=$escape(a.fileExtName);
$out+='" data-net-file-id="';
$out+=$escape(a.id);
$out+='" data-src="';
$out+=$escape(a.fileFullPath);
$out+='" data-name="';
$out+=$escape(a.fileName);
$out+='">';
$out+=$escape(a.fileName);
$out+='</a> </span> ';
});
$out+=' ';
}else{
$out+=' <span class="pull-left m-r-xs">暂无上传文件</span> ';
}
$out+=' </div> </div> </div> ';
$each(pointList,function(d,i){
$out+=' <div class="panel panel-default"> <div class="panel-body"> <h4 class="title-line"> 明细(<span data-action="itemIndex">';
$out+=$escape(i+1);
$out+='</span>) </h4> <div class="form-group"> <label class="col-24-xs-3 text-right">节点描述：</label> <div class="col-24-xs-21"> ';
$out+=$escape(d.feeDescription);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">比例：</label> <div class="col-24-xs-21"> ';
$out+=$escape(d.feeProportion);
$out+='% </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">金额：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_expNumberFilter(d.fee));
$out+=' 元 </div> </div> </div> </div> ';
});
$out+=' <div class="p-w-sm" id="approverOutBox"> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_cost/m_cost_collectionPlan',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,projectCostRole=$data.projectCostRole,dataList=$data.dataList,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="row"> <div class="col-md-6" id="designManagerBox"> </div> <div class="col-md-6 text-right"> ';
if(projectCostRole.receiveProjectFeeSet==1){
$out+=' <a class="btn btn-primary" data-action="addCollectionPlan">添加收款计划</a> ';
}
$out+=' </div> </div> <div class="m-t-xs" id="collectionPlanBox"> ';
if(dataList==null || dataList.length==0){
$out+=' <div class="panel panel-default no-borders m-t-xs"> <div class="panel-body text-center no-borders"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </div> ';
}
$out+=' </div> ';
return new String($out);
});/*v:1*/
template('m_cost/m_cost_collectionPlan_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,title=$data.title,doType=$data.doType,dataInfo=$data.dataInfo,_momentFormat=$helpers._momentFormat,$out='';$out+='<form class="form-horizontal m_cost_collectionPlan_add m "> <div class="form-group"> <label class="col-24-md-5 control-label">';
$out+=$escape(title);
$out+='类型<span class="fc-red">*</span>：</label> <div class="col-24-md-19"> <select class="form-control" name="feeType" style="width: 100%;"> <!--<option value="">请选择</option> ';
if(doType==0){
$out+=' <option value="1">合同回款</option> ';
}
$out+=' <option value="2">技术审查费</option> <option value="3">合作设计费</option> ';
if(doType==0){
$out+=' <option value="5">其他收入</option> ';
}else{
$out+=' <option value="4">其他支出</option> ';
}
$out+='--> </select> </div> </div> <div class="form-group"> <label class="col-24-md-5 control-label p-l-none">计划';
$out+=$escape(title);
$out+='金额<span class="fc-red">*</span>：</label> <div class="col-24-md-19"> <div class="input-group"> <input class="form-control" type="text" name="fee" value="';
$out+=$escape(dataInfo?dataInfo.totalCost:'');
$out+='"> <span class="input-group-addon">元</span> </div> </div> </div> <div class="form-group"> <label class="col-24-md-5 control-label p-l-none"> ';
if(doType==1){
$out+=' 收款方 ';
}else{
$out+=' 付款方 ';
}
$out+=' <span class="fc-red">*</span>： </label> <div class="col-24-md-19"> <input class="form-control" type="text" name="receivingUnit" value="';
$out+=$escape(dataInfo?dataInfo.companyName:'');
$out+='" > </span> </div> </div> <div class="form-group"> <label class="col-24-md-5 control-label p-l-none"> 合同名称<span class="fc-red">*</span>： </label> <div class="col-24-md-19"> <input class="form-control" type="text" name="contractName" value="';
$out+=$escape(dataInfo?dataInfo.contractName:'');
$out+='" > </span> </div> </div> <div class="form-group"> <label class="col-24-md-5 control-label p-l-none"> 合同编号<span class="fc-red">*</span>： </label> <div class="col-24-md-19"> <input class="form-control" type="text" name="contractNo" value="';
$out+=$escape(dataInfo?dataInfo.contractNo:'');
$out+='" > </span> </div> </div> <div class="form-group"> <label class="col-24-md-5 control-label p-l-none"> 合同日期<span class="fc-red">*</span>： </label> <div class="col-24-md-19"> <input type="text" class="form-control" name="contractDate" onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" value="';
$out+=$escape(_momentFormat(dataInfo?dataInfo.contractDate:'','YYYY-MM-DD'));
$out+='"> </div> </div> <div class="form-group"> <label class="col-24-md-5 control-label">关联合同：</label> <div class="col-24-md-19"> <div class="input-group select2-multiple"> <select class="js-example-disabled-results form-control" name="projectContract" multiple="multiple" readonly="" style="width: 392px;"> </select> <div class="input-group-btn"> <button tabindex="-1" class="web-uploader btn btn-primary" type="button" data-action="upload"></button> </div> </div> </div> </div>  </form> ';
return new String($out);
});/*v:1*/
template('m_cost/m_cost_collectionPlan_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,_isNullOrBlank=$helpers._isNullOrBlank,mainId=$data.mainId,$escape=$utils.$escape,pageText=$data.pageText,contractNo=$data.contractNo,editFlag=$data.editFlag,projectCostRole=$data.projectCostRole,operateCompanyId=$data.operateCompanyId,dataCompanyId=$data.dataCompanyId,totalCost=$data.totalCost,total=$data.total,_expNumberFilter=$helpers._expNumberFilter,contractName=$data.contractName,contractDate=$data.contractDate,_momentFormat=$helpers._momentFormat,attachList=$data.attachList,$each=$utils.$each,a=$data.a,$index=$data.$index,companyName=$data.companyName,status=$data.status,auditHistoryFlag=$data.auditHistoryFlag,costId=$data.costId,isAllowEditFlag=$data.isAllowEditFlag,repealEditFlag=$data.repealEditFlag,deleteFlag=$data.deleteFlag,pointList=$data.pointList,p=$data.p,i=$data.i,currentCompanyId=$data.currentCompanyId,v=$data.v,vi=$data.vi,deleteFinanceData=$data.deleteFinanceData,c=$data.c,ci=$data.ci,$out='';$out+='<div class="panel-body popover-box no-borders no-padding pt-relative m-cost-item"> ';
if(!_isNullOrBlank(mainId)){
$out+=' <div class="mask-layer"></div> <div class="mask-layer mask-layer-content"> <h2 class="fc-dark-grey m-b-md">审批中</h2> <p class="f-s-md"> ';
$out+=$escape(pageText.title);
$out+='的收款计划正在审批中，查看审批情况请点击 【<a class="fc-dark-blue" data-action="approvalDetails" data-id="';
$out+=$escape(mainId);
$out+='">审批详情</a>】 </p> </div> ';
}
$out+=' <table class="table table-bordered"> <thead> <tr> <th colspan="10" class=""> <div class="row"> <div class="col-24-sm-2 p-r-none" id="costTitle"> ';
$out+=$escape(pageText.title);
$out+=' </div> <div class="col-24-sm-3 no-padding"> <span class=" contract text-ellipsis" >合同编号：</span> <span class="text-navy contract text-ellipsis" data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(contractNo==null||contractNo==''?'--':contractNo);
$out+='"> ';
if(editFlag==1 && projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId ){
$out+=' <a href="javascript:void(0);" class="totalContract editable-click" data-action="editCostInfo" data-placeholder="请输入合同编号" data-key="contractNo" data-type="1" data-valid="2" data-value="';
$out+=$escape(contractNo);
$out+='"> ';
$out+=$escape(contractNo==null||contractNo==''?'--':contractNo);
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(contractNo==null||contractNo==''?'--':contractNo);
$out+=' ';
}
$out+=' </span> </div> <div class="col-24-sm-4 no-padding"> 计划收款金额： <span class="text-navy contract text-ellipsis" > ';
if(editFlag==1 && projectCostRole.receiveProjectFeeSet==1  && operateCompanyId==dataCompanyId){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="editCostInfo" data-placeholder="合同总金额不能为空" data-key="fee" data-type="1" data-valid="2" data-value="';
$out+=$escape(totalCost-0);
$out+='" data-limit-min="';
$out+=$escape(total.fee-0);
$out+='"> ';
$out+=$escape(totalCost!=null && totalCost-0>0?_expNumberFilter(totalCost):'0');
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(totalCost==null||totalCost-0==0?'0':_expNumberFilter(totalCost));
$out+=' ';
}
$out+=' &nbsp;';
$out+=$escape(_isNullOrBlank(totalCost==null)?'':'元');
$out+=' </span> </div> <div class="col-24-sm-4 no-padding" style="margin-top: 2px;"> <span class=" contract text-ellipsis" >合同名称：</span> <span class="text-navy contract text-ellipsis" data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(contractName==null||contractName==''?'--':contractName);
$out+='"> ';
if(editFlag==1 && projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId ){
$out+=' <a href="javascript:void(0);" class="totalContract editable-click" data-action="editCostInfo" data-placeholder="请输入合同名称" data-key="contractName" data-type="1" data-valid="2" data-value="';
$out+=$escape(contractName);
$out+='"> ';
$out+=$escape(contractName==null||contractName==''?'--':contractName);
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(contractName==null||contractName==''?'--':contractName);
$out+=' ';
}
$out+=' </span> </div> <div class="col-24-sm-3 no-padding"> <span>合同日期：</span> <span class="text-navy " data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(contractDate==null||contractDate==''?'--':  _momentFormat(contractDate,'YYYY/MM/DD'));
$out+='"> ';
if(editFlag==1 && projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId ){
$out+=' <a href="javascript:void(0);" class="totalContract editable-click" data-action="editCostInfo" data-placeholder="请选择合同日期" data-key="contractDate" data-type="1" data-valid="2" data-value="';
$out+=$escape(contractDate);
$out+='" > ';
$out+=$escape(contractDate==null||contractDate==''?'--':  _momentFormat(contractDate,'YYYY/MM/DD'));
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(contractDate==null||contractDate==''?'--':  _momentFormat(contractDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </span> </div> <!-- <div class="col-24-sm-4 no-padding"> <span class="col-24-sm-6 text-right no-padding">合同附件：</span> <div class="col-24-sm-18 no-padding m-t-n-xs"> ';
if(attachList!=null && attachList.length>0){
$out+=' ';
$each(attachList,function(a,$index){
$out+=' <span class="contract bg-v1-grey text-ellipsis m-r-xs m-t-xxs p-xxs" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(a.fileName);
$out+='"> <a href="';
$out+=$escape(a.fileFullPath);
$out+='" target="_blank" >';
$out+=$escape(a.fileName);
$out+='</a> ';
if(editFlag==1 ){
$out+=' <a class="curp pt-absolute right-5" href="javascript:void(0)" data-id="';
$out+=$escape(a.id);
$out+='" data-action="delAttach"> <i class="fa fa-times fc-red"></i> </a> ';
}
$out+=' </span> ';
});
$out+=' ';
}else{
$out+=' <span class="dp-inline-block m-r-xs m-t-xs">暂无上传文件</span> ';
}
$out+=' ';
if(editFlag==1 && projectCostRole.receiveProjectFeeSet==1  && operateCompanyId==dataCompanyId){
$out+=' <a href="javascript:void(0)" id="filePicker" data-action="recordAttach" class="upload-icon vertical-top m-t-xxs dp-inline-block" title="请上传PDF文件"></a> ';
}
$out+=' <div class="clearfix"></div> </div> </div>--> <div class="col-24-sm-4 no-padding"style="margin-top: 2px"> <span class="contract text-ellipsis" >付款方：</span> ';
if(editFlag==1 && projectCostRole.receiveProjectFeeSet==1 && operateCompanyId==dataCompanyId){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="editCostInfo" > ';
if(_isNullOrBlank(companyName)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' <span class="contract text-ellipsis" data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(companyName);
$out+='">';
$out+=$escape(companyName);
$out+='</span> ';
}
$out+=' </a> ';
}else{
$out+=' ';
if(_isNullOrBlank(companyName)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' <span class="contract text-ellipsis" data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(companyName);
$out+='">';
$out+=$escape(companyName);
$out+='</span> ';
}
$out+=' ';
}
$out+=' </div> <div class="col-24-sm-2 no-padding"> ';
if(status!='4'){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-value="';
$out+=$escape(status);
$out+='" data-key="status" data-type="5" data-container-class="select-sm"> ';
if(status=='3'){
$out+=' <span>修改中</span> ';
}else if(status=='0'){
$out+=' <span>进行中</span> ';
}else if(status=='6'){
$out+=' <span>已终止</span> ';
}else if(status=='2'){
$out+=' <span>已暂停</span> ';
}else if(status=='7'){
$out+=' <span>已完成</span> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> ';
}else{
$out+=' ';
if(status=='3'){
$out+=' <span>修改中</span> ';
}else if(status=='0'){
$out+=' <span>进行中</span> ';
}else if(status=='6'){
$out+=' <span>已终止</span> ';
}else if(status=='2'){
$out+=' <span>已暂停</span> ';
}else if(status=='7'){
$out+=' <span>已完成</span> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' ';
}
$out+=' </div> <div class="col-24-sm-2 p-l-none text-right"> ';
if(status==3){
$out+=' <span class="f-s-xxs fc-red m-r-sm">该计划在变更中</span> ';
}
$out+=' <div class="btn-group btn-operate dp-inline-block"> <button data-toggle="dropdown" class="btn btn-default btn-xs dropdown-toggle"><span class="caret"></span></button> <ul class="dropdown-menu dropdown-menu-right"> ';
if(auditHistoryFlag==1){
$out+=' <li> <a href="javascript:void(0);" data-action="approvalRecord" data-id="';
$out+=$escape(costId);
$out+='">审批记录</a> </li> ';
}
$out+=' ';
if((status==0 || status==2) &&  projectCostRole.receiveProjectFeeSet==1  && operateCompanyId==dataCompanyId){
$out+=' <li> <a href="javascript:void(0);" data-action="suspendProjectCost" data-status="';
$out+=$escape(status);
$out+='">';
$out+=$escape(status==0?'终止收款计划':'启动收款计划');
$out+='</a> </li> ';
}
$out+=' ';
if((status==0 || status==2) &&  projectCostRole.receiveProjectFeeSet==1  && operateCompanyId==dataCompanyId  && isAllowEditFlag==1){
$out+=' <li> <a href="javascript:void(0);" data-action="modifyPlan" data-status="3" data-id="';
$out+=$escape(costId);
$out+='">修改计划</a> </li> ';
}
$out+=' ';
if(projectCostRole.receiveProjectFeeSet==1  && operateCompanyId==dataCompanyId  && repealEditFlag==1){
$out+=' <li> <a href="javascript:void(0);" data-action="modifyPlan" data-status="0" data-id="';
$out+=$escape(costId);
$out+='">撤销修改</a> </li> ';
}
$out+='  ';
if(deleteFlag==1 && projectCostRole.receiveProjectFeeSet==1  && operateCompanyId==dataCompanyId){
$out+=' <li><a href="javascript:;" data-action="delCost" data-id="';
$out+=$escape(costId);
$out+='">删除收款计划</a></li> ';
}
$out+=' </ul> </div> </div> </div> </th> </tr> <tr> <th colspan="3" class="text-center v-middle">收款节点信息</th> <th colspan="3" class="text-center v-middle">收款通知</th>  <th colspan="3" class="text-center v-middle">到账明细</th> </tr> <tr> <th width="18%" class="text-center v-middle">收款节点</th> <th width="10%" class="text-center v-middle">比例</th> <th width="10%" class="text-center v-middle">金额（元）</th> <th width="10%" class="text-center">发起人</th> <th width="10%" class="text-center">金额（元）</th> <th width="10%" class="text-center">发票类型</th>  <th width="12%" class="text-center">到账金额（元）</th> <th width="10%" class="text-center">到账日期</th> <th width="10%" class="text-center">应收（元）</th> </tr> </thead> <tbody class="border-no-t"> ';
$each(pointList,function(p,i){
$out+=' <tr data-i="';
$out+=$escape(i);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='" data-fee="';
$out+=$escape(p.fee);
$out+='" data-backFee="';
$out+=$escape(p.backFee);
$out+='" data-main-id="';
$out+=$escape(p.mainId?p.mainId:'');
$out+='">  <td class="feeDescription" rowspan="';
$out+=$escape(p.pointDetailList.length==0?1:p.pointDetailList.length);
$out+='"> ';
if(editFlag==1 && projectCostRole.receiveProjectFeeSet==1  && operateCompanyId==dataCompanyId){
$out+=' <span class="feeDescription l-h-22" data-string="';
$out+=$escape(p.feeDescription);
$out+='"> <a href="javascript:void(0);" class="editable-click" data-action="editContract" data-edit-type="1" data-placeholder="请输入收款节点描述" data-key="feeDescription" data-type="1" data-valid="3" > ';
$out+=$escape(p.feeDescription);
$out+=' </a> </span> ';
}else{
$out+=' <span class="feeDescription pt-relative" data-string="';
$out+=$escape(p.feeDescription);
$out+='"> ';
$out+=$escape(p.feeDescription);
$out+=' </span> ';
}
$out+=' ';
if(status==0 && projectCostRole.startReceive==1 && p.backFee-0!=p.fee && (p.fee!=null && p.fee-0>0) ){
$out+=' <a href="javascript:void(0)" class="btn btn-primary btn-xs pull-right" data-action="initiatedContract" data-id="';
$out+=$escape(p.id);
$out+='" >发起收款</a> ';
}
$out+=' ';
if(editFlag==1 && p.deleteFlag == 0 && projectCostRole.receiveProjectFeeSet==1  && operateCompanyId==dataCompanyId && p.id!=null){
$out+=' <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right m-r-xs" data-action="delCostPoint" data-id="';
$out+=$escape(p.id);
$out+='" >删除</a> ';
}
$out+=' </td>  <td rowspan="';
$out+=$escape(p.pointDetailList.length==0?1:p.pointDetailList.length);
$out+='" class="text-center feeProportion ';
$out+=$escape(p.pid==null?'f-w-bold':'');
$out+='" data-value="';
$out+=$escape(p.feeProportion);
$out+='"> ';
if(editFlag==1 && projectCostRole.receiveProjectFeeSet==1  && operateCompanyId==dataCompanyId && totalCost!=null && totalCost-0>0 ){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="editContract" data-edit-type="2" data-key="feeProportion" data-type="8" data-valid="4" data-limit-min="';
$out+=$escape(p.backFee);
$out+='" data-total-cost="';
$out+=$escape(totalCost);
$out+='"> ';
$out+=$escape(!(p.feeProportion!=null && p.feeProportion-0>0)?'':p.feeProportion+'%');
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(p.feeProportion==null || p.feeProportion-0==0?'0':p.feeProportion+'%');
$out+=' ';
}
$out+=' </td>  <td rowspan="';
$out+=$escape(p.pointDetailList.length==0?1:p.pointDetailList.length);
$out+='" class="text-center fee ';
$out+=$escape(p.pid==null?'f-w-bold':'');
$out+='" data-value="';
$out+=$escape(p.fee);
$out+='"> ';
if(editFlag==1 && projectCostRole.receiveProjectFeeSet==1  && operateCompanyId==dataCompanyId && totalCost!=null && totalCost-0>0 ){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="editContract" data-edit-type="3" data-key="fee" data-type="8" data-valid="4" data-limit-min="';
$out+=$escape(p.backFee);
$out+='" data-total-cost="';
$out+=$escape(totalCost);
$out+='"> ';
$out+=$escape(p.fee!=null && p.fee-0>0?_expNumberFilter(p.fee):'');
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(p.fee!=null && p.fee-0>0?_expNumberFilter(p.fee):'0');
$out+=' ';
}
$out+=' </td>  <td class="text-center"> ';
if(p.pointDetailList!=null && p.pointDetailList.length>0){
$out+=' <span data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(p.pointDetailList[0].createDate);
$out+='"> ';
$out+=$escape(p.pointDetailList[0].userName);
$out+=' </span> ';
}
$out+=' </td>  <td class=" totalPaidFee text-center" data-value="';
$out+=$escape(p.pointDetailList.length>0?p.pointDetailList[0].fee:'');
$out+='"> ';
if(p.pointDetailList!=null && p.pointDetailList.length>0){
$out+=' ';
if(status==0 && projectCostRole.startReceive==1 && (p.pointDetailList[0].paymentList==null || p.pointDetailList[0].paymentList.length==0) && p.pointDetailList[0].companyId==currentCompanyId && p.pointDetailList[0].roleMap.editReceiveAndPayment==1){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="editContract" data-edit-type="4" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='" data-key="fee" data-value="';
$out+=$escape(p.pointDetailList[0].fee-0);
$out+='" data-type="1" data-valid="6" data-limit-min="';
$out+=$escape(p.pointDetailList[0].paidFee-0);
$out+='" data-limit-max="';
$out+=$escape(p.fee-0-(p.backFee-0)+(p.pointDetailList[0].fee-0));
$out+='" > ';
$out+=$escape(_expNumberFilter(p.pointDetailList[0].fee));
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(_expNumberFilter(p.pointDetailList[0].fee));
$out+=' ';
}
$out+=' ';
if(status==0 && p.pointDetailList[0]!=null && p.pointDetailList[0].id!=null && projectCostRole.startReceive==1 && p.pointDetailList[0].companyId==currentCompanyId && p.pointDetailList[0].roleMap.deleteReceiveAndPayment==1){
$out+=' <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right" data-action="delCostPointDetail" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='">删除</a> ';
}
$out+=' ';
}
$out+=' </td>  <td class="text-center"> ';
if(p.pointDetailList!=null && p.pointDetailList.length>0 && p.pointDetailList[0].invoiceType==1){
$out+=' <a href="javascript:void(0);" class="btn btn-primary btn-xs" data-action="editInvoice" data-invoice="';
$out+=$escape(p.pointDetailList[0].invoice);
$out+='" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='">普票</a> ';
}else if(p.pointDetailList!=null && p.pointDetailList.length>0 && p.pointDetailList[0].invoiceType==2){
$out+=' <a href="javascript:void(0);" class="btn btn-primary btn-xs" data-action="editInvoice" data-invoice="';
$out+=$escape(p.pointDetailList[0].invoice);
$out+='" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='">专票</a> ';
}else if(p.pointDetailList!=null && p.pointDetailList.length>0 && p.pointDetailList[0].invoiceType==3){
$out+=' <a href="javascript:void(0);" class="btn btn-primary btn-xs" data-action="editInvoice" data-invoice="';
$out+=$escape(p.pointDetailList[0].invoice);
$out+='" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='">收据</a> ';
}else if(status==0 && p.pointDetailList!=null && p.pointDetailList.length>0 && projectCostRole.startReceive==1){
$out+=' <a href="javascript:void(0);" class="btn btn-primary btn-xs" data-action="replenishInvoice" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='">补录发票</a> ';
}
$out+=' </td>  <!--<td class="invoice text-center ';
$out+=$escape(p.pointDetailList!=null && p.pointDetailList[0] && (!_isNullOrBlank(p.pointDetailList[0].invoiceNo) || !_isNullOrBlank(p.pointDetailList[0].roleMap.invoiceConfirm))?'':'bg-muted');
$out+='"> ';
if(status==0 && p.pointDetailList!=null && p.pointDetailList.length>0 && !_isNullOrBlank(p.pointDetailList[0].invoice) && !_isNullOrBlank(p.pointDetailList[0].roleMap.invoiceConfirm)){
$out+=' <a href="javascript:void(0)" class="btn btn-primary btn-xs" data-action="confirmInvoice" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='" data-invoice="';
$out+=$escape(p.pointDetailList[0].invoice);
$out+='">确认开票</a> ';
}else if(status==0 && p.pointDetailList!=null && p.pointDetailList.length>0 && p.pointDetailList[0].roleMap && p.pointDetailList[0].roleMap.modifyInvoiceFlag=='1'){
$out+=' &lt;!&ndash;<a href="javascript:void(0);" class="editable-click" data-action="editContract" data-edit-type="6" data-placeholder="请输入发票号码" data-key="invoiceNo" data-type="1" data-valid="1" data-invoice="';
$out+=$escape(p.pointDetailList[0].invoice);
$out+='"> ';
$out+=$escape(p.pointDetailList[0].invoiceNo);
$out+=' </a>&ndash;&gt; <a href="javascript:void(0)" class="" data-action="editInvoice" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='" data-invoice="';
$out+=$escape(p.pointDetailList[0].invoice);
$out+='"> ';
$out+=$escape(p.pointDetailList[0].invoiceNo);
$out+=' </a> ';
if(p.pointDetailList[0].paymentList.length == 0){
$out+=' <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right m-r-xs" data-action="deleteInvoice" delete-type="1" data-invoice="';
$out+=$escape(p.pointDetailList[0].invoice);
$out+='">删除</a> <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right m-r-xs" data-action="deleteInvoice" delete-type="2" data-invoice="';
$out+=$escape(p.pointDetailList[0].invoice);
$out+='">作废</a> ';
}
$out+=' ';
}else if(p.pointDetailList!=null && p.pointDetailList.length>0){
$out+=' ';
$out+=$escape(p.pointDetailList[0].invoiceNo);
$out+=' ';
}
$out+=' </td>-->  <td class="text-center no-padding" colspan="2"> ';
if(p.pointDetailList!=null  && p.pointDetailList.length>0 && p.pointDetailList[0].paymentList.length>0){
$out+=' ';
$each(p.pointDetailList[0].paymentList,function(v,vi){
$out+=' <div class="';
$out+=$escape(p.pointDetailList[0].paymentList.length==vi+1 && !(p.pointDetailList[0].roleMap!=null && p.pointDetailList[0].roleMap.financialForFee!=null)?'l-h-38':'paid-detail-box');
$out+='">  <div class="bPaidFee"> <span>';
$out+=$escape(_expNumberFilter(v.fee));
$out+='</span> ';
if(status==0 && deleteFinanceData== 1){
$out+=' <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right m-r-xs" data-action="delPaidFee" data-id="';
$out+=$escape(v.id);
$out+='">删除</a> ';
}
$out+=' </div>  <div class="paid-date"> ';
if(_isNullOrBlank(v.paidDate) &&  v.roleMap!=null && v.roleMap.financialForFee!=null){
$out+=' <a href="javascript:void(0)" class="btn btn-primary btn-xs" data-action="costConfirm" data-fee="';
$out+=$escape(v.fee);
$out+='" data-id="';
$out+=$escape(v.roleMap.financialForFee);
$out+='">确认</a> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(v.paidDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> <div class="clearfix"></div> </div> ';
});
$out+=' ';
}
$out+=' ';
if(status==0 && p.pointDetailList.length>0 && p.pointDetailList[0].roleMap!=null && p.pointDetailList[0].roleMap.financialForFee!=null){
$out+=' <span data-toggle="tooltip" data-placement="top" title="添加到账金额" class="l-h-38 pt-relative"> <a class="btn btn-outline full-width no-padding" href="javascript:void(0)" data-id="';
$out+=$escape(p.pointDetailList[0].roleMap.financialForFee);
$out+='" data-edit-type="5" data-action="editContract" data-key="fee" data-type="9" data-valid="6" data-limit-min="0" data-limit-max="';
$out+=$escape(p.pointDetailList[0].notReceiveFee-0);
$out+='" type="button" > <i class="fa fa-plus color-dark-blue f-s-xl" ></i> </a> </span> ';
}
$out+=' </td>  <td class="text-center"> ';
if(p.pointDetailList!=null && p.pointDetailList.length>0){
$out+=' ';
$out+=$escape(_expNumberFilter(p.pointDetailList[0].notReceiveFee));
$out+=' ';
}
$out+=' </td> </tr> ';
if(p.pointDetailList!=null && p.pointDetailList.length>1){
$out+=' ';
$each(p.pointDetailList,function(c,ci){
$out+=' ';
if(ci>0){
$out+=' <tr data-id="';
$out+=$escape(p.id);
$out+='" data-fee="';
$out+=$escape(p.fee);
$out+='" data-backFee="';
$out+=$escape(p.backFee);
$out+='">  <td class="text-center"> <span data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(c.createDate);
$out+='"> ';
$out+=$escape(c.userName);
$out+=' </span> </td>  <td class=" totalPaidFee text-center" data-value="';
$out+=$escape(c.fee);
$out+='"> ';
if(status==0 && projectCostRole.startReceive==1 && (c.paymentList==null || c.paymentList.length==0) && c.companyId==currentCompanyId && c.roleMap.editReceiveAndPayment==1){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="editContract" data-edit-type="4" data-id="';
$out+=$escape(c.id);
$out+='" data-key="fee" data-value="';
$out+=$escape(c.fee-0);
$out+='" data-type="1" data-valid="6" data-limit-min="';
$out+=$escape(c.paidFee-0);
$out+='" data-limit-max="';
$out+=$escape(p.fee-0-(p.backFee-0)+(c.fee-0));
$out+='"> ';
$out+=$escape(_expNumberFilter(c.fee));
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(_expNumberFilter(c.fee));
$out+=' ';
}
$out+=' ';
if(status==0 && c.id!=null && projectCostRole.startReceive==1 && c.companyId==currentCompanyId && c.roleMap.deleteReceiveAndPayment==1){
$out+=' <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right" data-action="delCostPointDetail" data-id="';
$out+=$escape(c.id);
$out+='">删除</a> ';
}
$out+=' </td>  <td class="text-center"> ';
if(c.invoiceType==1){
$out+=' <a href="javascript:void(0);" class="btn btn-primary btn-xs" data-action="editInvoice" data-invoice="';
$out+=$escape(c.invoice);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='">普票</a> ';
}else if(c.invoiceType==2){
$out+=' <a href="javascript:void(0);" class="btn btn-primary btn-xs" data-action="editInvoice" data-invoice="';
$out+=$escape(c.invoice);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='">专票</a> ';
}else if(c.invoiceType==3){
$out+=' <a href="javascript:void(0);" class="btn btn-primary btn-xs" data-action="editInvoice" data-invoice="';
$out+=$escape(c.invoice);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='">收据</a> ';
}else if(status==0 && projectCostRole.startReceive==1){
$out+=' <a href="javascript:void(0);" class="btn btn-primary btn-xs" data-action="replenishInvoice" data-id="';
$out+=$escape(c.id);
$out+='">补录发票</a> ';
}
$out+=' </td>  <!--<td class="invoice text-center ';
$out+=$escape(!_isNullOrBlank(c.invoiceNo) || !_isNullOrBlank(c.roleMap.invoiceConfirm)?'':'bg-muted');
$out+='"> ';
if(status==0 && !_isNullOrBlank(c.invoice) && !_isNullOrBlank(c.roleMap.invoiceConfirm)){
$out+=' <a href="javascript:void(0)" class="btn btn-primary btn-xs" data-action="confirmInvoice" data-id="';
$out+=$escape(c.id);
$out+='" data-invoice="';
$out+=$escape(c.invoice);
$out+='">确认开票</a> ';
}else if(status==0 && c.roleMap && c.roleMap.modifyInvoiceFlag=='1'){
$out+=' &lt;!&ndash;<a href="javascript:void(0);" class="editable-click" data-action="editContract" data-edit-type="6" data-placeholder="请输入发票号码" data-key="invoiceNo" data-type="1" data-valid="1" data-invoice="';
$out+=$escape(c.invoice);
$out+='"> ';
$out+=$escape(c.invoiceNo);
$out+=' </a>&ndash;&gt; <a href="javascript:void(0)" class="" data-action="editInvoice" data-id="';
$out+=$escape(c.id);
$out+='" data-invoice="';
$out+=$escape(c.invoice);
$out+='"> ';
$out+=$escape(c.invoiceNo);
$out+=' </a> ';
if(c.paymentList.length == 0){
$out+=' <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right m-r-xs" data-action="deleteInvoice" delete-type="1" data-invoice="';
$out+=$escape(c.invoice);
$out+='">删除</a> <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right m-r-xs" data-action="deleteInvoice" delete-type="2" data-invoice="';
$out+=$escape(c.invoice);
$out+='">作废</a> ';
}
$out+=' ';
}else{
$out+=' ';
$out+=$escape(c.invoiceNo);
$out+=' ';
}
$out+=' </td>-->  <td class="text-center no-padding" colspan="2"> ';
if(c.paymentList.length>0){
$out+=' ';
$each(c.paymentList,function(v,vi){
$out+=' <div class="';
$out+=$escape(c.paymentList.length==vi+1 && !(c.roleMap!=null && c.roleMap.financialForFee!=null)?'l-h-38':'paid-detail-box');
$out+='" >  <div class="bPaidFee"> <span>';
$out+=$escape(_expNumberFilter(v.fee));
$out+='</span> ';
if(status==0 && deleteFinanceData== 1){
$out+=' <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right m-r-xs" data-action="delPaidFee" data-id="';
$out+=$escape(v.id);
$out+='">删除</a> ';
}
$out+=' </div>  <div class="paid-date"> ';
if(_isNullOrBlank(v.paidDate) &&  v.roleMap!=null && v.roleMap.financialForFee!=null){
$out+=' <a href="javascript:void(0)" class="btn btn-primary btn-xs" data-action="costConfirm" data-fee="';
$out+=$escape(v.fee);
$out+='" data-id="';
$out+=$escape(v.roleMap.financialForFee);
$out+='">确认</a> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(v.paidDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> <div class="clearfix"></div> </div> ';
});
$out+=' ';
}
$out+=' ';
if(status==0 && c.roleMap!=null && c.roleMap.financialForFee!=null ){
$out+=' <span data-toggle="tooltip" data-placement="top" title="添加到账金额" class="l-h-38 pt-relative"> <a class="btn btn-outline full-width no-padding" href="javascript:void(0)" data-id="';
$out+=$escape(c.roleMap.financialForFee);
$out+='" data-edit-type="5" data-action="editContract" data-key="fee" data-type="9" data-valid="6" data-limit-min="0" data-limit-max="';
$out+=$escape(c.notReceiveFee-0);
$out+='" type="button" > <i class="fa fa-plus color-dark-blue f-s-xl" ></i> </a> </span> ';
}
$out+=' </td>  <td class="text-center">';
$out+=$escape(_expNumberFilter(c.notReceiveFee));
$out+='</td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' ';
});
$out+=' ';
if(editFlag==1 && projectCostRole.receiveProjectFeeSet==1  && operateCompanyId==dataCompanyId && totalCost!=null && totalCost-0>0 && total.feeProportion<100){
$out+=' <tr> <td colspan="9" align="center"> <span data-toggle="tooltip" data-placement="top" title="添加收款节点"> <a class="btn btn-outline full-width border-dashed" href="javascript:void(0)" data-action="addContract" type="button" > <i class="fa fa-plus color-dark-blue f-s-xl" ></i> </a> </span> </td> </tr> ';
}
$out+=' <tr class="gray-bg"> <td class="text-center">合计</td> <td class="text-center f-w-bold">';
$out+=$escape(total.feeProportion==null || total.feeProportion-0==0?'0':total.feeProportion+'%');
$out+='</td> <td class="text-center f-w-bold">';
$out+=$escape(total.fee==null || total.fee-0==0?0:_expNumberFilter(total.fee));
$out+='</td> <td></td> <td class="text-center">';
$out+=$escape(total.backMoney==null || total.backMoney-0==0?0:_expNumberFilter(total.backMoney));
$out+='</td> <td></td> <td class="text-center">';
$out+=$escape(total.toTheMoney==null || total.toTheMoney-0==0?0:_expNumberFilter(total.toTheMoney));
$out+='</td> <td></td> <td class="text-center">';
$out+=$escape(total.receivedUncollected==null || total.receivedUncollected-0==0?0:_expNumberFilter(total.receivedUncollected));
$out+='</td> </tr> </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_cost/m_cost_confirmInvoice',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,pointInfo=$data.pointInfo,$escape=$utils.$escape,_isNullOrBlank=$helpers._isNullOrBlank,_expNumberFilter=$helpers._expNumberFilter,_momentFormat=$helpers._momentFormat,invoiceInfo=$data.invoiceInfo,$out='';$out+='<div class="ibox no-margins"> <div class="ibox-content no-borders"> <form class="form-horizontal"> ';
if(pointInfo){
$out+=' <div class="form-group m-b-xs"> <label class="col-24-md-5 text-right">金额：</label> <div class="col-24-md-19"> ';
$out+=$escape(_isNullOrBlank(pointInfo.fee)?'0':_expNumberFilter(pointInfo.fee));
$out+=' 元 </div> </div> <div class="form-group m-b-xs"> <label class="col-24-md-5 text-right">申请日期：</label> <div class="col-24-md-19"> ';
$out+=$escape(_momentFormat(invoiceInfo.applyDate,'YYYY/MM/DD'));
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-24-md-5 text-right">收票方名称：</label> <div class="col-24-md-19"> ';
$out+=$escape(invoiceInfo.relationCompanyName);
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-24-md-5 text-right">纳税识别号：</label> <div class="col-24-md-19"> ';
$out+=$escape(invoiceInfo.taxIdNumber);
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-24-md-5 text-right">开票内容：</label> <div class="col-24-md-19"> ';
$out+=$escape(invoiceInfo.invoiceContent);
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-24-md-5 text-right">备注：</label> <div class="col-24-md-19"> ';
$out+=$escape(invoiceInfo.invoiceRemark);
$out+=' </div> </div> ';
if(invoiceInfo.invoiceType==2){
$out+=' <div class="form-group m-b-xs"> <label class="col-24-md-5 text-right">地址：</label> <div class="col-24-md-19"> ';
$out+=$escape(invoiceInfo.address);
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-24-md-5 text-right">电话：</label> <div class="col-24-md-19"> ';
$out+=$escape(invoiceInfo.cellphone);
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-24-md-5 text-right">开户行：</label> <div class="col-24-md-19"> ';
$out+=$escape(invoiceInfo.accountBank);
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-24-md-5 text-right">账号：</label> <div class="col-24-md-19"> ';
$out+=$escape(invoiceInfo.bankNo);
$out+=' </div> </div> ';
}
$out+=' <div class="hr-line-dashed m-t-none"></div> ';
}
$out+=' <div class="form-group"> <label class="col-24-md-5 control-label">发票号码：</label> <div class="col-24-md-19"> <input placeholder="请输入发票号码" class="form-control" type="text" name="invoiceNo" value="';
$out+=$escape(invoiceInfo?invoiceInfo.invoiceNo:'');
$out+='"> </div> </div>  </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_cost/m_cost_delete','<form class="form-horizontal m"> <div class="form-group "> <label class="col-24-md-5 control-label">删除原因：</label> <div class="col-24-md-19"> <textarea class="full-width" rows="5" name="reason"></textarea> </div> </div> <div id="approverOutBox"> </div> </form> ');/*v:1*/
template('m_cost/m_cost_menu',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,projectOperator=$data.projectOperator,$escape=$utils.$escape,id=$data.id,projectNameCode=$data.projectNameCode,dataCompanyId=$data.dataCompanyId,businessType=$data.businessType,$out='';$out+='<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right"> <ul class="secondary-menu-ul"> ';
if(projectOperator && projectOperator.receiveModule==1){
$out+=' <li class="active" id="collectionPlan"> <a href="#/project/cost?type=collectionPlan&id=';
$out+=$escape(id);
$out+='&projectName=';
$out+=$escape(projectNameCode);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='&businessType=';
$out+=$escape(businessType);
$out+='">收款计划</a> </li> ';
}
$out+=' ';
if(projectOperator && projectOperator.payModule==1){
$out+=' <li id="paymentPlan" > <a href="#/project/cost?type=paymentPlan&id=';
$out+=$escape(id);
$out+='&projectName=';
$out+=$escape(projectNameCode);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='&businessType=';
$out+=$escape(businessType);
$out+='">付款计划</a> </li> ';
}
$out+=' </ul> </div> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content" id="content-box"> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_cost/m_cost_paymentApplication',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,isInnerCompany=$data.isInnerCompany,$escape=$utils.$escape,costPayDetail=$data.costPayDetail,_expNumberFilter=$helpers._expNumberFilter,$out='';$out+='<form class="form-horizontal m"> ';
if(isInnerCompany){
$out+=' <div class="form-group "> <label class="col-24-xs-3 text-right">申请人：</label> <div class="col-24-xs-21"> ';
$out+=$escape(costPayDetail.userName);
$out+=' </div> </div> <div class="form-group "> <label class="col-24-xs-3 text-right">申请金额：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_expNumberFilter(costPayDetail.fee));
$out+=' 元 </div> </div> ';
}
$out+=' <div class="form-group "> <label class="col-24-xs-3 text-right">收款方：</label> <div class="col-24-xs-21"> ';
$out+=$escape(costPayDetail.toCompanyName);
$out+=' </div> </div> <div class="form-group "> <label class="col-24-xs-3 text-right">关联节点：</label> <div class="col-24-xs-21"> ';
$out+=$escape(costPayDetail.feeDescription);
$out+=' </div> </div> <div class="form-group "> <label class="col-24-xs-3 text-right">节点金额：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_expNumberFilter(costPayDetail.pointFee));
$out+=' 元 </div> </div> <div class="hr-line-dashed m-t-none"></div> <div class="form-group ';
$out+=$escape(isInnerCompany?'hide':'');
$out+='"> <label class="col-24-xs-3 control-label">付款金额：</label> <div class="col-24-xs-21"> <div class="input-group"> <input placeholder="金额" class="form-control pay-input" type="text" name="fee" value="';
$out+=$escape(costPayDetail.fee);
$out+='"> <span class="input-group-addon">元</span> </div> </div> </div> <div class="form-group"> <label class="col-24-xs-3 control-label">备注：</label> <div class="col-24-xs-21"> <textarea placeholder="请输入备注" class="form-control" type="text" name="pointDetailDescription"></textarea> </div> </div> <div class="hr-line-dashed m-t-none"></div> <div id="approverOutBox"> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_cost/m_cost_paymentPlan',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,projectCostRole=$data.projectCostRole,dataList=$data.dataList,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="row"> <div class="col-md-6" id="designManagerBox"> </div> <div class="col-md-6 text-right"> ';
if(projectCostRole.paymentProjectFeeSet==1){
$out+=' <a class="btn btn-primary" data-action="addCollectionPlan">添加付款计划</a> ';
}
$out+=' </div> </div> <div class="m-t-xs" id="collectionPlanBox" > ';
if(dataList==null || dataList.length==0){
$out+=' <div class="panel panel-default no-borders m-t-xs"> <div class="panel-body text-center no-borders"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </div> ';
}
$out+=' </div> ';
return new String($out);
});/*v:1*/
template('m_cost/m_cost_paymentPlan_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,_isNullOrBlank=$helpers._isNullOrBlank,mainId=$data.mainId,$escape=$utils.$escape,pageText=$data.pageText,contractNo=$data.contractNo,editFlag=$data.editFlag,projectCostRole=$data.projectCostRole,operateCompanyId=$data.operateCompanyId,dataCompanyId=$data.dataCompanyId,totalCost=$data.totalCost,total=$data.total,_expNumberFilter=$helpers._expNumberFilter,contractName=$data.contractName,contractDate=$data.contractDate,_momentFormat=$helpers._momentFormat,attachList=$data.attachList,$each=$utils.$each,a=$data.a,$index=$data.$index,companyName=$data.companyName,status=$data.status,auditFlag=$data.auditFlag,auditHistoryFlag=$data.auditHistoryFlag,costId=$data.costId,isAllowEditFlag=$data.isAllowEditFlag,repealEditFlag=$data.repealEditFlag,deleteFlag=$data.deleteFlag,pointList=$data.pointList,p=$data.p,i=$data.i,isInnerCompany=$data.isInnerCompany,currentCompanyId=$data.currentCompanyId,v=$data.v,vi=$data.vi,deleteFinanceData=$data.deleteFinanceData,c=$data.c,ci=$data.ci,$out='';$out+='<div class="panel-body popover-box no-borders no-padding m-cost-item pt-relative"> ';
if(!_isNullOrBlank(mainId)){
$out+=' <div class="mask-layer"></div> <div class="mask-layer mask-layer-content"> <h2 class="fc-dark-grey m-b-md">审批中</h2> <p class="f-s-md"> ';
$out+=$escape(pageText.title);
$out+='的付款计划正在审批中，查看审批情况请点击 【<a class="fc-dark-blue" data-action="approvalDetails" data-id="';
$out+=$escape(mainId);
$out+='">审批详情</a>】 </p> </div> ';
}
$out+=' <table class="table table-bordered"> <thead> <tr> <th colspan="10" class=""> <div class="row"> <div class="col-24-sm-2 p-r-none" id="costTitle"> ';
$out+=$escape(pageText.title);
$out+=' </div> <div class="col-24-sm-3 no-padding"> <span class=" contract text-ellipsis" >合同编号：</span> <span class="text-navy contract text-ellipsis" data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(contractNo==null||contractNo==''?'--':contractNo);
$out+='"> ';
if(editFlag==1 && projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId ){
$out+=' <a href="javascript:void(0);" class="totalContract editable-click" data-action="editCostInfo" data-placeholder="请输入合同编号" data-key="contractNo" data-type="1" data-valid="2" data-value="';
$out+=$escape(contractNo);
$out+='"> ';
$out+=$escape(contractNo==null||contractNo==''?'--':contractNo);
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(contractNo==null||contractNo==''?'--':contractNo);
$out+=' ';
}
$out+=' </span> </div> <div class="col-24-sm-4 no-padding"> <span>计划付款金额：</span> <span class="text-navy "> ';
if(editFlag==1 && projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId ){
$out+=' <a href="javascript:void(0);" class="totalContract editable-click" data-action="editCostInfo" data-placeholder="合同总金额不能为空" data-key="totalCost" data-type="1" data-valid="2" data-value="';
$out+=$escape(totalCost-0);
$out+='" data-limit-min="';
$out+=$escape(total.fee-0);
$out+='"> ';
$out+=$escape(totalCost!=null && totalCost-0>0?_expNumberFilter(totalCost):'0');
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(totalCost==null||totalCost-0==0?'0':_expNumberFilter(totalCost));
$out+=' ';
}
$out+=' &nbsp;';
$out+=$escape(_isNullOrBlank(totalCost==null)?'':'元');
$out+=' </span> </div> <div class="col-24-sm-4 no-padding" style="margin-top: 2px"> <span class=" contract text-ellipsis" >合同名称：</span> <span class="text-navy contract text-ellipsis" data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(contractName==null||contractName==''?'--':contractName);
$out+='"> ';
if(editFlag==1 && projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId ){
$out+=' <a href="javascript:void(0);" class="totalContract editable-click" data-action="editCostInfo" data-placeholder="请输入合同名称" data-key="contractName" data-type="1" data-valid="2" data-value="';
$out+=$escape(contractName);
$out+='"> ';
$out+=$escape(contractName==null||contractName==''?'--':contractName);
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(contractName==null||contractName==''?'--':contractName);
$out+=' ';
}
$out+=' </span> </div> <div class="col-24-sm-3 no-padding"> <span>合同日期：</span> <span class="text-navy " data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(contractDate==null||contractDate==''?'--':  _momentFormat(contractDate,'YYYY/MM/DD'));
$out+='"> ';
if(editFlag==1 && projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId ){
$out+=' <a href="javascript:void(0);" class="totalContract editable-click" data-action="editCostInfo" data-placeholder="请选择合同日期" data-key="contractDate" data-type="1" data-valid="2" data-value="';
$out+=$escape(contractDate);
$out+='"> ';
$out+=$escape(contractDate==null||contractDate==''?'--':  _momentFormat(contractDate,'YYYY/MM/DD'));
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(contractDate==null||contractDate==''?'--':  _momentFormat(contractDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </span> </div> <!-- <div class="col-24-sm-4 no-padding"> <span class="col-24-sm-6 text-right no-padding">合同附件：</span> <div class="col-24-sm-18 no-padding m-t-n-xs"> ';
if(attachList!=null && attachList.length>0){
$out+=' ';
$each(attachList,function(a,$index){
$out+=' <span class="contract bg-v1-grey text-ellipsis m-r-xs m-t-xs p-xxs" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(a.fileName);
$out+='"> <a href="';
$out+=$escape(a.fileFullPath);
$out+='" target="_blank">';
$out+=$escape(a.fileName);
$out+='</a> ';
if(editFlag==1){
$out+=' <a class="curp pt-absolute right-5" href="javascript:void(0)" data-id="';
$out+=$escape(a.id);
$out+='" data-action="delAttach"> <i class="fa fa-times fc-red"></i> </a> ';
}
$out+=' </span> ';
});
$out+=' ';
}else{
$out+=' <span class="dp-inline-block m-r-xs m-t-xs">暂无上传文件</span> ';
}
$out+=' ';
if(editFlag==1 && projectCostRole.paymentProjectFeeSet==1 &&
                            operateCompanyId==dataCompanyId ){
$out+=' <a href="javascript:void(0)" id="filePicker" data-action="recordAttach" class="upload-icon vertical-top m-t-xxs dp-inline-block" title="请上传PDF文件"></a> ';
}
$out+=' </div> </div>--> <div class="col-24-sm-4 no-padding" style="margin-top: 2px"> <span class="contract text-ellipsis" >收款方：</span> ';
if(editFlag==1 && projectCostRole.receiveProjectFeeSet==1 && operateCompanyId==dataCompanyId){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="editCostInfo" data-string="';
$out+=$escape(companyName);
$out+='"> ';
if(_isNullOrBlank(companyName)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' <span class="contract text-ellipsis" data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(companyName);
$out+='">';
$out+=$escape(companyName);
$out+='</span> ';
}
$out+=' </a> ';
}else{
$out+=' ';
if(_isNullOrBlank(companyName)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' <span class="contract text-ellipsis" data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(companyName);
$out+='">';
$out+=$escape(companyName);
$out+='</span> ';
}
$out+=' ';
}
$out+=' </div> <div class="col-24-sm-2 no-padding"> ';
if(status!='4'){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-value="';
$out+=$escape(status);
$out+='" data-key="status" data-type="5" data-container-class="select-sm"> ';
if(status=='3'){
$out+=' <span>修改中</span> ';
}else if(status=='0'){
$out+=' <span>进行中</span> ';
}else if(status=='6'){
$out+=' <span>已终止</span> ';
}else if(status=='2'){
$out+=' <span>已暂停</span> ';
}else if(status=='7'){
$out+=' <span>已完成</span> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> ';
}else{
$out+=' ';
if(status=='3'){
$out+=' <span>修改中</span> ';
}else if(status=='0'){
$out+=' <span>进行中</span> ';
}else if(status=='6'){
$out+=' <span>已终止</span> ';
}else if(status=='2'){
$out+=' <span>已暂停</span> ';
}else if(status=='7'){
$out+=' <span>已完成</span> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' ';
}
$out+=' </div> <div class="col-24-sm-2 p-l-none text-right"> ';
if(status==3){
$out+=' <span class="f-s-xxs fc-red m-r-sm">该计划在变更中</span> ';
}
$out+=' <div class="btn-group btn-operate dp-inline-block"> <button data-toggle="dropdown" class="btn btn-default btn-xs dropdown-toggle"><span class="caret"></span></button> <ul class="dropdown-menu dropdown-menu-right"> <!--';
if(editFlag==1  && projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId ){
$out+='-->  <!--<a href="javascript:void(0);" data-action="approvalSubmit">';
$out+=$escape(auditFlag==1?'提交付款计划审批':'发布付款计划');
$out+='</a>-->  <!--';
}
$out+='--> ';
if(auditHistoryFlag==1){
$out+=' <li> <a href="javascript:void(0);" data-action="approvalRecord" data-id="';
$out+=$escape(costId);
$out+='">审批记录</a> </li> ';
}
$out+=' ';
if((status==0 || status==2) && projectCostRole.paymentProjectFeeSet==1&&
                                operateCompanyId==dataCompanyId ){
$out+=' <li> <a href="javascript:void(0);" data-action="suspendProjectCost" data-status="';
$out+=$escape(status);
$out+='">';
$out+=$escape(status==0?'终止付款计划':'启动付款计划');
$out+='</a> </li> ';
}
$out+=' ';
if((status==0 || status==2) && projectCostRole.paymentProjectFeeSet==1 &&
                                operateCompanyId==dataCompanyId && isAllowEditFlag==1){
$out+=' <li> <a href="javascript:void(0);" data-action="modifyPlan" data-status="3" data-id="';
$out+=$escape(costId);
$out+='">修改计划</a> </li> ';
}
$out+=' ';
if(projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId &&
                                repealEditFlag==1){
$out+=' <li> <a href="javascript:void(0);" data-action="modifyPlan" data-status="0" data-id="';
$out+=$escape(costId);
$out+='">撤销修改</a> </li> ';
}
$out+='  ';
if(deleteFlag==1 && projectCostRole.paymentProjectFeeSet==1 &&
                                operateCompanyId==dataCompanyId ){
$out+=' <li><a href="javascript:;" data-action="delCost" data-id="';
$out+=$escape(costId);
$out+='">删除付款计划</a></li> ';
}
$out+=' </ul> </div> </div> </div> </th> </tr> <tr> <th colspan="3" class="text-center v-middle">付款节点信息</th> <th colspan="3" class="text-center v-middle">付款通知</th> <th colspan="3" class="text-center v-middle">付款明细</th> </tr> <tr> <th width="18%" class="text-center v-middle">付款节点</th> <th width="10%" class="text-center v-middle">比例</th> <th width="10%" class="text-center v-middle">金额（元）</th> <th width="10%" class="text-center">发起人</th> <th width="10%" class="text-center">金额（元）</th>  <th width="10%" class="text-center">发票类型</th> <th width="12%" class="text-center">付款金额（元）</th> <th width="10%" class="text-center">付款日期</th> <th width="10%" class="text-center">应付（元）</th> </tr> </thead> <tbody class="border-no-t"> ';
$each(pointList,function(p,i){
$out+=' <tr data-i="';
$out+=$escape(i);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='" data-fee="';
$out+=$escape(p.fee);
$out+='" data-backFee="';
$out+=$escape(p.backFee);
$out+='" data-main-id="';
$out+=$escape(p.mainId?p.mainId:'');
$out+='">  <td class="feeDescription" rowspan="';
$out+=$escape(p.pointDetailList.length==0?1:p.pointDetailList.length);
$out+='"> ';
if(editFlag==1 && projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId ){
$out+=' <span class="feeDescription l-h-22" data-string="';
$out+=$escape(p.feeDescription);
$out+='"> <a href="javascript:void(0);" class="editable-click" data-action="editContract" data-edit-type="1" data-placeholder="请输入节点描述" data-key="feeDescription" data-type="1" data-valid="3"> ';
$out+=$escape(p.feeDescription);
$out+=' </a> </span> ';
}else{
$out+=' <span class="feeDescription pt-relative" data-string="';
$out+=$escape(p.feeDescription);
$out+='"> ';
$out+=$escape(p.feeDescription);
$out+=' </span> ';
}
$out+=' ';
if(status==0 && projectCostRole.startPayment==1 && isInnerCompany==false && p.backFee-0!=p.fee &&
                (p.fee!=null && p.fee-0>0)){
$out+=' <a href="javascript:void(0)" class="btn btn-primary btn-xs pull-right" data-action="paymentRequest2">付款申请</a> ';
}
$out+=' ';
if(editFlag==1 && p.deleteFlag == 0 && projectCostRole.paymentProjectFeeSet==1 &&
                operateCompanyId==dataCompanyId && p.id!=null){
$out+=' <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right m-r-xs" data-action="delCostPoint" data-id="';
$out+=$escape(p.id);
$out+='">删除</a> ';
}
$out+=' </td>  <td rowspan="';
$out+=$escape(p.pointDetailList.length==0?1:p.pointDetailList.length);
$out+='" class="text-center feeProportion ';
$out+=$escape(p.pid==null?'f-w-bold':'');
$out+='" data-value="';
$out+=$escape(p.feeProportion);
$out+='"> ';
if(editFlag==1 && projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId &&
                totalCost!=null && totalCost-0>0){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="editContract" data-edit-type="2" data-key="feeProportion" data-type="8" data-valid="4" data-limit-min="';
$out+=$escape(p.backFee);
$out+='" data-total-cost="';
$out+=$escape(totalCost);
$out+='"> ';
$out+=$escape(!(p.feeProportion!=null && p.feeProportion-0>0)?'':p.feeProportion+'%');
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(p.feeProportion==null || p.feeProportion-0==0?'0':p.feeProportion+'%');
$out+=' ';
}
$out+=' </td>  <td rowspan="';
$out+=$escape(p.pointDetailList.length==0?1:p.pointDetailList.length);
$out+='" class="text-center fee ';
$out+=$escape(p.pid==null?'f-w-bold':'');
$out+='" data-value="';
$out+=$escape(p.fee);
$out+='"> ';
if(editFlag==1 && projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId &&
                totalCost!=null && totalCost-0>0){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="editContract" data-edit-type="3" data-key="fee" data-type="8" data-valid="4" data-limit-min="';
$out+=$escape(p.backFee);
$out+='" data-total-cost="';
$out+=$escape(totalCost);
$out+='"> ';
$out+=$escape(p.fee!=null && p.fee-0>0?_expNumberFilter(p.fee):'');
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(p.fee!=null && p.fee-0>0?_expNumberFilter(p.fee):'0');
$out+=' ';
}
$out+=' </td>  <td class="text-center ';
$out+=$escape(p.pointDetailList[0] && p.pointDetailList[0].auditStatus==2?'bg-muted':'');
$out+='"> ';
if(p.pointDetailList!=null && p.pointDetailList.length>0){
$out+=' <span data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(p.pointDetailList[0].createDate);
$out+='"> ';
$out+=$escape(p.pointDetailList[0].userName);
$out+=' </span> ';
}
$out+=' </td>  <td class=" totalPaidFee text-center ';
$out+=$escape(p.pointDetailList[0] && p.pointDetailList[0].auditStatus==2?'bg-muted':'');
$out+='" data-value="';
$out+=$escape(p.pointDetailList.length>0?p.pointDetailList[0].fee:'');
$out+='"> ';
if(p.pointDetailList!=null && p.pointDetailList.length>0){
$out+=' ';
if(status==0 && projectCostRole.startPayment==1 && (p.pointDetailList[0].paymentList==null ||
                p.pointDetailList[0].paymentList.length==0) && p.pointDetailList[0].companyId==currentCompanyId &&
                p.pointDetailList[0].roleMap.editReceiveAndPayment==1){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="editContract" data-edit-type="4" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='" data-key="fee" data-value="';
$out+=$escape(p.pointDetailList[0].fee-0);
$out+='" data-type="1" data-valid="6" data-limit-min="';
$out+=$escape(p.pointDetailList[0].paidFee-0);
$out+='" data-limit-max="';
$out+=$escape(p.fee-0-(p.backFee-0)+(p.pointDetailList[0].fee-0));
$out+='"> ';
$out+=$escape(_expNumberFilter(p.pointDetailList[0].fee));
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(_expNumberFilter(p.pointDetailList[0].fee));
$out+=' ';
}
$out+=' ';
if(status==0 && projectCostRole.startPayment==1 && p.pointDetailList[0]!=null &&
                p.pointDetailList[0].id!=null && p.pointDetailList[0].companyId==currentCompanyId &&
                p.pointDetailList[0].roleMap.deleteReceiveAndPayment==1 && p.pointDetailList[0].auditStatus!=2 ){
$out+=' <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right" data-action="delCostPointDetail" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='">删除</a> ';
}
$out+=' ';
}
$out+=' </td> <!--&lt;!&ndash;以下是审批状态 (0：未申请，5：审批中，2，退回，3撤销，1：已审批)&ndash;&gt; <td class="text-center ';
$out+=$escape((p.pointDetailList[0] && (p.pointDetailList[0].auditStatus==4 || p.pointDetailList[0].auditStatus==2))?'bg-muted':'');
$out+='"> ';
if(p.pointDetailList!=null && p.pointDetailList.length>0){
$out+=' ';
if(p.pointDetailList[0].auditStatus == 0){
$out+=' <a href="javascript:void(0);" class="btn btn-link text-navy" data-action="viewPaymentDetails" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='">待审核</a> ';
}else if(p.pointDetailList[0].auditStatus == 1){
$out+=' <a href="javascript:void(0);" class="btn btn-link text-navy" data-action="viewPaymentDetails" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='">已审批</a> ';
}else if(p.pointDetailList[0].auditStatus == 2){
$out+=' <a href="javascript:void(0);" class="btn btn-link text-navy" data-action="viewPaymentDetails" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='">已退回</a> ';
}else if(p.pointDetailList[0].auditStatus == 3){
$out+=' <a href="javascript:void(0);" class="btn btn-link text-navy" data-action="viewPaymentDetails" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='">已撤销</a> ';
}else if(p.pointDetailList[0].auditStatus == 5){
$out+=' <a href="javascript:void(0);" class="btn btn-link text-navy" data-action="viewPaymentDetails" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='">审批中</a> ';
}
$out+=' ';
}
$out+=' </td>-->  <td class="text-center"> ';
if(p.pointDetailList!=null && p.pointDetailList.length>0 && p.pointDetailList[0].invoiceType==1){
$out+=' 普票 ';
}else if(p.pointDetailList!=null && p.pointDetailList.length>0 && p.pointDetailList[0].invoiceType==2){
$out+=' 专票 ';
}else if(p.pointDetailList!=null && p.pointDetailList.length>0 && p.pointDetailList[0].invoiceType==3){
$out+=' 收据 ';
}else if(status==0 && p.pointDetailList!=null && p.pointDetailList.length>0 &&
                projectCostRole.startReceive==1){
$out+=' <a href="javascript:void(0);" class="btn btn-primary btn-xs" data-action="replenishInvoice" data-id="';
$out+=$escape(p.pointDetailList[0].id);
$out+='">补录发票</a> ';
}
$out+=' </td>  <td class="text-center no-padding" colspan="2"> ';
if(p.pointDetailList!=null && p.pointDetailList.length>0 &&
                p.pointDetailList[0].paymentList.length>0){
$out+=' ';
$each(p.pointDetailList[0].paymentList,function(v,vi){
$out+=' <div class="';
$out+=$escape(p.pointDetailList[0].paymentList.length==vi+1 && !(p.pointDetailList[0].roleMap!=null && p.pointDetailList[0].roleMap.financialForFee!=null)?'l-h-38':'paid-detail-box');
$out+='">  <div class="bPaidFee"> <span>';
$out+=$escape(_expNumberFilter(v.fee));
$out+='</span> ';
if(status==0 && deleteFinanceData== 1){
$out+=' <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right m-r-xs" data-action="delPaidFee" data-id="';
$out+=$escape(v.id);
$out+='">删除</a> ';
}
$out+=' </div>  <div class="paid-date"> ';
if(_isNullOrBlank(v.payDate) && v.roleMap!=null && v.roleMap.financialForFee!=null){
$out+=' <a href="javascript:void(0)" class="btn btn-primary btn-xs" data-action="costConfirm" data-fee="';
$out+=$escape(v.fee);
$out+='" data-id="';
$out+=$escape(v.roleMap.financialForFee);
$out+='">确认</a> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(v.payDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> <div class="clearfix"></div> </div> ';
});
$out+=' ';
}
$out+=' ';
if(status==0 && p.pointDetailList.length>0 && p.pointDetailList[0].roleMap!=null &&
                p.pointDetailList[0].roleMap.financialForFee!=null){
$out+=' <span data-toggle="tooltip" data-placement="top" title="添加付款金额" class="l-h-38"> <a class="btn btn-outline full-width no-padding" href="javascript:void(0)" data-id="';
$out+=$escape(p.pointDetailList[0].roleMap.financialForFee);
$out+='" data-edit-type="5" data-action="editContract" data-key="fee" data-type="9" data-valid="6" data-limit-min="0" data-limit-max="';
$out+=$escape(p.pointDetailList[0].notPayFee2-0);
$out+='" type="button"> <i class="fa fa-plus color-dark-blue f-s-xl"></i> </a> </span> ';
}
$out+=' </td>  <td class="text-center"> ';
if(p.pointDetailList!=null && p.pointDetailList.length>0){
$out+=' ';
$out+=$escape(_expNumberFilter(p.pointDetailList[0].notPayFee));
$out+=' ';
}
$out+=' </td> </tr> ';
if(p.pointDetailList!=null && p.pointDetailList.length>1){
$out+=' ';
$each(p.pointDetailList,function(c,ci){
$out+=' ';
if(ci>0){
$out+=' <tr data-i="';
$out+=$escape(i);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='" data-fee="';
$out+=$escape(p.fee);
$out+='" data-backFee="';
$out+=$escape(p.backFee);
$out+='">  <td class="text-center ';
$out+=$escape(c.auditStatus==2?'bg-muted':'');
$out+='"> ';
if(c.userName){
$out+=' <span data-toggle="tooltip" data-placement="top" title="';
$out+=$escape(c.createDate);
$out+='"> ';
$out+=$escape(c.userName);
$out+=' </span> ';
}
$out+=' </td>  <td class=" totalPaidFee text-center ';
$out+=$escape(c.auditStatus==2?'bg-muted':'');
$out+='" data-value="';
$out+=$escape(c.fee);
$out+='"> <div> ';
if(status==0 && projectCostRole.startPayment==1 && (c.paymentList==null ||
                    c.paymentList.length==0) && c.companyId==currentCompanyId && c.roleMap.editReceiveAndPayment==1){
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="editContract" data-edit-type="4" data-id="';
$out+=$escape(c.id);
$out+='" data-key="fee" data-value="';
$out+=$escape(c.fee-0);
$out+='" data-type="1" data-valid="6" data-limit-min="';
$out+=$escape(c.paidFee-0);
$out+='" data-limit-max="';
$out+=$escape(p.fee-0-(p.backFee-0)+(c.fee-0));
$out+='"> ';
$out+=$escape(_expNumberFilter(c.fee));
$out+=' </a> ';
}else{
$out+=' ';
$out+=$escape(_expNumberFilter(c.fee));
$out+=' ';
}
$out+=' ';
if(status==0 && c.id!=null && projectCostRole.startPayment==1 && c.companyId==currentCompanyId &&
                    c.roleMap.deleteReceiveAndPayment==1 && c.auditStatus!=2){
$out+=' <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right" data-action="delCostPointDetail" data-id="';
$out+=$escape(c.id);
$out+='">删除</a> ';
}
$out+=' </div> </td> <!--&lt;!&ndash;以下是审批状态&ndash;&gt; <td class="text-center ';
$out+=$escape(c.auditStatus==4||c.auditStatus==2?'bg-muted':'');
$out+='"> ';
if(c.auditStatus == 0){
$out+=' <a href="javascript:void(0);" class="btn btn-link text-navy p-w-xxs" data-action="viewPaymentDetails" data-id="';
$out+=$escape(c.id);
$out+='">待审核</a> ';
}else if(c.auditStatus == 1){
$out+=' <a href="javascript:void(0);" class="btn btn-link text-navy p-w-xxs" data-action="viewPaymentDetails" data-id="';
$out+=$escape(c.id);
$out+='">已审批</a> ';
}else if(c.auditStatus == 2){
$out+=' <a href="javascript:void(0);" class="btn btn-link text-navy p-w-xxs" data-action="viewPaymentDetails" data-id="';
$out+=$escape(c.id);
$out+='">已退回</a> ';
}else if(c.auditStatus == 3){
$out+=' <a href="javascript:void(0);" class="btn btn-link text-navy p-w-xxs" data-action="viewPaymentDetails" data-id="';
$out+=$escape(c.id);
$out+='">已撤销</a> ';
}else if(c.auditStatus == 5){
$out+=' <a href="javascript:void(0);" class="btn btn-link text-navy p-w-xxs" data-action="viewPaymentDetails" data-id="';
$out+=$escape(c.id);
$out+='">审批中</a> ';
}
$out+=' </td>-->  <td class="text-center"> ';
if(c.invoiceType==1){
$out+=' 普票 ';
}else if(c.invoiceType==2){
$out+=' 专票 ';
}else if(c.invoiceType==3){
$out+=' 收据 ';
}else if(status==0 && projectCostRole.startReceive==1){
$out+=' <a href="javascript:void(0);" class="btn btn-primary btn-xs" data-action="replenishInvoice" data-id="';
$out+=$escape(c.id);
$out+='">补录发票</a> ';
}
$out+=' </td>  <td class="text-center no-padding" colspan="2"> ';
if(c.paymentList.length>0){
$out+=' ';
$each(c.paymentList,function(v,vi){
$out+=' <div class="';
$out+=$escape(c.paymentList.length==vi+1 && !(c.roleMap!=null && c.roleMap.financialForFee!=null)?'l-h-38':'paid-detail-box');
$out+='">  <div class="bPaidFee"> <span>';
$out+=$escape(_expNumberFilter(v.fee));
$out+='</span> ';
if(status==0 && deleteFinanceData== 1){
$out+=' <a href="javascript:void(0)" class="btn btn-danger btn-xs pull-right m-r-xs" data-action="delPaidFee" data-id="';
$out+=$escape(v.id);
$out+='">删除</a> ';
}
$out+=' </div>  <div class="paid-date"> ';
if(_isNullOrBlank(v.payDate) && v.roleMap!=null && v.roleMap.financialForFee!=null){
$out+=' <a href="javascript:void(0)" class="btn btn-primary btn-xs" data-action="costConfirm" data-fee="';
$out+=$escape(v.fee);
$out+='" data-id="';
$out+=$escape(v.roleMap.financialForFee);
$out+='">确认</a> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(v.payDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> <div class="clearfix"></div> </div> ';
});
$out+=' ';
}
$out+=' ';
if(status==0 && c.roleMap!=null && c.roleMap.financialForFee!=null ){
$out+=' <span data-toggle="tooltip" data-placement="top" title="添加付款金额" class="l-h-38"> <a class="btn btn-outline full-width no-padding" href="javascript:void(0)" data-id="';
$out+=$escape(c.roleMap.financialForFee);
$out+='" data-edit-type="5" data-action="editContract" data-key="fee" data-type="9" data-valid="6" data-limit-min="0" data-limit-max="';
$out+=$escape(c.notPayFee2-0);
$out+='" type="button"> <i class="fa fa-plus color-dark-blue f-s-xl"></i> </a> </span> ';
}
$out+=' </td>  <td class="text-center">';
$out+=$escape(_expNumberFilter(c.notPayFee));
$out+='</td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' ';
});
$out+=' ';
if(editFlag==1 && projectCostRole.paymentProjectFeeSet==1 && operateCompanyId==dataCompanyId &&
        totalCost!=null && totalCost-0>0 && total.feeProportion<100){
$out+=' <tr> <td colspan="10" align="center"> <span data-toggle="tooltip" data-placement="top" title="添加付款节点"> <a class="btn btn-outline full-width border-dashed" href="javascript:void(0)" data-action="addContract" type="button"> <i class="fa fa-plus color-dark-blue f-s-xl"></i> </a> </span> </td> </tr> ';
}
$out+=' <tr class="gray-bg"> <td class="text-center">合计</td> <td class="text-center f-w-bold">';
$out+=$escape(total.feeProportion==null ||
                total.feeProportion-0==0?'0':total.feeProportion+'%');
$out+=' </td> <td class="text-center f-w-bold">';
$out+=$escape(total.fee==null || total.fee-0==0?0:_expNumberFilter(total.fee));
$out+='</td> <td></td> <td class="text-center">';
$out+=$escape(total.backMoney==null ||
                total.backMoney-0==0?0:_expNumberFilter(total.backMoney));
$out+=' </td> <td></td> <td class="text-center">';
$out+=$escape(total.payTheMoney==null ||
                total.payTheMoney-0==0?0:_expNumberFilter(total.payTheMoney));
$out+=' </td> <td></td> <td class="text-center">';
$out+=$escape(total.payUncollected==null ||
                total.payUncollected-0==0?0:_expNumberFilter(total.payUncollected));
$out+=' </td> </tr> </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_cost/m_editFee','<form class=" form m-editFee width-270"> <div class="form-group m-b-xs clearfix"> <label class="col-md-2 control-label p-l-none m-t-xs p-r-none">比例</label> <div class="col-md-10 p-r-none width-225 input-group" style="padding-left:15px;"> <input type="text" class="form-control full-width" name="feeProportion" data-action="feeCalculation" placeholder="比例" > <span class="input-group-addon">%</span> </div> </div> <div class="form-group m-b-xs clearfix"> <label class="col-md-2 control-label p-l-none m-t-xs p-r-none">金额</label> <div class="col-md-10 p-r-none width-225 input-group" style="padding-left:15px;" > <input type="text" class="form-control full-width" name="fee" data-action="feeCalculation" placeholder="金额"> <span class="input-group-addon">元</span> </div> </div> <div class="form-group col-md-12 m-b-xs p-r-none clearfix"> <button type="button" class="btn btn-default btn-sm m-popover-close pull-right "> <i class="glyphicon glyphicon-remove"></i> </button> <button type="button" class="btn btn-primary btn-sm m-popover-submit pull-right m-r-xs"> <i class="fa fa-check"></i> </button> <div class="clearfix"></div> </div> </form>');/*v:1*/
template('m_cost/m_editPaidFee','<form class="form feeForm width-270"> <div class="form-group m-b-xs"> <label class="col-24-md-8 control-label p-l-none m-t-xs">付款金额</label> <div class="col-24-md-16 no-padding"> <div class="input-group"> <input placeholder="金额" class="form-control" type="text" name="fee" data-action="feeCalculation"> <span class="input-group-addon">元</span> </div> </div> <div class="clearfix"></div> </div> <div class="form-group m-b-xs hide"> <label class="col-24-md-8 control-label m-t-xs p-l-none m-t-xs">付款日期</label> <div class="col-24-md-16 no-padding"> <div class="input-group"> <input class="form-control" type="text" name="paidDate" onFocus="WdatePicker({maxDate:new Date().toLocaleDateString()})" readonly /> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> <div class="clearfix"></div> </div> <div class="form-group col-md-12 m-b-xs p-r-none"> <button type="button" class="btn btn-default btn-sm m-popover-close pull-right m-b-sm"> <i class="glyphicon glyphicon-remove"></i> </button> <button type="button" class="btn btn-primary btn-sm m-popover-submit pull-right m-b-sm m-r-xs"> <i class="fa fa-check"></i> </button>     </div> </form>');/*v:1*/
template('m_cost/m_fee_confirm',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,confirmDate=$data.confirmDate,$out='';$out+='<form class="form-horizontal m width-200"> <div class="form-group"> <div class="col-sm-9"> <div class="input-group"> <input type="text" class="form-control input-sm" name="confirmDate" placeholder="选择日期" readonly onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" value="';
$out+=$escape(confirmDate);
$out+='"> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().focus();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> </div> <div class="col-sm-3 no-padding"> <button class="btn btn-primary btn-sm">确认</button> </div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_editable/m_editable',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,title=$data.title,$escape=$utils.$escape,contentClass=$data.contentClass,isShowOkBtn=$data.isShowOkBtn,isShowCancelBtn=$data.isShowCancelBtn,editableControlStyle=$data.editableControlStyle,$string=$utils.$string,content=$data.content,btnRight=$data.btnRight,$out='';$out+='<form class="m-editable"> ';
if(title){
$out+=' <h3 class="popover-title">';
$out+=$escape(title);
$out+='</h3> ';
}
$out+=' <div class="m-editable-content ';
$out+=$escape(contentClass);
$out+='"> <div class="m-editable-control pt-relative dp-inline-block ';
$out+=$escape((isShowOkBtn || isShowCancelBtn)?'show-btn':'');
$out+='" style="';
$out+=$escape(editableControlStyle);
$out+='"> ';
$out+=$string(content);
$out+=' </div> ';
if(isShowOkBtn || isShowCancelBtn){
$out+=' <div class="m-editable-buttons ';
$out+=$escape(btnRight?'dp-block text-right':'dp-inline-block');
$out+='"> ';
if(isShowOkBtn){
$out+=' <button type="submit" class="btn btn-primary btn-sm m-editable-submit"> <i class="glyphicon glyphicon-ok"></i> </button> ';
}
$out+=' ';
if(isShowCancelBtn){
$out+=' <button type="button" class="btn btn-default btn-sm m-editable-cancel"> <i class="glyphicon glyphicon-remove"></i> </button> ';
}
$out+=' </div> ';
}
$out+=' </div> </form>';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_address',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<div class="input-group cityBox pull-left m-r-xs" id="selectRegion" name="selectRegion"> <div class="dp-inline-block"> <select class="prov form-control" name="province"></select> </div> <div class="dp-inline-block m-l-xs"> <select class="city form-control" name="city" disabled="disabled" style="display: none;"></select> </div> <div class="dp-inline-block m-l-xs"> <select class="dist form-control" name="county" disabled="disabled" style="display: none;"></select> </div> </div> <input type="text" class="form-control pull-left" style="width: 280px;" name="address" placeholder="请输入地址" maxlength="255" value="';
$out+=$escape(dataInfo.address);
$out+='"> <div class="clearfix"></div> ';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_checkbox',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataInfo=$data.dataInfo,s=$data.s,i=$data.i,$escape=$utils.$escape,key=$data.key,$out='';$each(dataInfo,function(s,i){
$out+=' <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(s.isSelected==1){
$out+=' <input name="';
$out+=$escape(key);
$out+='" type="checkbox" checked value="';
$out+=$escape(s.id);
$out+='"/> ';
}else{
$out+=' <input name="';
$out+=$escape(key);
$out+='" type="checkbox" value="';
$out+=$escape(s.id);
$out+='" /> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(s.name);
$out+='</span> </label> </div> ';
});
$out+=' <script> $(\'.i-checks\').iCheck({ checkboxClass: \'icheckbox_square-green\', radioClass: \'iradio_square-green\' }); </script> ';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_dean_fee',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,value=$data.value,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,placeholder=$data.placeholder,$out='';$out+='<div class="form-group m-b-xs clearfix"> <label class="pull-left control-label p-l-none m-t-xs p-r-none"> ';
if(value.type==1){
$out+=' 合同总额： ';
}else{
$out+=' 收入： ';
}
$out+=' </label> <div class="p-r-none width-300 input-out-box" style="padding-left:15px;padding-top: 5px"> <span>';
$out+=$escape(_expNumberFilter(value.backFee));
$out+='元</span> </div> </div> <div class="form-group m-b-xs clearfix"> <label class="pull-left control-label p-l-none m-t-xs p-r-none">修正金额：</label> <div class="p-r-none width-300 input-out-box" style="padding-left:15px;" > <div class="input-group"> <input type="text" class="form-control full-width" name="fee" placeholder="金额" value="';
$out+=$escape(value.fee);
$out+='"> <span class="m-editable-clear" style="right: 42px;"><i class="fa fa-times-circle"></i></span> <span class="input-group-addon">元</span> </div> </div> </div> <div class="form-group m-b-xs clearfix"> <label class="pull-left control-label p-l-none m-t-xs p-r-none">合同编号：</label> <div class="p-r-none width-300 input-out-box" style="padding-left:15px;" > <div class="input-group"> <input type="text" class="form-control full-width" name="contractNo" style="width: 230px!important;" placeholder="合同编号" value="';
$out+=$escape(value.contractNo);
$out+='"> <span class="m-editable-clear" ><i class="fa fa-times-circle"></i></span> </div> </div> </div> <div class="form-group m-b-xs clearfix"> <label class="pull-left control-label p-l-none m-t-xs p-r-none">修改日期：</label> <div class="p-r-none width-300 input-out-box" style="padding-left:15px;" > <div class="input-group"> <input class="form-control full-width" type="text" name="modifyDate" value="';
$out+=$escape(value.modifyDate);
$out+='" onFocus="WdatePicker({maxDate:new Date().toLocaleDateString(),isShowClear:false})" readonly /> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> <div class="clearfix"></div> </div> <div class="form-group m-b-xs clearfix"> <span style="font-weight: bold">备注：</span> <textarea type="text" class="form-control input-sm p-r-md" style="height: 100px" placeholder="';
$out+=$escape(placeholder);
$out+='" name="remark">';
$out+=$escape(value.remark);
$out+='</textarea> </div> ';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_fee_calculation',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,value=$data.value,$out='';$out+='<div class="form-group m-b-xs clearfix"> <label class="pull-left control-label p-l-none m-t-xs p-r-none">比例：</label> <div class="p-r-none width-225 input-out-box" style="padding-left:15px;"> <div class="input-group"> <input type="text" class="form-control full-width" name="feeProportion" data-action="feeCalculation" placeholder="比例" value="';
$out+=$escape(value.feeProportion);
$out+='"> <span class="m-editable-clear" style="right: 42px;"><i class="fa fa-times-circle"></i></span> <span class="input-group-addon">%</span> </div> </div> </div> <div class="form-group m-b-xs clearfix"> <label class="pull-left control-label p-l-none m-t-xs p-r-none">金额：</label> <div class="p-r-none width-225 input-out-box" style="padding-left:15px;" > <div class="input-group"> <input type="text" class="form-control full-width" name="fee" data-action="feeCalculation" placeholder="金额" value="';
$out+=$escape(value.fee);
$out+='"> <span class="m-editable-clear" style="right: 42px;"><i class="fa fa-times-circle"></i></span> <span class="input-group-addon">元</span> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_input',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,inputGroupClass=$data.inputGroupClass,_isNullOrBlank=$helpers._isNullOrBlank,unit=$data.unit,controlClass=$data.controlClass,placeholder=$data.placeholder,value=$data.value,key=$data.key,$out='';$out+='<div class="';
$out+=$escape(inputGroupClass);
$out+=' ';
$out+=$escape(_isNullOrBlank(inputGroupClass) && !_isNullOrBlank(unit)?'input-group':'');
$out+='"> <input type="text" class="form-control ';
$out+=$escape(controlClass);
$out+=' p-r-md" placeholder="';
$out+=$escape(placeholder);
$out+='" value="';
$out+=$escape(value);
$out+='" name="';
$out+=$escape(key);
$out+='"> ';
if(unit){
$out+=' <span class="m-editable-clear" style="right: 42px;"><i class="fa fa-times-circle"></i></span> <span class="input-group-addon">';
$out+=$escape(unit);
$out+='</span> ';
}else{
$out+=' <span class="m-editable-clear"><i class="fa fa-times-circle"></i></span> ';
}
$out+=' </div> ';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_partyA',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,controlClass=$data.controlClass,key=$data.key,placeholder=$data.placeholder,value=$data.value,dataInfo=$data.dataInfo,$out='';$out+='<input type="text" class="form-control ';
$out+=$escape(controlClass);
$out+='" name="';
$out+=$escape(key);
$out+='" id="';
$out+=$escape(key);
$out+='" placeholder="';
$out+=$escape(placeholder);
$out+='" value="';
$out+=$escape(value);
$out+='" data-id="';
$out+=$escape(dataInfo.enterpriseId);
$out+='" autocomplete=\'off\'> <span class="m-editable-clear" ><i class="fa fa-times-circle"></i></span> <div class="partyA-select-box" style="position: absolute; top: 100%; left: 0px; z-index: 100; right: auto;background: #fff;border: solid 1px #ccc;border-radius: 5px;box-shadow: 1px 1px 6px 0 #9a9a9a;min-width: 100%; display: none;"> </div>';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_payment',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<div class="form-group m-b-xs"> <label class="pull-left control-label m-t-xs m-r-xs">';
$out+=$escape(dataInfo.doType==2?'付款':'到账');
$out+='金额：</label> <div class="p-r-none width-225 input-out-box"> <div class="input-group"> <input placeholder="金额" class="form-control pay-input" type="text" name="fee" > <span class="m-editable-clear" style="right: 56px;"><i class="fa fa-times-circle"></i></span> <span class="input-group-addon">元</span> </div> </div> <div class="clearfix"></div> </div> <div class="form-group m-b-xs"> <label class="pull-left control-label m-t-xs m-r-xs">';
$out+=$escape(dataInfo.doType==2?'付款':'到账');
$out+='日期：</label> <div class="p-r-none width-225 input-out-box"> <div class="input-group"> <input class="form-control pay-input" type="text" name="paidDate" onFocus="WdatePicker({maxDate:new Date().toLocaleDateString(),isShowClear:false})" readonly /> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> <div class="clearfix"></div> </div> ';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_proportion',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,value=$data.value,$out='';$out+='<div class="form-group m-b-xs clearfix"> <div class="p-r-none width-225 input-out-box" style="padding-left:15px;"> <div class="input-group"> <input type="text" class="form-control full-width" name="ratio" data-action="ratio" placeholder="占比" value="';
$out+=$escape(value);
$out+='"> <span class="m-editable-clear" style="right: 42px;"><i class="fa fa-times-circle"></i></span> <span class="input-group-addon">%</span> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_rtf','<div id="remarkEditor"> </div> ');/*v:1*/
template('m_editable/m_editable_select',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,key=$data.key,$each=$utils.$each,dataInfo=$data.dataInfo,s=$data.s,i=$data.i,$out='';$out+='<select class="form-control" name="';
$out+=$escape(key);
$out+='"> ';
$each(dataInfo,function(s,i){
$out+=' ';
if(s.isSelected==1){
$out+=' <option selected value="';
$out+=$escape(s.id);
$out+='">';
$out+=$escape(s.name);
$out+='</option> ';
}else{
$out+=' <option value="';
$out+=$escape(s.id);
$out+='">';
$out+=$escape(s.name);
$out+='</option> ';
}
$out+=' ';
});
$out+=' </select> ';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_select1',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,key=$data.key,value=$data.value,$each=$utils.$each,dataInfo=$data.dataInfo,p=$data.p,$index=$data.$index,$out='';$out+='<div class="input-group"> <input type="text" class="form-control" name="';
$out+=$escape(key);
$out+='" value="';
$out+=$escape(value);
$out+='"> <span class="m-editable-clear" style="right: 40px;"><i class="fa fa-times-circle"></i></span> <div class="input-group-btn"> <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"> <span class="caret"></span> </button> <ul class="dropdown-menu dropdown-menu-right" style="right: 0;left: inherit;"> ';
$each(dataInfo,function(p,$index){
$out+=' <li><a href="javascript:void(0);" data-id="';
$out+=$escape(p.id);
$out+='" data-name="';
$out+=$escape(p.name);
$out+='">';
$out+=$escape(p.name);
$out+='</a></li> ';
});
$out+=' </ul> </div> </div>';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_select2',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,key=$data.key,$out='';$out+='<select class="form-control" name="';
$out+=$escape(key);
$out+='" ></select> ';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_select_users',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,doType=$data.doType,controlClass=$data.controlClass,inputId=$data.inputId,$out='';$out+='<form class="m-editable m-editable-select-users"> <div class="m-editable-content"> <div class="m-editable-control ';
$out+=$escape(doType==1?'pt-relative dp-inline-block':'');
$out+='"> <input class="form-control m-editable-input ';
$out+=$escape(controlClass);
$out+='" name="userChooser" id="';
$out+=$escape(inputId);
$out+='" autocomplete="off" placeholder="请输入关键字并选择人员"/> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_textarea',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,placeholder=$data.placeholder,key=$data.key,value=$data.value,$out='';$out+='<textarea type="text" class="form-control input-sm p-r-md" placeholder="';
$out+=$escape(placeholder);
$out+='" name="';
$out+=$escape(key);
$out+='">';
$out+=$escape(value);
$out+='</textarea> <span class="m-editable-clear textarea-clear"><i class="fa fa-times-circle"></i></span>';
return new String($out);
});/*v:1*/
template('m_editable/m_editable_time',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,placeholder=$data.placeholder,value=$data.value,key=$data.key,$out='';$out+='<div class="input-group"> <input type="text" class="form-control input-sm" placeholder="';
$out+=$escape(placeholder);
$out+='" value="';
$out+=$escape(value);
$out+='" name="';
$out+=$escape(key);
$out+='"> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> ';
return new String($out);
});/*v:1*/
template('m_field/m_field_list_header',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,fieldList=$data.fieldList,f=$data.f,i=$data.i,$escape=$utils.$escape,$out='';$out+='<tr> ';
$each(fieldList,function(f,i){
$out+=' <th class="';
$out+=$escape(f.canBeOrder==1?'sorting':'');
$out+='" data-action="';
$out+=$escape(f.canBeOrder==1?'sort':'');
$out+='" data-code="';
$out+=$escape(f.code);
$out+='" data-type="';
$out+=$escape(f.filterType);
$out+='"> ';
$out+=$escape(f.name);
$out+=' ';
if(f.filterType && f.filterType!=0){
$out+=' <a class="icon-filter pull-right" id="filter_';
$out+=$escape(f.code);
$out+='_';
$out+=$escape(f.id);
$out+='"><i class="icon iconfont icon-shaixuan"></i></a> ';
}
$out+=' </th> ';
});
$out+=' </tr>';
return new String($out);
});/*v:1*/
template('m_field/m_field_list_row',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,trClass=$data.trClass,headerList=$data.headerList,f=$data.f,fi=$data.fi,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,$out='';if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' <tr class="';
$out+=$escape(trClass);
$out+='" data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" businessType = "';
$out+=$escape(d.businessType);
$out+='"> ';
$each(headerList,function(f,fi){
$out+=' <td data-code="';
$out+=$escape(f.code);
$out+='"> ';
if(f.showByATag){
$out+=' <a href="javascript:void(0)" data-action="';
$out+=$escape(f.code);
$out+='">  ';
if(f.type==2){
$out+=' ';
$out+=$escape(_momentFormat(d[f.code],'YYYY/MM/DD'));
$out+=' ';
}else if(f.type==3 || f.type==4){
$out+=' ';
$out+=$escape(_expNumberFilter(d[f.code]));
$out+=' ';
}else{
$out+=' ';
$out+=$escape(d[f.code]);
$out+=' ';
}
$out+=' </a> ';
}else if(!_isNullOrBlank(f.showByButtonTag) && ((!_isNullOrBlank(f.showByButtonTagCode) && d[f.showByButtonTagCode]==0) || _isNullOrBlank(f.showByButtonTagCode))){
$out+=' <button class="btn btn-primary btn-xs" data-action="';
$out+=$escape(f.code);
$out+='_';
$out+=$escape(f.showByButtonTagCode);
$out+='">';
$out+=$escape(f.showByButtonTag);
$out+='</button> ';
}else{
$out+=' <span> ';
if(f.type==2){
$out+=' ';
$out+=$escape(_momentFormat(d[f.code],'YYYY/MM/DD'));
$out+=' ';
}else if(f.type==3 || f.type==4){
$out+=' ';
$out+=$escape(_expNumberFilter(d[f.code]));
$out+=' ';
}else{
$out+=' ';
if(f.code=='projectCreatorName' && d.isOtherCreateProject==1){
$out+=' ';
$out+=$escape(d[f.code]);
$out+='&nbsp;&nbsp;<span class="icon iconfont icon-weibiaoti- fc-dark-blue"></span> ';
}else{
$out+=' ';
$out+=$escape(d[f.code]);
$out+=' ';
}
$out+=' ';
}
$out+=' </span> ';
}
$out+=' </td> ';
});
$out+=' </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="';
$out+=$escape(headerList.length);
$out+='" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_field/m_field_settings',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dialogMinHeight=$data.dialogMinHeight,$each=$utils.$each,optionalTitleGroupList=$data.optionalTitleGroupList,s=$data.s,$index=$data.$index,sub=$data.sub,$out='';$out+='<div class="panel panel-default no-margins no-borders m_field_settings"> <div class="panel-heading no-margins no-padding"> <div class="b-r pull-left left-title" > <h4 class="m-sm m-l">可选字段</h4> </div> <div class="pull-left right-title" > <h4 class="m-sm">当前选定字段<span class="fc-v1-grey fw-normal f-s-xs">(拖拽进行调整顺序)</span></h4> </div> <div class="clearfix"></div> </div> <div class="panel-body no-margins no-padding" style="';
$out+=$escape(dialogMinHeight);
$out+='"> <div class="b-r left-body"> ';
$each(optionalTitleGroupList,function(s,$index){
$out+=' <div class="field-group"> <div class="col-md-12"> <h4> ';
$out+=$escape(s.name);
$out+=' <label class="i-checks i-checks-label fw-normal pull-right"> <input name="itemCk" type="checkbox" value=""/> <span class="i-checks-span">全选</span> </label> </h4> <div class="hr-line-dashed m-t-n-xs m-b-xs"></div> </div> ';
$each(s.optionalTitleList,function(sub,$index){
$out+=' <div class="col-md-4 p-r-none"> <label class="i-checks i-checks-label fw-normal"> ';
if(sub.isSelected==1){
$out+=' ';
if(sub.canBeHide==0){
$out+=' <input name="itemCk" type="checkbox" checked value="';
$out+=$escape(sub.code);
$out+='" disabled=""/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" checked value="';
$out+=$escape(sub.code);
$out+='"/> ';
}
$out+=' ';
}else{
$out+=' <input name="itemCk" type="checkbox" value="';
$out+=$escape(sub.code);
$out+='" /> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(sub.name);
$out+='</span> </label> </div> ';
});
$out+=' <div class="clearfix"></div> </div> ';
});
$out+=' </div> <div class="right-body" > <ul class="list-group" id="selectedFieldBox"> </ul> </div> <div class="clearfix"></div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_field/m_field_settings_selected',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,selectedTitleList=$data.selectedTitleList,p=$data.p,pi=$data.pi,$escape=$utils.$escape,$out='';$each(selectedTitleList,function(p,pi){
$out+=' <li class="list-group-item no-borders" data-sort-id="';
$out+=$escape(pi);
$out+='" data-code="';
$out+=$escape(p.code);
$out+='"> <a href="javascript:void(0);">';
$out+=$escape(p.name);
$out+='</a> ';
if(p.canBeHide!=0){
$out+=' <a class="curp pull-right" href="javascript:void(0)" data-action="delSelectedField" > <i class="fa fa-times fc-red"></i> </a> ';
}
$out+=' <div class="clearfix"></div> </li> ';
});
return new String($out);
});/*v:1*/
template('m_filter/m_filter_address','<div class="data-list-filter p-xs" style="width: 320px;"> <div class="m-b-sm"> <div class="form-group m-b-xs col-md-12 p-r-none p-l-none" style="margin: 0 0 5px 0"> <label for="selectRegion" class="m-l-xs">所在地区</label> <div class="input-group cityBox" id="selectRegion" name="selectRegion"> <div class="dp-inline-block m-l-xs"> <select class="prov form-control" name="province"></select> </div> <div class="dp-inline-block m-l-xs"> <select class="city form-control" name="city" disabled="disabled" ></select> </div> <div class="dp-inline-block m-l-xs"> <select class="dist form-control" name="county" disabled="disabled" ></select> </div> </div> </div> </div> <div class="m-t-xs"> <button type="button" class="btn btn-primary btn-xs rounded pull-right" data-action="confirm">确定</button> <button type="button" class="btn btn-default btn-xs rounded pull-right m-r-xs" data-action="cancel">取消</button> <div class="clearfix"></div> </div> </div> ');/*v:1*/
template('m_filter/m_filter_checkbox',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,checkList=$data.checkList,d=$data.d,$index=$data.$index,currCheckedVal=$data.currCheckedVal,$escape=$utils.$escape,$out='';$out+='<div class="data-list-filter p-sm" > <div class="m-b-sm" style="border-bottom: solid 1px #f2f2f2;"> <label class="i-checks fw-normal"> <input name="ipt_allCheck" type="checkbox" value="0"/> <span class="i-checks-span">全选</span> </label> </div> <div> ';
$each(checkList,function(d,$index){
$out+=' <div class="col-md-4 p-r-none p-l-none"> <label class="i-checks fw-normal"> ';
if(currCheckedVal.indexOf(d.id)>-1){
$out+=' <input name="ipt_check" type="checkbox" checked value="';
$out+=$escape(d.id);
$out+='"/> ';
}else{
$out+=' <input name="ipt_check" type="checkbox" value="';
$out+=$escape(d.id);
$out+='"/> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(d.name);
$out+='</span> </label> </div> ';
});
$out+=' <div class="clearfix"></div> </div> <div class="m-t-xs"> <button type="button" class="btn btn-primary btn-xs rounded pull-right" data-action="confirm">确定</button> <button type="button" class="btn btn-default btn-xs rounded pull-right m-r-xs" data-action="cancel">取消</button> <div class="clearfix"></div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_filter/m_filter_checkbox_select',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,boxStyle=$data.boxStyle,$each=$utils.$each,selectList=$data.selectList,s=$data.s,$index=$data.$index,isParentCheck=$data.isParentCheck,sub=$data.sub,colClass=$data.colClass,$out='';$out+='<div class="data-list-filter m-filter-checkbox-select" style="';
$out+=$escape(boxStyle);
$out+='"> <div class="m-b-sm check-box-title" > <label class="i-checks fw-normal"> <input name="itemCk" type="checkbox" value=""/> <span class="i-checks-span">全选</span> </label> </div> <div class="p-w-sm"> ';
$each(selectList,function(s,$index){
$out+=' ';
if(s.childList!=null && s.childList.length>0){
$out+=' <div class="check-row"> <div class="col-md-12 p-r-none p-l-none"> ';
if(isParentCheck){
$out+=' <label class="i-checks i-checks-label fw-normal"> ';
if(s.isSelected){
$out+=' <input name="itemCk" type="checkbox" checked value="';
$out+=$escape(s.id);
$out+='" data-type="1"/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" value="';
$out+=$escape(s.id);
$out+='" data-type="1"/> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(s.name);
$out+='</span> </label> ';
}else{
$out+=' <label>';
$out+=$escape(s.name);
$out+='</label> ';
}
$out+=' </div> <div class="p-l-md"> ';
$each(s.childList,function(sub,$index){
$out+=' <div class="';
$out+=$escape(colClass?colClass:'check-item');
$out+=' p-r-none p-l-none"> <label class="i-checks i-checks-label fw-normal"> ';
if(sub.isSelected){
$out+=' <input name="itemCk" type="checkbox" checked value="';
$out+=$escape(sub.id);
$out+='"/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" value="';
$out+=$escape(sub.id);
$out+='" /> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(sub.name);
$out+='</span> </label> </div> ';
});
$out+=' </div> </div> ';
}else{
$out+=' <div class="check-row ';
$out+=$escape(colClass?colClass:'check-item');
$out+=' p-r-none p-l-none"> <label class="i-checks i-checks-label fw-normal"> ';
if(s.isSelected){
$out+=' <input name="itemCk" type="checkbox" checked value="';
$out+=$escape(s.id);
$out+='" data-type="1"/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" value="';
$out+=$escape(s.id);
$out+='" data-type="1"/> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(s.name);
$out+='</span> </label> </div> ';
}
$out+=' ';
});
$out+=' <div class="clearfix"></div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_filter/m_filter_input',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,placeholder=$data.placeholder,inputValue=$data.inputValue,isClear=$data.isClear,$out='';$out+='<div class="data-list-filter p-xs"> <div> <div class="form-group"> <input type="text" class="form-control input-sm p-r-md" name="txtVal" placeholder="';
$out+=$escape(placeholder?placeholder:'请输入关键字');
$out+='" value="';
$out+=$escape(inputValue);
$out+='" autocomplete=\'off\'> <span class="edit-clear"><i class="fa fa-times-circle"></i></span> </div> <div class="m-t-xs"> <button type="button" class="btn btn-primary btn-xs rounded pull-right" data-action="sureFilter">确定</button> ';
if(isClear){
$out+=' <button type="button" class="btn btn-default btn-xs rounded pull-right m-r-xs" data-action="clearInput">清空</button> ';
}
$out+=' <div class="clearfix"></div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_filter/m_filter_result_show',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,i=$data.i,$escape=$utils.$escape,$out='';$each(dataList,function(p,i){
$out+=' <span class="filter-result"> <span class="label "> <span class="filter-result-name">';
$out+=$escape(p.name);
$out+='</span> ';
if(p.isDelete!=0){
$out+=' <a class="curp" href="javascript:void(0)" data-action="delSelectedFilter" data-type="';
$out+=$escape(p.type);
$out+='"> <i class="fa fa-times fc-red"></i> </a> ';
}
$out+=' </span> ';
if(i < dataList.length-1 ){
$out+=' &nbsp;<span class="fa fa-angle-right p-w-xxs"></span> ';
}
$out+=' </span> ';
});
return new String($out);
});/*v:1*/
template('m_filter/m_filter_select',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,outClass=$data.outClass,$each=$utils.$each,selectList=$data.selectList,s=$data.s,$index=$data.$index,isMultiple=$data.isMultiple,$out='';$out+='<div class="data-list-filter ';
$out+=$escape(outClass);
$out+='"> <ul class="dropdown-menu"> ';
$each(selectList,function(s,$index){
$out+=' <li> <a class="no-margins p-r-xs" data-state-no="';
$out+=$escape(s.id);
$out+='"> ';
if(isMultiple){
$out+=' <label class="i-checks fw-normal"> ';
if(s.isSelected){
$out+=' <input name="itemCk" type="checkbox" checked value="';
$out+=$escape(s.id);
$out+='"/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" value="';
$out+=$escape(s.id);
$out+='" /> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(s.name);
$out+='</span> </label> ';
}else{
$out+=' <span class="check"> ';
if(s.isSelected){
$out+=' <i class="fa fa-check"></i> ';
}
$out+=' </span> <span class="dp-inline-block p-r-sm">';
$out+=$escape(s.name);
$out+='</span> ';
}
$out+=' </a> </li> ';
});
$out+=' </ul> <div class="clearfix"></div> </div>';
return new String($out);
});/*v:1*/
template('m_filter/m_filter_select_new',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$string=$utils.$string,label=$data.label,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,$out='';$out+='<div class="z-index-1 m-b-none"> <label class="inline v-middle m-b-none">';
$out+=$string(label);
$out+='：</label> ';
$each(dataList,function(p,$index){
$out+=' <a class="btn btn-link" data-id="';
$out+=$escape(p.id);
$out+='" data-action="selection">';
$out+=$escape(p.name);
$out+='</a> ';
});
$out+=' </div>';
return new String($out);
});/*v:1*/
template('m_filter/m_filter_time',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,timeData=$data.timeData,isEndTime=$data.isEndTime,$out='';$out+='<div class="data-list-filter p-xs width-225" > <div> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control input-sm" id="ipt_startTime" name="startTime" placeholder="开始时间" readonly onFocus="WdatePicker({maxDate:\'#F{$dp.$D(\\\'ipt_endTime\\\')}\'})" value="';
$out+=$escape(timeData.startTime);
$out+='"> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().focus();"> <i class="icon-sm icon-append fa fa-calendar" style="height: 28px;line-height: 28px;"></i> </span> </div> </div> ';
if(isEndTime){
$out+=' <div class="form-group m-t-xs"> <div class="input-group "> <input type="text" class="form-control input-sm" id="ipt_endTime" name="endTime" placeholder="结束时间" readonly onFocus="WdatePicker({minDate:\'#F{$dp.$D(\\\'ipt_startTime\\\')}\'})" value="';
$out+=$escape(timeData.endTime);
$out+='"> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().focus();"> <i class="icon-sm icon-append fa fa-calendar" style="height: 28px;line-height: 28px;"></i> </span> </div> </div> ';
}
$out+=' <div class="m-t-xs"> <button type="button" class="btn btn-primary btn-xs rounded pull-right" data-action="sureTimeFilter">确定</button> <button type="button" class="btn btn-default btn-xs rounded pull-right m-r-xs" data-action="clearTimeInput">清空</button> <div class="clearfix"></div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_filter/m_filter_timeCombination','<div class="m_filter_timeCombination"> <div class="form-group"> <label class="m-t-xs">时间：</label> <div class="pull-right m-l-xs"> <input type="text" class="form-control input-sm width-100" name="ipt_year" onclick="" placeholder="请选择年份" readonly/> <select class="form-control input-sm width-100 no-padding" name="ipt_month"> </select> </div> <div class="btn-group pull-right"> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-days="30">一个月</a> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-days="90">一季度</a> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-days="180">半年</a> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-days="360">一年</a> </div> <div class="clearfix"></div> </div> <div class="form-group"> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm time-input" id="ipt_startTime" name="startTime" placeholder="开始日期" readonly="" value=""> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm time-input" id="ipt_endTime" name="endTime" placeholder="结束日期" readonly="" value=""> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> </div> </div>');/*v:1*/
template('m_filter/m_filter_timeGroup','<div class="m_filter_timeCombination"> <div class="form-group"> <div class="form-group"> <label class="m-t-xs">时间：</label> <div class="btn-group pull-right"> <a class="btn btn-primary btn-sm m-r-none " href="javascript:void(0)" data-action="setTime" data-type="day">日</a> <a class="btn btn-default btn-sm m-r-none " href="javascript:void(0)" data-action="setTime" data-type="month">月</a> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-type="year">年</a> </div> </div> <div class="clearfix"></div> </div> <div class="form-group"> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm time-input" id="ipt_startTime" name="startTime" placeholder="开始日期" readonly="" value=""> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm time-input" id="ipt_endTime" name="endTime" placeholder="结束日期" readonly="" value=""> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> </div> </div>');/*v:1*/
template('m_filter/m_filter_time_new',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,label=$data.label,$string=$utils.$string,type=$data.type,$each=$utils.$each,yearList=$data.yearList,y=$data.y,$index=$data.$index,$escape=$utils.$escape,$out='';$out+='<div class="data-list-filter" > ';
if(label){
$out+=' <label class="dp-inline-block-1 v-middle m-b-none">';
$out+=$string(label);
$out+='：</label> ';
}
$out+=' ';
if(type==1){
$out+=' <a class="btn btn-link dp-inline-block-1" data-click-action="setTime" data-days="30">一个月</a> <a class="btn btn-link dp-inline-block-1" data-click-action="setTime" data-days="90">三个月</a> <a class="btn btn-link dp-inline-block-1" data-click-action="setTime" data-days="180">六个月</a> ';
}
$out+=' ';
$each(yearList,function(y,$index){
$out+=' <a class="btn btn-link dp-inline-block-1" data-click-action="setTime" data-days="';
$out+=$escape(y);
$out+='">';
$out+=$escape(y);
$out+='年</a> ';
});
$out+=' <div class="input-group inline v-middle ';
$out+=$escape(type==1||type==3?'':'hide');
$out+='" style="width: 129px;"> <input type="text" class="form-control input-sm" id="ipt_startTime" name="startTime" placeholder="';
$out+=$escape(type==3?'开始月份':'开始时间');
$out+='" readonly value="" style="width: 90px;padding: 6px;"> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar" style="height: 28px;line-height: 28px;"></i> </span> </div> <span class="glyphicon glyphicon-minus fc-v1-grey inline v-middle ';
$out+=$escape(type==1||type==3?'':'hide');
$out+='"></span> <div class="input-group inline v-middle ';
$out+=$escape(type==1||type==3?'':'hide');
$out+='" style="width: 129px;"> <input type="text" class="form-control input-sm" id="ipt_endTime" name="endTime" placeholder="';
$out+=$escape(type==3?'结束月份':'结束时间');
$out+='" readonly value="" style="width: 90px;padding: 6px;"> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar" style="height: 28px;line-height: 28px;"></i> </span> </div> <div class="input-group inline v-middle ';
$out+=$escape(type==2?'':'hide');
$out+='" style="width: 129px;"> <input type="text" class="form-control input-sm" id="ipt_year" name="yearTime" placeholder="年份" value="" style="width: 90px;padding: 6px;"> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar" style="height: 28px;line-height: 28px;"></i> </span> </div> </div>';
return new String($out);
});/*v:1*/
template('m_filter/m_filter_time_quick','<div class="m-filter-time-quick"> <div class="form-group"> <label class="m-t-xs">最近时间：</label> <div class="btn-group pull-right"> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-days="7">7天</a> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-days="30">30天</a> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-days="90">三个月</a> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-days="180">半年</a> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-days="360">一年</a> </div> <div class="clearfix"></div> </div> <div class="form-group"> <label class="m-t-xs">自定义时间：</label> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm time-input" id="ipt_startTime" name="startTime" placeholder="开始日期" readonly="" value=""> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"><i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm time-input" id="ipt_endTime" name="endTime" placeholder="结束日期" readonly="" value=""> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> </div> </div>');/*v:1*/
template('m_finance/m_costSharing_settings','<div class="m_costSharing_settings" > <div class="col-24-sm-8 col-24-md-8 col-24-lg-6 no-padding" id="left-box" style="border-right: solid 1px #ccc;"> <div class="clearfix margin-bottom-10"></div> <div id="organization_treeH"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </div> <div class="col-24-sm-16 col-24-md-16 col-24-lg-18 no-padding " id="right-box"> </div> </div> ');/*v:1*/
template('m_finance/m_costSharing_settings_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,feeEntryFieldList=$data.feeEntryFieldList,f=$data.f,i=$data.i,$escape=$utils.$escape,c=$data.c,ci=$data.ci,$out='';$out+='<div class="m_feeEntry_settings" > <table class="table table-bordered table-responsive"> <thead> <tr> <th width="35%">收支分类</th> <th width="45%">收支分类细类</th> <th width="20%">数据来源</th> </tr> </thead> <tbody> ';
$each(feeEntryFieldList,function(f,i){
$out+=' <tr> <td rowspan="';
$out+=$escape(f.childList!=null && f.childList.length>0 ?f.childList.length+1:'');
$out+='" class="gray-bg v-middle"> <div> <label class="i-checks i-checks-label pull-left"> <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(f.code);
$out+='" data-pid="';
$out+=$escape(f.pid);
$out+='" data-id="';
$out+=$escape(f.id);
$out+='"/> <span class="i-checks-span">';
$out+=$escape(f.name);
$out+='</span> </label> </div> </td> <td> ';
if(f.childList!=null && f.childList.length>0){
$out+=' <div> <label class="i-checks i-checks-label pull-left"> ';
if(f.childList[0].showStatus == 1){
$out+=' ';
if(f.childList[0].categoryType == 0){
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(f.childList[0].code);
$out+='" data-pid="';
$out+=$escape(f.childList[0].pid);
$out+='" data-id="';
$out+=$escape(f.childList[0].id);
$out+='" checked disabled/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(f.childList[0].code);
$out+='" data-pid="';
$out+=$escape(f.childList[0].pid);
$out+='" data-id="';
$out+=$escape(f.childList[0].id);
$out+='" checked/> ';
}
$out+=' ';
}else{
$out+=' ';
if(f.childList[0].categoryType == 0){
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(f.childList[0].code);
$out+='" data-pid="';
$out+=$escape(f.childList[0].pid);
$out+='" data-id="';
$out+=$escape(f.childList[0].id);
$out+='" disabled/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(f.childList[0].code);
$out+='" data-pid="';
$out+=$escape(f.childList[0].pid);
$out+='" data-id="';
$out+=$escape(f.childList[0].id);
$out+='"/> ';
}
$out+=' ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(f.childList[0].name);
$out+='</span> </label> </div> ';
}else{
$out+=' <button class="btn btn-link btn-add" data-action="addFeeField" title="添加设计任务" data-id="';
$out+=$escape(f.id);
$out+='"><i class="fa fa-plus"></i></button> ';
}
$out+=' </td> <td> ';
if(f.childList!=null && f.childList.length>0 && (f.childList[0].categoryType==2 || f.childList[0].categoryType==3)){
$out+=' 人工输入 ';
}
$out+=' </td> </tr> ';
if(f.childList!=null && f.childList.length>0){
$out+=' ';
$each(f.childList,function(c,ci){
$out+=' ';
if(ci>0){
$out+=' <tr class=""> <td> <div> <label class="i-checks i-checks-label pull-left"> ';
if(c.showStatus==1){
$out+=' ';
if(c.categoryType==0){
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(c.code);
$out+='" data-pid="';
$out+=$escape(c.pid);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='" checked disabled/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(c.code);
$out+='" data-pid="';
$out+=$escape(c.pid);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='" checked/> ';
}
$out+=' ';
}else{
$out+=' ';
if(c.categoryType==0){
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(c.code);
$out+='" data-pid="';
$out+=$escape(c.pid);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='" disabled/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(c.code);
$out+='" data-pid="';
$out+=$escape(c.pid);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='"/> ';
}
$out+=' ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(c.name);
$out+='</span> </label> </div> </td> <td> ';
if(c.categoryType==2 || c.categoryType==3){
$out+=' 人工输入 ';
}
$out+=' </td> </tr> ';
}
$out+=' ';
});
$out+=' <tr> <td > <button class="btn btn-link btn-add" data-action="addFeeField" title="添加设计任务" data-id="';
$out+=$escape(f.id);
$out+='"><i class="fa fa-plus"></i></button> </td> <td></td> </tr> ';
}
$out+=' ';
});
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_finance/m_expTypeSetting',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,expTypeList=$data.expTypeList,mainE=$data.mainE,i=$data.i,$escape=$utils.$escape,ch=$data.ch,j=$data.j,$out='';$out+='<div class="ibox ibox_min_height">  <div class="ibox-content no-padding"> <form id="expTypeSetting"> <fieldset id="expTypeMainContent"> <section class="categoryListOBox"> ';
$each(expTypeList,function(mainE,i){
$out+=' <div class="col-md-12" style="padding:10px 0 10px;"> <div class="row"> <div class="col-24-md-offset-1 col-24-md-22"> <div class="headline"><h2>';
$out+=$escape(mainE.parent.name);
$out+='</h2></div> </div> </div> <div class="row"> <div class="col-24-md-offset-4 col-24-md-16 "> <div class="row"> ';
$each(mainE.child,function(ch,j){
$out+=' <div class="col-md-12 "> <div class="row margin-bottom-10"> <div class="col-md-2"> <strong>';
$out+=$escape(ch.name);
$out+='</strong> </div> <div class="col-md-10"> ';
$out+=$escape(ch.expTypeMemo);
$out+=' </div> </div> </div> ';
});
$out+=' <div class="col-md-12 "> <div class="row"> <div class="col-md-3" style="padding: 8px 13px;"> <a href="javascript:void(0)" class="editExpButton roleControl" roleCode="sys_finance_type" flag="2" parent_name="';
$out+=$escape(mainE.parent.name);
$out+='" data-action="editButton';
$out+=$escape(i);
$out+='" style="color:#337b8e">修改';
$out+=$escape(mainE.parent.name);
$out+='>></a> </div> </div> </div> </div> </div> </div> </div> ';
});
$out+=' </section> </fieldset> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_finance/m_expTypeSetting_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,expTypeData=$data.expTypeData,$each=$utils.$each,value=$data.value,i=$data.i,$out='';$out+='<section class="categorySettingOBox"> <div class="col-md-12 margin-bottom-10" style="padding:10px 0 10px;"> <div class="row"> <div class="col-24-md-offset-1 col-24-md-22"> <div class="headline"><h2>';
$out+=$escape(expTypeData.parent.name);
$out+='</h2></div> </div> </div> <div class="row"> <div class="col-24-md-offset-1 col-24-md-22"> <table class="table"> <thead> <tr> <th width="20%">类别名称</th> <th width="70%">类别描述</th> <th width="10%">操作</th> </tr> </thead> <tbody> ';
$each(expTypeData.child,function(value,i){
$out+=' <tr class="categoryInput out-box" id="';
$out+=$escape(value.id);
$out+='"> <td> <input class="form-control" type="text" id="categoryName" name="categoryName" value="';
$out+=$escape(value.name);
$out+='"/> </td> <td> <input class="form-control" type="text" id="categoryMemo" name="categoryMemo" value="';
$out+=$escape(value.expTypeMemo);
$out+='" /> </td> <td> <div class="btn_del" style="padding-top: 5px;"> ';
if(!(expTypeData.parent.name=='其他费用' && i==0)){
$out+=' <a class="btn-u btn-u-sm btn-u-red rounded" data-action="categoryDelete" href="javascript:void(0);"><i class="fa fa-close"></i> </a> ';
}
$out+=' </div> </td> </tr> ';
});
$out+=' <tr class="addList"> <td align="center" colspan="3"> <div class="call-action-v1 call-action-v1-boxed rounded tag-box-v4 curp" data-action="addList" > <div class="call-action-v1-box margin-bottom-10 margin-top-10"> <div class="call-action-v1-in text-center color-dark-blue"> <a href="javascript:void(0);" style="cursor: pointer;"><i class="fa fa-plus fa-2x"></i></a> </div> </div> </div> </td> </tr> </tbody> </table> </div> </div>         </div> </section> <div class="footTools"> <div class="col-24-md-offset-1 col-24-md-22 text-right"> <a class="btn btn-default rounded" data-action="cancelEditType">返回</a> <a class="btn btn-primary rounded" data-action="saveEditType">保存</a> </div> </div>';
return new String($out);
});/*v:1*/
template('m_finance/m_feeEntry','<div class="m_feeEntry no-margin"> <div class="no-margin p-sm breadcrumb-box"> <form class="form-inline"> <div class="form-group z-index-1"> <label>当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> </form> </div> <div class="col-sm-4 col-xl-3 no-padding border-right" id="left-out-box"> <div id="left-box"> </div> </div> <div class="col-sm-8 col-xl-9 no-padding " id="right-box"> </div> </div>');/*v:1*/
template('m_finance/m_feeEntry_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,expFixedData=$data.expFixedData,_expNumberFilter=$helpers._expNumberFilter,$each=$utils.$each,p=$data.p,pi=$data.pi,s=$data.s,si=$data.si,managerCompanyIds=$data.managerCompanyIds,selectedOrg=$data.selectedOrg,$out='';$out+='<div class="text-center border-bottom date-chose-box"> <span class="f-s-xl pull-left m-l-md">';
$out+=$escape(_momentFormat(expFixedData.expDate,'YYYY年MM月'));
$out+='</span> <span class="pull-right m-r-md">支出：<span class="f-s-xl">';
$out+=$escape(_expNumberFilter(expFixedData.expAmount));
$out+='</span> 元</span> <span class="pull-right m-r-md">收入：<span class="f-s-xl">';
$out+=$escape(_expNumberFilter(expFixedData.incomeAmount));
$out+='</span> 元</span> <div class="clearfix"></div> </div> <div class="p-m"> <form id="expFixedForm"> <table class="table table-bordered table-responsive"> <thead> <tr> <th colspan="2">类别名称</th> <th>金额（元）</th> </tr> </thead> <tbody> ';
if(expFixedData.fixedList!=null && expFixedData.fixedList.length>0){
$out+=' ';
$each(expFixedData.fixedList,function(p,pi){
$out+=' ';
if(p.detailList!=null && p.detailList.length>0){
$out+=' ';
$each(p.detailList,function(s,si){
$out+=' <tr> ';
if(si==0){
$out+=' <td rowspan="';
$out+=$escape(p.detailList.length);
$out+='" class="v-middle">';
$out+=$escape(p.expTypeName);
$out+='</td> ';
}
$out+=' <td class="v-middle">';
$out+=$escape(s.expTypeName);
$out+='</td> ';
if(managerCompanyIds && managerCompanyIds.indexOf(selectedOrg.id)>-1){
$out+=' <td class="v-middle"> <input class="form-control input-sm" type="text" name="expAmount" maxlength="50" value="';
$out+=$escape(s.expAmount);
$out+='" id="';
$out+=$escape(s.id);
$out+='" data-exptype="';
$out+=$escape(s.expType);
$out+='" data-parent-name="';
$out+=$escape(p.expTypeName);
$out+='" data-name="';
$out+=$escape(s.expTypeName);
$out+='" data-seq="';
$out+=$escape(s.seq);
$out+='"> </td> ';
}else{
$out+=' <td> <span>';
$out+=$escape(_expNumberFilter(s.expAmount));
$out+='</span> </td> ';
}
$out+=' </tr> ';
});
$out+=' ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </tbody> </table> </form> <div class="text-right"> ';
if(managerCompanyIds && managerCompanyIds.indexOf(selectedOrg.id)>-1){
$out+=' <a class="btn btn-primary roleControl" roleCode="40001001" flag="2" data-action="saveExpFixed">保存</a> ';
}
$out+=' </div> </div>';
return new String($out);
});/*v:1*/
template('m_finance/m_feeEntry_monthList',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,selectedYear=$data.selectedYear,currentYear=$data.currentYear,$each=$utils.$each,monthList=$data.monthList,m=$data.m,mi=$data.mi,currentExpDate=$data.currentExpDate,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,$out='';$out+='<div class="text-center f-s-xl border-bottom date-chose-box"> <a class="m-r-md" data-action="prevYear"><i class="fa fa-angle-left"></i></a> <span data-type="selectedYear">';
$out+=$escape(selectedYear);
$out+='</span> ';
if(selectedYear<currentYear){
$out+=' <a class="m-l-md" data-action="nextYear"><i class="fa fa-angle-right"></i></a> ';
}else{
$out+=' <span class="m-l-md fc-v1-grey"><i class="fa fa-angle-right"></i></span> ';
}
$out+=' </div> ';
$each(monthList,function(m,mi){
$out+=' <div class="month-menu-box of-hidden curp ';
$out+=$escape(currentExpDate==null?(mi==0?'active':''):(currentExpDate==m.expDate?'active':''));
$out+='" data-action="getExpFixed" data-expdate="';
$out+=$escape(m.expDate);
$out+='"> <div class="col-xs-5 month p-r-none"> ';
$out+=$escape(_momentFormat(m.expDate,'MM月'));
$out+=' <div class="user-name"> 财务人员： ';
if(m.userName!=null && m.userName!=''){
$out+=' ';
$out+=$escape(m.userName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </div> </div> <div class="col-xs-7 detail text-right p-l-none"> <div class="income m-b"> 收入：<span class="span-money" title="';
$out+=$escape(_expNumberFilter(m.incomeAmount));
$out+='">';
$out+=$escape(_expNumberFilter(m.incomeAmount));
$out+='</span> 元 </div> <div class="expenditure"> 支出：<span class="span-money" title="';
$out+=$escape(_expNumberFilter(m.expAmount));
$out+='">';
$out+=$escape(_expNumberFilter(m.expAmount));
$out+='</span> 元 </div> </div> </div> ';
});
$out+=' ';
return new String($out);
});/*v:1*/
template('m_finance/m_feeEntry_settings','<div class="m_feeEntry_settings" >                <div id="right-box"> </div> </div> ');/*v:1*/
template('m_finance/m_feeEntry_settings_add','<style> body>span.select2-container{ z-index: 1125 !important; } </style> <form class="addFeeFieldForm form-horizontal m"> <div class="form-group"> <label class="col-md-3 p-r-none m-t-xs">类型名称：</label> <div class="col-md-9"> <input class="form-control input-sm" type="text" name="feeField" placeholder="请输入类型名称"/> </div> </div>  </form>');/*v:1*/
template('m_finance/m_feeEntry_settings_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,feeEntryFieldList=$data.feeEntryFieldList,f=$data.f,i=$data.i,isEdit=$data.isEdit,$escape=$utils.$escape,c=$data.c,ci=$data.ci,$out='';$out+='<div class="m_feeEntry_settings" > <table class="table table-bordered table-responsive"> <thead> <tr> <th width="20%">收支分类</th> <th width="70%" class="no-padding"> <div class="row no-margin"> <div class="col-sm-6 p-xs border-right">收支分类子项</div> <div class="col-sm-6 p-xs">数据来源</div> </div> </th> </tr> </thead> <tbody> ';
$each(feeEntryFieldList,function(f,i){
$out+=' <tr> <td class="gray-bg v-middle"> <div class="dp-inline-block"> <label class="i-checks i-checks-label m-b-none"> ';
if(isEdit==1){
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(f.code);
$out+='" data-pid="';
$out+=$escape(f.pid);
$out+='" data-id="';
$out+=$escape(f.id);
$out+='"/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(f.code);
$out+='" data-pid="';
$out+=$escape(f.pid);
$out+='" data-id="';
$out+=$escape(f.id);
$out+='" disabled/> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(f.name);
$out+='</span> </label> </div> </td> <td class="no-padding l-h-14"> <div class="item-box"> ';
$each(f.childList,function(c,ci){
$out+=' <div class="row no-margin ';
$out+=$escape(ci==f.childList.length-1 && isEdit!=1?'':'border-bottom');
$out+='"> <div class="col-sm-6 p-xs border-right"> <div class="dp-inline-block"> <label class="i-checks i-checks-label m-b-none"> ';
if(c.showStatus==1){
$out+=' ';
if(c.disabled==true || isEdit==0){
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(c.code);
$out+='" data-pid="';
$out+=$escape(c.pid);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='" checked disabled/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(c.code);
$out+='" data-pid="';
$out+=$escape(c.pid);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='" checked/> ';
}
$out+=' ';
}else{
$out+=' ';
if(c.disabled==true || isEdit==0){
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(c.code);
$out+='" data-pid="';
$out+=$escape(c.pid);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='" disabled/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" data-code="';
$out+=$escape(c.code);
$out+='" data-pid="';
$out+=$escape(c.pid);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='"/> ';
}
$out+=' ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(c.name);
$out+='</span> </label> </div> ';
if(c.isDefaulted !=1 && isEdit==1){
$out+=' <a href="javascript:void(0);" data-action="editName" data-id="';
$out+=$escape(c.id);
$out+='" data-pid="';
$out+=$escape(f.id);
$out+='" data-name="';
$out+=$escape(c.name);
$out+='" data-category-type="';
$out+=$escape(c.categoryType);
$out+='" style="display: none;"> <i class="ic-edit"></i> </a> <a href="javascript:void(0);" data-action="delFeeField" data-id="';
$out+=$escape(c.id);
$out+='" style="display: none;"> <i class="glyphicon glyphicon-remove text-danger"></i> </a> ';
}
$out+=' <div class="clearfix"></div> </div> <div class="col-sm-6 p-xs"> ';
$out+=$escape(c.dataSource);
$out+=' </div> </div> ';
});
$out+=' </div> ';
if(isEdit==1){
$out+=' <div class="row no-margin"> <div class="col-sm-12 p-xs"> <a class="btn btn-link btn-add" data-action="addFeeField" title="添加设计任务" data-id="';
$out+=$escape(f.id);
$out+='"><i class="fa fa-plus"></i></a> <a href="javascript:void(0);" class="absolute-top-right" data-action="expand" style="right: 8px;top: 5px;" title="展示或收起分类子项"> <i class="fa fa-angle-double-up text-bold f-s-lg"></i> </a> </div> </div> ';
}
$out+=' </td> </tr> ';
});
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_finance/m_finance_basic_settings',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,companyDataList=$data.companyDataList,c=$data.c,i=$data.i,$escape=$utils.$escape,isEdit=$data.isEdit,_expNumberDecimalFilter=$helpers._expNumberDecimalFilter,_momentFormat=$helpers._momentFormat,$out='';$out+='<div class="m_finance_basic_settings" > <div class="fc-black font-bold"> <p>说明：</p> <P>1、余额初始值：设置日期：年、月由用户确定，日期由系统默认为用户确定月份的最后一天。</P> <p>2、余额初始日期：对应于设定日期各团队的账面资金。设置日期之后相应的各项财务数据将在此基础上产生，避免由于录入历史财务数据的不完整带来的各项财务数据的不准确。</p> <p>3、最低余额：确保各团队正常运作的最低余额（账面可流动资金），根据企业的实际需求可设置可不设置。</p> </div> <table class="table table-bordered table-responsive"> <thead> <tr> <th width="17%">组织名称</th> <th width="14%">录入余额初始值（元）</th> <th width="14%">录入余额初始日期</th> <th width="13%">设置最低余额（元）</th> <th width="10%">当前余额（元）</th>  <th width="10%">上月费用录入（元）</th> <th width="12%">当前余额变更</th> </tr> </thead> <tbody> ';
$each(companyDataList,function(c,i){
$out+=' <tr data-i="';
$out+=$escape(i);
$out+='" data-company-id="';
$out+=$escape(c.companyId);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='"> <td class="fc-black font-bold"> ';
$out+=$escape(c.companyName);
$out+=' </td> <td> <a href="javascript:void(0);" class="editable-click ';
$out+=$escape(isEdit==1?'':'normal');
$out+='" data-action="initialBalance" data-value="';
$out+=$escape(c.initialBalance);
$out+='" data-key="initialBalance" data-type="1" data-valid="6" > ';
if(c.initialBalance==null||c.initialBalance==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_expNumberDecimalFilter(c.initialBalance));
$out+=' ';
}
$out+=' </a> </td> <td> <a href="javascript:void(0);" data-action="editDate" data-action-type="';
$out+=$escape(i);
$out+='" class="editable-click ';
$out+=$escape(isEdit==1?'':'normal');
$out+='" data-value="';
$out+=$escape(c.setBalanceDate);
$out+='"> ';
if(c.setBalanceDate==null||c.setBalanceDate==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(c.setBalanceDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </a> </td> <td> <a href="javascript:void(0);" class="editable-click ';
$out+=$escape(isEdit==1?'':'normal');
$out+='" data-action="lowBalance" data-value="';
$out+=$escape(c.lowBalance);
$out+='" data-key="lowBalance" data-type="1" data-valid="6" > ';
if(c.lowBalance==null||c.lowBalance==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_expNumberDecimalFilter(c.lowBalance));
$out+=' ';
}
$out+=' </a> </td> <td>';
$out+=$escape(_expNumberDecimalFilter(c.currentBalance));
$out+='</td> <!--<td>';
$out+=$escape(_expNumberDecimalFilter(c.currentIncome));
$out+='</td>--> <td>';
$out+=$escape(_expNumberDecimalFilter(c.lastMonthFixFee));
$out+='</td> <td> ';
if(isEdit==1){
$out+=' <button class="btn btn-primary btn-xs" data-action="balanceChange" >余额变更</button> ';
}
$out+=' <button class="btn btn-primary btn-xs" data-action="changeRecord">变更记录</button> </td> </tr> ';
});
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_finance/m_finance_basic_settings_change','<form class="form-horizontal m"> <div class="form-group"> <label class="col-24-sm-5 control-label">变更类型<span class="fc-red">*</span>：</label> <div class="col-24-sm-18"> <select class="form-control full-width" name="changeType" > <option value="">请选择变更类型</option> <option value="1">增加余额值</option> <option value="2">减少余额值</option> </select> </div> </div> <div class="form-group"> <label class="col-24-sm-5 control-label">变更余额(元)<span class="fc-red">*</span>：</label> <div class="col-24-sm-18"> <input placeholder="请输入变更余额" class="form-control" type="text" name="changeAmount" /> </div> </div> <div class="form-group"> <label class="col-24-sm-5 control-label">变更原因：</label> <div class="col-24-sm-18"> <textarea placeholder="请输入变更原因" class="form-control" type="text" name="changeReason"></textarea> </div> </div> </form> ');/*v:1*/
template('m_finance/m_finance_basic_settings_change_record',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_expNumberDecimalFilter=$helpers._expNumberDecimalFilter,_url=$helpers._url,$out='';$out+='<form class="form-horizontal m"> <table class="table table-hover table-bordered table-responsive dataTable" > <thead> <tr> <th>变更时间</th> <th> 变更类型 </th> <th> 变更余额(元) </th> <th> 变更原因 </th> <th> 变更前余额(元) </th> <th> 变更后余额(元) </th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,$index){
$out+=' <tr data-id="';
$out+=$escape(p.id);
$out+='"> <td>';
$out+=$escape(_momentFormat(p.changeDate,'YYYY/MM/DD'));
$out+='</td> <td>  ';
if(p.changeType==1){
$out+=' 增加余额值 ';
}else{
$out+=' 减少余额值 ';
}
$out+=' </td> <td>';
$out+=$escape(_expNumberDecimalFilter(p.changeAmount));
$out+='</td> <td>';
$out+=$escape(p.changeReason);
$out+='</td> <td>';
$out+=$escape(_expNumberDecimalFilter(p.beforeChangeAmount));
$out+='</td> <td>';
$out+=$escape(_expNumberDecimalFilter(p.afterChangeAmount));
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="6" class="text-center v-middle"> <div > <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </form> ';
return new String($out);
});/*v:1*/
template('m_finance/m_finance_settings_menu','<div class="ibox no-margin"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right">           </div> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content"> <div class="row"> <div class="col-md-12" id="content-box"> </div> </div> </div> </div>');/*v:1*/
template('m_finance_confirm/m_approval_capital_changes','<div class="m"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> <div class="time-combination form-group"> </div> <button class="btn btn-white btn-sm" data-action="refreshBtn">刷新数据</button> <button class="btn btn-primary btn-sm pull-right" data-action="addCapitalChanges">创建资金变动</button> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div>');/*v:1*/
template('m_finance_confirm/m_approval_capital_changes_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,formView=$data.formView,$out='';$out+='<div class="m-form-template-generate-edit p-sm"> <form class="form-horizontal" id="fieldForm"> <div class="form-group"> <label class="col-xs-2 control-label"> 申请人<span class="fc-red">*</span>： </label> <div class="col-xs-10"> <select class="form-control" name="applyUserId"></select> </div> </div> <div class="form-group"> <label class="col-xs-2 control-label"> 部门<span class="fc-red">*</span>： </label> <div class="col-xs-10"> <select class="form-control" name="departId"></select> </div> </div> <div class="clearfix"></div> <div class="form-group"> <label class="col-sm-2 control-label">收款方<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <select class="form-control receiveName" name="enterpriseId" data-placeholder="请输入或选择收款方"/> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">付款方<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <select class="form-control payment-collection" name="fromCompanyId" data-placeholder="请输入或选择付款方"/> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">类型<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <select class="form-control" name="expAllName"></select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">用途说明：</label> <div class="col-sm-10"> <textarea placeholder="请输入付款事由" class="form-control" type="text" name="remark">';
$out+=$escape(dataInfo?dataInfo.remark:'');
$out+='</textarea> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">金额<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入付款金额" class="form-control" type="text" name="sumExpAmount" value="';
$out+=$escape(dataInfo?dataInfo.fee:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">付款方式：</label> <div class="col-sm-10"> <select class="form-control" name="expType"></select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">附件：</label> <div class="col-sm-10"> <div class="row"> <div class="col-md-12 m-b-xs"> <span id="showFileLoading"> </span> </div> <div class="col-md-12 m-b-sm"> <span class="uploadmgrContainer"> </span> </div> </div> </div> </div> ';
if(formView!=1){
$out+=' <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div id="approverOutBox"> </div> ';
}
$out+=' </form> </div> ';
return new String($out);
});/*v:1*/
template('m_finance_confirm/m_approval_capital_changes_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,_expNumberFilter=$helpers._expNumberFilter,$each=$utils.$each,a=$data.a,i=$data.i,$out='';$out+='<form class="form-horizontal p-m m-b-lg overflow-y-auto m-dialog-resize"> <div class="form-group"> <label class="col-24-xs-3 text-right p-l-none">收款方<span class="fc-red">*</span>：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo?dataInfo.enterpriseId:'');
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right p-l-none">付款方<span class="fc-red">*</span>：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo?dataInfo.fromCompanyId:'');
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">类型：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo?dataInfo.expName:'');
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">用途说明：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo?dataInfo.remark:'');
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">金额<span class="fc-red">*</span>：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo?_expNumberFilter(dataInfo.sumExpAmount):'');
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">付款方式：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo?dataInfo.expType:'');
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">附件：</label> <div class="col-24-xs-21"> ';
if(dataInfo.attachList!=null && dataInfo.attachList.length>0){
$out+=' ';
$each(dataInfo.attachList,function(a,i){
$out+=' <span class="label m-r-xs" style="background: #ecf0f1;padding: 5px 10px;"> <a href="javascript:void(0)" data-action="preview" data-file-ext="';
$out+=$escape(a.fileExtName);
$out+='" data-net-file-id="';
$out+=$escape(a.id);
$out+='" data-src="';
$out+=$escape(a.fileFullPath);
$out+='" data-name="';
$out+=$escape(a.fileName);
$out+='"> ';
$out+=$escape(a.fileName);
$out+=' </a> </span> ';
});
$out+=' ';
}
$out+=' </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_finance_confirm/m_approval_capital_changes_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,pageIndex=$data.pageIndex,_expNumberFilter=$helpers._expNumberFilter,_emptyDisplay=$helpers._emptyDisplay,_momentFormat=$helpers._momentFormat,doType=$data.doType,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-responsive dataTable"> <thead> <tr> <th>序号</th> <th> 编号 <a class="icon-filter pull-right" id="filter_expNo" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>金额（元）</th> <th>部门</th> <th class=""> 经办人 <a class="icon-filter pull-right" id="filter_submitUserName"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>审批人</th> <th>收款方</th> <th>付款方</th> <th>收支分类</th> <th>分类子项</th> <th class="sorting_desc min-w-60" data-action="sort" data-code="expDate"> 申请时间 </th> <th class="sorting_desc min-w-60" data-action="sort" data-code="approveDate">审批时间</th> <th>付款时间</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <tr class="curp" data-id="';
$out+=$escape(p.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='"> <td>';
$out+=$escape(i+1+pageIndex*10);
$out+='</td> <td>';
$out+=$escape(p.expNo);
$out+='</td> <td>';
$out+=$escape(_expNumberFilter(p.sumExpAmount));
$out+='</td> <td>';
$out+=$escape(p.departName);
$out+='</td> <td>';
$out+=$escape(p.submitUserName);
$out+='</td> <td>';
$out+=$escape(p.auditPersonName);
$out+='</td> <td>';
$out+=$escape(_emptyDisplay(p.enterpriseId));
$out+='</td> <td>';
$out+=$escape(_emptyDisplay(p.fromCompanyId));
$out+='</td> <td>';
$out+=$escape(p.expParentName);
$out+='</td> <td>';
$out+=$escape(p.expName);
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.expDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.approveDate,'YYYY/MM/DD'));
$out+='</td> <td> ';
if(doType==1 &&  p.approveStatus == '1' && p.allocationDate==null){
$out+=' <button type="button" class="btn btn-primary btn-xs rounded" data-action="agreeToGrant" data-id="';
$out+=$escape(p.id);
$out+='">同意确认</button> <button type="button" class="btn btn-default btn-xs rounded" data-action="sendBack" data-id="';
$out+=$escape(p.id);
$out+='">退回</button> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(p.allocationDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="13" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_finance_confirm/m_approval_exp','<div class="m"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> <div class="time-combination form-group"> </div> <button class="btn btn-white btn-sm" data-action="refreshBtn">刷新数据</button> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div>');/*v:1*/
template('m_finance_confirm/m_approval_exp_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,doType=$data.doType,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,c=$data.c,ci=$data.ci,$escape=$utils.$escape,pageIndex=$data.pageIndex,_expNumberFilter=$helpers._expNumberFilter,_momentFormat=$helpers._momentFormat,_mathSubtract=$helpers._mathSubtract,_emptyDisplay=$helpers._emptyDisplay,currentCompanyUserId=$data.currentCompanyUserId,_url=$helpers._url,$out='';$out+=' <table class="table table-bordered table-responsive dataTable"> <thead> <tr> ';
if(doType==1 || doType==3){
$out+=' <th>序号</th> ';
}
$out+=' <th> 编号 <a class="icon-filter pull-right" id="filter_expNo" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>金额（元）</th> <th>核销金额</th> <th>核销日期</th> <th>待核销</th> <th>部门</th> <th class=""> 经办人 <a class="icon-filter pull-right" id="filter_submitUserName"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>审批人</th> <th> 收款方 ';
if(doType==3){
$out+=' <a class="icon-filter pull-right" id="filter_toCompanyName" ><i class="icon iconfont icon-shaixuan"></i></a> ';
}
$out+=' </th> <th> 付款方 ';
if(doType==3){
$out+=' <a class="icon-filter pull-right" id="filter_fromCompanyName" ><i class="icon iconfont icon-shaixuan"></i></a> ';
}
$out+=' </th> <th>收支分类</th> <th>分类子项</th> <th class="sorting_desc min-w-60" data-action="sort" data-code="expDate"> 申请时间 </th> <th class="sorting_desc min-w-60" data-action="sort" data-code="approveDate">审批时间</th> <th>付款时间</th>  </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' ';
if(p.verificationList && p.verificationList.length>0){
$out+=' ';
$each(p.verificationList,function(c,ci){
$out+=' <tr class="curp" data-id="';
$out+=$escape(p.id);
$out+='" data-sid="';
$out+=$escape(c.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" data-sumexpamount="';
$out+=$escape(p.sumExpAmount);
$out+='"> ';
if((doType==1 || doType==3) && ci==0){
$out+=' <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(i+1+pageIndex*10);
$out+='</td> ';
}
$out+=' ';
if(ci==0){
$out+=' <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(p.expNo);
$out+='</td> <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(_expNumberFilter(p.sumExpAmount));
$out+='</td> ';
}
$out+=' <td> ';
$out+=$escape(_expNumberFilter(c.verificationAmount));
$out+=' </td> <td> ';
if(doType==1 && c.approveStatus==1){
$out+=' <button type="button" class="btn btn-primary btn-xs rounded" data-action="costOffItem">核销</button> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(c.verificationDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </td> ';
if(ci==0){
$out+=' <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(_expNumberFilter(_mathSubtract(p.sumExpAmount,p.verificationAmount)));
$out+='</td> <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(p.departName);
$out+='</td> <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(p.submitUserName);
$out+='</td> <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(p.auditPersonName);
$out+='</td> <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(_emptyDisplay(p.enterpriseId));
$out+='</td> <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(_emptyDisplay(p.fromCompanyId));
$out+='</td> <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(p.expParentName);
$out+='</td> <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(p.expName);
$out+='</td> <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(_momentFormat(p.expDate,'YYYY/MM/DD'));
$out+='</td> <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle">';
$out+=$escape(_momentFormat(p.approveDate,'YYYY/MM/DD'));
$out+='</td> <td rowspan="';
$out+=$escape(p.verificationList.length+1);
$out+='" class="v-middle"> ';
if(doType==1 &&  p.approveStatus == '1' && p.allocationDate==null){
$out+=' <button type="button" class="btn btn-primary btn-xs rounded" data-action="agreeToGrant" data-id="';
$out+=$escape(p.id);
$out+='">同意拨款</button> <button type="button" class="btn btn-default btn-xs rounded" data-action="sendBack" data-id="';
$out+=$escape(p.id);
$out+='">退回</button> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(p.allocationDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </td> ';
}
$out+=' <!--<td>';
$out+=$escape(_expNumberFilter(c.reimburseAmount));
$out+='</td> <td>';
$out+=$escape(_expNumberFilter(c.returnAmount));
$out+='</td>--> </tr> ';
if(ci==p.verificationList.length-1){
$out+=' <tr data-id="';
$out+=$escape(p.id);
$out+='" data-sid="" data-type="operation"> <td colspan="2" class="text-center"> ';
if(doType==2 && p.companyUserId == currentCompanyUserId && p.approveStatus == '6' && p.applyAmount < p.sumExpAmount){
$out+=' <button type="button" class="btn btn-link no-padding height-20" data-action="costOff" data-depart-id="';
$out+=$escape(p.departId);
$out+='" data-type="2" title="核销申请"> <i class="fa fa-plus color-dark-blue f-s-xl"></i> </button> ';
}else if(doType==1 && p.applyAmount < p.sumExpAmount){
$out+=' <button type="button" class="btn btn-link no-padding height-20" data-action="costOff" data-depart-id="';
$out+=$escape(p.departId);
$out+='" data-type="1" title="核销"> <i class="fa fa-plus color-dark-blue f-s-xl"></i> </button> ';
}else{
$out+=' ';
}
$out+=' </td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="curp" data-id="';
$out+=$escape(p.id);
$out+='" data-sid="" data-i="';
$out+=$escape(i);
$out+='" data-sumexpamount="';
$out+=$escape(p.sumExpAmount);
$out+='"> ';
if(doType==1 || doType==3){
$out+=' <td>';
$out+=$escape(i+1+pageIndex*10);
$out+='</td> ';
}
$out+=' <td>';
$out+=$escape(p.expNo);
$out+='</td> <td>';
$out+=$escape(_expNumberFilter(p.sumExpAmount));
$out+='</td> <td colspan="2" class="text-center"> ';
if(doType==2 && p.companyUserId == currentCompanyUserId && p.approveStatus == '6' && p.applyAmount < p.sumExpAmount){
$out+=' <button type="button" class="btn btn-link no-padding height-20" data-action="costOff" data-depart-id="';
$out+=$escape(p.departId);
$out+='" data-type="2" title="核销申请"> <i class="fa fa-plus color-dark-blue f-s-xl"></i> </button> ';
}else if(doType==1 && p.approveStatus == '6' && p.applyAmount < p.sumExpAmount){
$out+=' <button type="button" class="btn btn-link no-padding height-20" data-action="costOff" data-depart-id="';
$out+=$escape(p.departId);
$out+='" data-type="1" title="核销"> <i class="fa fa-plus color-dark-blue f-s-xl"></i> </button> ';
}else{
$out+=' ';
}
$out+=' </td> <td>';
$out+=$escape(_expNumberFilter(_mathSubtract(p.sumExpAmount,p.verificationAmount)));
$out+='</td> <td>';
$out+=$escape(p.departName);
$out+='</td> <td>';
$out+=$escape(p.submitUserName);
$out+='</td> <td>';
$out+=$escape(p.auditPersonName);
$out+='</td> <td>';
$out+=$escape(_emptyDisplay(p.enterpriseId));
$out+='</td> <td>';
$out+=$escape(_emptyDisplay(p.fromCompanyId));
$out+='</td> <td>';
$out+=$escape(p.expParentName);
$out+='</td> <td>';
$out+=$escape(p.expName);
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.expDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.approveDate,'YYYY/MM/DD'));
$out+='</td> <td> ';
if(doType==1 &&  p.approveStatus == '1' && p.allocationDate==null){
$out+=' <button type="button" class="btn btn-primary btn-xs rounded" data-action="agreeToGrant" data-id="';
$out+=$escape(p.id);
$out+='">同意拨款</button> <button type="button" class="btn btn-default btn-xs rounded" data-action="sendBack" data-id="';
$out+=$escape(p.id);
$out+='">退回</button> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(p.allocationDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="';
$out+=$escape(doType==1 || doType==3?'16':'15');
$out+='" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_finance_confirm/m_approval_payment','<div class="m"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> <div class="time-combination form-group"> </div> <button class="btn btn-white btn-sm" data-action="refreshBtn">刷新数据</button> <button type="button" class="btn btn-primary pull-right" data-action="setField" title="设置字段"> <span><i class="fa fa-list"></i> <span class="caret m-t-n-xs"></span></span> </button> </form> <div class="data-list-box"> <div class="data-list-container"> <table class="table table-bordered table-hover cell-border dataTable"> <thead></thead> <tbody></tbody> </table> </div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div>');/*v:1*/
template('m_finance_confirm/m_approval_payment_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,pageIndex=$data.pageIndex,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-responsive"> <thead> <tr> <th>序号</th> <th>编号</th> <th>申请时间</th> <th>申请人</th> <th>所在组织</th> <th>类型</th> <th>所在部门</th> <th>用途说明</th> <th>申请金额</th> <th>审批人</th> <th>审批时间</th> <th>拨款时间</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='"> <td>';
$out+=$escape(i+1+pageIndex*10);
$out+='</td> <td>编号</td> <td>申请时间</td> <td>申请人</td> <td>所在组织</td> <td>类型</td> <td>所在部门</td> <td>用途说明</td> <td>申请金额</td> <td>审批人</td> <td>审批时间</td> <td>拨款时间</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="12" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_finance_confirm/m_finance_confirm_menu','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right"> <ul class="secondary-menu-ul pull-right"> <li class="roleControl active" roleCode="400010" flag="2" id="feeEntry"> <a href="#/financeConfirm/feeEntry">费用录入</a> </li> <li class="roleControl" roleCode="40001902" flag="2" id="billing"> <a href="#/financeConfirm/billing">开票确认</a> </li> <li class="roleControl" roleCode="40001904" flag="2" id="projectReceipt"> <a href="#/financeConfirm/projectReceipt">项目收款</a> </li> <li class="roleControl" roleCode="40001903" flag="2" id="projectPayment"> <a href="#/financeConfirm/projectPayment">项目付款</a> </li> <li class="roleControl" roleCode="40001905" flag="2" id="approvalPayment"> <a href="#/financeConfirm/approvalPayment">审批付款</a> </li> <li class="roleControl" roleCode="40001905" flag="2" id="approvalExp"> <a href="#/financeConfirm/approvalExp">借款/往来/保证金等收付款</a> </li> <li class="roleControl" roleCode="40001905" flag="2" id="singleFundChange"> <a href="#/financeConfirm/singleFundChange">资金变动</a> </li> </ul> </div> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content no-padding" id="content-box"> </div> </div>');/*v:1*/
template('m_finance_confirm/m_project_payment','<div class="m"> <form role="form" class="form-horizontal filter-form m-b-sm"> <div class="row" id="filterBox"> <div class="col-md-12"> <div class=""> <label class="inline">项目范围：</label> <select class="from-control width-300 inline" name="zoneOrgId"></select> </div> </div> <div class="col-md-12 m-t-xs" id="timeSelect"> </div> <div class="col-md-12 m-t-xs"> <div class=" "> <label class="inline">搜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;索：</label> <input class="form-control input-sm width-300 inline v-middle" type="text" name="keyword" placeholder="请输入关键字"> </div> </div> <div class="col-md-12 m-t"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> </div> </div> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> ');/*v:1*/
template('m_finance_confirm/m_project_payment_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,pageIndex=$data.pageIndex,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-hover table-responsive"> <thead> <tr> <th>序号</th> <th>申请日期</th> <th>申请人</th> <th>金额</th> <th> 付款类型 <a class="icon-filter pull-right" id="filter_feeType"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th> 关联项目 <a class="icon-filter pull-right" id="filter_projectName"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>付款节点</th> <th> 收款方 <a class="icon-filter pull-right" id="filter_associatedOrg"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>付款金额</th> <th>付款时间</th> <th>应付</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' <tr class="curp" data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='"> <td>';
$out+=$escape(i+1+pageIndex*10);
$out+='</td> <td>';
$out+=$escape(_momentFormat(d.createDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(d.operatorName);
$out+='</td> <td> <span class="td-span-pr">';
$out+=$escape(_expNumberFilter(d.fee));
$out+='</span> </td> <td>';
$out+=$escape(d.feeTypeName);
$out+='</td> <td class="max-width-v1"> <div class="text-ellipsis-2 text-wrap" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(d.projectName);
$out+='"> ';
$out+=$escape(d.projectName);
$out+=' </div> </td> <td class="max-width-v1"> <div class="text-ellipsis-2 text-wrap" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(d.feeName);
$out+='"> ';
$out+=$escape(d.feeName);
$out+=' </div> </td> <td> ';
if(d.toCompanyName!=null && d.toCompanyName!=''){
$out+=' ';
$out+=$escape(d.toCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </td> <td> <button class="btn btn-primary btn-xs roleControl" roleCode="40000102" flag="7" data-id="';
$out+=$escape(d.myTaskId);
$out+='" data-edit-type="5" data-action="editContract" data-key="fee" data-type="9" data-valid="6" data-limit-min="0" data-limit-max="';
$out+=$escape(d.profitFee-0);
$out+='" > 付款确认 </button> </td> <td> ';
if(_isNullOrBlank(d.lastPaymentDate)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(d.lastPaymentDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </td> <td>';
$out+=$escape(_expNumberFilter(d.profitFee));
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="11" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_finance_confirm/m_project_receipt','<div class="m"> <form role="form" class="form-horizontal filter-form m-b-sm"> <div class="row" id="filterBox"> <div class="col-md-12"> <div class=""> <label class="inline">项目范围：</label> <select class="from-control width-300 inline" name="zoneOrgId"></select> </div> </div> <div class="col-md-12 m-t-xs" id="timeSelect"> </div> <div class="col-md-12 m-t-xs"> <div class=" "> <label class="inline">搜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;索：</label> <input class="form-control input-sm width-300 inline v-middle" type="text" name="keyword" placeholder="请输入关键字"> </div> </div> <div class="col-md-12 m-t"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> </div> </div> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> ');/*v:1*/
template('m_finance_confirm/m_project_receipt_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,pageIndex=$data.pageIndex,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-hover table-responsive"> <thead> <tr> <th>序号</th> <th>申请日期</th> <th>申请人</th> <th>金额</th> <th> 收款类型 <a class="icon-filter pull-right" id="filter_feeType"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th> 关联项目 <a class="icon-filter pull-right" id="filter_projectName"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>回款节点</th> <th> 付款方 <a class="icon-filter pull-right" id="filter_associatedOrg"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>到账金额</th> <th>到账时间</th> <th>应收</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' <tr class="curp" data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='"> <td>';
$out+=$escape(i+1+pageIndex*10);
$out+='</td> <td>';
$out+=$escape(_momentFormat(d.createDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(d.operatorName);
$out+='</td> <td> <span class="td-span-pr">';
$out+=$escape(_expNumberFilter(d.fee));
$out+='</span> </td> <td>';
$out+=$escape(d.feeTypeName);
$out+='</td> <td class="max-width-v1"> <div class="text-ellipsis-2 text-wrap" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(d.projectName);
$out+='"> ';
$out+=$escape(d.projectName);
$out+=' </div> </td> <td class="max-width-v1"> <div class="text-ellipsis-2 text-wrap" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(d.feeName);
$out+='"> ';
$out+=$escape(d.feeName);
$out+=' </div> </td> <td> ';
if(d.fromCompanyName!=null && d.fromCompanyName!=''){
$out+=' ';
$out+=$escape(d.fromCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </td> <td> <button class="btn btn-primary btn-xs roleControl" roleCode="40000103" flag="7" data-id="';
$out+=$escape(d.myTaskId);
$out+='" data-edit-type="5" data-action="editContract" data-key="fee" data-type="9" data-valid="6" data-limit-min="0" data-limit-max="';
$out+=$escape(d.profitFee-0);
$out+='"> 到账确认 </button> </td> <td> ';
if(_isNullOrBlank(d.lastPaymentDate)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(d.lastPaymentDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </td> <td>';
$out+=$escape(_expNumberFilter(d.profitFee));
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="11" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_form_template/m_form_template_generate_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataInfo=$data.dataInfo,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,$each=$utils.$each,p=$data.p,i=$data.i,_expNumberFilter=$helpers._expNumberFilter,a=$data.a,c=$data.c,ci=$data.ci,cc=$data.cc,cci=$data.cci,s=$data.s,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,typeStr=$data.typeStr,u=$data.u,ui=$data.ui,isShowBtn=$data.isShowBtn,isView=$data.isView,currentCompanyUserId=$data.currentCompanyUserId,$out='';$out+='<form class="form-horizontal m-form-template-generate-details p-sm overflow-y-auto m-dialog-resize"> ';
if(dataInfo.dynamicAudit && dataInfo.dynamicAudit.baseAuditData && dataInfo.dynamicAudit.baseAuditData.expNo){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">审批编号：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo.dynamicAudit.baseAuditData.expNo);
$out+=' </div> </div> ';
}
$out+=' ';
if(dataInfo.dynamicAudit && dataInfo.dynamicAudit.baseAuditData.userName){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">申请人：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo.dynamicAudit.baseAuditData.userName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">申请时间：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_momentFormat(dataInfo.dynamicAudit.baseAuditData.expDate,'YYYY/MM/DD'));
$out+=' </div> </div> ';
}
$out+=' ';
if(dataInfo.dynamicAudit && dataInfo.dynamicAudit.baseAuditData && dataInfo.dynamicAudit.baseAuditData.companyName){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">所在组织：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo.dynamicAudit.baseAuditData.companyName);
$out+=' </div> </div> ';
}
$out+=' ';
if(dataInfo.dynamicAudit && dataInfo.dynamicAudit.baseAuditData && dataInfo.dynamicAudit.baseAuditData.departName){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">部门：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo.dynamicAudit.baseAuditData.departName);
$out+=' </div> </div> ';
}
$out+=' <h4 class="title-line m-l-sm">审批详情</h4> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> ';
if(dataInfo && dataInfo.dynamicAudit && dataInfo.dynamicAudit.fieldList){
$out+=' ';
if(dataInfo.dynamicAudit.type=='projectSetUp' || dataInfo.dynamicAudit.type=='contractAudit' || dataInfo.dynamicAudit.type=='expApply' || dataInfo.dynamicAudit.type=='verification' || dataInfo.dynamicAudit.type=='singleFundChange'){
$out+=' <div id="approvalDetailsBox"></div> ';
}else{
$out+=' ';
$each(dataInfo.dynamicAudit.fieldList,function(p,i){
$out+=' ';
if(p.fieldType!=10 &&  p.fieldType!=9){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">';
$out+=$escape(p.fieldTitle?p.fieldTitle:'标题');
$out+='：</label> <div class="col-24-xs-21" data-statistics="';
$out+=$escape(p.isStatistics?p.isStatistics:'');
$out+='" data-value="';
$out+=$escape(p.fieldValueText?p.fieldValueText:'');
$out+='" data-field-unit="';
$out+=$escape(p.fieldUnit?p.fieldUnit:'');
$out+='"> ';
if(p.fieldType==4){
$out+=' ';
$out+=$escape(_momentFormat(p.fieldValueText,'YYYY/MM/DD'));
$out+=' ';
}else if(p.fieldType==5 && (p.fieldUnit=='元' || p.fieldUnit=='万元')){
$out+=' ';
$out+=$escape(_expNumberFilter(p.fieldValueText));
$out+=' ';
}else{
$out+=' ';
$out+=$escape(p.fieldValueText?p.fieldValueText:'');
$out+=' ';
}
$out+=' </div> </div> ';
}
$out+=' ';
if(p.fieldType==10 && dataInfo && dataInfo.dynamicAudit && dataInfo.dynamicAudit.attachList!=null && dataInfo.dynamicAudit.attachList.length>0){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">';
$out+=$escape(p.fieldTitle?p.fieldTitle:'附件');
$out+='：</label> <div class="col-24-xs-21"> ';
$each(dataInfo.dynamicAudit.attachList,function(a,i){
$out+=' <span class="label m-r-xs" style="background: #ecf0f1;padding: 5px 10px;"> <a href="javascript:void(0)" data-action="preview" data-file-ext="';
$out+=$escape(a.fileExtName);
$out+='" data-net-file-id="';
$out+=$escape(a.id);
$out+='" data-index="';
$out+=$escape(i);
$out+='" data-src="';
$out+=$escape(a.fileFullPath);
$out+='" data-name="';
$out+=$escape(a.fileName);
$out+='"> ';
$out+=$escape(a.fileName);
$out+=' </a> </span> ';
});
$out+=' </div> </div> ';
}
$out+=' ';
if(p.detailFieldList && p.detailFieldList.length>0){
$out+=' ';
$each(p.detailFieldList,function(c,ci){
$out+=' <div class="panel panel-default"> <div class="panel-body"> <h4 class="title-line"> 明细(<span data-action="panelIndex">';
$out+=$escape(ci+1);
$out+='</span>) </h4> ';
$each(c,function(cc,cci){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">';
$out+=$escape(cc.fieldTitle?cc.fieldTitle:'标题');
$out+='：</label> <div class="col-24-xs-21" data-statistics="';
$out+=$escape(cc.isStatistics?cc.isStatistics:'');
$out+='" data-value="';
$out+=$escape(cc.fieldValueText?cc.fieldValueText:'');
$out+='" data-field-unit="';
$out+=$escape(cc.fieldUnit?cc.fieldUnit:'');
$out+='"> ';
if(cc.fieldType==4){
$out+=' ';
$out+=$escape(_momentFormat(cc.fieldValueText,'YYYY/MM/DD'));
$out+=' ';
}else if(cc.fieldType==5 && (cc.fieldUnit=='元' || cc.fieldUnit=='万元')){
$out+=' ';
$out+=$escape(_expNumberFilter(cc.fieldValueText));
$out+=' ';
}else{
$out+=' ';
$out+=$escape(cc.fieldValueText?cc.fieldValueText:'');
$out+=' ';
}
$out+=' </div> </div> ';
});
$out+=' </div> </div> ';
});
$out+=' ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' ';
}
$out+=' <div id="isShowStatistics" style="display: none;"> <div class="form-group"> <label class="col-24-xs-3 control-label">总计：</label> <div class="col-24-xs-21 p-t-7"> <span id="expAmount">';
$out+=$escape(dataInfo?dataInfo.totalExpAmount:'0');
$out+='</span> </div> </div> </div> <h4 class="title-line m-l-sm">审批流程</h4> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r" ></div> <div class="form-group"> <div class="col-sm-12 p-w-md"> <table class="table table-hover table-bordered m-b-xs" > <thead> <tr> <th width="40%">审批</th> <th width="40%">操作</th> <th width="20%">审批时间</th> </tr> </thead> <tbody> ';
if(dataInfo && dataInfo.dynamicAudit &&  dataInfo.dynamicAudit.auditList!=null && dataInfo.dynamicAudit.auditList.length>0){
$out+=' ';
$each(dataInfo.dynamicAudit.auditList,function(s,i){
$out+=' <tr> <td> ';
if(_isNullOrBlank(s.fileFullPath)){
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30"/> ';
}else{
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(s.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" > ';
}
$out+=' <span class="dp-inline-block"> <p class="m-b-none">';
$out+=$escape(s.userName);
$out+='</p> <p class="m-b-none fc-v1-grey">';
$out+=$escape(s.companyName);
$out+='</p> </span> </td> <td> ';
if(s.approveStatus=='1'){
$out+=' <p class="text-success m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}else if(s.approveStatus=='2' || s.approveStatus=='3'){
$out+=' <p class="text-danger m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}else{
$out+=' <p class="m-b-none"> ';
if(dataInfo.dynamicAudit.type=='singleFundChange' && s.approveStatusName=='已拨款'){
$out+=' 已确认 ';
}else if(dataInfo.dynamicAudit.type=='singleFundChange' && s.approveStatusName=='等待财务拨款'){
$out+=' 等待财务确认 ';
}else{
$out+=' ';
$out+=$escape(s.approveStatusName);
$out+=' ';
}
$out+=' </p> ';
}
$out+=' ';
if(s.approveStatusName=='发起申请' && !_isNullOrBlank(s.remark)){
$out+=' <p class="fc-v1-grey m-b-none">';
$out+=$escape(typeStr);
$out+='备注：';
$out+=$escape(s.remark);
$out+='</p> ';
}
$out+=' ';
if(s.approveStatusName=='退回'  && !_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">退回原因：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}else if(!_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">审批意见：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}
$out+=' </td> <td> ';
$out+=$escape(_momentFormat(s.approveDate,'YYYY/MM/DD'));
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr> <td colspan="3" class="text-center">暂无数据</td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
if( dataInfo && dataInfo.dynamicAudit &&  dataInfo.dynamicAudit.ccCompanyUserList!=null && dataInfo.dynamicAudit.ccCompanyUserList.length>0){
$out+=' <h4 class="title-line m-l-sm">抄送人</h4> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div class="form-group"> <div class="col-sm-12 p-w-md approval-out-box"> ';
$each(dataInfo.dynamicAudit.ccCompanyUserList,function(u,ui){
$out+=' <div class="approver-outbox"> <div class="approver-box "> <div class="img-circle"> <img alt="image" class="img-circle" src="';
$out+=$escape(_isNullOrBlank(u.fileFullPath)?_url('/img/head_default.png'):u.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" height="30"> </div> <div class="m-t-xs">';
$out+=$escape(u.userName);
$out+='</div> </div> </div> ';
});
$out+=' </div> </div> ';
}
$out+=' </form> ';
if(isShowBtn){
$out+=' <div class="footer border-b-radius text-right"> ';
if(isView){
$out+=' <button class="btn btn-default" data-action="cancel">关闭</button> ';
}else{
$out+=' <button class="btn btn-default" data-action="cancel"> ';
if((dataInfo && dataInfo.dynamicAudit.auditFlag==1)
                || (dataInfo && dataInfo.dynamicAudit.baseAuditData.companyUserId == currentCompanyUserId && dataInfo.dynamicAudit.baseAuditData.approveStatus == 0)){
$out+=' 取消 ';
}else{
$out+=' 关闭 ';
}
$out+=' </button> ';
if(dataInfo && dataInfo.dynamicAudit.auditFlag==1){
$out+=' <button class="btn btn-primary" data-action="agree">同意</button> <button class="btn btn-success" data-action="returnBack">退回</button> ';
}
$out+=' ';
if(dataInfo && dataInfo.dynamicAudit.repealFlag == 1 ){
$out+=' <button class="btn btn-danger" data-action="cancellation">撤销</button> ';
}
$out+=' ';
if(currentCompanyUserId==dataInfo.dynamicAudit.baseAuditData.companyUserId && (dataInfo.dynamicAudit.baseAuditData.approveStatus=='0' || dataInfo.dynamicAudit.baseAuditData.approveStatus=='5')){
$out+=' <button class="btn btn-warning" data-action="remind">提醒</button> ';
}
$out+=' ';
}
$out+=' </div> ';
}
return new String($out);
});/*v:1*/
template('m_form_template/m_form_template_generate_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,fieldId=$data.fieldId,dataInfo=$data.dataInfo,$out='';$out+='<div class="m-form-template-generate-edit p-sm"> <form class="form-horizontal" id="fieldForm"> <div class="col-xs-12 form-item " data-type="2" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label"> 申请人<span class="fc-red">*</span>： </label> <div class="col-xs-10"> <select class="form-control" name="applyUserId"></select> </div> </div> <div class="form-group"> <label class="col-xs-2 control-label"> 部门<span class="fc-red">*</span>： </label> <div class="col-xs-10"> <select class="form-control" name="departId"></select> </div> </div> </div> </form> <div class="clearfix"></div> <form class="form-horizontal"> <div class="p-l" id="isShowStatistics" style="display: none;"> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div class="form-group"> <label class="col-sm-2 control-label">总计：</label> <div class="col-sm-10 p-t-7"> <span id="expAmount">';
$out+=$escape(dataInfo?dataInfo.totalExpAmount:'0');
$out+='</span> </div> </div> </div> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div class="p-l" id="approverOutBox"> </div> </form> </div>';
return new String($out);
});/*v:1*/
template('m_form_template/m_form_template_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,type=$data.type,$escape=$utils.$escape,itemKey=$data.itemKey,defaultData=$data.defaultData,$each=$utils.$each,p=$data.p,$index=$data.$index,c=$data.c,o=$data.o,$out='';if(type==1){
$out+=' <div class="col-xs-12 form-item" data-type="1" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <label class="col-24-xs-4 control-label"> <span> ';
$out+=$escape(defaultData.fieldTitle);
$out+=' </span> ';
if(defaultData.requiredType==1){
$out+=' <span class="fc-red">*</span> ';
}
$out+=' </label> <div class="col-24-xs-20"> <input type="text" class="form-control control" value="" placeholder="';
$out+=$escape(defaultData.fieldTooltip);
$out+='"> </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==2){
$out+=' <div class="col-xs-12 form-item " data-type="2" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <label class="col-24-xs-4 control-label"> <span>';
$out+=$escape(defaultData.fieldTitle);
$out+='</span> ';
if(defaultData.requiredType==1){
$out+=' <span class="fc-red">*</span> ';
}
$out+=' </label> <div class="col-24-xs-20"> <textarea type="text" class="form-control control" placeholder="';
$out+=$escape(defaultData.fieldTooltip);
$out+='"></textarea> </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==3){
$out+=' <div class="col-xs-12 form-item " data-type="3" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <label class="col-24-xs-4 control-label"> <span>';
$out+=$escape(defaultData.fieldTitle);
$out+='</span> ';
if(defaultData.requiredType==1){
$out+=' <span class="fc-red">*</span> ';
}
$out+=' </label> <div class="col-24-xs-20"> <div class="input-group"> <input type="text" class="form-control control" placeholder="';
$out+=$escape(defaultData.fieldTooltip);
$out+='" readonly="" onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" value=""> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==4){
$out+=' <div class="col-xs-12 form-item " data-type="4" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <label class="col-24-xs-4 control-label"> <span>';
$out+=$escape(defaultData.fieldTitle);
$out+='</span> ';
if(defaultData.requiredType==1){
$out+=' <span class="fc-red">*</span> ';
}
$out+=' </label> <div class="col-24-xs-8 no-padding"> <div class="';
$out+=$escape(defaultData.dateFormatType==1?'col-24-xs-24':'col-24-xs-12 p-r-none');
$out+=' time-box"> <div class="input-group"> <input type="text" class="form-control control" placeholder="';
$out+=$escape(defaultData.fieldTooltip);
$out+='" readonly="" onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" value=""> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> <div class="col-24-xs-6 p-l-xs p-r-none time-hh" style="';
$out+=$escape(defaultData.dateFormatType==1 || defaultData.dateFormatType==3?'display: none;':'');
$out+='"> <select class="form-control"> <option value="01">01</option> <option value="02">02</option> <option value="03">03</option> <option value="04">04</option> <option value="05">05</option> <option value="06">06</option> <option value="07">07</option> <option value="08">08</option> <option value="09" selected>09</option> <option value="10">10</option> <option value="11">11</option> <option value="12">12</option> <option value="13">13</option> <option value="14">14</option> <option value="15">15</option> <option value="16">16</option> <option value="17">17</option> <option value="18">18</option> <option value="19">19</option> <option value="20">20</option> <option value="21">21</option> <option value="22">22</option> <option value="23">23</option> <option value="24">24</option> </select> </div> <div class="col-24-xs-6 p-l-xs p-r-none time-mm" style="';
$out+=$escape(defaultData.dateFormatType==1 || defaultData.dateFormatType==3?'display: none;':'');
$out+='"> <select class="form-control"> <option value="00">00</option> <option value="30">30</option> </select> </div> <div class="col-24-xs-12 p-l-xs am-pm" style="';
$out+=$escape(defaultData.dateFormatType==1 || defaultData.dateFormatType==2?'display: none;':'');
$out+='"> <select class="form-control"> <option>上午</option> <option>下午</option> </select> </div> </div> <label class="col-24-xs-4 control-label"> <span>';
$out+=$escape(defaultData.fieldTitle2);
$out+='</span> ';
if(defaultData.requiredType==1){
$out+=' <span class="fc-red">*</span> ';
}
$out+=' </label> <div class="col-24-xs-8 no-padding"> <div class="';
$out+=$escape(defaultData.dateFormatType==1?'col-24-xs-24':'col-24-xs-12 p-r-none');
$out+=' time-box"> <div class="input-group"> <input type="text" class="form-control control" placeholder="';
$out+=$escape(defaultData.fieldTooltip2);
$out+='" readonly="" onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" value=""> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> <div class="col-24-xs-6 p-l-xs p-r-none time-hh" style="';
$out+=$escape(defaultData.dateFormatType==1 || defaultData.dateFormatType==3?'display: none;':'');
$out+='"> <select class="form-control"> <option value="01">01</option> <option value="02">02</option> <option value="03">03</option> <option value="04">04</option> <option value="05">05</option> <option value="06">06</option> <option value="07">07</option> <option value="08">08</option> <option value="09" selected>09</option> <option value="10">10</option> <option value="11">11</option> <option value="12">12</option> <option value="13">13</option> <option value="14">14</option> <option value="15">15</option> <option value="16">16</option> <option value="17">17</option> <option value="18">18</option> <option value="19">19</option> <option value="20">20</option> <option value="21">21</option> <option value="22">22</option> <option value="23">23</option> <option value="24">24</option> </select> </div> <div class="col-24-xs-6 p-l-xs p-r-none time-mm" style="';
$out+=$escape(defaultData.dateFormatType==1 || defaultData.dateFormatType==3?'display: none;':'');
$out+='"> <select class="form-control"> <option value="00">00</option> <option value="30">30</option> </select> </div> <div class="col-24-xs-12 p-l-xs am-pm" style="';
$out+=$escape(defaultData.dateFormatType==1 || defaultData.dateFormatType==2?'display: none;':'');
$out+='"> <select class="form-control"> <option>上午</option> <option>下午</option> </select> </div> </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==5){
$out+=' <div class="col-xs-12 form-item " data-type="5" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <label class="col-24-xs-4 control-label"> <span>';
$out+=$escape(defaultData.fieldTitle);
$out+='</span> ';
if(defaultData.requiredType==1){
$out+=' <span class="fc-red">*</span> ';
}
$out+=' </label> <div class="col-24-xs-20"> <div class="input-group full-width"> <input type="text" class="form-control control" placeholder="';
$out+=$escape(defaultData.fieldTooltip);
$out+='" name="fieldUnit" > ';
if(defaultData.fieldUnit!=null && defaultData.fieldUnit!=''){
$out+=' <span class="input-group-addon ">';
$out+=$escape(defaultData.fieldUnit);
$out+='</span> ';
}else{
$out+=' <span class="input-group-addon" style="display: none;"></span> ';
}
$out+=' </div> </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==6){
$out+=' <div class="col-xs-12 form-item " data-type="6" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <label class="col-24-xs-4 control-label"> <span>';
$out+=$escape(defaultData.fieldTitle);
$out+='</span> ';
if(defaultData.requiredType==1){
$out+=' <span class="fc-red">*</span> ';
}
$out+=' </label> <div class="col-24-xs-20"> <select class="form-control control"> <option value="">';
$out+=$escape(defaultData.fieldTooltip);
$out+='</option> ';
if(defaultData.fieldSelectedValueList && defaultData.fieldSelectedValueList.length>0 && defaultData.fieldSelectedValueList[0].child!=null){
$out+=' ';
$each(defaultData.fieldSelectedValueList,function(p,$index){
$out+=' <optgroup data-select2-id="';
$out+=$escape(p.id);
$out+='" label="';
$out+=$escape(p.name);
$out+='"> ';
if(p.child!=null && p.child.length>0){
$out+=' ';
$each(p.child,function(c,$index){
$out+=' <option value="';
$out+=$escape(c.id);
$out+='">';
$out+=$escape(c.name==null?c.selectableName:c.name);
$out+='</option> ';
});
$out+=' ';
}
$out+=' </optgroup> ';
});
$out+=' ';
}else{
$out+=' ';
if(defaultData.fieldTooltip && defaultData.fieldTooltip!=''){
$out+=' <option value="">';
$out+=$escape(defaultData.fieldTooltip);
$out+='</option> ';
}
$out+=' ';
$each(defaultData.fieldSelectedValueList,function(o,$index){
$out+=' <option value="';
$out+=$escape(o.id);
$out+='">';
$out+=$escape(o.name==null?o.selectableName:o.name);
$out+='</option> ';
});
$out+=' ';
}
$out+=' </select> </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==7){
$out+=' <div class="col-xs-12 form-item " data-type="7" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <label class="col-24-xs-4 control-label"> <span>';
$out+=$escape(defaultData.fieldTitle);
$out+='</span> ';
if(defaultData.requiredType==1){
$out+=' <span class="fc-red">*</span> ';
}
$out+=' </label> <div class="col-24-xs-20"> ';
if(defaultData.fieldSelectedValueList && defaultData.fieldSelectedValueList.length>0){
$out+=' ';
$each(defaultData.fieldSelectedValueList,function(o,$index){
$out+=' <div class="';
$out+=$escape(defaultData.arrangeType==1?'pull-left':'');
$out+=' m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="optional"/> <span class="i-checks-span">';
$out+=$escape(o.name==null?o.selectableName:o.name);
$out+='</span> </label> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="optional"/> <span class="i-checks-span">选项1</span> </label> </div> <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> <input type="radio" name="optional"/> <span class="i-checks-span">选项2</span> </label> </div> ';
}
$out+=' </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==8){
$out+=' <div class="col-xs-12 form-item " data-type="8" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <label class="col-24-xs-4 control-label"> <span>';
$out+=$escape(defaultData.fieldTitle);
$out+='</span> ';
if(defaultData.requiredType==1){
$out+=' <span class="fc-red">*</span> ';
}
$out+=' </label> <div class="col-24-xs-20"> ';
if(defaultData.fieldSelectedValueList && defaultData.fieldSelectedValueList.length>0){
$out+=' ';
$each(defaultData.fieldSelectedValueList,function(o,$index){
$out+=' <div class="';
$out+=$escape(defaultData.arrangeType==1?'pull-left':'');
$out+=' m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> <input type="checkbox" name="optional"/> <span class="i-checks-span">';
$out+=$escape(o.name==null?o.selectableName:o.name);
$out+='</span> </label> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> <input type="checkbox" name="optional" /> <span class="i-checks-span">选项1</span> </label> </div> <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> <input type="checkbox" name="optional" /> <span class="i-checks-span">选项2</span> </label> </div> ';
}
$out+=' </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==9){
$out+=' <div class="col-xs-12 form-item " data-type="9" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <div class="panel panel-default" style="min-height: 100px;margin-left:45px;"> <div class="panel-body"> <form id="subFieldBox"> <h4 class="title-line"> 明细 <span class="fc-v1-grey fw-normal">(可拖入左侧多个控件，不包括明细、附件控件)</span></h4> </form> </div> </div> <div class="col-24-xs-20 col-24-xs-offset-4"> <button class="btn btn-primary btn-sm" data-action="addItem" title="添加明细"><i class="fa fa-plus"></i>&nbsp;添加明细</button> </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==10){
$out+=' <div class="col-xs-12 form-item " data-type="10" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <label class="col-24-xs-4 control-label">附件</label> <div class="col-24-xs-20"> <button class="btn btn-primary btn-sm" data-action="addItem" title="上传附件"><i class="fa fa-upload"></i>&nbsp;上传附件</button> </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==11){
$out+=' <div class="col-xs-12 form-item " data-type="11" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <label class="col-24-xs-4 control-label"> <span>';
$out+=$escape(defaultData.fieldTitle);
$out+='</span> ';
if(defaultData.requiredType==1){
$out+=' <span class="fc-red">*</span> ';
}
$out+=' </label> <div class="col-24-xs-20"> <select class="form-control control"> <option value="">请选择</option> </select> </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==12){
$out+=' <div class="col-xs-12 form-item " data-type="12" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <label class="col-24-xs-4 control-label"> <span>';
$out+=$escape(defaultData.fieldTitle);
$out+='</span> ';
if(defaultData.requiredType==1){
$out+=' <span class="fc-red">*</span> ';
}
$out+=' </label> <div class="col-24-xs-20"> <select class="form-control control"> <option value="">请选择</option> </select> </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==13){
$out+=' <div class="col-xs-12 form-item " data-type="13" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="form-group"> <label class="col-24-xs-4 control-label"><span>';
$out+=$escape(defaultData.fieldTitle);
$out+='</span></label> <div class="col-24-xs-20"> </div> </div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}else if(type==14){
$out+=' <div class="col-xs-12 form-item " data-type="14" data-key="';
$out+=$escape(itemKey);
$out+='"> <div class="hr-line-dashed m-t-none m-b-sm"></div> <button class="btn btn-link absolute-top-right dp-none" data-action="delItem"><i class="glyphicon glyphicon-remove"></i></button> </div> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_form_template/m_form_template_itemForEdit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fieldType=$data.fieldType,$escape=$utils.$escape,fieldId=$data.fieldId,fieldTitle=$data.fieldTitle,requiredType=$data.requiredType,fieldValue=$data.fieldValue,fieldTooltip=$data.fieldTooltip,dateFormatType=$data.dateFormatType,fieldTitle2=$data.fieldTitle2,fieldId2=$data.fieldId2,fieldValue2=$data.fieldValue2,fieldTooltip2=$data.fieldTooltip2,itemKey=$data.itemKey,isStatistics=$data.isStatistics,statisticalCondition=$data.statisticalCondition,fieldUnit=$data.fieldUnit,fieldSelectValueType=$data.fieldSelectValueType,fieldSelectedValueList=$data.fieldSelectedValueList,$each=$utils.$each,p=$data.p,$index=$data.$index,c=$data.c,o=$data.o,arrangeType=$data.arrangeType,panelIndex=$data.panelIndex,$out='';if(fieldType==1){
$out+=' <div class="col-xs-12 form-item" data-type="1" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label"> ';
$out+=$escape(fieldTitle?fieldTitle:'单行文本');
if(requiredType==1){
$out+='<span class="fc-red">*</span>';
}
$out+='： </label> <div class="col-xs-10"> <input type="text" class="form-control" name="';
$out+=$escape(fieldId);
$out+='" value="';
$out+=$escape(fieldValue?fieldValue:'');
$out+='" placeholder="';
$out+=$escape(fieldTooltip?fieldTooltip:'请输入单行文本');
$out+='"> </div> </div> </div> ';
}else if(fieldType==2){
$out+=' <div class="col-xs-12 form-item " data-type="2" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label"> ';
$out+=$escape(fieldTitle?fieldTitle:'多行文本');
if(requiredType==1){
$out+='<span class="fc-red">*</span>';
}
$out+='： </label> <div class="col-xs-10"> <textarea type="text" class="form-control" name="';
$out+=$escape(fieldId);
$out+='" placeholder="';
$out+=$escape(fieldTooltip?fieldTooltip:'请输入多行文本');
$out+='">';
$out+=$escape(fieldValue?fieldValue:'');
$out+='</textarea> </div> </div> </div> ';
}else if(fieldType==3){
$out+=' <div class="col-xs-12 form-item " data-type="3" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label"> ';
$out+=$escape(fieldTitle?fieldTitle:'日期');
if(requiredType==1){
$out+='<span class="fc-red">*</span>';
}
$out+='： </label> <div class="col-xs-10"> <div class="input-group"> <input type="text" class="form-control" name="';
$out+=$escape(fieldId);
$out+='" placeholder="';
$out+=$escape(fieldTooltip?fieldTooltip:'请选择日期');
$out+='" readonly="" onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" value="';
$out+=$escape(fieldValue?fieldValue:'');
$out+='"> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> </div> </div> ';
}else if(fieldType==4){
$out+=' <div class="col-xs-12 form-item " data-type="4" > <div class="form-group"> <label class="col-xs-2 control-label"> ';
$out+=$escape(fieldTitle?fieldTitle:'开始时间');
if(requiredType==1){
$out+='<span class="fc-red">*</span>';
}
$out+='： </label> <div class="col-xs-4" data-type="4" data-field-id="';
$out+=$escape(fieldId);
$out+='" data-format-type="';
$out+=$escape(dateFormatType);
$out+='" data-value="';
$out+=$escape(fieldValue?fieldValue:'');
$out+='"> <div class="row">  <div class="';
$out+=$escape(dateFormatType==1?'col-24-xs-24':'col-24-xs-13 p-r-none');
$out+=' time-box"> <div class="input-group"> <input type="text" class="form-control start-time" name="';
$out+=$escape(fieldId);
$out+='" placeholder="';
$out+=$escape(fieldTooltip?fieldTooltip:'请选择日期');
$out+='" readonly="" onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" value=""> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> <div class="col-24-xs-5 p-l-xs p-r-none time-hh" style="';
$out+=$escape(dateFormatType==1 || dateFormatType==3?'display: none;':'');
$out+='"> <select class="form-control no-padding" name="item_select"> <option value="01">01</option> <option value="02">02</option> <option value="03">03</option> <option value="04">04</option> <option value="05">05</option> <option value="06">06</option> <option value="07">07</option> <option value="08">08</option> <option value="09" selected>09</option> <option value="10">10</option> <option value="11">11</option> <option value="12">12</option> <option value="13">13</option> <option value="14">14</option> <option value="15">15</option> <option value="16">16</option> <option value="17">17</option> <option value="18">18</option> <option value="19">19</option> <option value="20">20</option> <option value="21">21</option> <option value="22">22</option> <option value="23">23</option> <option value="24">24</option> </select> </div> <div class="col-24-xs-6 p-l-xs time-mm" style="';
$out+=$escape(dateFormatType==1 || dateFormatType==3?'display: none;':'');
$out+='"> <select class="form-control no-padding" name="item_select"> <option value="00">00</option> <option value="30">30</option> </select> </div> <div class="col-24-xs-11 p-l-xs am-pm" style="';
$out+=$escape(dateFormatType==1 || dateFormatType==2?'display: none;':'');
$out+='"> <select class="form-control no-padding" name="item_select"> <option value="上午">上午</option> <option value="下午">下午</option> </select> </div> </div> </div> <label class="col-xs-2 control-label"> ';
$out+=$escape(fieldTitle2?fieldTitle2:'结束时间');
if(requiredType==1){
$out+='<span class="fc-red">*</span>';
}
$out+='： </label> <div class="col-xs-4" data-type="4" data-field-id="';
$out+=$escape(fieldId2);
$out+='"> <div class="row"> <div class="';
$out+=$escape(dateFormatType==1?'col-24-xs-24':'col-24-xs-13 p-r-none');
$out+=' time-box" data-format-type="';
$out+=$escape(dateFormatType);
$out+='" data-value="';
$out+=$escape(fieldValue2?fieldValue2:'');
$out+='"> <div class="input-group"> <input type="text" class="form-control end-time" name="';
$out+=$escape(fieldId2);
$out+='" placeholder="';
$out+=$escape(fieldTooltip2?fieldTooltip2:'请选择日期');
$out+='" readonly="" onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" value=""> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> <div class="col-24-xs-5 p-l-xs p-r-none time-hh" style="';
$out+=$escape(dateFormatType==1 || dateFormatType==3?'display: none;':'');
$out+='"> <select class="form-control no-padding" name="item_select"> <option value="01">01</option> <option value="02">02</option> <option value="03">03</option> <option value="04">04</option> <option value="05">05</option> <option value="06">06</option> <option value="07">07</option> <option value="08">08</option> <option value="09" selected>09</option> <option value="10">10</option> <option value="11">11</option> <option value="12">12</option> <option value="13">13</option> <option value="14">14</option> <option value="15">15</option> <option value="16">16</option> <option value="17">17</option> <option value="18">18</option> <option value="19">19</option> <option value="20">20</option> <option value="21">21</option> <option value="22">22</option> <option value="23">23</option> <option value="24">24</option> </select> </div> <div class="col-24-xs-6 p-l-xs time-mm" style="';
$out+=$escape(dateFormatType==1 || dateFormatType==3?'display: none;':'');
$out+='"> <select class="form-control no-padding" name="item_select"> <option value="00">00</option> <option value="30">30</option> </select> </div> <div class="col-24-xs-11 p-l-xs am-pm" style="';
$out+=$escape(dateFormatType==1 || dateFormatType==2?'display: none;':'');
$out+='"> <select class="form-control no-padding" name="item_select"> <option value="上午">上午</option> <option value="下午">下午</option> </select> </div> </div> </div> </div> </div> ';
}else if(fieldType==5){
$out+=' <div class="col-xs-12 form-item " data-type="5" data-key="';
$out+=$escape(itemKey);
$out+='" data-field-id="';
$out+=$escape(fieldId);
$out+='" data-statistics="';
$out+=$escape(isStatistics?isStatistics:'');
$out+='" data-statistical-condition="';
$out+=$escape(statisticalCondition?statisticalCondition:'');
$out+='" data-field-unit="';
$out+=$escape(fieldUnit?fieldUnit:'');
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label"> ';
$out+=$escape(fieldTitle?fieldTitle:'数字');
if(requiredType==1){
$out+='<span class="fc-red">*</span>';
}
$out+='： </label> <div class="col-xs-10"> <div class="input-group full-width"> <input type="text" class="form-control" name="';
$out+=$escape(fieldId);
$out+='" placeholder="';
$out+=$escape(fieldTooltip?fieldTooltip:'请输入数字');
$out+='" value="';
$out+=$escape(fieldValue?fieldValue:'');
$out+='"> ';
if(fieldUnit!=null && fieldUnit!=''){
$out+=' <span class="input-group-addon "> ';
$out+=$escape(fieldUnit);
$out+=' </span> ';
}
$out+=' </div> </div> </div> </div> ';
}else if(fieldType==6){
$out+=' <div class="col-xs-12 form-item " data-type="6" data-key="';
$out+=$escape(itemKey);
$out+='" data-field-id="';
$out+=$escape(fieldId);
$out+='" data-field-value-type="';
$out+=$escape(fieldSelectValueType);
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label"> ';
$out+=$escape(fieldTitle?fieldTitle:'下拉列表');
if(requiredType==1){
$out+='<span class="fc-red">*</span>';
}
$out+='： </label> <div class="col-xs-10"> <select name="';
$out+=$escape(fieldId);
$out+='"> ';
if(fieldSelectedValueList && fieldSelectedValueList.length>0 && fieldSelectedValueList[0].child!=null){
$out+=' ';
$each(fieldSelectedValueList,function(p,$index){
$out+=' <optgroup data-select2-id="';
$out+=$escape(p.id);
$out+='" label="';
$out+=$escape(p.name);
$out+='"> ';
if(p.child!=null && p.child.length>0){
$out+=' ';
$each(p.child,function(c,$index){
$out+=' ';
if(fieldValue==c.id){
$out+=' <option value="';
$out+=$escape(c.id);
$out+='" selected>';
$out+=$escape(c.name==null?c.selectableName:c.name);
$out+='</option> ';
}else{
$out+=' <option value="';
$out+=$escape(c.id);
$out+='">';
$out+=$escape(c.name==null?c.selectableName:c.name);
$out+='</option> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </optgroup> ';
});
$out+=' ';
}else{
$out+=' ';
if(fieldTooltip && fieldTooltip!=''){
$out+=' <option value="">';
$out+=$escape(fieldTooltip);
$out+='</option> ';
}
$out+=' ';
$each(fieldSelectedValueList,function(o,$index){
$out+=' ';
if(fieldValue==o.id){
$out+=' <option value="';
$out+=$escape(o.id);
$out+='" selected>';
$out+=$escape(o.name==null?o.selectableName:o.name);
$out+='</option> ';
}else{
$out+=' <option value="';
$out+=$escape(o.id);
$out+='">';
$out+=$escape(o.name==null?o.selectableName:o.name);
$out+='</option> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </select> </div> </div> </div> ';
}else if(fieldType==7){
$out+=' <div class="col-xs-12 form-item " data-type="7" data-key="';
$out+=$escape(itemKey);
$out+='" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label"> ';
$out+=$escape(fieldTitle?fieldTitle:'单选框');
if(requiredType==1){
$out+='<span class="fc-red">*</span>';
}
$out+='： </label> <div class="col-xs-10"> ';
if(fieldSelectedValueList && fieldSelectedValueList.length>0){
$out+=' ';
$each(fieldSelectedValueList,function(o,$index){
$out+=' <div class="';
$out+=$escape(arrangeType==1?'pull-left':'');
$out+=' m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(fieldValue && fieldValue==o.id){
$out+=' <input type="radio" name="';
$out+=$escape(fieldId?fieldId:'optional');
$out+='" value="';
$out+=$escape(o.id);
$out+='" checked/> ';
}else{
$out+=' <input type="radio" name="';
$out+=$escape(fieldId?fieldId:'optional');
$out+='" value="';
$out+=$escape(o.id);
$out+='"/> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(o.name==null?o.selectableName:o.name);
$out+='</span> </label> </div> ';
});
$out+=' ';
}
$out+=' </div> </div> </div> ';
}else if(fieldType==8){
$out+=' <div class="col-xs-12 form-item " data-type="8" data-key="';
$out+=$escape(itemKey);
$out+='" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label"> ';
$out+=$escape(fieldTitle?fieldTitle:'复选框');
if(requiredType==1){
$out+='<span class="fc-red">*</span>';
}
$out+='： </label> <div class="col-xs-10"> ';
if(fieldSelectedValueList && fieldSelectedValueList.length>0){
$out+=' ';
$each(fieldSelectedValueList,function(o,$index){
$out+=' <div class="';
$out+=$escape(arrangeType==1?'pull-left':'');
$out+=' m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(fieldValue && fieldValue.indexOf(o.id)>-1){
$out+=' <input type="checkbox" name="';
$out+=$escape(fieldId?fieldId:'optional');
$out+='" value="';
$out+=$escape(o.id);
$out+='" checked/> ';
}else{
$out+=' <input type="checkbox" name="';
$out+=$escape(fieldId?fieldId:'optional');
$out+='" value="';
$out+=$escape(o.id);
$out+='"/> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(o.name==null?o.selectableName:o.name);
$out+='</span> </label> </div> ';
});
$out+=' ';
}
$out+=' </div> </div> </div> ';
}else if(fieldType==9){
$out+=' <div class="col-xs-12 form-item " data-type="9" data-key="';
$out+=$escape(itemKey);
$out+='" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="form-group"> <div class="panel panel-default"> <div class="panel-body"> <form> <h4 class="title-line"> 明细(<span data-action="panelIndex">';
$out+=$escape(panelIndex?panelIndex:'1');
$out+='</span>) <a class="curp pull-right ';
$out+=$escape(panelIndex==null || panelIndex==1?'hide':'');
$out+='" href="javascript:void(0)" data-action="delItem" title="删除明细"> <i class="glyphicon glyphicon-remove fc-red"></i> </a> </h4> </form> </div> </div> <div class="col-xs-10 col-xs-offset-2"> <button class="btn btn-primary btn-sm" data-action="addItem" title="添加明细"><i class="fa fa-plus"></i>&nbsp;添加明细</button> </div> </div> </div> ';
}else if(fieldType=='panelBody9'){
$out+=' <div class="panel panel-default"> <div class="panel-body"> <form> <h4 class="title-line"> 明细(<span data-action="panelIndex">';
$out+=$escape(panelIndex?panelIndex:'1');
$out+='</span>) <a class="curp pull-right ';
$out+=$escape(panelIndex==null || panelIndex==1?'hide':'');
$out+='" href="javascript:void(0)" data-action="delItem" title="删除明细"> <i class="glyphicon glyphicon-remove fc-red"></i> </a> </h4> </form> </div> </div> ';
}else if(fieldType==10){
$out+=' <div class="col-xs-12 form-item " data-type="10" data-key="';
$out+=$escape(itemKey);
$out+='" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label">附件：</label> <div class="col-xs-10"> <div class="row"> <div class="col-md-12 m-b-xs"> <span id="showFileLoading"> </span> </div> <div class="col-md-12"> <span class="uploadmgrContainer"> </span> </div> </div> </div> </div> </div> ';
}else if(fieldType==12){
$out+=' <div class="col-xs-12 form-item " data-type="12" data-key="';
$out+=$escape(itemKey);
$out+='" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label">关联项目';
if(requiredType==1){
$out+='<span class="fc-red">*</span>';
}
$out+='：</label> <div class="col-xs-10"> <select name="';
$out+=$escape(fieldId);
$out+='"> ';
if(fieldTooltip && fieldTooltip!=''){
$out+=' <option value="">';
$out+=$escape(fieldTooltip);
$out+='</option> ';
}else{
$out+=' <option value="">请选择关联项目</option> ';
}
$out+=' ';
if(fieldSelectedValueList && fieldSelectedValueList.length>0){
$out+=' ';
$each(fieldSelectedValueList,function(o,$index){
$out+=' ';
if(fieldValue==o.id){
$out+=' <option value="';
$out+=$escape(o.id);
$out+='" selected>';
$out+=$escape(o.name);
$out+='</option> ';
}else{
$out+=' <option value="';
$out+=$escape(o.id);
$out+='">';
$out+=$escape(o.name);
$out+='</option> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </select> </div> </div> </div> ';
}else if(fieldType==11){
$out+=' <div class="col-xs-12 form-item " data-type="11" data-key="';
$out+=$escape(itemKey);
$out+='" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label">关联审批';
if(requiredType==1){
$out+='<span class="fc-red">*</span>';
}
$out+='：</label> <div class="col-xs-10"> <select name="';
$out+=$escape(fieldId);
$out+='"> ';
if(fieldTooltip && fieldTooltip!=''){
$out+=' <option value="">';
$out+=$escape(fieldTooltip);
$out+='</option> ';
}else{
$out+=' <option value="">请选择关联审批</option> ';
}
$out+=' ';
if(fieldSelectedValueList && fieldSelectedValueList.length>0){
$out+=' ';
$each(fieldSelectedValueList,function(o,$index){
$out+=' ';
if(fieldValue==o.id){
$out+=' <option value="';
$out+=$escape(o.id);
$out+='" selected>';
$out+=$escape(o.name);
$out+='</option> ';
}else{
$out+=' <option value="';
$out+=$escape(o.id);
$out+='">';
$out+=$escape(o.name);
$out+='</option> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </select> </div> </div> </div> ';
}else if(fieldType==13){
$out+=' <div class="col-xs-12 form-item " data-type="13" data-key="';
$out+=$escape(itemKey);
$out+='" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label"> ';
$out+=$escape(fieldTitle?fieldTitle:'纯文本');
$out+=' </label> <div class="col-xs-10"> </div> </div> </div> ';
}else if(fieldType==14){
$out+=' <div class="col-xs-12 form-item " data-type="14" data-key="';
$out+=$escape(itemKey);
$out+='" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="hr-line-dashed m-t-none m-b-sm"></div> </div> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_form_template/m_form_template_item_property',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,itemKey=$data.itemKey,type=$data.type,formFieldInfo=$data.formFieldInfo,$each=$utils.$each,o=$data.o,i=$data.i,auditPropertyList=$data.auditPropertyList,p=$data.p,$index=$data.$index,$out='';$out+='<div class="item-property" data-key="';
$out+=$escape(itemKey);
$out+='" data-type="';
$out+=$escape(type);
$out+='" data-control="singleText"> <input type="hidden" name="dataType" value="';
$out+=$escape(type);
$out+='"/> <input type="hidden" name="itemKey" value="';
$out+=$escape(itemKey);
$out+='"/> ';
if(type!=9 && type!=10 && type!=14 && type!=11 && type!=12){
$out+=' <div class="form-group"> <label>标题';
$out+=$escape(type==4?'1':'');
$out+='</label> <input placeholder="请输入标题';
$out+=$escape(type==4?'1':'');
$out+='" class="form-control" type="text" name="fieldTitle" value="';
$out+=$escape(formFieldInfo?formFieldInfo.fieldTitle:'');
$out+='" maxlength="10"> </div> ';
}
$out+=' ';
if(type!=7 && type!=8 && type!=9 && type!=10 && type!=14 && type!=13 && type!=14){
$out+=' <div class="form-group"> <label>提示文字';
$out+=$escape(type==4?'1':'');
$out+='</label> <input placeholder="请输入提示文字';
$out+=$escape(type==4?'1':'');
$out+='" class="form-control" type="text" name="fieldTooltip" value="';
$out+=$escape(formFieldInfo?formFieldInfo.fieldTooltip:'');
$out+='"> </div> ';
}
$out+=' ';
if(type==4){
$out+=' <div class="form-group"> <label>标题2</label> <input placeholder="请输入标题2" class="form-control" type="text" name="fieldTitle2" value="';
$out+=$escape(formFieldInfo?formFieldInfo.fieldTitle2:'');
$out+='"> </div> <div class="form-group"> <label>提示文字2</label> <input placeholder="请输入提示文字2" class="form-control" type="text" name="fieldTooltip2" value="';
$out+=$escape(formFieldInfo?formFieldInfo.fieldTooltip2:'');
$out+='"> </div> <div class="form-group pt-relative"> <label>日期类型</label> <div class="row"> <div class="col-xs-12"> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo.dateType==null || (formFieldInfo && formFieldInfo.dateType==1)){
$out+=' <input type="radio" name="dateType" value="1" checked/> ';
}else{
$out+=' <input type="radio" name="dateType" value="1"/> ';
}
$out+=' <span class="i-checks-span">年/月/日</span> </label> </div> <div class="col-xs-12"> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo && formFieldInfo.dateType==2){
$out+=' <input type="radio" name="dateType" value="2" checked/> ';
}else{
$out+=' <input type="radio" name="dateType" value="2"/> ';
}
$out+=' <span class="i-checks-span">年/月/日 时:分</span> </label> </div> <div class="col-xs-12"> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo && formFieldInfo.dateType==3){
$out+=' <input type="radio" name="dateType" value="3" checked/> ';
}else{
$out+=' <input type="radio" name="dateType" value="3"/> ';
}
$out+=' <span class="i-checks-span">年/月/日 上午&下午</span> </label> </div> </div> </div> ';
}
$out+=' ';
if(type==5){
$out+=' <div class="form-group"> <label>单位</label> <input placeholder="请输入单位" class="form-control" type="text" name="fieldUnit" value="';
$out+=$escape(formFieldInfo?formFieldInfo.fieldUnit:'');
$out+='"> </div> ';
if(formFieldInfo.isShowStatistics==1){
$out+=' <div class="form-group"> <label>是否参与统计</label> <div class=""> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo&&formFieldInfo.isStatistics==1){
$out+=' <input type="checkbox" name="isStatistics" value="1" checked/> ';
}else{
$out+=' <input type="checkbox" name="isStatistics" value="1"/> ';
}
$out+=' <span class="i-checks-span">参与统计</span> </label> </div> </div> ';
}
$out+=' <div class="form-group"> <label>是否需要财务拨款</label> <div class=""> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo && formFieldInfo.isFinanceStatistics==1){
$out+=' <input type="checkbox" name="isFinanceStatistics" value="1" checked/> ';
}else{
$out+=' <input type="checkbox" name="isFinanceStatistics" value="1"/> ';
}
$out+=' <span class="i-checks-span">是</span> </label> </div> </div> ';
}
$out+=' ';
if(type==6){
$out+=' <div class="form-group pt-relative"> <label>可选项</label> <div class="row"> <div class="col-xs-12"> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo && formFieldInfo&&formFieldInfo.optional==1){
$out+=' <input type="radio" name="optional" value="1" checked/> ';
}else{
$out+=' <input type="radio" name="optional" value="1"/> ';
}
$out+=' <span class="i-checks-span">财务设置中的报销类型<i class="glyphicon glyphicon-info-sign fc-dark-blue m-l-xs"></i></span> </label> </div> <div class="col-xs-12"> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo && formFieldInfo.optional==2){
$out+=' <input type="radio" name="optional" value="2" checked/> ';
}else{
$out+=' <input type="radio" name="optional" value="2"/> ';
}
$out+=' <span class="i-checks-span">财务设置中的费用类型<i class="glyphicon glyphicon-info-sign fc-dark-blue m-l-xs"></i></span> </label> </div> <div class="col-xs-12"> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo && formFieldInfo.optional==3){
$out+=' <input type="radio" name="optional" value="3" checked/> ';
}else{
$out+=' <input type="radio" name="optional" value="3"/> ';
}
$out+=' <span class="i-checks-span">系统中的请假类型<i class="glyphicon glyphicon-info-sign fc-dark-blue m-l-xs"></i></span> </label> </div> <div class="col-xs-12"> <label class="i-checks i-checks-label fw-normal"> ';
if((formFieldInfo && (formFieldInfo.optional==null || formFieldInfo.optional==0)) || formFieldInfo==null){
$out+=' <input type="radio" name="optional" value="0" checked/> ';
}else{
$out+=' <input type="radio" name="optional" value="0"/> ';
}
$out+=' <span class="i-checks-span">自定义添加</span> </label> </div> </div> <div class="select-item" style="';
$out+=$escape(((formFieldInfo && (formFieldInfo.optional==null || formFieldInfo.optional==0)) || formFieldInfo==null)?'display: block;':'display: none;');
$out+='"> <button class="btn btn-link absolute-top-right" data-action="addSelectItem" style="top:108px;right: -7px;"><i class="fa fa-plus"></i></button> <div class="row m-b-xs" data-type="optional"> <div class="col-xs-11"> <input placeholder="选项1" class="form-control" type="text" name="iptOptional" value="';
$out+=$escape(formFieldInfo&& formFieldInfo.iptOptional && formFieldInfo.iptOptional.length>0?formFieldInfo.iptOptional[0]:'');
$out+='"> </div> <div class="col-xs-1 no-padding" style="display: none;"> <button class="btn btn-link p-h-xxs" data-action="delSelectItem"><i class="glyphicon glyphicon-remove"></i></button> </div> </div> <div class="row m-b-xs" data-type="optional"> <div class="col-xs-11"> <input placeholder="选项2" class="form-control" type="text" name="iptOptional" value="';
$out+=$escape(formFieldInfo && formFieldInfo.iptOptional && formFieldInfo.iptOptional.length>1?formFieldInfo.iptOptional[1]:'');
$out+='"> </div> <div class="col-xs-1 no-padding"> <button class="btn btn-link p-h-xxs" data-action="delSelectItem"><i class="glyphicon glyphicon-remove"></i></button> </div> </div> ';
if(formFieldInfo && formFieldInfo.iptOptional && formFieldInfo.iptOptional.length>2){
$out+=' ';
$each(formFieldInfo.iptOptional,function(o,i){
$out+=' ';
if(i>1){
$out+=' <div class="row m-b-xs" data-type="optional"> <div class="col-xs-11"> <input placeholder="选项';
$out+=$escape(i);
$out+='" class="form-control" type="text" name="iptOptional" value="';
$out+=$escape(o);
$out+='"> </div> <div class="col-xs-1 no-padding"> <button class="btn btn-link p-h-xxs" data-action="delSelectItem"><i class="glyphicon glyphicon-remove"></i></button> </div> </div> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </div> </div> <div class="form-group"> <label>是否作为收支明细的分类</label> <div class=""> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo && formFieldInfo.isFeeType==1){
$out+=' <input type="checkbox" name="isFeeType" value="1" checked/> ';
}else{
$out+=' <input type="checkbox" name="isFeeType" value="1"/> ';
}
$out+=' <span class="i-checks-span">是</span> </label> </div> </div> ';
}
$out+=' ';
if(type==7 || type==8){
$out+=' <div class="form-group pt-relative"> <label>可选项</label> <button class="btn btn-link absolute-top-right" data-action="addSelectItem" style="top:-8px;right: -7px;"><i class="fa fa-plus"></i></button> <div class="row m-b-xs" data-type="optional"> <div class="col-xs-11"> <input placeholder="选项1" class="form-control" type="text" name="iptOptional" value="';
$out+=$escape(formFieldInfo && formFieldInfo.iptOptional && formFieldInfo.iptOptional.length>0?formFieldInfo.iptOptional[0]:'');
$out+='"> </div> <div class="col-xs-1 no-padding" style="display: none;"> <button class="btn btn-link p-h-xxs" data-action="delSelectItem"><i class="glyphicon glyphicon-remove"></i></button> </div> </div> <div class="row m-b-xs" data-type="optional"> <div class="col-xs-11"> <input placeholder="选项2" class="form-control" type="text" name="iptOptional" value="';
$out+=$escape(formFieldInfo && formFieldInfo.iptOptional && formFieldInfo.iptOptional.length>1?formFieldInfo.iptOptional[1]:'');
$out+='"> </div> <div class="col-xs-1 no-padding"> <button class="btn btn-link p-h-xxs" data-action="delSelectItem"><i class="glyphicon glyphicon-remove"></i></button> </div> </div> ';
if(formFieldInfo && formFieldInfo.iptOptional && formFieldInfo.iptOptional.length>2){
$out+=' ';
$each(formFieldInfo.iptOptional,function(o,i){
$out+=' ';
if(i>1){
$out+=' <div class="row m-b-xs" data-type="optional"> <div class="col-xs-11"> <input placeholder="选项';
$out+=$escape(i);
$out+='" class="form-control" type="text" name="iptOptional" value="';
$out+=$escape(o);
$out+='"> </div> <div class="col-xs-1 no-padding"> <button class="btn btn-link p-h-xxs" data-action="delSelectItem"><i class="glyphicon glyphicon-remove"></i></button> </div> </div> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </div> <div class="form-group pt-relative"> <label>排列方式</label> <div> <label class="i-checks i-checks-label fw-normal m-r-sm"> ';
if(formFieldInfo.arrangeType==null || (formFieldInfo&&formFieldInfo.arrangeType==1)){
$out+=' <input type="radio" name="arrangeType" value="1" checked/> ';
}else{
$out+=' <input type="radio" name="arrangeType" value="1"/> ';
}
$out+=' <span class="i-checks-span">横向</span> </label> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo&&formFieldInfo.arrangeType==2){
$out+=' <input type="radio" name="arrangeType" value="2" checked/> ';
}else{
$out+=' <input type="radio" name="arrangeType" value="2" /> ';
}
$out+=' <span class="i-checks-span">纵向</span> </label> </div> </div> ';
}
$out+=' ';
if(type==11){
$out+=' <div class="form-group pt-relative"> <label>审批属性</label> <div class="row"> ';
$each(auditPropertyList,function(p,$index){
$out+=' <div class="col-xs-12"> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo && formFieldInfo.approvalAttr!=null && formFieldInfo.approvalAttr.indexOf(p.id)>-1){
$out+=' <input type="checkbox" name="approvalAttr" value="';
$out+=$escape(p.id);
$out+='" checked/> ';
}else{
$out+=' <input type="checkbox" name="approvalAttr" value="';
$out+=$escape(p.id);
$out+='"/> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(p.name);
$out+='</span> </label> </div> ';
});
$out+=' <!--<div class="col-xs-12"> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo && formFieldInfo.approvalAttr!=null && formFieldInfo.approvalAttr.indexOf('1')>-1){
$out+=' <input type="checkbox" name="approvalAttr" value="1" checked/> ';
}else{
$out+=' <input type="checkbox" name="approvalAttr" value="1"/> ';
}
$out+=' <span class="i-checks-span">报销</span> </label> </div> <div class="col-xs-12"> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo && formFieldInfo.approvalAttr!=null && formFieldInfo.approvalAttr.indexOf('2')>-1){
$out+=' <input type="checkbox" name="approvalAttr" value="2" checked /> ';
}else{
$out+=' <input type="checkbox" name="approvalAttr" value="2" /> ';
}
$out+=' <span class="i-checks-span">费用申请</span> </label> </div> <div class="col-xs-12"> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo && formFieldInfo.approvalAttr!=null && formFieldInfo.approvalAttr.indexOf('3')>-1){
$out+=' <input type="checkbox" name="approvalAttr" value="3" checked/> ';
}else{
$out+=' <input type="checkbox" name="approvalAttr" value="3" /> ';
}
$out+=' <span class="i-checks-span">请假</span> </label> </div> <div class="col-xs-12"> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo && formFieldInfo.approvalAttr!=null && formFieldInfo.approvalAttr.indexOf('4')>-1){
$out+=' <input type="checkbox" name="approvalAttr" value="4" checked/> ';
}else{
$out+=' <input type="checkbox" name="approvalAttr" value="4" /> ';
}
$out+=' <span class="i-checks-span">出差</span> </label> </div>--> </div> </div> ';
}
$out+=' ';
if(type==12){
$out+=' <div class="form-group pt-relative"> <label>项目属性</label> <div> <label class="i-checks i-checks-label fw-normal m-r-sm"> ';
if(formFieldInfo&&formFieldInfo.projectAttr==1){
$out+=' <input type="radio" name="projectAttr" value="1" checked/> ';
}else{
$out+=' <input type="radio" name="projectAttr" value="1" /> ';
}
$out+=' <span class="i-checks-span">我参与的项目</span> </label> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo&&formFieldInfo.projectAttr==2){
$out+=' <input type="radio" name="projectAttr" value="2" checked/> ';
}else{
$out+=' <input type="radio" name="projectAttr" value="2"/> ';
}
$out+=' <span class="i-checks-span">所有项目</span> </label> </div> </div> ';
}
$out+=' ';
if(type!=9 && type!=10 && type!=14 && type!=13 && type!=14){
$out+=' <div class="form-group"> <label>是否必填</label> <div class=""> <label class="i-checks i-checks-label fw-normal"> ';
if(formFieldInfo&&formFieldInfo.requiredType==1){
$out+=' <input type="checkbox" name="requiredType" value="1" checked/> ';
}else{
$out+=' <input type="checkbox" name="requiredType" value="1"/> ';
}
$out+=' <span class="i-checks-span">必填</span> </label> </div> </div> ';
}
$out+=' ';
if(type==9 || type==10 || type==14){
$out+=' <div> 该控件无属性 </div> ';
}
$out+=' </div>';
return new String($out);
});/*v:1*/
template('m_form_template/m_form_template_preview',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataInfo=$data.dataInfo,$escape=$utils.$escape,fieldId=$data.fieldId,$out='';$out+='<div class="m-form-template-preview p-sm overflow-y-auto m-dialog-resize"> <form class="form-horizontal"> ';
if(dataInfo && dataInfo.isSystem!=1){
$out+=' <div class="col-xs-12 form-item " data-type="2" data-field-id="';
$out+=$escape(fieldId);
$out+='"> <div class="form-group"> <label class="col-xs-2 control-label"> 申请人<span class="fc-red">*</span>： </label> <div class="col-xs-10"> <select class="form-control" name="applyUserId"></select> </div> </div> <div class="form-group"> <label class="col-xs-2 control-label"> 部门<span class="fc-red">*</span>： </label> <div class="col-xs-10"> <select class="form-control" name="departId"></select> </div> </div> </div> ';
}
$out+=' </form> </div> ';
return new String($out);
});/*v:1*/
template('m_form_template/m_form_template_project',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,doType=$data.doType,$out='';$out+='<div class="ibox m-projectBasicInfo min-h"> <div class="ibox-content p-b-none no-borders no-padding"> <form class="sky-form no-margins"> <div class="row"> <div class="col-md-6"> <h4> 基本信息 </h4> </div> <div class="col-md-6 text-right"> </div> </div> <table class="table table-bordered m-b-xs"> <tbody> <tr> <td width="12%"><b>项目名称</b></td> <td width="37%"> <input type="text" class="form-control input-sm p-r-md" placeholder="请输入项目名称" value="" name="projectName"> </td> <td width="12%"><b>立项时间</b></td> <td> <div class="input-group" > <input type="text" class="form-control input-sm " placeholder="立项时间" onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" readonly="" value=""> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().focus();"> <i class="icon-sm icon-append fa fa-calendar" style="height: 28px;line-height: 28px;"></i> </span> </div> </td> </tr> <tr> <td><b>项目编号</b></td> <td> <input type="text" class="form-control input-sm p-r-md" placeholder="请输入项目编号" value="" name="projectNo"> </td> <td><b>立项组织</b></td> <td> <select class="form-control" name="projectCreator"></select> </td> </tr> <tr> <td><b>项目状态</b></td> <td> <select class="form-control" name="status"></select> </td> <td><b>立项人</b></td> <td>--</td> </tr> <tr> <td><b>甲方</b></td> <td> <input type="text" class="form-control input-sm p-r-md" placeholder="请输入甲方名称" value="" name="constructCompanyName"> </td> <td><b>乙方</b></td> <td> <select class="form-control" name="companyBid"></select> </td> </tr> <tr> <td><b>项目地点</b></td> <td colspan="3"> <input type="text" class="form-control input-sm p-r-md" placeholder="请输入项目地点" value="" > </td> </tr> </tbody> </table> ';
if(doType=='projectSetUp'){
$out+=' <div class="row"> <div class="col-md-6"> <h4 class="pull-left">项目信息</h4> <a href="javascript:void(0)" class="designRangeEditBtn pull-left m-t-xs m-l-sm" data-action="editDesignRange"> <i class=" fa fa-pencil fc-dark-blue"></i> </a> </div> </div> <table class="table table-bordered m-b-xs"> <tbody> <tr> <td><b>设计分类</b></td> <td> <div class="input-group"> <input type="text" class="form-control" name="projectType" value="" placeholder="请输入设计分类"> <div class="input-group-btn"> <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button> <ul class="dropdown-menu dropdown-menu-right" style="right: 0;left: inherit;"> <li><a href="javascript:void(0);" data-id="67b460467d5d4506885b3807acef1105" data-name="城乡规划设计">城乡规划设计</a></li> </ul> </div> </div> </td> <td><b>功能分类</b></td> <td> <a href="javascript:void(0);" class="editable editable-click" data-action="edit_builtType"> <span class="fc-v1-grey">未设置</span> </a> </td> </tr> <tr> <td width="12%"><b>基地面积</b></td> <td width="37%"> <input type="text" class="form-control input-sm p-r-md dp-inline-block" placeholder="请输入" value="" name="propertyField" style="width: 90%;"/> <span class="unit-span">m²</span> </td> <td width="12%"><b>容积率</b></td> <td> <input type="text" class="form-control input-sm p-r-md dp-inline-block" placeholder="请输入" value="" name="propertyField" style="width: 90%;"/> </td> </tr> <tr> <td width="12%"><b>总建筑面积</b></td> <td width="37%"> <span> <input type="text" class="form-control input-sm p-r-md dp-inline-block" placeholder="请输入" value="" name="propertyField" style="width: 90%;"/> <span class="unit-span">m&sup2;</span> </span> </td> <td width="12%"><b>计容建筑面积</b></td> <td> <span> <input type="text" class="form-control input-sm p-r-md dp-inline-block" placeholder="请输入" value="" name="propertyField" style="width: 90%;"/> <span class="unit-span">m&sup2;</span> </span> </td> </tr> <tr> <td width="12%"><b>覆盖率</b></td> <td width="37%"> <span> <input type="text" class="form-control input-sm p-r-md dp-inline-block" placeholder="请输入" value="" name="propertyField" style="width: 90%;"/> <span class="unit-span">%</span> </span> </td> <td width="12%"><b>绿化率</b></td> <td> <span> <input type="text" class="form-control input-sm p-r-md dp-inline-block" placeholder="请输入" value="" name="propertyField" style="width: 90%;"/> <span class="unit-span">%</span> </span> </td> </tr> <tr> <td width="12%"><b>建筑高度</b></td> <td width="37%"> <span> <input type="text" class="form-control input-sm p-r-md dp-inline-block" placeholder="请输入" value="" name="propertyField" style="width: 90%;"/> <span class="unit-span">m</span> </span> </td> <td width="12%" class="p-l-none"><b>建筑层数(地上)</b></td> <td> <span> <input type="text" class="form-control input-sm p-r-md dp-inline-block" placeholder="请输入" value="" name="propertyField" style="width: 90%;"/> <span class="unit-span">层</span> </span> </td> </tr> <tr> <td width="12%" class="p-l-none"><b>建筑层数(地下)</b></td> <td width="37%"> <span> <input type="text" class="form-control input-sm p-r-md dp-inline-block" placeholder="请输入" value="" name="propertyField" style="width: 90%;"/> <span class="unit-span">层</span> </span> </td> <td width="12%"></td> <td></td> </tr> </tbody> </table> ';
}
$out+=' ';
if(doType=='projectSetUp'){
$out+=' <div class="row"> <div class="col-md-6"> <h4 class="pull-left">设计范围</h4> <a href="javascript:void(0)" class="designRangeEditBtn pull-left m-t-xs m-l-sm" data-action="editDesignRange"> <i class=" fa fa-pencil fc-dark-blue"></i> </a> </div> </div> <table class="table table-bordered m-b-xs"> <tbody> <tr> <td width="12%"><b>设计范围</b></td> <td colspan="3"> </td> </tr> </tbody> </table> ';
}
$out+=' ';
if(doType=='contractAudit'){
$out+=' <div class="row"> <div class="col-md-6"> <h4 class="pull-left"> 合同信息 </h4> </div> <div class="col-md-6 text-right p-b-xs"> </div> </div> <table class="table table-bordered m-b-xs"> <tbody> <tr> <td width="12%"> <b>合同附件</b> </td> <td colspan="3"> <a href="javascript:void(0)" id="filePicker" name="recordAttach" class="upload-icon" title="请上传PDF文件"></a> <note class="pt-relative vertical-sub" style="color: #777;bottom: 3px;" >请上传pdf文件！</note> </td> </tr> <tr> <td><b>合同签订</b></td> <td colspan="3"> <div class="input-group" > <input type="text" class="form-control input-sm " placeholder="合同签订" onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" readonly="" value=""> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().focus();"> <i class="icon-sm icon-append fa fa-calendar" style="height: 28px;line-height: 28px;"></i> </span> </div> </td> </tr> </tbody> </table> ';
}
$out+=' </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_form_template/m_form_template_settings',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,rootPath=$data.rootPath,_url=$helpers._url,title=$data.title,baseData=$data.baseData,subTitle=$data.subTitle,$each=$utils.$each,o=$data.o,i=$data.i,iconList=$data.iconList,p=$data.p,$out='';$out+='<div class="m-box m-form-template-settings white-bg navbar-static-top"> <div class="m-box-title"> <div class="fixed-title navbar-static-top" > <div class="col-xs-6 text-white"> <a href="';
$out+=$escape(rootPath);
$out+='" class="pull-left svg" target="_blank"> <object class="maoding-logo pt-relative max-h-35" data="';
$out+=$escape(_url('/img/logo_white.png'));
$out+='"></object> </a> <h3 class="pull-left">';
$out+=$escape(title);
$out+='</h3> </div> <div class="col-xs-6 text-right"> <button class="btn btn-primary border-fff" data-action="formPreview">预览</button> <button class="btn btn-default" data-action="save">保存</button> <button class="btn btn-default" data-action="saveAndEnable">保存并使用</button> <button class="btn btn-link text-white" data-action="close"><i class="glyphicon glyphicon-remove"></i></button> </div> </div> </div> <div class="m-box-content"> <div class="m-box-content-title"> <div class="col-24-xs-5 bg-v4-grey min-h-50"> <h4 class="p-l-xs p-t-sm">可选控件</h4> </div> <div class="col-24-xs-14 bg-v1-grey min-h-50"> <h4 class="p-t-sm text-center" id="formName">';
$out+=$escape(baseData.name?baseData.name:subTitle);
$out+='</h4> </div> <div class="col-24-xs-5 bg-v4-grey min-h-50"> <ul class="secondary-menu-ul"> <li class="active"><a href="javascript:void(0);" type="1">表单属性</a> </li> <li> <a href="javascript:void(0);" type="2">控件属性</a> </li> </div> </div> <div class="col-24-xs-5 bg-v3-grey" id="controlBox"> ';
if(baseData.optionalWidgetList && baseData.optionalWidgetList.length>0 ){
$out+=' ';
$each(baseData.optionalWidgetList,function(o,i){
$out+=' <div class="col-xs-5 bg-v2-grey p-sm m-sm border-dashed curp control-item" data-type="';
$out+=$escape(o.fieldType);
$out+='">';
$out+=$escape(o.fieldTitle);
$out+='<i class="icon iconfont ';
$out+=$escape(o.iconKey);
$out+=' pull-right"></i></div> ';
});
$out+=' ';
}
$out+='  </div> <div class="col-24-xs-14 no-padding" id="contentBox" style="overflow: auto;"> <form class="form-horizontal content-form m-md" id="selectedFieldBox" style="position: relative;"> </form> </div> <div class="col-24-xs-5 bg-v2-grey p-t-sm" id="propertyBox" > <form role="form" data-property-type="1"> <div class="form-group"> <label>审批单流程分类</label> <select class="form-control m-b" name="formType"> <option value="">请选择流程分类</option> ';
if(baseData.formGroupList && baseData.formGroupList.length>0){
$out+=' ';
$each(baseData.formGroupList,function(o,i){
$out+=' ';
if(baseData.formType==o.id){
$out+=' <option value="';
$out+=$escape(o.id);
$out+='" selected>';
$out+=$escape(o.groupName);
$out+='</option> ';
}else{
$out+=' <option value="';
$out+=$escape(o.id);
$out+='">';
$out+=$escape(o.groupName);
$out+='</option> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </select> </div> <div class="form-group"> <label>审批单名称</label> <input placeholder="请输入表单名称" class="form-control" type="text" name="formName" value="';
$out+=$escape(baseData.name?baseData.name:subTitle);
$out+='"> </div> <div class="form-group m-b-xs"> <label>审批单编号</label> <input placeholder="请输入审批单编号前缀" class="form-control" type="text" name="rulePrefixKey" value="';
$out+=$escape(baseData.rulePrefixKey);
$out+='"/> </div> <div class="form-group"> <span class="fc-v1-grey f-s-xs">*如报销申请编号前缀为BZ</span> </div> <div class="form-group"> <label>说明</label> <textarea placeholder="请输入表单说明" class="form-control" type="text" name="documentation">';
$out+=$escape(baseData.documentation);
$out+='</textarea> </div> <div class="form-group"> <label>图标</label> <div class="row"> <div class="col-xs-12 p-r-none"> ';
$each(iconList,function(p,i){
$out+=' <div class="pull-left m-b-sm m-r-sm"> <span class="icon-circle-out curp ';
$out+=$escape(i==0?'active':'');
$out+='"> <span class="icon-circle ';
$out+=$escape(p.color);
$out+='"><i class="icon iconfont ';
$out+=$escape(p.id);
$out+='" data-icon="';
$out+=$escape(p.id);
$out+='"></i></span> </span> </div> ';
});
$out+=' <div class="clearfix"></div> </div> </div> </div> </form> <form role="form" data-property-type="2" style="display: none;"> </form> </div> <div class="clearfix"></div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_historyData/m_historyData',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="ibox ibox-shadow m_historyData"> <div class="ibox-title border-no-t"> <div class="ibox-tools"> <div class="mt-element-step-new" style="margin-bottom: 30px;"> <div class="row step-line"> <div class="mt-step-desc"> </div> <div class="col-md-4 mt-step-col first active" data-step="1"> <div class="mt-step-number bg-white">1</div> <div class="mt-step-title uppercase font-grey-cascade">文件上传</div> <div class="mt-step-content font-grey-cascade">根据模板填充数据并上传</div> </div> <div class="col-md-4 mt-step-col" data-step="2"> <div class="mt-step-number bg-white">2</div> <div class="mt-step-title uppercase font-grey-cascade">数据预览</div> <div class="mt-step-content font-grey-cascade">预览并校验要导入的数据</div> </div> <div class="col-md-4 mt-step-col last" data-step="3"> <div class="mt-step-number bg-white">3</div> <div class="mt-step-title uppercase font-grey-cascade">导入完成</div> <div class="mt-step-content font-grey-cascade">提交最终处理后的数据</div> </div> </div> </div> </div> </div> <div class="ibox-content"> <div class="row step-container" style="margin-bottom: 150px;"> <div class="col-md-12 text-center" style="margin-bottom: 20px;"> <img src="';
$out+=$escape(_url('/img/default/without_exp.png'));
$out+='"> <p style="font-size:24px;">您需要准备好可导入的Excel文档和设置立项组织</p> <select id="selectOrg"></select> </div> <div class="col-md-12 text-center"> <button type="button" class="btn btn-outline btn-warning m-r-md" data-action="downloadTemplate">下载模板</button> <button type="button" class="btn btn-primary roleControl" roleCode="10000601" flag="2" data-action="uploadFile">上传文件</button> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_historyData/m_historyData_step2',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,msg=$data.msg,showSubmit=$data.showSubmit,list=$data.list,$each=$utils.$each,o=$data.o,i=$data.i,p=$data.p,t=$data.t,$out='';$out+='<div class="col-md-12"> <div class="alert alert-warning"> ';
$out+=$escape(msg);
$out+='&nbsp;&nbsp;<a href="javascript:void(0);" data-action="reImport">重新导入</a>';
if(showSubmit===true){
$out+=' <button type="button" class="btn btn-success btn-sm pull-right" data-action="submit" style="position: relative;top:-5px;">提交有效数据</button>';
}
$out+=' </div> </div> <div class="col-md-12"> <table class="footable table table-stripped toggle-arrow-tiny" data-page-size="10"> <thead> <tr> <th data-sort-ignore="true" data-toggle="true">项目编号</th> <th data-sort-ignore="true">项目名称</th> <th data-sort-ignore="true">立项组织</th> <th data-sort-ignore="true">立项人</th> <th data-sort-ignore="true">立项日期</th> <th data-sort-ignore="true" data-hide="all">合同签订日期</th> <th data-sort-ignore="true" data-hide="all">项目地点</th> <th data-sort-ignore="true" data-hide="all">项目状态</th> <th data-sort-ignore="true" data-hide="all">甲方</th> <th data-sort-ignore="true" data-hide="all">乙方</th> <th data-sort-ignore="true" data-hide="all">可导入</th> <th data-sort-ignore="true">可导入</th> <th data-sort-ignore="true" data-hide="all">项目详情</th> </tr> </thead> <tbody> ';
if(list&&list.length>0 ){
$out+=' ';
$each(list,function(o,i){
$out+=' <tr> <td>';
$out+=$escape(o.projectNo);
$out+='</td> <td>';
$out+=$escape(o.projectName);
$out+='</td> <td>';
$out+=$escape(o.creatorOrgName);
$out+='</td> <td>';
$out+=$escape(o.creatorUserName);
$out+='</td> <td>';
$out+=$escape(o.projectCreateDate);
$out+='</td> <td>';
$out+=$escape(o.contractDate);
$out+='</td> <td>';
$out+=$escape(o.province+' '+o.city+' '+o.detailAddress);
$out+='</td> <td>';
$out+=$escape(o.projectStatus);
$out+='</td> <td>';
$out+=$escape(o.aCompanyName);
$out+='</td> <td>';
$out+=$escape(o.bCompanyName);
$out+='</td> <td>';
if(o.valid===true){
$out+=' <span class="fc-v1-green">是</span> ';
}else{
$out+=' <span class="fc-v1-red">否，';
$out+=$escape(o.errorReason);
$out+='</span> ';
}
$out+=' </td> <td> ';
if(o.valid===true){
$out+=' <i class="fa fa-check fc-v1-green"></i> ';
}else{
$out+=' <span class="fc-v1-red">不可导入，';
$out+=$escape(o.errorReason);
$out+='</span> ';
}
$out+=' </td> <td> ';
$each(o.designContentList,function(p,t){
$out+=' <strong>';
$out+=$escape(p.contentName);
$out+=':</strong> ';
if(p.startDate!=null){
$out+=' <span>开始时间：';
$out+=$escape(p.startDate);
$out+=',&nbsp;</span> ';
}else{
$out+=' <span>开始时间：未设置,&nbsp;</span> ';
}
$out+=' ';
if(p.endDate!=null){
$out+=' <span>结束时间：';
$out+=$escape(p.endDate);
$out+=',&nbsp;</span> ';
}else{
$out+=' <span>结束时间：未设置,&nbsp;</span> ';
}
$out+=' <span>工期：';
$out+=$escape(p.periodString);
$out+='</span></br> ';
});
$out+=' </td> </tr> ';
});
$out+=' ';
}
$out+=' </tbody> <tfoot> <tr> <td colspan="11"> <ul class="pagination pull-right"></ul> </td> </tr> </tfoot> </table> </div>';
return new String($out);
});/*v:1*/
template('m_historyData/m_historyData_step3',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="col-md-12 text-center" style="margin-bottom: 20px;"> <img src="';
$out+=$escape(_url('/img/default/invite_success.png'));
$out+='"> <p style="font-size:24px;">恭喜你，导入成功！</p> </div>';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_cost_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,formView=$data.formView,$out='';$out+='<div class="m-form-template-generate-edit p-sm"> <form class="form-horizontal" id="fieldForm"> <div class="form-group"> <label class="col-xs-2 control-label"> 申请人<span class="fc-red">*</span>： </label> <div class="col-xs-10"> <select class="form-control" name="applyUserId"></select> </div> </div> <div class="form-group"> <label class="col-xs-2 control-label"> 部门<span class="fc-red">*</span>： </label> <div class="col-xs-10"> <select class="form-control" name="departId"></select> </div> </div> <div class="clearfix"></div> <div class="form-group"> <label class="col-sm-2 control-label">收款方<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <select class="form-control receiveName" name="enterpriseId" data-placeholder="请输入或选择收款方"/> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">付款方<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <select class="form-control payment-collection" name="fromCompanyId" data-placeholder="请输入或选择付款方"/> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">类型<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <select class="form-control" name="expAllName"></select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">用途说明：</label> <div class="col-sm-10"> <textarea placeholder="请输入付款事由" class="form-control" type="text" name="remark">';
$out+=$escape(dataInfo?dataInfo.remark:'');
$out+='</textarea> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">金额<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入付款金额" class="form-control" type="text" name="sumExpAmount" value="';
$out+=$escape(dataInfo?dataInfo.fee:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">付款方式：</label> <div class="col-sm-10"> <select class="form-control" name="expType"></select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">附件：</label> <div class="col-sm-10"> <div class="row"> <div class="col-md-12 m-b-xs"> <span id="showFileLoading"> </span> </div> <div class="col-md-12 m-b-sm"> <span class="uploadmgrContainer"> </span> </div> </div> </div> </div> ';
if(formView!=1){
$out+=' <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div id="approverOutBox"> </div> ';
}
$out+=' </form> </div> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_cost_add_approver',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,userList=$data.userList,$each=$utils.$each,u=$data.u,ui=$data.ui,$escape=$utils.$escape,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,$out='';if(userList!=null && userList.length>0){
$out+=' ';
$each(userList,function(u,ui){
$out+=' <div class="approver-outbox"> <div class="approver-box"> <div class="img-circle"> <img alt="image" class="img-circle" src="';
$out+=$escape(_isNullOrBlank(u.fileFullPath)?_url('/img/head_default.png'):u.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" height="30"> </div> <div class="m-t-xs text-ellipsis full-width" data-container="body" data-toggle="tooltip" data-original-title="';
$out+=$escape(u.userName);
$out+='">';
$out+=$escape(u.userName);
$out+='</div> </div> </div> ';
if(ui+1 < userList.length ){
$out+=' <div class="arrow-icon dp-inline-block vertical-top p-h-sm"> <i class="fa fa-long-arrow-right"></i> </div> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_cost_add_ccUser',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,userList=$data.userList,$each=$utils.$each,u=$data.u,ui=$data.ui,$escape=$utils.$escape,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,$out='';if(userList!=null && userList.length>0){
$out+=' ';
$each(userList,function(u,ui){
$out+=' <div class="approver-outbox"> <div class="approver-box pt-relative"> <div class="img-circle"> <img alt="image" class="img-circle" src="';
$out+=$escape(_isNullOrBlank(u.fileFullPath)?_url('/img/head_default.png'):u.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" height="30"> </div> <div class="m-t-xs text-ellipsis full-width">';
$out+=$escape(u.userName);
$out+='</div> <a href="javascript:void(0);" class="cc-remove" data-action="removeCcUser" data-i="';
$out+=$escape(ui);
$out+='" style="display: none;"><i class="glyphicon glyphicon-remove"></i></a> </div> </div> ';
});
$out+=' ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_cost_add_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,data=$data.data,dataInfo=$data.dataInfo,$each=$utils.$each,p=$data.p,$index=$data.$index,c=$data.c,d=$data.d,relationRecordData=$data.relationRecordData,$out='';$out+='<div class="panel panel-default"> <div class="panel-body"> <form> <h4 class="title-line"> ';
$out+=$escape(data.title);
$out+='明细(<span data-action="itemIndex">';
$out+=$escape(data.itemIndex);
$out+='</span>) ';
if(data.itemIndex>1){
$out+=' <a class="curp pull-right" href="javascript:void(0)" data-action="delItem" title="删除';
$out+=$escape(data.title);
$out+='明细"> <i class="glyphicon glyphicon-remove fc-red"></i> </a> ';
}
$out+=' </h4> <div class="form-group"> <label class="col-sm-2 control-label">';
$out+=$escape(data.title);
$out+='金额<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div class="input-group"> <input placeholder="请输入';
$out+=$escape(data.title);
$out+='金额" class="form-control" type="text" name="expAmount" value="';
$out+=$escape(dataInfo?dataInfo.expAmount:'');
$out+='"> <span class="input-group-addon">元</span> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">';
$out+=$escape(data.title);
$out+='类型<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <select class="form-control full-width" name="expType" > ';
$each(data.expTypeList,function(p,$index){
$out+=' <optgroup data-select2-id="';
$out+=$escape(p.parent.id);
$out+='" label="';
$out+=$escape(p.parent.name);
$out+='"> ';
if(p.child!=null && p.child.length>0){
$out+=' ';
$each(p.child,function(c,$index){
$out+=' ';
if(dataInfo && dataInfo.expType==c.id){
$out+=' <option value="';
$out+=$escape(c.id);
$out+='" selected>';
$out+=$escape(c.name);
$out+='</option> ';
}else{
$out+=' <option value="';
$out+=$escape(c.id);
$out+='">';
$out+=$escape(c.name);
$out+='</option> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </optgroup> ';
});
$out+=' </select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">用途说明<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <textarea placeholder="请输入用途说明" class="form-control" type="text" name="expUse">';
$out+=$escape(dataInfo?dataInfo.expUse:'');
$out+='</textarea> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">关联项目：</label> <div class="col-sm-10"> <select class="form-control full-width" name="projectName" > <option value="">请选择关联项目</option> ';
$each(data.projectList,function(p,$index){
$out+=' ';
if(dataInfo && dataInfo.projectId==p.id){
$out+=' <option value="';
$out+=$escape(p.id);
$out+='" selected>';
$out+=$escape(p.projectName);
$out+='</option> ';
}else{
$out+=' <option value="';
$out+=$escape(p.id);
$out+='">';
$out+=$escape(p.projectName);
$out+='</option> ';
}
$out+=' ';
});
$out+=' </select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">关联审批：</label> <div class="col-sm-10"> <select class="form-control full-width" name="linkageApproval" > ';
$each(data.auditList,function(d,$index){
$out+=' ';
if(relationRecordData && relationRecordData.id == d.id){
$out+=' <option value="';
$out+=$escape(d.id);
$out+='" selected>';
$out+=$escape(d.addressStr);
$out+='</option> ';
}else{
$out+=' <option value="';
$out+=$escape(d.id);
$out+='">';
$out+=$escape(d.addressStr);
$out+='</option> ';
}
$out+=' ';
});
$out+=' </select> </div> </div> </form> </div> </div>';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_cost_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,exp=$data.exp,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,doType=$data.doType,enterpriseName=$data.enterpriseName,$each=$utils.$each,detailList=$data.detailList,d=$data.d,i=$data.i,title=$data.title,_expNumberFilter=$helpers._expNumberFilter,totalExpAmount=$data.totalExpAmount,attachList=$data.attachList,a=$data.a,auditList=$data.auditList,s=$data.s,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,typeStr=$data.typeStr,ccCompanyUserList=$data.ccCompanyUserList,u=$data.u,ui=$data.ui,currentAuditPerson=$data.currentAuditPerson,currentCompanyUserId=$data.currentCompanyUserId,$out='';$out+='<form class="form-horizontal p-sm m-b-lg overflow-y-auto m-dialog-resize"> ';
if(exp && exp.expNo){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">审批编号：</label> <div class="col-24-xs-21"> ';
$out+=$escape(exp.expNo);
$out+=' </div> </div> ';
}
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">申请人：</label> <div class="col-24-xs-21"> ';
$out+=$escape(exp.submitter);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">申请时间：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_momentFormat(exp.submittime,'YYYY/MM/DD'));
$out+=' </div> </div> ';
if(exp.companyName){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">所在组织：</label> <div class="col-24-xs-21"> ';
$out+=$escape(exp.companyName);
$out+=' </div> </div> ';
}
$out+=' ';
if(exp.departName){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">部门：</label> <div class="col-24-xs-21"> ';
$out+=$escape(exp.departName);
$out+=' </div> </div> ';
}
$out+=' <h4 class="title-line m-l-sm">审批详情</h4> <div class="hr-line-dashed m-t-none m-b-sm"></div> ';
if(doType == 2){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">收款方：</label> <div class="col-24-xs-21"> ';
$out+=$escape(enterpriseName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">备注：</label> <div class="col-24-xs-21"> ';
$out+=$escape(exp.remark);
$out+=' </div> </div> ';
}
$out+=' ';
$each(detailList,function(d,i){
$out+=' <div class="panel panel-default"> <div class="panel-body"> <h4 class="title-line"> ';
$out+=$escape(title);
$out+='明细(<span data-action="itemIndex">';
$out+=$escape(i+1);
$out+='</span>) </h4> <div class="form-group"> <label class="col-24-xs-3 text-right">';
$out+=$escape(title);
$out+='金额：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_expNumberFilter(d.expAmount));
$out+=' 元 </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">';
$out+=$escape(title);
$out+='类型：</label> <div class="col-24-xs-21"> ';
$out+=$escape(d.expName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">用途说明：</label> <div class="col-24-xs-21"> ';
$out+=$escape(d.expUse);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">关联项目：</label> <div class="col-24-xs-21"> ';
$out+=$escape(d.projectName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">关联审批：</label> <div class="col-24-xs-21"> ';
if(d.relationRecordData!=null){
$out+=' ';
$out+=$escape(d.relationRecordData.address);
$out+=$escape(_momentFormat(d.relationRecordData.startTime,'YYYY/MM/DD'));
$out+=$escape(_momentFormat(d.relationRecordData.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> </div> </div> ';
});
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">';
$out+=$escape(title);
$out+='总金额：</label> <div class="col-24-xs-21"> <i class="fa fa-jpy"></i> <span id="expAmount">';
$out+=$escape(totalExpAmount);
$out+='</span>元 </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">附件：</label> <div class="col-24-xs-21"> ';
if(attachList!=null && attachList.length>0){
$out+=' ';
$each(attachList,function(a,i){
$out+=' <span class="label m-r-xs" style="background: #ecf0f1;padding: 5px 10px;"> <a href="javascript:void(0)" data-action="preview" data-file-ext="';
$out+=$escape(a.fileExtName);
$out+='" data-net-file-id="';
$out+=$escape(a.id);
$out+='" data-src="';
$out+=$escape(a.fileFullPath);
$out+='" data-name="';
$out+=$escape(a.fileName);
$out+='"> ';
$out+=$escape(a.fileName);
$out+=' </a> </span> ';
});
$out+=' ';
}
$out+=' </div> </div> <h4 class="title-line m-l-sm">审批流程</h4> <div class="hr-line-dashed m-t-none m-b-sm" ></div> <div class="form-group"> <div class="col-sm-12 p-w-md"> <table class="table table-hover table-bordered m-b-xs" > <thead> <tr> <th width="40%">审批</th> <th width="40%">操作</th> <th width="20%">审批时间</th> </tr> </thead> <tbody> ';
if(auditList!=null && auditList.length>0){
$out+=' ';
$each(auditList,function(s,i){
$out+=' <tr> <td> ';
if(_isNullOrBlank(s.fileFullPath)){
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30"/> ';
}else{
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(s.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" > ';
}
$out+=' <span class="dp-inline-block"> <p class="m-b-none">';
$out+=$escape(s.userName);
$out+='</p> <p class="m-b-none fc-v1-grey">';
$out+=$escape(s.companyName);
$out+='</p> </span> </td> <td> ';
if(s.approveStatus=='1'){
$out+=' <p class="text-success m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}else if(s.approveStatus=='2' || s.approveStatus=='3'){
$out+=' <p class="text-danger m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}else{
$out+=' <p class="m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}
$out+=' ';
if(s.approveStatusName=='发起申请' && !_isNullOrBlank(s.remark)){
$out+=' <p class="fc-v1-grey m-b-none">';
$out+=$escape(typeStr);
$out+='备注：';
$out+=$escape(s.remark);
$out+='</p> ';
}
$out+=' ';
if(s.approveStatusName=='退回'  && !_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">退回原因：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}else if(!_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">审批意见：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}
$out+=' </td> <td> ';
$out+=$escape(_momentFormat(s.approveDate,'YYYY/MM/DD'));
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr> <td colspan="3" class="text-center">暂无数据</td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
if(ccCompanyUserList!=null && ccCompanyUserList.length>0){
$out+=' <h4 class="title-line m-l-sm">抄送人</h4> <div class="hr-line-dashed m-t-none m-b-sm"></div> <div class="form-group"> <div class="col-sm-12 p-w-md approval-out-box"> ';
$each(ccCompanyUserList,function(u,ui){
$out+=' <div class="approver-outbox"> <div class="approver-box "> <div class="img-circle"> <img alt="image" class="img-circle" src="';
$out+=$escape(_isNullOrBlank(u.fileFullPath)?_url('/img/head_default.png'):u.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" height="30"> </div> <div class="m-t-xs">';
$out+=$escape(u.userName);
$out+='</div> </div> </div> ';
});
$out+=' </div> </div> ';
}
$out+=' </form> <div class="footer border-b-radius text-right"> <button class="btn btn-default" data-action="cancel"> ';
if(((exp.approveStatus=='0' || exp.approveStatus=='5') && currentAuditPerson.companyUserId == currentCompanyUserId && currentAuditPerson.approveStatus == 0)
            || (exp.companyUserId == currentCompanyUserId && exp.approveStatus == 0)){
$out+=' 取消 ';
}else{
$out+=' 关闭 ';
}
$out+=' </button> ';
if((exp.approveStatus=='0' || exp.approveStatus=='5') && currentAuditPerson.companyUserId == currentCompanyUserId && currentAuditPerson.approveStatus == 0 ){
$out+=' <button class="btn btn-primary" data-action="agree">同意</button> <button class="btn btn-success" data-action="returnBack">退回</button> ';
}
$out+=' ';
if(exp.companyUserId == currentCompanyUserId && exp.approveStatus == 0 ){
$out+=' <button class="btn btn-danger" data-action="cancellation">撤销</button> ';
}
$out+=' ';
if(currentCompanyUserId==exp.companyUserId && (exp.approveStatus=='0' || exp.approveStatus=='5')){
$out+=' <button class="btn btn-warning" data-action="remind">提醒</button> ';
}
$out+=' </div> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_cost_off',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,dataInfo=$data.dataInfo,$out='';$out+='<form class="form-horizontal p-m overflow-y-auto m-dialog-resize m-approval-cost-off"> <div class="form-group"> <div class="col-sm-12"> <button class="btn btn-primary btn-xs" data-action="addItem" title="添加明细"><i class="fa fa-plus"></i>添加明细</button> </div> </div> <div class="form-group"> <div class="col-sm-12"> <div class="row"> <div class="col-md-12 m-b-xs"> <span id="showFileLoading"> </span> </div> <div class="col-md-12"> <span class="uploadmgrContainer"> </span> </div> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 text-right">报销金额：</label> <div class="col-sm-10"> <i class="fa fa-jpy"></i> <span id="expAmount" data-value="0">0</span>元 </div> </div>  <div class="form-group"> <label class="col-sm-2 text-right">核销金额：</label> <div class="col-sm-10"> <i class="fa fa-jpy"></i> <span id="verificationAmount">';
$out+=$escape(_expNumberFilter(0));
$out+='</span>元 </div> </div> <!--<div class="form-group"> <label class="col-sm-2 control-label">费用余额：</label> <div class="col-sm-10 p-t-7"> <div><span id="expBalance">';
$out+=$escape(dataInfo?_expNumberFilter(0-dataInfo.sumExpAmount):'0');
$out+='</span>元</div> <p class="f-s-xs fc-v1-grey">备注：费用余额为负值，申请人退回等值金额后，该费用申请流程结束；费用余额为正值，申请人报销等值金额后，该费用申请流程结束</p> </div> </div>--> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div id="approverOutBox"> </div> </form> <div class="footer border-b-radius text-right"> <button class="btn btn-default" data-action="cancel">取消</button> <button class="btn btn-primary" data-action="save">确认</button> </div>';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_cost_off_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,detailList=$data.detailList,d=$data.d,i=$data.i,$escape=$utils.$escape,title=$data.title,_expNumberFilter=$helpers._expNumberFilter,mainAmount=$data.mainAmount,attachList=$data.attachList,a=$data.a,$out='';$out+='<form class="form-horizontal p-m m-b-lg overflow-y-auto m-dialog-resize"> ';
$each(detailList,function(d,i){
$out+=' <div class="panel panel-default"> <div class="panel-body"> <h4 class="title-line"> ';
$out+=$escape(title);
$out+='明细(<span data-action="itemIndex">';
$out+=$escape(i+1);
$out+='</span>) </h4> <div class="form-group"> <label class="col-24-xs-3 text-right">';
$out+=$escape(title);
$out+='金额：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_expNumberFilter(d.expAmount));
$out+=' 元 </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">';
$out+=$escape(title);
$out+='类型：</label> <div class="col-24-xs-21"> ';
$out+=$escape(d.expName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">用途说明：</label> <div class="col-24-xs-21"> ';
$out+=$escape(d.expUse);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">关联项目：</label> <div class="col-24-xs-21"> ';
$out+=$escape(d.projectName);
$out+=' </div> </div> </div> </div> ';
});
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">报销金额：</label> <div class="col-24-xs-21"> <i class="fa fa-jpy"></i> <span id="expAmount">';
$out+=$escape(_expNumberFilter(mainAmount.reimburseAmount));
$out+='</span>元 </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">退还金额：</label> <div class="col-24-xs-21"> <i class="fa fa-jpy"></i> <span id="returnAmount">';
$out+=$escape(_expNumberFilter(mainAmount.returnAmount));
$out+='</span>元 </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">核销金额：</label> <div class="col-24-xs-21"> <i class="fa fa-jpy"></i> <span id="verificationAmount">';
$out+=$escape(_expNumberFilter(mainAmount.verificationAmount));
$out+='</span>元 </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">附件：</label> <div class="col-24-xs-21"> ';
if(attachList!=null && attachList.length>0){
$out+=' ';
$each(attachList,function(a,i){
$out+=' <span class="label m-r-xs" style="background: #ecf0f1;padding: 5px 10px;"> <a href="javascript:void(0)" data-action="preview" data-file-ext="';
$out+=$escape(a.fileExtName);
$out+='" data-net-file-id="';
$out+=$escape(a.id);
$out+='" data-src="';
$out+=$escape(a.fileFullPath);
$out+='" data-name="';
$out+=$escape(a.fileName);
$out+='"> ';
$out+=$escape(a.fileName);
$out+=' </a> </span> ';
});
$out+=' ';
}
$out+=' </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_cost_off_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,data=$data.data,dataInfo=$data.dataInfo,$each=$utils.$each,p=$data.p,$index=$data.$index,c=$data.c,$out='';$out+='<div class="panel panel-default"> <div class="panel-body"> <form> <h4 class="title-line"> 明细(<span data-action="itemIndex">';
$out+=$escape(data.itemIndex);
$out+='</span>) ';
if(data.itemIndex>1){
$out+=' <a class="curp pull-right" href="javascript:void(0)" data-action="delItem" title="删除明细"> <i class="glyphicon glyphicon-remove fc-red"></i> </a> ';
}
$out+=' </h4> <div class="form-group"> <label class="col-sm-2 control-label">报销金额<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div class="input-group"> <input placeholder="请输入报销金额" class="form-control" type="text" name="expAmount" value="';
$out+=$escape(dataInfo?dataInfo.expAmount:'');
$out+='"> <span class="input-group-addon">元</span> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">报销类型<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div> <select class="form-control full-width" name="expType" > ';
$each(data.expTypeList,function(p,$index){
$out+=' <optgroup data-select2-id="';
$out+=$escape(p.parent.id);
$out+='" label="';
$out+=$escape(p.parent.name);
$out+='"> ';
if(p.child!=null && p.child.length>0){
$out+=' ';
$each(p.child,function(c,$index){
$out+=' ';
if(dataInfo && dataInfo.expType==c.id){
$out+=' <option value="';
$out+=$escape(c.id);
$out+='" selected>';
$out+=$escape(c.name);
$out+='</option> ';
}else{
$out+=' <option value="';
$out+=$escape(c.id);
$out+='">';
$out+=$escape(c.name);
$out+='</option> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </optgroup> ';
});
$out+=' </select> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">用途说明<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <textarea placeholder="请输入用途说明" class="form-control" type="text" name="expUse">';
$out+=$escape(dataInfo?dataInfo.expUse:'');
$out+='</textarea> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">关联项目：</label> <div class="col-sm-10"> <div> <select class="form-control full-width" name="projectName" > <option value="">请选择关联项目</option> ';
$each(data.projectList,function(p,$index){
$out+=' ';
if(dataInfo && dataInfo.projectId==p.id){
$out+=' <option value="';
$out+=$escape(p.id);
$out+='" selected>';
$out+=$escape(p.projectName);
$out+='</option> ';
}else{
$out+=' <option value="';
$out+=$escape(p.id);
$out+='">';
$out+=$escape(p.projectName);
$out+='</option> ';
}
$out+=' ';
});
$out+=' </select> </div> </div> </div> </form> </div> </div>';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_cost_off_return',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,sumExpAmount=$data.sumExpAmount,_mathSubtract=$helpers._mathSubtract,applyAmount=$data.applyAmount,$out='';$out+='<form class="form-horizontal p-sm overflow-y-auto m-dialog-resize"> <div class="form-group"> <label class="col-24-xs-3 text-right">申请金额：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_expNumberFilter(sumExpAmount));
$out+=' 元 </div> </div> <div class="form-group"> <label class="col-24-xs-3 control-label">核销金额：</label> <div class="col-24-xs-21"> <input placeholder="请输入核销金额" class="form-control" type="text" name="returnAmount" value="';
$out+=$escape(_mathSubtract(sumExpAmount,applyAmount));
$out+='"> </div> </div>  <div class="form-group"> <label class="col-24-xs-3 text-right p-t-7">附件：</label> <div class="col-24-xs-21"> <div class="row"> <div class="col-md-12 m-b-xs"> <span id="showFileLoading"> </span> </div> <div class="col-md-12"> <span class="uploadmgrContainer"> </span> </div> </div> </div> </div> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div id="approverOutBox"> </div> </form> <div class="footer border-b-radius text-right"> <button class="btn btn-default" data-action="cancel">取消</button> <button class="btn btn-primary" data-action="save">确认核销</button> </div>';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_cost_off_return_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataInfo=$data.dataInfo,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,$each=$utils.$each,a=$data.a,i=$data.i,s=$data.s,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,typeStr=$data.typeStr,u=$data.u,ui=$data.ui,isShowBtn=$data.isShowBtn,currentCompanyUserId=$data.currentCompanyUserId,$out='';$out+='<form class="form-horizontal p-m overflow-y-auto m-dialog-resize"> ';
if(dataInfo.dynamicAudit && dataInfo.dynamicAudit.baseAuditData && dataInfo.dynamicAudit.baseAuditData.expNo){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">审批编号：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo.dynamicAudit.baseAuditData.expNo);
$out+=' </div> </div> ';
}
$out+=' ';
if(dataInfo.dynamicAudit && dataInfo.dynamicAudit.baseAuditData.userName){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">申请人：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo.dynamicAudit.baseAuditData.userName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">申请时间：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_momentFormat(dataInfo.dynamicAudit.baseAuditData.expDate,'YYYY/MM/DD'));
$out+=' </div> </div> ';
}
$out+=' ';
if(dataInfo.dynamicAudit && dataInfo.dynamicAudit.baseAuditData && dataInfo.dynamicAudit.baseAuditData.companyName){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">所在组织：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo.dynamicAudit.baseAuditData.companyName);
$out+=' </div> </div> ';
}
$out+=' ';
if(dataInfo.dynamicAudit && dataInfo.dynamicAudit.baseAuditData && dataInfo.dynamicAudit.baseAuditData.departName){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">部门：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo.dynamicAudit.baseAuditData.departName);
$out+=' </div> </div> ';
}
$out+=' <h4 class="title-line m-l-sm">审批详情</h4> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div class="form-group"> <label class="col-24-xs-3 text-right">申请金额：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_expNumberFilter(dataInfo.verification.applyAmount));
$out+=' 元 </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">核销金额：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_expNumberFilter(dataInfo.verification.returnAmount));
$out+=' 元 </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">附件：</label> <div class="col-24-xs-21"> ';
if(dataInfo.dynamicAudit.attachList!=null && dataInfo.dynamicAudit.attachList.length>0){
$out+=' ';
$each(dataInfo.dynamicAudit.attachList,function(a,i){
$out+=' <span class="label m-r-xs" style="background: #ecf0f1;padding: 5px 10px;"> <a href="javascript:void(0)" data-action="preview" data-file-ext="';
$out+=$escape(a.fileExtName);
$out+='" data-net-file-id="';
$out+=$escape(a.id);
$out+='" data-src="';
$out+=$escape(a.fileFullPath);
$out+='" data-name="';
$out+=$escape(a.fileName);
$out+='"> ';
$out+=$escape(a.fileName);
$out+=' </a> </span> ';
});
$out+=' ';
}
$out+=' </div> </div> ';
if(dataInfo && dataInfo.dynamicAudit &&  dataInfo.dynamicAudit.auditList!=null && dataInfo.dynamicAudit.auditList.length>0){
$out+=' <h4 class="title-line m-l-sm">审批流程</h4> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r" ></div> <div class="form-group"> <div class="col-sm-12 p-w-md"> <table class="table table-hover table-bordered m-b-xs" > <thead> <tr> <th width="40%">审批</th> <th width="40%">操作</th> <th width="20%">审批时间</th> </tr> </thead> <tbody> ';
$each(dataInfo.dynamicAudit.auditList,function(s,i){
$out+=' <tr> <td> ';
if(_isNullOrBlank(s.fileFullPath)){
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30"/> ';
}else{
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(s.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" > ';
}
$out+=' <span class="dp-inline-block"> <p class="m-b-none">';
$out+=$escape(s.userName);
$out+='</p> <p class="m-b-none fc-v1-grey">';
$out+=$escape(s.companyName);
$out+='</p> </span> </td> <td> ';
if(s.approveStatus=='1'){
$out+=' <p class="text-success m-b-none"> ';
$out+=$escape(s.approveStatusName);
$out+=' </p> ';
}else if(s.approveStatus=='2' || s.approveStatus=='3'){
$out+=' <p class="text-danger m-b-none"> ';
$out+=$escape(s.approveStatusName);
$out+=' </p> ';
}else{
$out+=' <p class="m-b-none"> ';
if(s.approveStatusName=='已拨款'){
$out+=' 已核销 ';
}else if(s.approveStatusName=='等待财务拨款'){
$out+=' 等待财务核销 ';
}else{
$out+=' ';
$out+=$escape(s.approveStatusName);
$out+=' ';
}
$out+=' </p> ';
}
$out+=' ';
if(s.approveStatusName=='发起申请' && !_isNullOrBlank(s.remark)){
$out+=' <p class="fc-v1-grey m-b-none">';
$out+=$escape(typeStr);
$out+='备注：';
$out+=$escape(s.remark);
$out+='</p> ';
}
$out+=' ';
if(s.approveStatusName=='退回'  && !_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">退回原因：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}else if(!_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">审批意见：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}
$out+=' </td> <td> ';
$out+=$escape(_momentFormat(s.approveDate,'YYYY/MM/DD'));
$out+=' </td> </tr> ';
});
$out+=' </tbody> </table> </div> </div> ';
}
$out+=' ';
if( dataInfo && dataInfo.dynamicAudit &&  dataInfo.dynamicAudit.ccCompanyUserList!=null && dataInfo.dynamicAudit.ccCompanyUserList.length>0){
$out+=' <h4 class="title-line m-l-sm">抄送人</h4> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div class="form-group"> <div class="col-sm-12 p-w-md approval-out-box"> ';
$each(dataInfo.dynamicAudit.ccCompanyUserList,function(u,ui){
$out+=' <div class="approver-outbox"> <div class="approver-box "> <div class="img-circle"> <img alt="image" class="img-circle" src="';
$out+=$escape(_isNullOrBlank(u.fileFullPath)?_url('/img/head_default.png'):u.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" height="30"> </div> <div class="m-t-xs">';
$out+=$escape(u.userName);
$out+='</div> </div> </div> ';
});
$out+=' </div> </div> ';
}
$out+=' </form> ';
if(isShowBtn){
$out+=' <div class="footer border-b-radius text-right"> <button class="btn btn-default" data-action="cancel"> ';
if((dataInfo && dataInfo.dynamicAudit.auditFlag==1)
        || (dataInfo && dataInfo.dynamicAudit.baseAuditData.companyUserId == currentCompanyUserId && dataInfo.dynamicAudit.baseAuditData.approveStatus == 0)){
$out+=' 取消 ';
}else{
$out+=' 关闭 ';
}
$out+=' </button> ';
if(dataInfo && dataInfo.dynamicAudit.auditFlag==1){
$out+=' <button class="btn btn-primary" data-action="agree">同意</button> <button class="btn btn-success" data-action="returnBack">退回</button> ';
}
$out+=' ';
if(dataInfo && dataInfo.dynamicAudit.repealFlag == 1 ){
$out+=' <button class="btn btn-danger" data-action="cancellation">撤销</button> ';
}
$out+=' ';
if(currentCompanyUserId==dataInfo.dynamicAudit.baseAuditData.companyUserId && (dataInfo.dynamicAudit.baseAuditData.approveStatus=='0' || dataInfo.dynamicAudit.baseAuditData.approveStatus=='5')){
$out+=' <button class="btn btn-warning" data-action="remind">提醒</button> ';
}
$out+=' </div> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_cost_off_tab',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,isVerification=$data.isVerification,$escape=$utils.$escape,dataInfo=$data.dataInfo,$each=$utils.$each,p=$data.p,i=$data.i,$out='';$out+='<!--<div class="tabs-container"> <ul class="nav nav-tabs"> ';
if(isVerification){
$out+=' <li class="active"> <a data-toggle="tab" href="#tab-1" aria-expanded="false"> 费用核销';
$out+=$escape(dataInfo && dataInfo.verificationList && dataInfo.verificationList.length>0?dataInfo.verificationList.length+1:'');
$out+=' </a> </li> ';
}
$out+=' ';
if(dataInfo && dataInfo.verificationList && dataInfo.verificationList.length>0){
$out+=' ';
$each(dataInfo.verificationList,function(p,i){
$out+=' <li class=""><a data-toggle="tab" href="#tab-record-';
$out+=$escape(i+1);
$out+='" aria-expanded="false">费用核销';
$out+=$escape(i+1);
$out+='</a></li> ';
});
$out+=' ';
}
$out+=' <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">费用申请2</a></li> </ul> <div class="tab-content"> ';
if(isVerification){
$out+=' <div id="tab-1" class="tab-pane active" data-type="costOff"> <div class="panel-body no-padding"> </div> </div> ';
}
$out+=' ';
if(dataInfo && dataInfo.verificationList && dataInfo.verificationList.length>0){
$out+=' ';
$each(dataInfo.verificationList,function(p,i){
$out+=' <div id="tab-record-';
$out+=$escape(i+1);
$out+='" class="tab-pane" data-type="costOffRecord" data-i="';
$out+=$escape(i);
$out+='"> <div class="panel-body no-padding"> </div> </div> ';
});
$out+=' ';
}
$out+=' <div id="tab-2" class="tab-pane" data-type="expApply"> <div class="panel-body no-padding"> </div> </div> </div> </div>--> <div class="m-dialog-resize p-m overflow-y-auto"> <div> <h4 class="title-line m-l-sm"> 往来明细 <button class="btn btn-link pull-right f-s-xl m-t-n-sm" data-action="expand"><i class="fa fa-angle-double-down"></i></button> </h4> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div class="tab-pane content hide" data-type="expApply"></div> </div> ';
if(dataInfo && dataInfo.verificationList && dataInfo.verificationList.length>0){
$out+=' <div> <h4 class="title-line m-l-sm"> 核销记录 <button class="btn btn-link pull-right f-s-xl m-t-n-sm" data-action="expand"><i class="fa fa-angle-double-down"></i></button> </h4> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div class="p-xs content hide"> ';
$each(dataInfo.verificationList,function(p,i){
$out+=' <div> <h4 class="title-line m-l-sm"> 费用核销';
$out+=$escape(i+1);
$out+=' </h4> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div class="tab-pane" data-type="costOffRecord" data-i="';
$out+=$escape(i);
$out+='"></div> </div> ';
});
$out+=' </div> </div> ';
}
$out+=' ';
if(isVerification){
$out+=' <div> <h4 class="title-line m-l-sm"> 费用核销 <button class="btn btn-link pull-right f-s-xl m-t-n-sm" data-action="expand"><i class="fa fa-angle-double-down"></i></button> </h4> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div class="tab-pane content hide" data-type="costOff"></div> </div> ';
}
$out+=' </div>  ';
if(isVerification){
$out+=' <div class="footer border-b-radius text-right"> <button class="btn btn-default" data-action="cancel">取消</button> <button class="btn btn-primary" data-action="confirmCostOff">确认核销</button> </div> ';
}else{
$out+=' <div class="footer border-b-radius text-right"> <button class="btn btn-default" data-action="cancel">关闭</button> </div> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_data','<div class="m"> <form role="form" class="form-inline m-b-sm"> <div class="row"> <div class="col-md-12"> <label class="">审批类型：</label> <div class="dp-inline-block-1"> <select class="form-control" name="parentExpType"></select> </div> <div class="dp-inline-block-1 m-l-sm" id="expTypeBox">  </div> </div> <div class="col-md-9"> </div> <div class="col-md-12" id="timeSelect"> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> </div> </div> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> ');/*v:1*/
template('m_approval/m_approval_data_exp_type',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,expTypeList=$data.expTypeList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,$out='';$each(expTypeList,function(p,$index){
$out+=' <label class="i-checks i-checks-label fw-normal dp-inline-block vertical-middle m-r-sm m-t-xs"> <input name="expType" type="checkbox" value="';
$out+=$escape(p.id);
$out+='"/> <span class="i-checks-span">';
$out+=$escape(p.name);
$out+='</span> </label> ';
});
return new String($out);
});/*v:1*/
template('m_approval/m_approval_data_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,currentCompanyUserId=$data.currentCompanyUserId,_url=$helpers._url,$out='';$out+='<table class="table table-hover table-bordered table-responsive dataTable" > <thead> <tr> <th> 编号 <a class="icon-filter pull-right" id="filter_expNo" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>申请日期</th> <th class="min-w-60"> 申请人 <a class="icon-filter pull-right" id="filter_userNameLike"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th> 经办人 <a class="icon-filter pull-right" id="filter_submitUserName"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>审批人</th> <th>所在组织</th> <th>部门</th> <th> 类型  </th> <th class="min-w-60"> 审批状态 <a class="icon-filter pull-right" id="filter_approveStatus"><i class="icon iconfont icon-shaixuan"></i></a> </th>  </tr> </thead> <tbody> ';
$each(dataList,function(p,$index){
$out+=' <tr class="curp" data-type="';
$out+=$escape(p.type);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='"> <td>';
$out+=$escape(p.expNo);
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.expDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(p.userName);
$out+='</td> <td>';
$out+=$escape(p.submitUserName);
$out+='</td> <td>';
$out+=$escape(p.auditPersonName);
$out+='</td> <td>';
$out+=$escape(p.companyName);
$out+='</td> <td>';
$out+=$escape(p.departName);
$out+='</td> <td>';
$out+=$escape(p.expTypeName);
$out+='</td> <td>';
$out+=$escape(p.approveStatusName);
$out+='</td> <!--<td> ';
if(p.expFlag!=1 && (p.approveStatus ==2 || p.approveStatus ==3) && p.companyUserId == currentCompanyUserId && p.type!=5 ){
$out+=' <button class="btn btn-primary btn-xs" data-action="edit">编辑</button> ';
}
$out+=' </td>--> </tr> ';
});
$out+=' ';
if(dataList==null || dataList.length==0){
$out+=' <tr class="no-data"> <td colspan="9" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_data_list_for_finance',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,_emptyDisplay=$helpers._emptyDisplay,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-responsive dataTable"> <thead> <tr> <th> 编号 <a class="icon-filter pull-right" id="filter_expNo" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>金额（元）</th> <th>部门</th> <th class=""> 经办人 <a class="icon-filter pull-right" id="filter_submitUserName"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th>审批人</th> <th>收款方</th> <th>付款方</th> <th>收支分类</th> <th>分类子项</th> <th class="" data-action="sort" data-code="expDate"> 申请时间 </th> <th class="" data-action="sort" data-code="approveDate">审批时间</th> <th>付款时间</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <tr class="curp" data-id="';
$out+=$escape(p.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='"> <td>';
$out+=$escape(p.expNo);
$out+='</td> <td>';
$out+=$escape(_expNumberFilter(p.sumExpAmount));
$out+='</td> <td>';
$out+=$escape(p.departName);
$out+='</td> <td>';
$out+=$escape(p.submitUserName);
$out+='</td> <td>';
$out+=$escape(p.auditPersonName);
$out+='</td> <td>';
$out+=$escape(_emptyDisplay(p.enterpriseId));
$out+='</td> <td>';
$out+=$escape(_emptyDisplay(p.fromCompanyId));
$out+='</td> <td>';
$out+=$escape(p.expParentName);
$out+='</td> <td>';
$out+=$escape(p.expName);
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.expDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.approveDate,'YYYY/MM/DD'));
$out+='</td> <td> ';
$out+=$escape(_momentFormat(p.allocationDate,'YYYY/MM/DD'));
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="12" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_dynamic_audit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dynamicAuditMap=$data.dynamicAuditMap,$escape=$utils.$escape,labelClass=$data.labelClass,contentClass=$data.contentClass,processFlag=$data.processFlag,userList=$data.userList,$out='';$out+=' ';
if(dynamicAuditMap && dynamicAuditMap.auditFlag==1){
$out+=' <div class="form-group"> <label class="';
$out+=$escape(labelClass);
$out+=' control-label">审批人：</label> <div class="';
$out+=$escape(contentClass);
$out+=' approval-out-box"> <div class="" id="approverBox"> ';
if(processFlag=='1' || userList==null || userList.length==0){
$out+=' <div class="approver-outbox vertical-top dp-inline-block p-w-xs"> <a class="btn btn-default btn-circle" type="button" data-action="addApprover"> <i class="fa fa-plus"></i> </a> </div> ';
}
$out+=' </div>  <div class="row clearfix"> <div class="col-sm-10 p-t-xs"> <input type="hidden" name="approver" > </div> </div> </div> </div> <div class="form-group"> <label class="';
$out+=$escape(labelClass);
$out+=' control-label">抄送人：</label> <div class="';
$out+=$escape(contentClass);
$out+=' approval-out-box"> <div id="ccUserListBox" class="dp-block"> <div class="approver-outbox vertical-top dp-inline-block p-w-xs"> <a class="btn btn-default btn-circle" type="button" data-action="addCcUser"> <i class="fa fa-plus"></i> </a> </div> </div> </div> </div> ';
}
return new String($out);
});/*v:1*/
template('m_approval/m_approval_exp_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,_expNumberFilter=$helpers._expNumberFilter,$each=$utils.$each,a=$data.a,i=$data.i,$out='';$out+='<form class="form-horizontal p-m m-b-lg overflow-y-auto m-dialog-resize"> <div class="form-group"> <label class="col-24-xs-3 text-right p-l-none">收款方<span class="fc-red">*</span>：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo?dataInfo.enterpriseId:'');
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right p-l-none">付款方<span class="fc-red">*</span>：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo?dataInfo.fromCompanyId:'');
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">类型：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo?dataInfo.expName:'');
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">用途说明：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo?dataInfo.remark:'');
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">金额<span class="fc-red">*</span>：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo?_expNumberFilter(dataInfo.sumExpAmount):'');
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">付款方式：</label> <div class="col-24-xs-21"> ';
$out+=$escape(dataInfo?dataInfo.expType:'');
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">附件：</label> <div class="col-24-xs-21"> ';
if(dataInfo.attachList!=null && dataInfo.attachList.length>0){
$out+=' ';
$each(dataInfo.attachList,function(a,i){
$out+=' <span class="label m-r-xs" style="background: #ecf0f1;padding: 5px 10px;"> <a href="javascript:void(0)" data-action="preview" data-file-ext="';
$out+=$escape(a.fileExtName);
$out+='" data-net-file-id="';
$out+=$escape(a.id);
$out+='" data-src="';
$out+=$escape(a.fileFullPath);
$out+='" data-name="';
$out+=$escape(a.fileName);
$out+='"> ';
$out+=$escape(a.fileName);
$out+=' </a> </span> ';
});
$out+=' ';
}
$out+=' </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_initiate',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,c=$data.c,ci=$data.ci,_getIconColor=$helpers._getIconColor,_isNullOrBlank=$helpers._isNullOrBlank,$out='';$out+=' <div class="ibox ibox_min_height"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-6">  <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 审批管理 </li> <li class="active fa fa-angle-right"> <strong>发起审批</strong> </li> </ol> </div> </div> <div class="col-md-6 text-right p-w-sm"> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content"> <div class=""> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' ';
if(p.formList && p.formList.length>0){
$out+=' <div class="panel panel-default"> <div class="panel-body"> <h4 class="title-line">';
$out+=$escape(p.groupName);
$out+='</h4> <div class="row"> ';
if(p.formList && p.formList.length>0){
$out+=' ';
$each(p.formList,function(c,ci){
$out+=' <div class="col-md-2 m-b-sm"> <span class="pull-left icon-circle ';
$out+=$escape(_getIconColor(c.iconKey?c.iconKey:'icon-zidingyibankuai'));
$out+='"> <i class="icon iconfont ';
$out+=$escape(c.iconKey?c.iconKey:'icon-zidingyibankuai');
$out+='" ></i> </span> <div class="pt-absolute full-width p-l-xl m-l-xs"> <a class="btn btn-link text-ellipsis full-width p-b-xs text-left ';
$out+=$escape(_isNullOrBlank(c.documentation)?'m-t-sm':'');
$out+='" title="';
$out+=$escape(c.name);
$out+='" data-action="initiate" data-form-id="';
$out+=$escape(c.formId);
$out+='" data-issystem="';
$out+=$escape(c.isSystem);
$out+='">';
$out+=$escape(c.name);
$out+='</a> ';
if(!_isNullOrBlank(c.documentation)){
$out+=' <span class="text-ellipsis-2 fc-v3-grey full-width p-l p-r-sm f-s-xxs" title="';
$out+=$escape(c.documentation);
$out+='">';
$out+=$escape(c.documentation);
$out+='</span> ';
}
$out+=' </div> <div class="clearfix"></div> </div> ';
});
$out+=' ';
}
$out+=' </div> </div> </div> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </div> </div> </div>  ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_leave_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,data=$data.data,$escape=$utils.$escape,dataInfo=$data.dataInfo,_momentFormat=$helpers._momentFormat,$each=$utils.$each,p=$data.p,$index=$data.$index,$out='';$out+='<form class="form-horizontal m"> <div class="panel panel-default"> <div class="panel-body"> ';
if(data.doType==3){
$out+=' <div class="form-group"> <label class="col-sm-2 control-label">';
$out+=$escape(data.title);
$out+='类型<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <select class="form-control full-width" name="leaveType" > </select> </div> </div> ';
}
$out+=' ';
if(data.doType==4){
$out+=' <div class="form-group"> <label class="col-sm-2 control-label">出差地点<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入出差地点" class="form-control" type="text" name="address" value="';
$out+=$escape(dataInfo?dataInfo.address:'');
$out+='"> </div> </div> ';
}
$out+=' <div class="form-group"> <label class="col-sm-2 control-label">开始时间<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div class="input-group"> <input type="text" class="form-control" id="ipt_startTime" name="leaveStartTime" placeholder="开始时间" readonly onFocus="WdatePicker({maxDate:\'#F{$dp.$D(\\\'ipt_endTime\\\')}\',startDate:\'%y-%M-%d %H:00:00\',isShowToday:false,autoPickDate:false,dateFmt:\'yyyy-MM-dd HH:mm\',disabledDates:[\'....-..-.. ..:0[1-9]\',\'....-..-.. ..:[1-2][0-9]\',\'....-..-.. ..:[4-9][0-9]\',\'....-..-.. ..:3[1-9]\']})" value="';
$out+=$escape(dataInfo?_momentFormat(dataInfo.startTime,'YYYY-MM-DD HH:mm'):'');
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">结束时间<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div class="input-group"> <input type="text" class="form-control" id="ipt_endTime" name="leaveEndTime" placeholder="开始时间" readonly onFocus="WdatePicker({minDate:\'#F{$dp.$D(\\\'ipt_startTime\\\')}\',startDate:\'%y-%M-%d %H:00:00\',isShowToday:false,dateFmt:\'yyyy-MM-dd HH:mm\',disabledDates:[\'....-..-.. ..:0[1-9]\',\'....-..-.. ..:[1-2][0-9]\',\'....-..-.. ..:[4-9][0-9]\',\'....-..-.. ..:3[1-9]\']})" value="';
$out+=$escape(dataInfo?_momentFormat(dataInfo.endTime,'YYYY-MM-DD HH:mm'):'');
$out+='"> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">';
$out+=$escape(data.title);
$out+='天数<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div class="input-group"> <input placeholder="请输入';
$out+=$escape(data.title);
$out+='天数" class="form-control" type="text" name="leaveTime" value="';
$out+=$escape(dataInfo?dataInfo.leaveTime:'');
$out+='"> <span class="input-group-addon">天</span> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">';
$out+=$escape(data.title);
$out+='事由：</label> <div class="col-sm-10"> <textarea placeholder="请输入';
$out+=$escape(data.title);
$out+='事由" class="form-control" type="text" name="remark">';
$out+=$escape(dataInfo?dataInfo.remark:'');
$out+='</textarea> </div> </div> ';
if(data.doType==4){
$out+=' <div class="form-group"> <label class="col-sm-2 control-label">关联项目：</label> <div class="col-sm-10"> <select class="form-control full-width" name="projectId" > ';
$each(data.projectList,function(p,$index){
$out+=' ';
if(dataInfo && dataInfo.projectId && dataInfo.projectId==p.id){
$out+=' <option value="';
$out+=$escape(p.id);
$out+='" selected >';
$out+=$escape(p.projectName);
$out+='</option> ';
}else{
$out+=' <option value="';
$out+=$escape(p.id);
$out+='">';
$out+=$escape(p.projectName);
$out+='</option> ';
}
$out+=' ';
});
$out+=' </select> </div> </div> ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">附件：</label> <div class="col-sm-10"> <div class="row"> <div class="col-md-12 m-b-xs"> <span id="showFileLoading"> </span> </div> <div class="col-md-12 m-b-sm"> <span class="uploadmgrContainer"> </span> </div> </div> </div> </div> <div class="form-group m-b-none"> <div class="col-md-12"> <span class="uploadmgrContainer"></span> </div> </div> <div class="hr-line-dashed m-t-none m-b-sm"></div> <div class="form-group"> <label class="col-sm-2 control-label">审批人：</label> <div class="col-sm-10"> <div id="approverBox"> </div> ';
if(data.processFlag=='1'){
$out+=' <div class="approver-box text-center pull-left"> <a class="btn btn-default btn-circle circle-lg" type="button" data-action="addApprover" title="添加审批人"> <i class="fa fa-plus"></i> </a> </div> ';
}
$out+='  <div class="row clearfix"> <div class="col-sm-10 p-t-xs"> <input type="hidden" name="approver" > </div> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">抄送人：</label> <div class="col-sm-10"> <div id="ccUserListBox"> </div> <div class="approver-box text-center pull-left"> <a class="btn btn-default btn-circle circle-lg" type="button" data-action="addCcUser" title="添加抄送人"> <i class="fa fa-plus"></i> </a> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_leave_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,expNo=$data.expNo,$escape=$utils.$escape,userName=$data.userName,_momentFormat=$helpers._momentFormat,submitTime=$data.submitTime,companyName=$data.companyName,departName=$data.departName,doType=$data.doType,title=$data.title,leaveTypeName=$data.leaveTypeName,address=$data.address,startTime=$data.startTime,endTime=$data.endTime,leaveTime=$data.leaveTime,remark=$data.remark,attachList=$data.attachList,$each=$utils.$each,a=$data.a,i=$data.i,auditList=$data.auditList,s=$data.s,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,typeStr=$data.typeStr,ccCompanyUserList=$data.ccCompanyUserList,u=$data.u,ui=$data.ui,approveStatus=$data.approveStatus,currentAuditPerson=$data.currentAuditPerson,currentCompanyUserId=$data.currentCompanyUserId,companyUserId=$data.companyUserId,$out='';$out+='<form class="form-horizontal p-sm overflow-y-auto m-dialog-resize"> ';
if(expNo){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">审批编号：</label> <div class="col-24-xs-21"> ';
$out+=$escape(expNo);
$out+=' </div> </div> ';
}
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">申请人：</label> <div class="col-24-xs-21"> ';
$out+=$escape(userName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">申请时间：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_momentFormat(submitTime,'YYYY/MM/DD'));
$out+=' </div> </div> ';
if(companyName){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">所在组织：</label> <div class="col-24-xs-21"> ';
$out+=$escape(companyName);
$out+=' </div> </div> ';
}
$out+=' ';
if(departName){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">部门：</label> <div class="col-24-xs-21"> ';
$out+=$escape(departName);
$out+=' </div> </div> ';
}
$out+=' <h4 class="title-line m-l-sm">审批详情</h4> <div class="hr-line-dashed m-t-none m-b-sm"></div> ';
if(doType==3){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">';
$out+=$escape(title);
$out+='类型：</label> <div class="col-24-xs-21"> ';
$out+=$escape(leaveTypeName);
$out+=' </div> </div> ';
}
$out+=' ';
if(doType==4){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">出差地点：</label> <div class="col-24-xs-21"> ';
$out+=$escape(address);
$out+=' </div> </div> ';
}
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">开始时间：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_momentFormat(startTime,'A'));
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">结束时间：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_momentFormat(endTime,'A'));
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">';
$out+=$escape(title);
$out+='天数：</label> <div class="col-24-xs-21"> ';
$out+=$escape(leaveTime);
$out+='天 </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">';
$out+=$escape(title);
$out+='事由：</label> <div class="col-24-xs-21"> ';
$out+=$escape(remark);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">附件：</label> <div class="col-24-xs-21"> ';
if(attachList!=null && attachList.length>0){
$out+=' ';
$each(attachList,function(a,i){
$out+=' <span class="label m-r-xs" style="background: #ecf0f1;padding: 5px 10px;"> <a href="javascript:void(0)" data-action="preview" data-file-ext="';
$out+=$escape(a.fileExtName);
$out+='" data-net-file-id="';
$out+=$escape(a.id);
$out+='" data-src="';
$out+=$escape(a.fileFullPath);
$out+='" data-name="';
$out+=$escape(a.fileName);
$out+='"> ';
$out+=$escape(a.fileName);
$out+=' </a> </span> ';
});
$out+=' ';
}
$out+=' </div> </div> <h4 class="title-line m-l-sm">审批流程</h4> <div class="hr-line-dashed m-t-none m-b-sm" ></div> <div class="form-group"> <div class="col-sm-12 p-w-md"> <table class="table table-hover table-bordered m-b-xs" > <thead> <tr> <th width="40%">审批</th> <th width="40%">操作</th> <th width="20%">审批时间</th> </tr> </thead> <tbody> ';
if(auditList!=null && auditList.length>0){
$out+=' ';
$each(auditList,function(s,i){
$out+=' <tr> <td> ';
if(_isNullOrBlank(s.fileFullPath)){
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30"/> ';
}else{
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(s.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" > ';
}
$out+=' <span class="dp-inline-block"> <p class="m-b-none">';
$out+=$escape(s.userName);
$out+='</p> <p class="m-b-none fc-v1-grey">';
$out+=$escape(s.companyName);
$out+='</p> </span> </td> <td> ';
if(s.approveStatus=='1'){
$out+=' <p class="text-success m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}else if(s.approveStatus=='2' || s.approveStatus=='3'){
$out+=' <p class="text-danger m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}else{
$out+=' <p class="m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}
$out+=' ';
if(s.approveStatusName=='发起申请' && !_isNullOrBlank(s.remark)){
$out+=' <p class="fc-v1-grey m-b-none">';
$out+=$escape(typeStr);
$out+='备注：';
$out+=$escape(s.remark);
$out+='</p> ';
}
$out+=' ';
if(s.approveStatusName=='退回'  && !_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">退回原因：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}else if(!_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">审批意见：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}
$out+=' </td> <td> ';
$out+=$escape(_momentFormat(s.approveDate,'YYYY/MM/DD'));
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr> <td colspan="3" class="text-center">暂无数据</td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
if(ccCompanyUserList!=null && ccCompanyUserList.length>0){
$out+=' <h4 class="title-line m-l-sm">抄送人</h4> <div class="hr-line-dashed m-t-none m-b-sm"></div> <div class="form-group"> <div class="col-sm-12 p-w-md approval-out-box"> ';
$each(ccCompanyUserList,function(u,ui){
$out+=' <div class="approver-outbox"> <div class="approver-box "> <div class="img-circle"> <img alt="image" class="img-circle" src="';
$out+=$escape(_isNullOrBlank(u.fileFullPath)?_url('/img/head_default.png'):u.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" height="30"> </div> <div class="m-t-xs">';
$out+=$escape(u.userName);
$out+='</div> </div> </div> ';
});
$out+=' </div> </div> ';
}
$out+=' </form> <div class="footer border-b-radius text-right"> <button class="btn btn-default" data-action="cancel"> ';
if(((approveStatus==0 || approveStatus==5) && currentAuditPerson.companyUserId == currentCompanyUserId && currentAuditPerson.approveStatus == 0)
            || (companyUserId == currentCompanyUserId && approveStatus == 0)){
$out+=' 取消 ';
}else{
$out+=' 关闭 ';
}
$out+=' </button> ';
if((approveStatus==0 || approveStatus==5) && currentAuditPerson.companyUserId == currentCompanyUserId && currentAuditPerson.approveStatus == 0 ){
$out+=' <button class="btn btn-primary" data-action="agree">同意</button> <button class="btn btn-success" data-action="returnBack">退回</button> ';
}
$out+=' ';
if(companyUserId == currentCompanyUserId && approveStatus == 0 ){
$out+=' <button class="btn btn-danger" data-action="cancellation">撤销</button> ';
}
$out+=' ';
if(currentCompanyUserId==companyUserId && (approveStatus=='0' || approveStatus=='5')){
$out+=' <button class="btn btn-warning" data-action="remind">提醒</button> ';
}
$out+=' </div> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_menu','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right"> <ul class="secondary-menu-ul pull-right">  <li class="" id="applied"> <a href="#/approval/applied">我申请的</a> </li> <li class="" id="pending"> <a href="#/approval/pending">待我审批<span class="badge badge-info m-b-xs m-l-xs" id="approvalPendingAuditCount"></span></a> </li> <li class="" id="approved"> <a href="#/approval/approved">我已审批</a> </li> <li class="" id="ccMy"> <a href="#/approval/ccMy">抄送我的</a> </li> </ul> </div> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content no-padding" id="content-box"> </div> </div>');/*v:1*/
template('m_approval/m_approval_mgt','<div class="m-approval-mgt"> <form role="form" class="form-inline m-b-sm text-right"> <button class="btn btn-primary" data-action="addGroup">添加流程分类</button>  <button class="btn btn-primary" data-action="addNewForm">创建新审批</button> </form> <div id="approvalManagement"> </div> </div>');/*v:1*/
template('m_approval/m_approval_mgt_addGroup',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<form class="m"> <div class="form-group"> <label>流程分类名称：</label> <div> <input placeholder="请输入流程分类名称" class="form-control" type="text" name="name" value="';
$out+=$escape(dataInfo?dataInfo.name:'');
$out+='"> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_mgt_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,editForm=$data.editForm,$each=$utils.$each,approvalList=$data.approvalList,p=$data.p,i=$data.i,c=$data.c,ci=$data.ci,$escape=$utils.$escape,_getIconColor=$helpers._getIconColor,$out='';$out+='<table class="table table-bordered "> <thead> <tr> <th>流程分类</th> <th>名称</th> <th>编号</th> <th>图标</th>  <th>说明</th> ';
if(editForm=='1'){
$out+=' <th>操作</th> ';
}
$out+=' </tr> </thead> <tbody> ';
$each(approvalList,function(p,i){
$out+=' ';
if(p.formList!=null && p.formList.length>0){
$out+=' ';
$each(p.formList,function(c,ci){
$out+=' <tr data-id="';
$out+=$escape(c.id);
$out+='" data-pid="';
$out+=$escape(p.id);
$out+='" data-seq="';
$out+=$escape(c.seq);
$out+='" data-form-id="';
$out+=$escape(c.formId);
$out+='" class="';
$out+=$escape(c.status==0?'fc-v1-grey':'');
$out+='"> ';
if(ci==0){
$out+=' <td class="vertical-middle" rowspan="';
$out+=$escape(p.formList.length);
$out+='"> <span class="text-bold">';
$out+=$escape(p.name);
$out+='</span> ';
if(editForm=='1' && p.isEdit == 1){
$out+=' <button class="btn btn-link btn-xs no-padding fc-dark-blue" data-action="editGroup" title="编辑分类"> <i class="icon iconfont icon-bianji"></i> </button> <button class="btn btn-link btn-xs no-padding fc-red" data-action="delGroup" title="删除分类"> <i class="glyphicon glyphicon-remove"></i> </button> ';
}
$out+=' </td> ';
}
$out+=' <td class="vertical-middle">';
$out+=$escape(c.name);
$out+='</td> <td class="vertical-middle">';
$out+=$escape(c.rulePrefixKey);
$out+='</td> <td class="vertical-middle"> <span class="icon-circle vertical-middle ';
$out+=$escape(_getIconColor(c.iconKey?c.iconKey:'icon-zidingyibankuai'));
$out+='"> <i class="icon iconfont ';
$out+=$escape(c.iconKey?c.iconKey:'icon-zidingyibankuai');
$out+='" ></i> </span> </td>  <td class="vertical-middle">';
$out+=$escape(c.documentation);
$out+='</td> ';
if(editForm=='1'){
$out+=' <td class="vertical-middle"> <button class="btn btn-link btn-xs fc-dark-blue" data-action="editForm" title="编辑表单属性"><i class="icon iconfont icon-bianji"></i></button> <button class="btn btn-link btn-xs fc-dark-blue" data-action="preview" title="表单模板预览"><i class="icon iconfont icon-yulan"></i></button> <div class="btn-group"> <button type="button" class="btn btn-link btn-xs fc-dark-blue dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"><i class="icon iconfont icon-gengduo"></i></button> <ul class="dropdown-menu"> <li><a class="fc-dark-grey" href="javascript:void(0);" data-action="moveToGroup">移动到其他分类</a></li> ';
if(c.isFixForm != 1){
$out+=' <li><a class="fc-dark-grey" href="javascript:void(0);" data-action="delApproval">删除</a></li> ';
}
$out+=' </ul> </div> ';
if(c.isFixForm != 1){
$out+=' <i class="icon-separation-line"></i> <button class="btn btn-link text-navy no-padding " data-action="editApproval" data-type="';
$out+=$escape(c.type);
$out+='">表单设置</button> ';
}
$out+=' <i class="icon-separation-line"></i> ';
if(c.status==1){
$out+=' <a class="btn btn-link p-l-xs p-r-none fc-dark-blue" data-action="whetherEnable" data-status="0" title="是否启用"><i class="icon iconfont icon-kaiguanguan f-s-xs"></i></a> ';
}else{
$out+=' <a class="btn btn-link p-l-xs p-r-none fc-v1-grey" data-action="whetherEnable" data-status="1" title="是否启用"><i class="icon iconfont icon-kaiguanguan1 f-s-xs"></i></a> ';
}
$out+=' </td> ';
}
$out+=' </tr> ';
});
$out+=' ';
}else{
$out+=' <tr data-pid="';
$out+=$escape(p.id);
$out+='"> <td> <span class="text-bold">';
$out+=$escape(p.name);
$out+='</span> ';
if(editForm=='1' && p.isEdit == 1){
$out+=' <button class="btn btn-link btn-xs no-padding fc-dark-blue" data-action="editGroup" title="编辑分类"> <i class="icon iconfont icon-bianji"></i> </button> <button class="btn btn-link btn-xs no-padding fc-red" data-action="delGroup" title="删除分类"> <i class="glyphicon glyphicon-remove"></i> </button> ';
}
$out+=' </td> <td colspan="';
$out+=$escape(editForm=='1'?5:4);
$out+='" class="text-center fc-v1-grey">暂无审批流程数据</td> </tr> ';
}
$out+=' ';
});
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_mgt_form_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataInfo=$data.dataInfo,$escape=$utils.$escape,$each=$utils.$each,iconList=$data.iconList,p=$data.p,i=$data.i,$out='';$out+='<form class="form-horizontal m m-approval-mgt-form-edit"> <div class="form-group"> <label class="col-sm-2 control-label">流程分类<span class="fc-red">*</span>：</label> <div class="col-sm-10"> ';
if(dataInfo && dataInfo.isSystem==1){
$out+=' <select class="form-control" name="formType" disabled title="系统默认不可更改"></select> ';
}else{
$out+=' <select class="form-control" name="formType"></select> ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">名称<span class="fc-red">*</span>：</label> <div class="col-sm-10"> ';
if(dataInfo && dataInfo.isFixForm==1){
$out+=' <input class="form-control" type="text" name="formName" placeholder="请输入流程名称" value="';
$out+=$escape(dataInfo?dataInfo.name:'');
$out+='" disabled title="系统默认不可更改"/> ';
}else{
$out+=' <input class="form-control" type="text" name="formName" placeholder="请输入流程名称" value="';
$out+=$escape(dataInfo?dataInfo.name:'');
$out+='"/> ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">编号<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input class="form-control" type="text" name="rulePrefixKey" placeholder="请输入编号" value="';
$out+=$escape(dataInfo?dataInfo.rulePrefixKey:'');
$out+='"/> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">说明：</label> <div class="col-sm-10"> ';
if(dataInfo && dataInfo.isSystem==1){
$out+=' <textarea placeholder="请输入说明" class="form-control" type="text" name="documentation" disabled title="系统默认不可更改">';
$out+=$escape(dataInfo?dataInfo.documentation:'');
$out+='</textarea> ';
}else{
$out+=' <textarea placeholder="请输入说明" class="form-control" type="text" name="documentation">';
$out+=$escape(dataInfo?dataInfo.documentation:'');
$out+='</textarea> ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">图标：</label> <div class="col-sm-10"> <div class="row "> <div class="col-xs-12 p-r-none"> ';
$each(iconList,function(p,i){
$out+=' <div class="pull-left m-b-sm m-r-sm"> <span class="icon-circle-out curp ';
$out+=$escape(dataInfo&&dataInfo.iconKey==p.id?'active':((dataInfo==null || dataInfo.iconKey==null)&&i==0?'active':''));
$out+='"> <span class="icon-circle ';
$out+=$escape(p.color);
$out+='"><i class="icon iconfont ';
$out+=$escape(p.id);
$out+='" data-icon="';
$out+=$escape(p.id);
$out+='"></i></span> </span> </div> ';
});
$out+=' </div> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_mgt_grid','<div class="m-approval-mgt-grid"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1 p-l-sm"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> </form> <div class="grid-content" id="gridContent"></div> <div class="clearfix"></div> </div>');/*v:1*/
template('m_approval/m_approval_mgt_grid_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,c=$data.c,ci=$data.ci,_getIconColor=$helpers._getIconColor,$out='';if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' ';
if(p.formList && p.formList.length>0){
$out+=' <h4 class="title-line">';
$out+=$escape(p.groupName);
$out+='</h4> <div class="p-xxs m-b-sm ';
$out+=$escape(i<dataList.length-1?'border-bottom':'');
$out+='"> ';
if(p.formList && p.formList.length>0){
$out+=' ';
$each(p.formList,function(c,ci){
$out+=' <div class="grid-item" data-id="';
$out+=$escape(c.id);
$out+='" data-pid="';
$out+=$escape(p.id);
$out+='" data-form-id="';
$out+=$escape(p.formId);
$out+='"> <span class="icon-circle vertical-middle ';
$out+=$escape(_getIconColor(c.iconKey?c.iconKey:'icon-zidingyibankuai'));
$out+='"> <i class="icon iconfont ';
$out+=$escape(c.iconKey?c.iconKey:'icon-zidingyibankuai');
$out+='" ></i> </span> <a class="btn btn-link p-l-xs p-r-none text-ellipsis" title="';
$out+=$escape(c.name);
$out+='" data-action="preview" data-form-id="';
$out+=$escape(c.formId);
$out+='" data-issystem="';
$out+=$escape(c.isSystem);
$out+='">';
$out+=$escape(c.name);
$out+='</a> <a class="btn btn-link p-l-xs p-r-none f-s-xs" data-action="setProcess" data-form-id="';
$out+=$escape(c.formId);
$out+='" data-type="';
$out+=$escape(c.type);
$out+='">流程设置</a> </div> ';
});
$out+=' ';
}
$out+=' <div class="clearfix"></div> </div> ';
}
$out+=' ';
});
$out+=' ';
}
return new String($out);
});/*v:1*/
template('m_approval/m_approval_mgt_moveToGroup','<form class="m"> <div class="form-group"> <label>选择流程分类：</label> <div> <select readonly="" name="groupName"> </select> </div> </div> </form> ');/*v:1*/
template('m_approval/m_approval_mgt_setProcess','<div class="m_approval_mgt_setProcess"> <div class="row"> <div class="col-sm-3 border-right of-auto p-t-lg p-l-lg" id="leftBox" style="height:500px;"> </div> <div class="col-sm-9" id="rightBox"> </div> </div> </div>');/*v:1*/
template('m_approval/m_approval_mgt_setProcessCondition',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,processData=$data.processData,$each=$utils.$each,o=$data.o,i=$data.i,$out='';$out+='<form class="form-horizontal m m_approval_mgt_setProcessCondition "> <div class="form-group"> <div class="col-md-12"> <h4>';
$out+=$escape(processData.name);
$out+='</h4> <p class="fc-v1-grey"> 请输入“<span id="processName">';
$out+=$escape(processData.name);
$out+='</span><span id="processUnit">（';
$out+=$escape(processData.unit);
$out+='）</span>”的分隔数字，我们将为您自动生成数值区间做为审批条件： </p> </div> </div> <div class="form-group"> <div class="col-md-12"> <p>请选择分组条件</p> <p class=""> ';
if(processData.optionalConditionList && processData.optionalConditionList.length>0){
$out+=' ';
$each(processData.optionalConditionList,function(o,i){
$out+=' <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal" data-name="';
$out+=$escape(o.name);
$out+='" data-unit="';
$out+=$escape(o.unit);
$out+='"> ';
if(i==0){
$out+=' <input type="radio" name="optionalCondition" value="';
$out+=$escape(o.id);
$out+='" checked/> ';
}else{
$out+=' <input type="radio" name="optionalCondition" value="';
$out+=$escape(o.id);
$out+='"/> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(o.name?o.name:'数字');
$out+='</span> </label> </div> ';
});
$out+=' ';
}
$out+=' </p> </div> </div> <div class="form-group m-b-xs"> <div class="col-md-2 m-b-xs"> <input class="form-control input-sm" type="text" name="conditionalVal"> </div> <div class="col-md-1 m-b-xs"> <a class="btn btn-primary btn-circle " type="button" data-action="addCondition"> <i class="fa fa-plus"></i> </a> </div> </div> <div class="error-tip m-b-xs"></div> <div class="well m-b-none"> <p>例如：</p> <p>1、输入“报销金额”分隔数字</p> <div class="row"> <div class="col-md-2 m-b-xs"> <input class="form-control input-sm" type="text" value="1000" readonly> </div> <div class="col-md-1 m-b-xs p-xxs text-center"> < </div> <div class="col-md-2 m-b-xs"> <input class="form-control input-sm" type="text" value="3000" readonly> </div> </div> <p>2、我们将为您自动生成数值区间做为审批条件</p> <div class="row"> <div class="col-md-12 "> <span class="label label-primary">报销金额 < 1000</span> </div> <div class="col-md-12 m-t-xs"> <span class="label label-white">审批人：张三</span> </div> <div class="col-md-12 m-t-xs"> <span class="label label-primary">1000 <= 报销金额 < 3000</span> </div> <div class="col-md-12 m-t-xs"> <span class="label label-white">审批人：李四</span> </div> <div class="col-md-12 m-t-xs"> <span class="label label-white">审批人：王五</span> </div> <div class="col-md-12 m-t-xs"> <span class="label label-primary">报销金额 >= 3000</span> </div> <div class="col-md-12 m-t-xs"> <span class="label label-white">审批人：张三</span> </div> </div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_mgt_setProcess_approver',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,flowTaskList=$data.flowTaskList,p=$data.p,i=$data.i,$escape=$utils.$escape,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,doType=$data.doType,$out='';$each(flowTaskList,function(p,i){
$out+=' <div class="approver-outbox"> <div class="approver-box text-center"> <div class="img-circle"> <img alt="image" class="img-circle" src="';
$out+=$escape(p.candidateUserList && p.candidateUserList.length>0 && !_isNullOrBlank(p.candidateUserList[0].imgUrl)?p.candidateUserList[0].imgUrl:_url('/img/head_default.png'));
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="50" height="50"> </div> <div class="m-t-xs full-width text-ellipsis" data-container="body" data-toggle="tooltip" data-original-title="';
$out+=$escape(p.name);
$out+='"> ';
$out+=$escape(p.name);
$out+=' </div> <a href="javascript:void(0);" class="approver-remove" data-action="removeApprover" data-type="';
$out+=$escape(doType);
$out+='" data-i="';
$out+=$escape(i);
$out+='" style="display: none;"> <i class="glyphicon glyphicon-remove"></i> </a> </div> </div> ';
if((i+1) < flowTaskList.length ){
$out+=' <div class="arrow-icon p-h-m"> <i class="fa fa-long-arrow-right"></i> </div> ';
}
$out+=' ';
});
return new String($out);
});/*v:1*/
template('m_approval/m_approval_mgt_setProcess_cc',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,userList=$data.userList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,$out='';if(userList!=null && userList.length>0){
$out+=' ';
$each(userList,function(p,i){
$out+=' <div class="approver-outbox"> <div class="approver-box text-center"> <div class="img-circle"> <img alt="image" class="img-circle" src="';
$out+=$escape(_isNullOrBlank(p.imgUrl)?_url('/img/head_default.png'):p.imgUrl);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="50" height="50"> </div> <div class="m-t-xs text-ellipsis full-width">';
$out+=$escape(p.name);
$out+='</div> <a href="javascript:void(0);" class="approver-remove" data-action="removeCcUser" data-i="';
$out+=$escape(i);
$out+='" style="display: none;"> <i class="glyphicon glyphicon-remove"></i> </a> </div> </div> ';
});
$out+=' ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_mgt_setProcess_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,treeSelectedData=$data.treeSelectedData,name=$data.name,isSystem=$data.isSystem,formId=$data.formId,optionalConditionList=$data.optionalConditionList,$out='';$out+='<div class="row m-t-lg"> <div class="col-md-2 text-right">部门：</div> <div class="col-md-10">';
$out+=$escape(treeSelectedData?treeSelectedData.text:'');
$out+='</div> </div> <div class="row m-t-sm"> <div class="col-md-2 text-right">模版模型：</div> <div class="col-md-10">';
$out+=$escape(name);
$out+='</div> </div> <div class="row m-t-sm"> <div class="col-md-2 text-right">审批流程：</div> <div class="col-md-10">  ';
if(isSystem==1 && formId!='attendanceClock'){
$out+=' <div class="m-b-xs"> <label class="i-checks i-checks-label"> <input class="ck" name="iCheck" type="radio" data-type="0" /> <span class="i-checks-span-default">无需审批</span> </label> </div> ';
}
$out+=' <div> <label class="i-checks i-checks-label"> <input class="ck" name="iCheck" type="radio" data-type="1" /> <span class="i-checks-span-default">自由流程</span> </label> <span class="fc-v1-grey dp-inline-block vertical-top">（组织成员可自行添加相应的审批人）</span> </div> <div class="m-t-xs"> <label class="i-checks i-checks-label"> <input class="ck" name="iCheck" type="radio" data-type="2" /> <span class="i-checks-span-default">固定流程</span> </label> <span class="fc-v1-grey dp-inline-block vertical-top">（组织成员需按照规定好的审批人流程进行审批）</span> </div> <div class="panel panel-default" data-type="2" data-i="0" style="display: none;"> <div class="panel-heading"> 当为“固定流程”时 </div> <div class="panel-body" > <div class="row"> <div class="col-24-xs-3 col-xl-1 p-t-md p-l-sm p-r-none text-center"> 审批人设置： </div> <div class="col-24-xs-21 col-xl-11 p-l-none panel-item" > <div class="approver-box text-center"> <a class="btn btn-default btn-circle " type="button" data-action="addApprover"> <i class="fa fa-plus"></i> </a> <div class="m-t-xs">添加</div> </div> </div> </div> <div class="row border-top p-t"> <div class="col-24-xs-3 col-xl-1 p-t-md p-l-sm p-r-none text-center"> 抄送人设置： </div> <div class="col-24-xs-21 col-xl-11 p-l-none panel-item"> <div class="approver-box text-center"> <a class="btn btn-default btn-circle" type="button" data-action="addCcUser"> <i class="fa fa-plus"></i> </a> <div class="m-t-xs">添加</div> </div> </div> </div> </div> <div class="panel-footer"> <p>比如组织报销流程为“酋长 > 部落”，设定固定流程后，组织成员填写审批单时，审批人已经默认设置为“酋长 > 部落”，且成员自己不能修改。 </p> </div> </div> <div class="m-t-xs"> ';
if((optionalConditionList && optionalConditionList.length>0) || formId=='projectPayApply'  ){
$out+=' <label class="i-checks i-checks-label"> <input class="ck" name="iCheck" type="radio" data-type="3" /> <span class="i-checks-span-default">分条件设置流程</span> </label> ';
}else{
$out+=' <label class="i-checks i-checks-label" title="当前审批不可设置此项"> <input class="ck" name="iCheck" type="radio" data-type="3" disabled title="当前审批不可设置此项"/> <span class="i-checks-span-default">分条件设置流程</span> </label> ';
}
$out+=' <span class="fc-v1-grey dp-inline-block vertical-top">（申请人提交的表单会进入相应审批条件设置的审批流程）</span> ';
if((optionalConditionList && optionalConditionList.length>0) || formId=='projectPayApply' ){
$out+=' <a class="btn btn-link vertical-top no-padding" data-action="setApprovalCondition" data-type="3" style="display: none;margin-top: -1px;">设置审批条件</a> ';
}else{
$out+=' <span class="fc-v1-grey dp-inline-block vertical-top">（当前没有可选的分组条件,不能选择此项！）</span> ';
}
$out+=' </div> <div id="flowTaskGroupList"> </div> </div> </div> <div class="row m-b-sm"> <div class="col-md-2"></div> <div class="col-md-10"> <a class="btn btn-primary" data-action="save">保存</a>  </div> </div>';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_mgt_setProcess_flow',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,flowTaskGroupList=$data.flowTaskGroupList,f=$data.f,i=$data.i,$escape=$utils.$escape,$out='';$each(flowTaskGroupList,function(f,i){
$out+=' <div class="panel panel-default" data-type="3" data-i="';
$out+=$escape(i);
$out+='"> <div class="panel-heading"> ';
$out+=$escape(f.title);
$out+=' </div> <div class="panel-body"> <div class="row"> <div class="col-24-xs-3 col-xl-1 p-t-md p-l-sm p-r-none text-center"> 审批人设置： </div> <div class="col-24-xs-21 col-xl-11 p-l-none panel-item" > <div class="approver-box text-center"> <a class="btn btn-default btn-circle " type="button" data-action="addApprover"> <i class="fa fa-plus"></i> </a> <div class="m-t-xs">添加</div> </div> </div> </div> <div class="row border-top p-t"> <div class="col-24-xs-3 col-xl-1 p-t-md p-l-sm p-r-none text-center"> 抄送人设置： </div> <div class="col-24-xs-21 col-xl-11 p-l-none panel-item"> <div class="approver-box text-center"> <a class="btn btn-default btn-circle" type="button" data-action="addCcUser"> <i class="fa fa-plus"></i> </a> <div class="m-t-xs">添加</div> </div> </div> </div> </div> </div> ';
});
return new String($out);
});/*v:1*/
template('m_approval/m_approval_mgt_tab','<div class="tabs-container m-t m-l m-r"> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="false">审批列表</a></li> <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">表单设置</a></li> <li class=""><a data-toggle="tab" href="#tab-3" aria-expanded="false">流程设置</a></li> </ul> <div class="tab-content"> <div id="tab-1" class="tab-pane active" data-type="approvalGrid"> <div class="panel-body"> </div> </div> <div id="tab-2" class="tab-pane" data-type="approvalList"> <div class="panel-body"> </div> </div> <div id="tab-3" class="tab-pane" data-type="processSettings"> <div class="panel-body no-padding"> <div class="border-bottom p-sm select-approval"> <select class="form-control" name="approvalList"></select> </div> <div id="processSettingsBox"> </div> </div> </div> </div> </div>');/*v:1*/
template('m_approval/m_approval_mgt_temp_select',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,_getProjectTempIcon=$helpers._getProjectTempIcon,_getIconColor=$helpers._getIconColor,c=$data.c,$index=$data.$index,_isNullOrBlank=$helpers._isNullOrBlank,$out='';$out+='<form class="form-horizontal m m-approval-mgt-temp-select"> <div class="row m-l-n-xs m-t-sm"> <div class="col-sm-3 temp-title-box"> <ul class="list-group no-shadow"> <li class="list-group-item no-borders curp" data-id="1"> <i class="fa fa-codepen m-r-sm"></i>空白模板 <span class="pull-right fc-v1-grey">1</span> </li> ';
if(dataList && dataList.length>0){
$out+=' <li class="list-group-item no-borders fc-dark-gray">复制已有模板</li> ';
$each(dataList,function(p,i){
$out+=' <li class="list-group-item no-borders curp" data-id="';
$out+=$escape(p.id);
$out+='"> <!--<i class="icon iconfont ';
$out+=$escape(_getProjectTempIcon(p.groupName));
$out+=' m-r-sm"></i>-->';
$out+=$escape(p.groupName);
$out+=' <span class="pull-right fc-v1-grey">';
$out+=$escape(p.formList.length);
$out+='</span> </li> ';
if(dataList[i].companyId!=null && dataList[i+1].companyId==null){
$out+=' <li class="list-group-item no-borders fc-dark-gray">系统模板</li> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </ul> </div> <div class="col-sm-9 temp-list-box"> <h3 class="fw-normal m-b-xs m-t-sm temp-name" data-id="1">空白模板</h3> <div class="row p-l-sm "> <div class="approval-temp-box border" data-action="addForm" data-id="" data-form-id=""> <span class="pull-left icon-circle ';
$out+=$escape(_getIconColor('icon-zidingyibankuai'));
$out+='"> <i class="icon iconfont icon-zidingyibankuai" ></i> </span> <div class="pt-absolute full-width p-l-xl m-l-xs"> <a class="btn btn-link text-ellipsis full-width p-b-xs text-left m-t-sm" >新的审批表单</a> </div> <div class="clearfix"></div> </div> </div> ';
if(dataList && dataList.length>0){
$out+=' <h3 class="title-line title-v2 bg-v1">企业模板</h3> ';
$each(dataList,function(p,i){
$out+=' <h3 class="fw-normal title-v1 temp-name" data-id="';
$out+=$escape(p.id);
$out+='"> ';
$out+=$escape(p.groupName);
$out+=' </h3> <div class="row p-l-sm"> ';
if(p.formList && p.formList.length>0){
$out+=' ';
$each(p.formList,function(c,$index){
$out+=' <div class="approval-temp-box border" data-action="addForm" data-id="';
$out+=$escape(c.id);
$out+='" data-form-id="';
$out+=$escape(c.formId);
$out+='"> <span class="pull-left icon-circle ';
$out+=$escape(_getIconColor(c.iconKey?c.iconKey:'icon-zidingyibankuai'));
$out+='"> <i class="icon iconfont ';
$out+=$escape(c.iconKey?c.iconKey:'icon-zidingyibankuai');
$out+='" ></i> </span> <div class="pt-absolute full-width p-l-xl m-l-xs"> <a class="btn btn-link text-ellipsis full-width p-b-xs text-left ';
$out+=$escape(_isNullOrBlank(c.documentation)?'m-t-sm':'');
$out+='" title="';
$out+=$escape(c.name);
$out+='">';
$out+=$escape(c.name);
$out+='</a> ';
if(!_isNullOrBlank(c.documentation)){
$out+=' <span class="text-ellipsis-2 fc-v3-grey full-width p-l p-r-sm f-s-xxs" title="';
$out+=$escape(c.documentation);
$out+='">';
$out+=$escape(c.documentation);
$out+='</span> ';
}
$out+=' </div> <div class="clearfix"></div> </div> ';
});
$out+=' ';
}
$out+=' </div> ';
if(dataList[i].companyId!=null && dataList[i+1].companyId==null){
$out+=' <h3 class="title-line title-v2 bg-v1">系统模板</h3> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_operational_comments',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,doType=$data.doType,isFreeProcess=$data.isFreeProcess,$out='';$out+='<form class="form-horizontal m ';
$out+=$escape(doType==1?'text-center':'');
$out+='" > ';
if(doType==2){
$out+=' <div class="m-b-sm"> <label>审批意见：</label> <textarea placeholder="请输入审批意见" class="form-control" type="text" name="auditMessage"></textarea> </div> ';
}
$out+=' ';
if(isFreeProcess=='1' && doType==1){
$out+=' <button type="button" class="btn btn-sm btn-default rounded m-t-lg m-b-lg" data-action="cancel">取消</button> <button type="button" class="btn btn-sm btn-primary rounded m-t-lg m-b-lg" data-action="agreeAndDone">同意并完成</button> <button type="button" class="btn btn-sm btn-primary rounded m-t-lg m-b-lg" data-action="agreeAndToNext">同意并继续</button> ';
}else{
$out+=' <button type="button" class="btn btn-sm btn-default rounded" data-action="cancel">取消</button> <button type="button" class="btn btn-sm btn-primary rounded" data-action="confirm">确定</button> ';
}
$out+=' </form> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_payment_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,audit=$data.audit,$escape=$utils.$escape,costPayDetail=$data.costPayDetail,auditList=$data.auditList,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,_isNullOrBlank=$helpers._isNullOrBlank,deleteReason=$data.deleteReason,attachList=$data.attachList,$each=$utils.$each,a=$data.a,i=$data.i,s=$data.s,_url=$helpers._url,typeStr=$data.typeStr,ccCompanyUserList=$data.ccCompanyUserList,u=$data.u,ui=$data.ui,isView=$data.isView,auditFlag=$data.auditFlag,currentCompanyUserId=$data.currentCompanyUserId,approveStatus=$data.approveStatus,$out='';$out+='<form class="form-horizontal p-sm overflow-y-auto m-dialog-resize"> ';
if(audit && audit.expNo){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">审批编号：</label> <div class="col-24-xs-21"> ';
$out+=$escape(audit.expNo);
$out+=' </div> </div> ';
}
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">发起人：</label> <div class="col-24-xs-21"> ';
$out+=$escape(costPayDetail.userName);
$out+=' </div> </div> ';
if(auditList && auditList.length>0){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">发起时间：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_momentFormat(auditList[0].approveDate,'YYYY/MM/DD'));
$out+=' </div> </div> ';
}
$out+=' <h4 class="title-line m-l-sm">审批详情</h4> <div class="hr-line-dashed m-t-none m-b-sm"></div> <div class="form-group"> <label class="col-24-xs-3 text-right">收款方：</label> <div class="col-24-xs-21"> ';
$out+=$escape(costPayDetail.toCompanyName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">关联项目：</label> <div class="col-24-xs-21"> ';
$out+=$escape(costPayDetail.projectName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">关联节点：</label> <div class="col-24-xs-21"> ';
$out+=$escape(costPayDetail.feeDescription);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">节点金额：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_expNumberFilter(costPayDetail.pointFee));
$out+=' 元 </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">付款金额：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_expNumberFilter(costPayDetail.fee));
$out+=' 元 </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">描述：</label> <div class="col-24-xs-21"> ';
$out+=$escape(costPayDetail.pointDetailDescription);
$out+=' </div> </div> ';
if(!_isNullOrBlank(deleteReason)){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">删除原因：</label> <div class="col-24-xs-21"> ';
$out+=$escape(deleteReason);
$out+=' </div> </div> ';
}
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">附件：</label> <div class="col-24-xs-21"> ';
if(attachList!=null && attachList.length>0){
$out+=' ';
$each(attachList,function(a,i){
$out+=' <span class="label m-r-xs" style="background: #ecf0f1;padding: 5px 10px;"> <a href="javascript:void(0)" data-action="preview" data-file-ext="';
$out+=$escape(a.fileExtName);
$out+='" data-net-file-id="';
$out+=$escape(a.id);
$out+='" data-src="';
$out+=$escape(a.fileFullPath);
$out+='" data-name="';
$out+=$escape(a.fileName);
$out+='"> ';
$out+=$escape(a.fileName);
$out+=' </a> </span> ';
});
$out+=' ';
}
$out+=' </div> </div> <h4 class="title-line m-l-sm">审批流程</h4> <div class="hr-line-dashed m-t-none m-b-sm" ></div> <div class="form-group"> <div class="col-sm-12 p-w-md"> <table class="table table-hover table-bordered m-b-xs" > <thead> <tr> <th width="40%">审批</th> <th width="40%">操作</th> <th width="20%">审批时间</th> </tr> </thead> <tbody> ';
if(auditList!=null && auditList.length>0){
$out+=' ';
$each(auditList,function(s,i){
$out+=' <tr> <td> ';
if(_isNullOrBlank(s.fileFullPath)){
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30"/> ';
}else{
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(s.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" > ';
}
$out+=' <span class="dp-inline-block"> <p class="m-b-none">';
$out+=$escape(s.userName);
$out+='</p> <p class="m-b-none fc-v1-grey">';
$out+=$escape(s.companyName);
$out+='</p> </span> </td> <td> ';
if(s.approveStatus=='1'){
$out+=' <p class="text-success m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}else if(s.approveStatus=='2' || s.approveStatus=='3'){
$out+=' <p class="text-danger m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}else{
$out+=' <p class="m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}
$out+=' ';
if(s.approveStatusName=='发起申请' && !_isNullOrBlank(s.remark)){
$out+=' <p class="fc-v1-grey m-b-none">';
$out+=$escape(typeStr);
$out+='备注：';
$out+=$escape(s.remark);
$out+='</p> ';
}
$out+=' ';
if(s.approveStatusName=='退回'  && !_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">退回原因：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}else if(!_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">审批意见：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}
$out+=' </td> <td> ';
$out+=$escape(_momentFormat(s.approveDate,'YYYY/MM/DD'));
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr> <td colspan="3" class="text-center">暂无数据</td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
if(ccCompanyUserList!=null && ccCompanyUserList.length>0){
$out+=' <h4 class="title-line m-l-sm">抄送人</h4> <div class="hr-line-dashed m-t-none m-b-sm"></div> <div class="form-group"> <div class="col-sm-12 p-w-md approval-out-box"> ';
$each(ccCompanyUserList,function(u,ui){
$out+=' <div class="approver-outbox"> <div class="approver-box "> <div class="img-circle"> <img alt="image" class="img-circle" src="';
$out+=$escape(_isNullOrBlank(u.fileFullPath)?_url('/img/head_default.png'):u.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" height="30"> </div> <div class="m-t-xs">';
$out+=$escape(u.userName);
$out+='</div> </div> </div> ';
});
$out+=' </div> </div> ';
}
$out+=' </form> <div class="footer border-b-radius text-right"> ';
if(isView){
$out+=' <button class="btn btn-default" data-action="cancel">关闭</button> ';
}else{
$out+=' <button class="btn btn-default" data-action="cancel">';
$out+=$escape(auditFlag!=null && auditFlag=='1'?'取消':'关闭');
$out+='</button> ';
if(auditFlag!=null && auditFlag=='1'){
$out+=' <button class="btn btn-primary" data-action="agree">同意</button> <button class="btn btn-success" data-action="returnBack">退回</button> ';
}
$out+=' ';
if(currentCompanyUserId==audit.companyUserId && (approveStatus=='0' || approveStatus=='5')){
$out+=' <button class="btn btn-warning" data-action="remind">提醒</button> ';
}
$out+=' ';
}
$out+=' </div> ';
return new String($out);
});/*v:1*/
template('m_approval/m_approval_submit_record',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,i=$data.i,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<form class="form-horizontal m"> <table class="table table-hover table-bordered table-responsive dataTable" > <thead> <tr> <th>序号</th> <th>申请时间</th> <th>申请人</th> <th>审批人</th> <th>审批时间</th> </tr> </thead> <tbody> ';
$each(dataList,function(p,i){
$out+=' <tr class="curp" data-type="';
$out+=$escape(p.type);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='"> <td>';
$out+=$escape(i+1);
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.expDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(p.userName);
$out+='</td> <td>';
$out+=$escape(p.auditPersonName);
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.approveDate,'YYYY/MM/DD'));
$out+='</td> </tr> ';
});
$out+=' ';
if(dataList==null || dataList.length==0){
$out+=' <tr class="no-data"> <td colspan="5" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </form> ';
return new String($out);
});/*v:1*/
template('m_imgCropper/m_imgCropper',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,thumbnailPreviewClass=$data.thumbnailPreviewClass,$out='';$out+='<div class="m_imgCropper" style="overflow: auto;max-height: 500px;min-height: 300px;"> <form class="form-horizontal rounded-4x noborder"> <div class="ibox m-b-xs"> <div class="ibox-content"> <div class="title row"> <div class="col-md-12"> <div class="margin-bottom-20"> <span>请先上传一张图片,支持jpg、jpeg、png格式。</span> <div class="btnFilePicker" class="dp-inline-block"></div> </div> </div> </div> <div class="setArea row m-b-xs hide"> <div class="col-md-9"> <div class="thumbnail thumbnail-style"> <img class="img-container img-responsive" src=""> </div> </div> <div class="col-md-3"> <div class="thumbnail thumbnail-style thumbnail-preview ';
$out+=$escape(thumbnailPreviewClass);
$out+='"> <div class="clearfix"> <div class="img-preview preview-md"></div> </div> </div> </div> </div> </div> </div> </form> </div>';
return new String($out);
});/*v:1*/
template('m_inviteBPartner/m_inviteBPartner',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,filePath=$data.filePath,$escape=$utils.$escape,_url=$helpers._url,companyName=$data.companyName,systemManager=$data.systemManager,cellphone=$data.cellphone,$out='';$out+='<div class="ibox"> <div class="ibox-title border-fff"> <span class="f-s-md dp-inline-block l-h-16">事业合伙人邀请组织</span> </div> <div class="ibox-content text-center"> <div class="m-b-sm"> ';
if(filePath!='' && filePath!=null){
$out+=' <img alt="image" class="img-circle width-100 height-100" src="';
$out+=$escape(filePath);
$out+='"> ';
}else{
$out+=' <img alt="image" class="img-circle width-100 height-100" src="';
$out+=$escape(_url('/img/default/org_default_headPic.png'));
$out+='"> ';
}
$out+=' </div> <p class="f-s-lg">';
$out+=$escape(companyName);
$out+='</p> <p class="f-s-m fc-v1-grey">企业负责人:';
$out+=$escape(systemManager);
$out+='</p> </div> <div class="ibox-content"> <div class="row"> <div class="col-sm-12"> <form role="form"> <div class="form-group"> <label class="f-s-m fw-400">您的手机号：</label> <p class="f-s-m fc-dark-blue fw-600">';
$out+=$escape(cellphone);
$out+='</p> </div> <div class="form-group"> <label class="f-s-m fw-400">输入完整手机号校验身份：</label> <input name="cellphone" id=\'cellphone\' placeholder="手机号" class="form-control"></div> <div class="form-group"> <a class="btn btn-primary btn-block btn-ok">确定</a> </div> </form> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_inviteBPartner/m_inviteBPartner_create_has',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,a_companyName=$data.a_companyName,$out='';$out+='<div class="ibox"> <div class="ibox-title border-fff"> <span class="f-s-md l-h-16 dp-inline-block" >创建新组织</span> </div> <div class="ibox-content"> <p class="f-s-m l-h-14 p-h-xs">该组织创建后将会自动成为&nbsp;<span class="fc-v1-yellow">';
$out+=$escape(a_companyName);
$out+='</span>&nbsp;的事业合伙人</p> <div class="row"> <div class="col-sm-12"> <form class="createOrgOBox"> <div class="form-group"> <input name="companyName" placeholder="组织名称" class="form-control"> </div> <div class="form-group pt-fixed" style="bottom: 0;left: 20px;right: 20px;"> <a class="btn btn-primary btn-lg btn-block btn-ok" data-action="createOrgSubmit">立即创建</a> </div> </form> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_inviteBPartner/m_inviteBPartner_create_hasNo',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,a_companyName=$data.a_companyName,$out='';$out+='<div class="ibox"> <div class="ibox-title border-fff"> <span class="dp-inline-block f-s-md l-h-16">创建账号和组织</span> </div> <div class="ibox-content"> <p class="f-s-m l-h-14 p-h-xs">该组织创建后将会自动成为&nbsp;<span class="fc-v1-yellow">';
$out+=$escape(a_companyName);
$out+='</span>&nbsp;的事业合伙人</p> <div class="row"> <div class="col-sm-12"> <form role="form" class="createOrgOBox"> <div class="form-group"> <label class="fw-400 f-s-m dp-block m-b-xs">个人信息：</label> <input name="userName" placeholder="姓名" class="form-control m-b-xs"> <input name="adminPassword" placeholder="密码" type="password" class="form-control m-b-xs"> <label class="fw-400 f-s-m dp-block">组织信息：</label> <input name="companyName" placeholder="组织名称" class="form-control m-b-xs"> </div> <div class="form-group pt-fixed" style="bottom: 0;left: 20px;right: 20px;"> <a class="btn btn-primary btn-lg btn-block btn-ok" data-action="createOrgAndAccountSubmit">立即创建</a> </div> </form> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_inviteBPartner/m_inviteBPartner_org',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,a_companyName=$data.a_companyName,$each=$utils.$each,companyList=$data.companyList,c=$data.c,i=$data.i,_url=$helpers._url,$out='';$out+='<div class="ibox"> <div class="ibox-title border-fff"> <span class="dp-inline-block f-s-md l-h-16">组织选择</span> </div> <div class="ibox-content no-pd"> <ul class="todo-list small-list m-invite-group"> <li><p class="f-s-m l-h-14 m-t-sm"> 请选择&nbsp;<span class="fc-v1-yellow">你已创建的组织</span>&nbsp;或&nbsp;<span class="fc-v1-yellow">新创建一个组织</span>&nbsp;成为&nbsp;<span class="fc-v1-yellow">“';
$out+=$escape(a_companyName);
$out+='”</span>&nbsp;的事业合伙人</p></li> ';
$each(companyList,function(c,i){
$out+=' ';
if(c.flag===1){
$out+=' <li class="unselectable" data-action="selectOrg" data-memo="';
$out+=$escape(c.memo);
$out+='"> <div class="ibox-content box-shadow border" style="padding: 10px 20px 5px;height:90px;"> <div class="dp-inline-block p-h-sm"> <p class="fc-v1-grey f-s-md l-h-16">';
$out+=$escape(c.companyName);
$out+='</p> <p class="f-s-xs l-h-12 fc-v1-grey">';
$out+=$escape(c.memo);
$out+='</p> </div> ';
if(c.filePath!=null && c.filePath!=''){
$out+=' <img alt="image" class="img-circle pull-right img-responsive hidden-xs" width="90" src="';
$out+=$escape(c.filePath);
$out+='"> ';
}else{
$out+=' <img alt="image" class="img-circle pull-right img-responsive hidden-xs" width="90" src="';
$out+=$escape(_url('/img/default/org_default_headPic.png'));
$out+='"> ';
}
$out+=' </div> </li> ';
}else{
$out+=' <li class="selectable" data-action="selectOrgApply" data-company-id="';
$out+=$escape(c.id);
$out+='" data-company-name="';
$out+=$escape(c.companyName);
$out+='"> <div class="ibox-content box-shadow border" style="padding: 10px 20px 5px;height:90px;"> <div class="dp-inline-block p-h-sm"> <p class="f-s-md l-h-16">';
$out+=$escape(c.companyName);
$out+='</p> <p class="f-s-xs l-h-12 fc-v1-grey">企业负责人:';
$out+=$escape(c.systemManager);
$out+='</p> </div> ';
if(c.filePath!=null && c.filePath!=''){
$out+=' <img alt="image" class="img-circle pull-right img-responsive hidden-xs" width="90" src="';
$out+=$escape(c.filePath);
$out+='"> ';
}else{
$out+=' <img alt="image" class="img-circle pull-right img-responsive hidden-xs" width="90" src="';
$out+=$escape(_url('/img/default/org_default_headPic.png'));
$out+='"> ';
}
$out+=' </div> </li> ';
}
$out+=' ';
});
$out+=' <li class="selectable"> <a href="javascript:void(0)"> <div class="ibox-content box-shadow border" style="padding: 0;"> <p style="font-size: 16px;line-height: 16px;"> <a href="javascript:void(0)" data-action="createOrg" style="padding: 20px 20px 15px;display: inline-block;width: 100%;">创建新组织</a> </p> </div> </a> </li> </ul> </div> </div>';
return new String($out);
});/*v:1*/
template('m_inviteBPartner/m_inviteBPartner_org_hasNo',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="ibox"> <div class="ibox-content text-center no-border p-r-none p-l-none"> <div class="m-b-md m-t-lg"> <img alt="image" class="img-circle width-200" src="';
$out+=$escape(_url('/img/default/defaultpage_pic_data.png'));
$out+='" > </div> <p class="f-s-lg m-t-md">你还没有组织，请先创建组织</p> <div class="form-group"> <a class="btn btn-primary btn-lg btn-ok" href="javascript:void(0)" data-action="createOrg">创建组织</a> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_inviteBPartner/m_inviteBPartner_success',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,companyName=$data.companyName,a_companyName=$data.a_companyName,$out='';$out+='<div class="ibox"> <div class="ibox-content text-center no-border p-l-none p-r-none"> <div class="m-b-sm"> <img alt="image" class="img-circle width-100" src="';
$out+=$escape(_url('/img/default/invite_success.png'));
$out+='" > </div> <p class="f-s-lg">恭喜！</p> <p class="f-s-m fc-v1-grey">';
$out+=$escape(companyName);
$out+=' 已经成为 ';
$out+=$escape(a_companyName);
$out+=' 的事业合伙人</p> </div> </div>';
return new String($out);
});/*v:1*/
template('m_login/m_forgetPWDStep1',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,title=$data.title,_serverUrl=$helpers._serverUrl,$out='';$out+='<style> .form-group{position: relative;} </style> <div class="passwordBox animated fadeInDown"> <div class="row"> <div class="col-md-12"> <div class="ibox-content"> <h2 class="font-bold">';
$out+=$escape(title);
$out+='</h2> <p> 请填写您的账号 </p> <div class="row"> <div class="col-lg-12"> <form class="m-t forgetStep1OBox"> <div class="form-group"> <input class="input-autofill-selected form-control" type="text" placeholder="请输入手机号" name="cellphone" id="cellphone" maxlength="11"> </div> <div class="form-group "> <div class="input-group"> <input placeholder="请输入验证码" class="input-autofill-selected input form-control" type="text" id="verifcationCode" name="verifcationCode" placeholder="验证码"> <span class="input-group-btn"> <a type="button" class="btn btn-u" id="getCode" data-action="getCode" style="width:96px;">获取验证码</a> </span> </div> </div> <a type="submit" class="btn btn-primary block full-width m-b" href="javascript:void(0)" data-action="nextStep">下一步</a> <p class="text-muted text-left">  <a href="';
$out+=$escape(_serverUrl('/#/login'));
$out+='">返回登录</a> </p> </form> </div> </div> </div> </div> </div> <hr>         </div> ';
return new String($out);
});/*v:1*/
template('m_login/m_forgetPWDStep2',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,title=$data.title,cellphone=$data.cellphone,$out='';$out+='<style> .form-group{position: relative;} </style> <div class="passwordBox animated fadeInDown"> <div class="row"> <div class="col-md-12"> <div class="ibox-content"> <h2 class="font-bold">';
$out+=$escape(title);
$out+='</h2>    <div class="row"> <div class="col-lg-12"> <form class="m-t forgetStep2OBox"> <div class="form-group"> <label class="label">注册手机号： <span class="cellPhone form-control-static">';
$out+=$escape(cellphone);
$out+='</span></label> </div> <div class="form-group"> <input class="form-control" type="text" placeholder="请输入密码" id="password" name="password" autocomplete="off" onfocus="this.type=\'password\'"> </div> <a type="submit" class="btn btn-primary block full-width m-b" href="javascript:void(0)" data-action="completeChange">完成</a> </form> </div> </div> </div> </div> </div> <hr>         </div>';
return new String($out);
});/*v:1*/
template('m_login/m_login','<style> div.ibox-content,div.login-form-qrcode-wrapper{float: left;} div.ibox-content{ width: 60%;border-radius: 4px;} div.login-form-qrcode-wrapper{ width: auto; background-color: transparent;} </style> <div class="ibox-content "> <div class="tabs-container tabs-container-1"> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="true">账号登录</a></li> <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">手机登录</a></li> </ul> <div class="tab-content min-h-50"> <div id="tab-1" class="tab-pane active"> <div class="panel-body no-padding" data-type="accountLogin"> <form class="m-t" id="loginForm"> <div class="form-group"> <input type="account" tabindex="1" id="cellphone" name="cellphone" placeholder="请输入您注册使用的手机号码" class="input-autofill-selected form-control margin-bottom-20 rounded" autocomplete="off" maxlength="11"> </div> <div class="form-group"> <input type="password" tabindex="2" id="password" name="password" placeholder="请输入登录密码" class="input-autofill-selected form-control margin-bottom-20 rounded" autocomplete="new-password" > </div> <div > <label class="i-checks i-checks-label "> <input name="remember" type="checkbox"/> <span class="i-checks-span fc-dark-gray">记住密码</span> </label> </div> <a class="btn btn-primary block full-width m-b" id="btnLogin" tabindex="3" type="submit">登录</a> </form> </div> </div> <div id="tab-2" class="tab-pane"> <div class="panel-body no-padding" data-type="mobileLogin"> <form id="mobileLoginForm" class="p-h-sm"> <div class="row m-b-md"> <div class="col-sm-12"> <input id="cellphone" name="cellphone" class="input-autofill-selected form-control" type="account" autocomplete="off" placeholder="请输入您注册使用的手机号码"> </div> </div> <div class="row"> <div class="col-sm-12"> <div class="input-group"> <input class="input-autofill-selected form-control" type="text" id="receiveCode" autocomplete="off" name="code" maxlength="11" placeholder="请输入手机验证码"> <span class="input-group-btn"> <a href="javascript:;" class="btn btn-default btn-code" data-action="receiveCode">获取验证码</a> </span> </div> </div> </div> <div class="row"> <div class="col-sm-12 p-t-md"> <a class="btn btn-primary block full-width" id="btnMobileLogin" tabindex="3" type="submit">登录</a> </div> </div> </form> </div> </div> </div> </div> <a href="#/forgetLoginPwd"> <small>忘记密码?</small> </a> </div> ');/*v:1*/
template('m_login/m_login_uptPassword',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,type=$data.type,$escape=$utils.$escape,cellphone=$data.cellphone,$out='';$out+='<form class="form-horizontal rounded-bottom changePassWordOBox"> <input type="password" style="display:none;"> <div class="panel-body"> <div class="col-md-12"> ';
if(type==1){
$out+=' <div class="form-group"> <label class="col-sm-12">当前账号';
$out+=$escape(cellphone);
$out+='的密码过于简单，请重新设定8位以上包含大小写字母数字及特殊字符组合的密码! </label> </div> ';
}else{
$out+=' <div class="form-group"> <label class="col-sm-12">当前账号';
$out+=$escape(cellphone);
$out+='已经超过180天没有修改密码了，请重新设定8位以上包含大小写字母数字及特殊字符组合的密码! </label> </div> ';
}
$out+=' <div class="form-group"> <label class="col-sm-3 control-label">旧密码<span class="fc-red">*</span></label> <div class="col-sm-9"> <input type="password" class="form-control changePwdDtoOldPwd" name="oldPassword" > </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">新密码<span class="fc-red">*</span></label> <div class="col-sm-9"> <input type="password" class="form-control changePwdDtoPwd" name="password" id="newPassword"> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">确认新密码<span class="fc-red">*</span></label> <div class="col-sm-9"> <input type="password" class="form-control changePwdDtoRePwd" name="rePassword"> </div> </div> <div class="form-group row" style="margin-left: 10px;margin-right: 11px"> <div class="row col-24-md-21"> <input placeholder="请输入验证码" class="input-autofill-selected input form-control" autocomplete="false" type="text" id="verifcationCode" name="verifcationCode" placeholder="验证码"> </div> <div class="row col-24-md-3"> <span class="input-group-btn"> <a type="button" class="btn btn-u" id="getCode" data-action="getCode" style="width:96px;">获取验证码</a> </span> </div> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_login/m_popover_login','<form id="loginForm" style="width: 240px;"> <div class="form-group"> <input type="text" tabindex="1" id="cellphone" name="cellphone" placeholder="请输入手机号码" class="form-control margin-bottom-20 rounded" maxlength="11"> </div> <div class="form-group"> <input type="text" tabindex="2" id="password" name="password" placeholder="请输入登录密码" class="form-control margin-bottom-20 rounded" autocomplete="off" onfocus="this.type=\'password\'"> </div> <div class="form-group" style="margin-bottom: 0;overflow: hidden;"> <a class="btn-u btn-u-dark-blue block full-width m-b rounded text-center m-popover-submit" id="btnLogin" tabindex="3">登录</a> <a data-url="#/forgetLoginPwd" href="javascript:void(0)" id="btnForgetPwd" class="pull-right"> <small>忘记密码？</small> </a> </div> </form>');/*v:1*/
template('m_login/m_register',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_serverUrl=$helpers._serverUrl,_url=$helpers._url,cdnUrl=$data.cdnUrl,$out='';$out+='<style> .form-group{position: relative;} </style> <div class="middle-box text-center loginscreen animated fadeInDown"> <div> <div class="text-center" style=" margin-bottom: 36px;"> <a href="';
$out+=$escape(_serverUrl('/'));
$out+='"><object data="';
$out+=$escape(_url('/img/logo_white.png'));
$out+='" style="width: 50px;"></object></a> </div>  <form class="m-t registerOBox" role="form" action="login.html"> <div class="form-group text-left"> <input class="form-control" type="text" placeholder="手机号" name="cellphone" id="cellphone" maxlength="11"> </div> <div class="form-group text-left"> <div class="input-group"> <input placeholder="验证码" class="input form-control" type="text" id="verifcationCode" name="verifcationCode" placeholder="验证码"> <span class="input-group-btn"> <a type="button" class="btn btn-u" id="getCode" data-action="getCode" style="width:96px;">获取验证码</a> </span> </div> </div> <div class="form-group text-left"> <input class="form-control" type="text" placeholder="姓名" id="userName" name="userName"> </div> <div class="form-group text-left"> <input class="form-control" type="text" placeholder="密码，至少包含6位字符" id="password" name="password" autocomplete="off" onfocus="this.type=\'password\'" maxlength="32"> </div> <div class="form-group text-left"> <input type="checkbox" id="serviceTerm" name="serviceTerm"/><span style="display: inline-block;margin-left: 5px;">已阅读并同意 <a href="';
$out+=$escape(cdnUrl);
$out+='/download/SeriveTerm.pdf" target="_blank">《用户服务协议》</a></span> </div> <a type="submit" class="btn btn-primary block full-width m-b" href="javascript:void(0)" data-action="submitRegister">注册</a> <p class="text-muted text-center"> <small>已有账号？</small> <a href="';
$out+=$escape(_serverUrl('/#/login'));
$out+='">立即登录</a> </p> </form> </div> </div>';
return new String($out);
});/*v:1*/
template('m_inviteBranch/m_inviteBranch',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,filePath=$data.filePath,$escape=$utils.$escape,_url=$helpers._url,companyName=$data.companyName,systemManager=$data.systemManager,cellphone=$data.cellphone,$out='';$out+='<div class="ibox"> <div class="ibox-title border-fff"> <span class="f-s-md dp-inline-block l-h-16">分支机构邀请组织</span> </div> <div class="ibox-content text-center"> <div class="m-b-sm"> ';
if(filePath!='' && filePath!=null){
$out+=' <img alt="image" class="img-circle width-100 height-100" src="';
$out+=$escape(filePath);
$out+='"> ';
}else{
$out+=' <img alt="image" class="img-circle width-100 height-100" src="';
$out+=$escape(_url('/img/default/org_default_headPic.png'));
$out+='"> ';
}
$out+=' </div> <p class="f-s-lg">';
$out+=$escape(companyName);
$out+='</p> <p class="f-s-m fc-v1-grey">企业负责人:';
$out+=$escape(systemManager);
$out+='</p> </div> <div class="ibox-content"> <div class="row"> <div class="col-sm-12"> <form role="form"> <div class="form-group"> <label class="f-s-m fw-400">您的手机号：</label> <p class="f-s-m fc-dark-blue fw--600">';
$out+=$escape(cellphone);
$out+='</p> </div> <div class="form-group"> <label class="f-s14 fw-400">输入完整手机号校验身份：</label> <input name="cellphone" id=\'cellphone\' placeholder="手机号" class="form-control"></div> <div class="form-group"> <a class="btn btn-primary btn-block btn-ok">确定</a> </div> </form> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_inviteBranch/m_inviteBranch_create_has',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,a_companyName=$data.a_companyName,$out='';$out+='<div class="ibox"> <div class="ibox-title border-fff"> <span class="f-s-md l-h-16 dp-inline-block">创建新组织</span> </div> <div class="ibox-content"> <p class="f-s-m l-h-14 p-h-xs">该组织创建后将会自动成为&nbsp;<span class="fc-v1-yellow">';
$out+=$escape(a_companyName);
$out+='</span>&nbsp;的分支机构</p> <div class="row"> <div class="col-sm-12"> <form class="createOrgOBox"> <div class="form-group"> <input name="companyName" placeholder="组织名称" class="form-control"> </div> <div class="form-group pt-fixed" style="bottom: 0;left: 20px;right: 20px;"> <a class="btn btn-primary btn-lg btn-block btn-ok" data-action="createOrgSubmit">立即创建</a> </div> </form> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_inviteBranch/m_inviteBranch_create_hasNo',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,a_companyName=$data.a_companyName,$out='';$out+='<div class="ibox"> <div class="ibox-title border-fff"> <span class="f-s-md l-h-16 dp-inline-block">创建账号和组织</span> </div> <div class="ibox-content"> <p class="f-s-m l-h-14 p-h-xs">该组织创建后将会自动成为&nbsp;<span class="fc-v1-yellow">';
$out+=$escape(a_companyName);
$out+='</span>&nbsp;的分支机构</p> <div class="row"> <div class="col-sm-12"> <form role="form" class="createOrgOBox"> <div class="form-group"> <label class="f-s-m fw-400 dp-block">个人信息：</label> <input name="userName" placeholder="姓名" class="form-control m-b-xs"> <input name="adminPassword" placeholder="密码" type="password" class="form-control m-b-xs"> <label class="f-s-m fw-400 dp-block">组织信息：</label> <input name="companyName" placeholder="组织名称" class="form-control m-b-xs"> </div> <div class="form-group pt-fixed" style="bottom: 0;left: 20px;right: 20px;"> <a class="btn btn-primary btn-lg btn-block btn-ok" data-action="createOrgAndAccountSubmit">立即创建</a> </div> </form> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_inviteBranch/m_inviteBranch_org',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,a_companyName=$data.a_companyName,$each=$utils.$each,companyList=$data.companyList,c=$data.c,i=$data.i,_url=$helpers._url,$out='';$out+='<div class="ibox"> <div class="ibox-title border-fff"> <span class="f-s-md l-h-16 dp-inline-block">组织选择</span> </div> <div class="ibox-content no-pd"> <ul class="todo-list small-list m-invite-group"> <li><p class="f-s-m l-h-14 m-t-sm"> 请选择&nbsp;<span class="fc-v1-yellow">你已创建的组织</span>&nbsp;或&nbsp;<span class="fc-v1-yellow">新创建一个组织</span>&nbsp;成为&nbsp;<span class="fc-v1-yellow">“';
$out+=$escape(a_companyName);
$out+='”</span>&nbsp;的分支机构</p></li> ';
$each(companyList,function(c,i){
$out+=' ';
if(c.flag===1){
$out+=' <li class="unselectable" data-action="selectOrg" data-memo="';
$out+=$escape(c.memo);
$out+='"> <div class="ibox-content box-shadow border" style="padding: 10px 20px 5px;height:90px;"> <div class="dp-inline-block p-h-sm"> <p class="f-s-md l-h-16 fc-v1-grey">';
$out+=$escape(c.companyName);
$out+='</p> <p class="f-s-xs l-h-12 fc-v1-grey">';
$out+=$escape(c.memo);
$out+='</p> </div> ';
if(c.filePath!=null && c.filePath!=''){
$out+=' <img alt="image" class="img-circle pull-right img-responsive hidden-xs" width="90" src="';
$out+=$escape(c.filePath);
$out+='"> ';
}else{
$out+=' <img alt="image" class="img-circle pull-right img-responsive hidden-xs" width="90" src="';
$out+=$escape(_url('/img/default/org_default_headPic.png'));
$out+='"> ';
}
$out+=' </div> </li> ';
}else{
$out+=' <li class="selectable" data-action="selectOrgApply" data-company-id="';
$out+=$escape(c.id);
$out+='" data-company-name="';
$out+=$escape(c.companyName);
$out+='"> <div class="ibox-content box-shadow border" style="padding: 10px 20px 5px;height:90px;"> <div class="dp-inline-block p-h-sm"> <p class="f-s-md l-h-16">';
$out+=$escape(c.companyName);
$out+='</p> <p class="f-s-xs l-h-12 fc-v1-grey">企业负责人:';
$out+=$escape(c.systemManager);
$out+='</p> </div> ';
if(c.filePath!=null && c.filePath!=''){
$out+=' <img alt="image" class="img-circle pull-right img-responsive hidden-xs" width="90" src="';
$out+=$escape(c.filePath);
$out+='"> ';
}else{
$out+=' <img alt="image" class="img-circle pull-right img-responsive hidden-xs" width="90" src="';
$out+=$escape(_url('/img/default/org_default_headPic.png'));
$out+='"> ';
}
$out+=' </div> </li> ';
}
$out+=' ';
});
$out+=' <li class="selectable"> <a href="javascript:void(0)"> <div class="ibox-content box-shadow border" style="padding: 0;"> <p class="f-s-md l-h-16"> <a href="javascript:void(0)" data-action="createOrg" style="padding: 20px 20px 15px;display: inline-block;width: 100%;">创建新组织</a> </p> </div> </a> </li> </ul> </div> </div>';
return new String($out);
});/*v:1*/
template('m_inviteBranch/m_inviteBranch_org_hasNo',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="ibox"> <div class="ibox-content text-center no-border p-l-none p-r-none"> <div class="m-b-md m-t-lg"> <img alt="image" class="img-circle width-200" src="';
$out+=$escape(_url('/img/default/defaultpage_pic_data.png'));
$out+='" > </div> <p class="f-s-lg m-t-md">你还没有组织，请先创建组织</p> <div class="form-group"> <a class="btn btn-primary btn-lg btn-ok" href="javascript:void(0)" data-action="createOrg">创建组织</a> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_inviteBranch/m_inviteBranch_success',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,companyName=$data.companyName,a_companyName=$data.a_companyName,$out='';$out+='<div class="ibox"> <div class="ibox-content text-center no-border p-r-none p-l-none"> <div class="m-b-sm"> <img alt="image" class="img-circle width-100" src="';
$out+=$escape(_url('/img/default/invite_success.png'));
$out+='" > </div> <p class="f-s-lg">恭喜！</p> <p class="f-s-m fc-v1-grey">';
$out+=$escape(companyName);
$out+=' 已经成为 ';
$out+=$escape(a_companyName);
$out+=' 的分支机构</p> </div> </div>';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project','<div class="ibox m-light-project"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li class="active"> <strong>协同任务</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content">  <div class="row">  <form role="form" class="form-inline m-b-sm p-w-sm" id="conditionSearch"> <div class="row"> <div class="col-md-12" id="timeSelect"> </div> <div class="col-md-12" id="groupSelect"> </div> <div class="col-md-12" id="statusSelect"> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-primary btn-sm" data-action="addLightProject"><i class="fa fa-plus f-s-m" ></i>&nbsp;创建任务</button> </div> </div> </form> <div class="col-24-sm-24"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> </div> </div> ');/*v:1*/
template('m_light_project/m_light_project_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,templateId=$data.templateId,projectInfo=$data.projectInfo,$each=$utils.$each,p=$data.p,$index=$data.$index,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<form class="form-horizontal m-light-project-add m"> ';
if(templateId && projectInfo){
$out+=' <div class="row no-margin dp-flex"> <div class="col-sm-6 border-right"> <div class="text-center fc-v3-grey m-b-sm">工作流</div> <div class="template-task-flow m-t-lg"> <ul class="overview-content dp-flex"> ';
if(projectInfo.groupList && projectInfo.groupList.length>0){
$out+=' ';
$each(projectInfo.groupList,function(p,$index){
$out+=' <li class="template-task-flow-item taskflow m-r-md"> <span class="item-name">';
$out+=$escape(p.group.name);
$out+='</span> </li> ';
});
$out+=' ';
}
$out+=' </ul> </div> </div> <div class="col-sm-6"> <div class="text-center fc-dark-gray m-b-sm"> 正在从模板“';
$out+=$escape(projectInfo.project.projectName);
$out+='”创建新任务 </div> <div class="form-group"> <label class="col-sm-12">任务名称<span class="fc-red">*</span>：</label> <div class="col-sm-12 p-r-none"> <input placeholder="请输入任务名称" class="form-control" type="text" name="projectName" value="';
$out+=$escape(dataInfo?dataInfo.projectName:'');
$out+='"> </div> </div> <div class="row"> <div class="col-sm-6"> <div class="form-group"> <label class="col-sm-12">任务分组：</label> <div class="col-sm-10 p-r-none"> <select class="form-control" name="groupId"></select> </div> <div class="col-sm-2 no-padding"> <button class="btn btn-link" data-action="editGroup" title="创建分组"> <i class="fa fa-plus f-s-md"></i> </button> </div> </div> </div> <div class="col-sm-6"> <div class="form-group"> <label class="col-sm-12 p-r-none">负责人：</label> <div class="col-sm-12 p-r-none"> <select class="form-control" name="principalUsrId"></select> </div> </div> </div> </div> <div class="row"> <div class="col-sm-6"> <div class="form-group"> <label class="col-sm-12 p-r-none">开始时间：</label> <div class="col-sm-12 p-r-none"> <div class="input-group"> <input type="text" class="form-control" id="ipt_startDate" name="startDate" placeholder="开始时间" readonly onFocus="WdatePicker({maxDate:\'#F{$dp.$D(\\\'ipt_endDate\\\')}\'})" value="';
$out+=$escape(dataInfo?dataInfo.startDate:'');
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> </div> </div> <div class="col-sm-6"> <div class="form-group"> <label class="col-sm-12 p-r-none">结束时间：</label> <div class="col-sm-12 p-r-none"> <div class="input-group "> <input type="text" class="form-control" id="ipt_endDate" name="endDate" placeholder="结束时间" readonly onFocus="WdatePicker({minDate:\'#F{$dp.$D(\\\'ipt_startDate\\\')}\'})" value="';
$out+=$escape(dataInfo?dataInfo.endDate:'');
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> </div> </div> </div> </div> </div> ';
}else{
$out+=' <div class="form-group"> <label class="col-sm-2 control-label p-r-none">任务名称<span class="fc-red">*</span>：</label> <div class="col-sm-9 p-r-none"> <input placeholder="请输入任务名称" class="form-control" type="text" name="projectName" value="';
$out+=$escape(dataInfo?dataInfo.projectName:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label p-r-none">任务分组：</label> <div class="col-sm-9 p-r-none"> <select class="form-control" name="groupId"></select> </div> <div class="col-sm-1 no-padding"> <button class="btn btn-link" data-action="editGroup" title="创建分组"> <i class="fa fa-plus f-s-md"></i> </button> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label p-r-none">负责人：</label> <div class="col-sm-9 p-r-none"> <select class="form-control" name="principalUsrId"></select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label p-r-none">开始时间：</label> <div class="col-sm-9 p-r-none"> <div class="input-group"> <input type="text" class="form-control" id="ipt_startDate" name="startDate" placeholder="开始时间" readonly onFocus="WdatePicker({maxDate:\'#F{$dp.$D(\\\'ipt_endDate\\\')}\'})" value="';
$out+=$escape(dataInfo?dataInfo.startDate:'');
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label p-r-none">结束时间：</label> <div class="col-sm-9 p-r-none"> <div class="input-group "> <input type="text" class="form-control" id="ipt_endDate" name="endDate" placeholder="结束时间" readonly onFocus="WdatePicker({minDate:\'#F{$dp.$D(\\\'ipt_startDate\\\')}\'})" value="';
$out+=$escape(dataInfo?dataInfo.endDate:'');
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label p-r-none">任务状态：</label> <div class="col-sm-9 p-r-none"> <select class="form-control" name="status"> <option value="2">未开始</option> <option value="0" selected>进行中</option> <option value="3">已暂停</option> <option value="4">已终止</option> <option value="1">已完成</option> </select> </div> </div> ';
}
$out+=' </form> ';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_detail',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,doType=$data.doType,fromType=$data.fromType,$escape=$utils.$escape,projectName=$data.projectName,$out='';if(doType==2){
$out+=' <div class="m-light-project-detail"> <div id="projectContent"></div> </div> ';
}else{
$out+=' <div class="ibox m-light-project-detail m-b-none"> <div class="ibox-title secondary-menu-outbox"> ';
if(fromType==2){
$out+=' <div class="row p-t-sm"> <div class="col-sm-6"> <span>模板名称：<span class="project-name">';
$out+=$escape(projectName?projectName:'');
$out+='</span></span> <a data-action="editProject"><i class="icon iconfont icon-bianji"></i>编辑</a> </div> <div class="col-sm-6 p-r-sm text-right"> <a class="fc-v3-grey" href="javascript:;" data-action="closeDialog"><i class="icon iconfont icon-quxiao"></i></a> </div> </div> ';
}else{
$out+=' <div class="row"> <div class="col-sm-6" id="secondary-menu">  <div class="pull-left" id="breadcrumb"></div> </div> <div class="col-sm-6 p-t-7 p-r-sm text-right"> ';
if(doType==1 && fromType==null){
$out+=' <button class="btn btn-primary" data-action="switchProjectByView" data-type="1" title="标准看板"><i class="fa fa-trello"></i></button> <button class="btn btn-primary btn-outline" data-action="switchProjectByView" data-type="2" title="成员看板"><i class="fa fa-user" ></i></button> <button class="btn btn-primary btn-outline" data-action="switchProjectByView" data-type="3" title="表格看板"><i class="fa fa-table" ></i></button> ';
}
$out+=' ';
if(fromType==1){
$out+=' <button class="btn btn-default" onclick="javascript:window.location.href=\'#/myTask/light?status=1\'">返回</button> ';
}
$out+=' ';
if(doType==1){
$out+=' <button class="btn btn-danger" data-action="delProject">删除</button> <button class="btn btn-primary" data-action="editProject">编辑</button> <button class="btn btn-primary" data-action="addProjectMember"><i class="fa fa-plus f-s-m" ></i>&nbsp;人员</button> ';
}
$out+=' </div> </div> ';
}
$out+=' </div> <div class="ibox-content" id="projectContent"> </div> </div> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_detail_kanban',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataInfo=$data.dataInfo,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,kanbanType=$data.kanbanType,d=$data.d,di=$data.di,_isNullOrBlank=$helpers._isNullOrBlank,doType=$data.doType,fromType=$data.fromType,_momentFormat=$helpers._momentFormat,_interceptName=$helpers._interceptName,$out='';if(dataInfo.groupList){
$out+=' ';
$each(dataInfo.groupList,function(p,i){
$out+=' <div class="panel panel-default panel-kanban" id="panel-';
$out+=$escape(p.group.id);
$out+='" data-group-id="';
$out+=$escape(p.group.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='"> <div class="panel-heading"> <!--<span class="f-s-md fw-bold">';
$out+=$escape(p.group.name);
$out+='</span>--> ';
if(kanbanType==1){
$out+=' <a class="task-group-name show-span dp-inline-block-1 vertical-top m-t-xxs curp text-ellipsis" data-action="editTaskGroup" data-value="';
$out+=$escape(p.group.name);
$out+='" data-key="groupName" data-placeholder="请输入版块名称" data-type="1" data-valid="1" data-max-length="100"> ';
$out+=$escape(p.group.name);
$out+=' </a> ';
}else{
$out+=' <span class="task-group-name dp-inline-block-1 vertical-top m-t-xxs text-ellipsis"> ';
$out+=$escape(p.group.name);
$out+=' </span> ';
}
$out+=' <span class="list-count fc-v1-grey">·<i>';
$out+=$escape(p.detailList.length);
$out+='</i></span> ';
if(kanbanType==1){
$out+=' <div class="btn-group pull-right"> <button data-toggle="dropdown" class="btn btn-link no-padding dropdown-toggle" data-action="dropdownToggle" aria-expanded="false"><i class="fa fa-ellipsis-v"></i></button> <ul class="dropdown-menu pt-relative hide"> <li><a href="javascript:;" data-action="editGroupName" data-id="';
$out+=$escape(p.group.id);
$out+='">修改版块标题</a></li> <li><a href="javascript:;" data-action="delGroup" data-id="';
$out+=$escape(p.group.id);
$out+='">删除版块</a></li> </ul> </div> ';
}
$out+=' </div> <div class="panel-body no-padding"> <ul class="list-group no-shadow" id="list-group-';
$out+=$escape(p.group.id);
$out+='"> ';
if(p.detailList && p.detailList.length>0){
$out+=' ';
$each(p.detailList,function(d,di){
$out+=' <li class="list-group-item p-sm" data-id="';
$out+=$escape(d.id);
$out+='" data-original-group="';
$out+=$escape(p.group.id);
$out+='" data-i="';
$out+=$escape(di);
$out+='"> <div> <label class="i-checks i-checks-label fw-normal"> ';
if(!_isNullOrBlank(d.completeDate)){
$out+=' <input name="taskItem" type="checkbox" checked value=""/> ';
}else{
$out+=' <input name="taskItem" type="checkbox" value=""/> ';
}
$out+=' <span class="i-checks-span"></span> </label> <span class="task-name dp-inline-block vertical-top m-t-xxs curp ';
$out+=$escape(!_isNullOrBlank(d.completeDate)?'todo-completed':'');
$out+='" data-action="taskDetail">';
$out+=$escape(d.taskName);
$out+='</span> <div class="pull-right"> <div class="btn-group"> <button data-toggle="dropdown" class="btn btn-default btn-xs dropdown-toggle" data-action="dropdownToggle" aria-expanded="false"> <span class="caret"></span> </button> <ul class="dropdown-menu pt-relative hide"> ';
if(doType==1 && fromType!=2){
$out+=' <li><a href="javascript:;" data-action="moveTask" data-type="2" data-id="';
$out+=$escape(d.id);
$out+='">移动</a></li> <li><a href="javascript:;" data-action="copyTask" data-type="1" data-id="';
$out+=$escape(d.id);
$out+='">复制</a></li> ';
}
$out+=' <li><a href="javascript:;" data-action="delTask" data-id="';
$out+=$escape(d.id);
$out+='">删除</a></li> </ul> </div> </div> <div class="clearfix"></div> </div> ';
if(d.severity){
$out+=' <div class="p-l-l"> ';
if(d.severity=='1'){
$out+=' <label class="label label-danger" data-value="';
$out+=$escape(d.severity);
$out+='"><span>高</span></label> ';
}else if(d.severity=='2'){
$out+=' <label class="label label-success" data-value="';
$out+=$escape(d.severity);
$out+='"><span>中</span></label> ';
}else if(d.severity=='3'){
$out+=' <label class="label label-warning" data-value="';
$out+=$escape(d.severity);
$out+='"><span>低</span></label> ';
}
$out+=' </div> ';
}
$out+=' ';
if(!_isNullOrBlank(d.startDate) || !_isNullOrBlank(d.endDate)){
$out+=' <div class="m-t-xs p-l-l"> <span class="glyphicon glyphicon-time dp-inline-block"></span> <span>';
$out+=$escape(_momentFormat(d.startDate,'YYYY/MM/DD'));
$out+=' - ';
$out+=$escape(_momentFormat(d.endDate,'YYYY/MM/DD'));
$out+='</span> </div> ';
}
$out+=' ';
if(d.principalUser || (d.checkItemSize && d.checkItemSize>0) || (kanbanType==2)){
$out+=' <div class="m-t-xs p-l-l"> <div class="pull-left"> ';
if(d.checkItemSize && d.checkItemSize>0){
$out+=' <span class="icon iconfont icon-renwudiaodu dp-inline-block"></span> <span>';
$out+=$escape(d.completeCheckItemSize);
$out+='/';
$out+=$escape(d.checkItemSize);
$out+='</span> ';
}
$out+=' </div> ';
if(kanbanType==1){
$out+=' ';
if(doType==1 && fromType!=2 && d.principalUser){
$out+=' <span class="label label-info label-circle dp-inline-block-1 pull-right" title="';
$out+=$escape(d.principalUser.userName);
$out+='">';
$out+=$escape(_interceptName(d.principalUser.userName,2));
$out+='</span> ';
}
$out+=' ';
}else{
$out+=' <span class="label label-info dp-inline-block-1 pull-right text-ellipsis width-60" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(d.groupName);
$out+='">';
$out+=$escape(d.groupName);
$out+='</span> ';
}
$out+=' <div class="clearfix"></div> </div> ';
}
$out+=' </li> ';
});
$out+=' ';
}
$out+=' </ul> </div> <div class="panel-footer ';
$out+=$escape(p.detailList && p.detailList.length>0?'':'b-t-none');
$out+='"> <a href="javascript:void(0)" data-action="addTask"> <i class="icon iconfont icon-tianjia1 f-s-md"></i> <span class="">&nbsp;添加新工作项...</span> </a> </div> </div> ';
});
$out+=' ';
}
$out+=' ';
if(kanbanType==1){
$out+=' <div class="panel panel-default panel-kanban"> <div class="panel-heading row-hover task-group-add"> <a href="javascript:void(0)" data-action="addTaskGroup" data-key="groupName" data-type="1" data-valid="1"> <i class="icon iconfont icon-tianjia1 f-s-md"></i> <span class="hide">&nbsp;添加新板块...</span> </a> </div> </div> ';
}
$out+='  ';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_detail_task_item_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,doType=$data.doType,fromType=$data.fromType,$out='';$out+='<form class="form-horizontal m"> <div class="form-group m-b-none"> <input class="form-control" name="taskName" placeholder="输入新工作项标题"/> </div> <div class="form-group m-b-xs" id="tagsBox"> </div> <div class="form-group m-b-xs"> <span class="glyphicon glyphicon-time dp-inline-block"></span> ';
if(doType==1 && fromType!=2){
$out+=' <a class="dp-inline-block input-time" data-action="selectTime" data-start-time="" data-end-time=""> <span class="fc-dark-gray">设置时间</span> </a> ';
}else{
$out+=' <a class="dp-inline-block btn btn-link input-time" disabled="disabled"> <span class="fc-dark-gray">设置时间</span> </a> ';
}
$out+=' </div> <div class="form-group m-b-none"> <span class="glyphicon glyphicon-user dp-inline-block"></span> ';
if(doType==1 && fromType!=2){
$out+=' <a class="btn btn-link select-user" data-action="selectUser" data-type="12" data-key="principalUsrId" data-value="" data-cookies="0" data-url-type="3" data-multiple="0" data-is-clear="1"> <span class="fc-dark-gray">负责人</span> </a> ';
}else{
$out+=' <a class="btn btn-link select-user" disabled="disabled" data-action=""> <span class="fc-dark-gray">负责人</span> </a> ';
}
$out+=' </div> <div class="form-group border-top p-t m-t-sm"> <div class="col-sm-6"> <button class="btn btn-link no-padding" data-action="addTags">添加优先级</button> </div> <div class="col-sm-6 text-right"> <button class="btn btn-default btn-xs" data-action="cancelAddTask">取消</button> <button class="btn btn-primary btn-xs" data-action="saveAddTask">确定</button> </div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_detail_task_item_tags','<div class="task-item-tags width-200"> <h4 class="m-l m-t-sm m-b-sm">优先级</h4> <div class="col-sm-12 m-b-xs"> <a class="item-line label label-danger" data-value="1"><span>高</span></a> </div> <div class="col-sm-12 m-b-xs"> <a class="item-line label label-success" data-value="2"><span>中</span></a> </div> <div class="col-sm-12 m-b-xs"> <a class="item-line label label-warning" data-value="3"><span>低</span></a> </div> </div>');/*v:1*/
template('m_light_project/m_light_project_detail_view_table',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataInfo=$data.dataInfo,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_isNullOrBlank=$helpers._isNullOrBlank,_momentFormat=$helpers._momentFormat,m=$data.m,mi=$data.mi,_url=$helpers._url,$out='';$out+='<table class="table table-hover table-bordered table-responsive dataTable" > <thead> <tr> <th width="15%">标题</th> <th width="10%">任务状态</th> <th width="12%">所属板块</th> <th width="10%">负责人</th> <th width="12%">开始时间</th> <th width="12%">结束时间</th> <th width="8%">优先级</th> <th>参与人员</th> </tr> </thead> <tbody> ';
$each(dataInfo.list,function(p,$index){
$out+=' <tr class="curp" data-id="';
$out+=$escape(p.id);
$out+='" data-action="taskDetail"> <td> <span class="show-span">';
$out+=$escape(p.taskName);
$out+='</span> <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(p.taskName);
$out+='" data-key="taskName" data-placeholder="请输入任务名称" data-type="1" data-valid="1" data-max-length="50" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> <span class="show-span"> ';
if(!_isNullOrBlank(p.completeDate)){
$out+=' 已完成 ';
}else{
$out+=' 进行中 ';
}
$out+=' </span> <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(!_isNullOrBlank(p.completeDate)?1:0);
$out+='" data-key="isComplete" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> ';
$out+=$escape(p.groupName);
$out+=' <a href="javascript:void(0);" data-action="xeditable_moveTask" data-type="2" data-id="';
$out+=$escape(p.id);
$out+='" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> <span class="show-span"> ';
if(p.principalUser){
$out+=' ';
$out+=$escape(p.principalUser.userName);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" data-action="xeditable" data-type="12" data-key="principalUsrId" data-url-type="3" data-cookies="0" data-multiple="0" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> <span class="show-span"> ';
if(!_isNullOrBlank(p.startDate)){
$out+=' ';
$out+=$escape(_momentFormat(p.startDate,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(_momentFormat(p.startDate,'YYYY-MM-DD'));
$out+='" data-type="10" data-key="startDate" data-max-date="';
$out+=$escape(_momentFormat(p.endDate,'YYYY-MM-DD'));
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> <span class="show-span"> ';
if(!_isNullOrBlank(p.endDate)){
$out+=' ';
$out+=$escape(_momentFormat(p.endDate,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(_momentFormat(p.endDate,'YYYY-MM-DD'));
$out+='" data-type="10" data-key="endDate" data-min-date="';
$out+=$escape(_momentFormat(p.startDate,'YYYY-MM-DD'));
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> <span class="show-span"> ';
if(p.severity=='1'){
$out+=' <label class="label label-danger" data-value="';
$out+=$escape(p.severity);
$out+='"><span>高</span></label> ';
}else if(p.severity=='2'){
$out+=' <label class="label label-success" data-value="';
$out+=$escape(p.severity);
$out+='"><span>中</span></label> ';
}else if(p.severity=='3'){
$out+=' <label class="label label-warning" data-value="';
$out+=$escape(p.severity);
$out+='"><span>低</span></label> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(p.severity);
$out+='" data-key="severity" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> <span class="show-span"> ';
if(p.memberList && p.memberList.length>0){
$out+=' ';
$each(p.memberList,function(m,mi){
$out+=' ';
if(mi==p.memberList.length-1){
$out+=' ';
$out+=$escape(m.userName);
$out+=' ';
}else{
$out+=' ';
$out+=$escape(m.userName);
$out+=', ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" data-action="xeditable" data-type="12" data-key="memberList" data-url-type="3" data-cookies="0" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> </tr> ';
});
$out+=' ';
if(dataInfo.list==null || dataInfo.list.length==0){
$out+=' <tr class="no-data"> <td colspan="8" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_group',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,activeId=$data.activeId,groupList=$data.groupList,$each=$utils.$each,p=$data.p,i=$data.i,$out='';$out+='<ul class="list-group m-b-sm"> <li class="list-group-item ';
$out+=$escape(activeId==''?'active':'');
$out+='" data-id=""> <div class="row"> <a class="group-name dp-block col-sm-10 p-r-none" data-action="selectProjectGroup">全部任务</a> </div> </li> ';
if(groupList && groupList.length>0){
$out+=' ';
$each(groupList,function(p,i){
$out+=' <li class="list-group-item ';
$out+=$escape(activeId==p.id?'active':'');
$out+='" data-id="';
$out+=$escape(p.id);
$out+='"> <div class="row"> <a class="group-name dp-block col-sm-10 p-r-none" data-action="selectProjectGroup">';
$out+=$escape(p.name);
$out+='</a> <div class="col-sm-2"> <div class="btn-group no-padding pull-right"> <button data-toggle="dropdown" class="btn btn-link no-padding dropdown-toggle" aria-expanded="false"><i class="fa fa-ellipsis-v"></i></button> <ul class="dropdown-menu"> <li><a href="javascript:;" data-action="editGroupName">修改分组</a></li> <li><a href="javascript:;" data-action="delGroup">删除分组</a></li> </ul> </div> </div> </div> </li> ';
});
$out+=' ';
}
$out+=' </ul>';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<table class="table table-hover table-bordered table-responsive dataTable" > <thead> <tr> <th>任务名称</th> <th>任务状态</th> <th>任务类型</th> <th>负责人</th> <th class="sorting_desc w-100" data-action="sort" data-code="startDate">进度计划</th> <th class="sorting_desc w-100" data-action="sort" data-code="completeDate">完成时间</th> <th>创建人</th> <th class="sorting_desc w-100" data-action="sort" data-code="createDate">创建时间</th> </tr> </thead> <tbody> ';
$each(dataList,function(p,$index){
$out+=' <tr class="curp" data-id="';
$out+=$escape(p.id);
$out+='" onclick="javascript:window.location.href=\'#/lightProject/detail?id=';
$out+=$escape(p.id);
$out+='\'"> <td>';
$out+=$escape(p.projectName);
$out+='</td> <td> ';
if(p.status==0){
$out+=' 进行中 ';
}else if(p.status==1){
$out+=' 已完成 ';
}
$out+=' </td> <td>';
$out+=$escape(p.groupName);
$out+='</td> <td> ';
$out+=$escape(p.principalUsrName);
$out+=' </td> <td>';
$out+=$escape(_momentFormat(p.startDate,'YYYY/MM/DD'));
$out+=' - ';
$out+=$escape(_momentFormat(p.endDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.completeDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(p.createUserName);
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.createDate,'YYYY/MM/DD'));
$out+='</td> </tr> ';
});
$out+=' ';
if(dataList==null || dataList.length==0){
$out+=' <tr class="no-data"> <td colspan="8" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_task_copy',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,titlePrefix=$data.titlePrefix,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <div class="col-sm-12"> <span class="fc-dark-gray">';
$out+=$escape(titlePrefix);
$out+='工作项</span> </div> </div> <div class="form-group"> <label class="col-sm-12">选择看板<span class="fc-red">*</span>：</label> <div class="col-sm-12"> <select class="form-control" name="projectList"></select> </div> </div> <div class="form-group"> <label class="col-sm-12">选择板块<span class="fc-red">*</span>：</label> <div class="col-sm-12"> <select class="form-control" name="groupList"></select> </div> </div> <div class="form-group"> <div class="col-sm-12"> <button class="btn btn-primary btn-sm" data-action="save">';
$out+=$escape(titlePrefix);
$out+='</button> <button class="btn btn-default btn-sm" data-action="closeDialog">取消</button> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_task_detail',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,doType=$data.doType,$escape=$utils.$escape,dataInfo=$data.dataInfo,groupList=$data.groupList,$each=$utils.$each,g=$data.g,i=$data.i,_isNullOrBlank=$helpers._isNullOrBlank,_interceptName=$helpers._interceptName,fromType=$data.fromType,_momentFormat=$helpers._momentFormat,$string=$utils.$string,c=$data.c,$index=$data.$index,m=$data.m,currentCompanyUserName=$data.currentCompanyUserName,$out='';$out+='<div class="m-light-project-task-detail "> <div class="m"> <div class="row no-margin border-bottom m-b-xs"> <div class="col-sm-6"> <div class=""> ';
if(doType==1){
$out+=' <a class="dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"> <span class="group-name">';
$out+=$escape(dataInfo.group.groupName);
$out+='</span> <span class="caret"></span> </a> <ul class="dropdown-menu"> ';
if(groupList && groupList.length>0){
$out+=' ';
$each(groupList,function(g,i){
$out+=' <li><a href="javascript:;" data-action="moveTask" data-id="';
$out+=$escape(g.group.id);
$out+='">';
$out+=$escape(g.group.name);
$out+='</a></li> ';
});
$out+=' ';
}
$out+=' </ul> ';
}else{
$out+=' <span>';
$out+=$escape(dataInfo.group.groupName);
$out+='</span> ';
}
$out+=' </div> </div> <div class="col-sm-6 text-right"> <a class="fc-v3-grey m-r-sm" data-action="addTags"><i class="fa fa-tag"></i>&nbsp;优先级</a> <a class="fc-v3-grey m-r-sm" data-action="showAddCheckList"><i class="icon iconfont icon-renwudiaodu"></i>&nbsp;核对清单</a> <div class="dp-inline-block vertical-unset m-r-sm"> <a class="fc-v3-grey dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"> <span class="fa fa-bars"></span>&nbsp;更多 </a> <ul class="dropdown-menu dropdown-menu-right"> ';
if(doType==1){
$out+=' <li><a href="javascript:;" data-action="copyTask" data-type="2">移动</a></li> <li><a href="javascript:;" data-action="copyTask" data-type="1">复制</a></li> ';
}
$out+=' <li><a href="javascript:;" data-action="delTask">删除</a></li> </ul> </div> <span class="divice m-r-sm">|</span> <a class="fc-v3-grey" href="javascript:;" data-action="closeDialog"><i class="icon iconfont icon-quxiao"></i></a> </div> <div class="col-sm-12 m-t-md task-item"> <label class="i-checks i-checks-label fw-normal"> ';
if(!_isNullOrBlank(dataInfo.task.completeDate)){
$out+=' <input name="taskItem" type="checkbox" value="" checked data-id="';
$out+=$escape(dataInfo.task.id);
$out+='"/> ';
}else{
$out+=' <input name="taskItem" type="checkbox" value="" data-id="';
$out+=$escape(dataInfo.task.id);
$out+='"/> ';
}
$out+=' <span class="i-checks-span"></span> </label> <a class="task-name show-span dp-inline-block-1 vertical-top width-300 m-t-xxs curp ';
$out+=$escape(!_isNullOrBlank(dataInfo.task.completeDate)?'todo-completed':'');
$out+='" data-action="xeditable" data-edit-type="1" data-value="';
$out+=$escape(dataInfo.task.taskName);
$out+='" data-key="taskName" data-placeholder="请输入任务名称" data-type="1" data-valid="1" data-max-length="100"> ';
$out+=$escape(dataInfo.task.taskName);
$out+=' </a> </div> </div> <div class="of-auto max-h-500 p-t-sm p-b-lg"> <div class="row no-margin m-t-xs"> <div class="col-sm-6"> <div class="m-b-xs"> <span class="glyphicon glyphicon-user dp-inline-block m-r-sm"></span> <span>负责人</span> </div> <div class="p-l-l"> ';
if(dataInfo.principalUser && dataInfo.principalUser.userName){
$out+=' <span class="label label-info label-circle dp-inline-block-1 show-span" title="';
$out+=$escape(dataInfo.principalUser.userName);
$out+='">';
$out+=$escape(_interceptName(dataInfo.principalUser.userName,2));
$out+='</span> ';
}
$out+=' <button class="btn btn-default btn-circle" type="button" data-action="selectUser" data-type="12" data-key="principalUsrId" data-url-type="3" data-cookies="0" data-multiple="0"> <i class="fa fa-plus"></i> </button> </div> </div> <div class="col-sm-3"> <div class="m-b-xs"> <span class="glyphicon glyphicon-time m-r-sm"></span> <span>开始时间</span> </div> <div class="p-l-l"> ';
if(doType==1 && fromType!=2){
$out+=' <a class="" data-action="xeditable" data-value="';
$out+=$escape(_momentFormat(dataInfo.task.startDate,'YYYY-MM-DD'));
$out+='" data-type="10" data-key="startDate" data-max-date="';
$out+=$escape(_momentFormat(dataInfo.task.endDate,'YYYY-MM-DD'));
$out+='" data-init-show="1" data-onpicked-save="1" > ';
if(!_isNullOrBlank(dataInfo.task.startDate)){
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.startDate,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">点击设置</span> ';
}
$out+=' </a> ';
}else{
$out+=' <a class="btn btn-link no-padding" data-action="" disabled="disabled"><span class="fc-v1-grey">点击设置</span></a> ';
}
$out+=' </div> </div> <div class="col-sm-3"> <div class="m-b-xs"> <span class="glyphicon glyphicon-time m-r-sm"></span> <span>截止时间</span> </div> <div class="p-l-l"> ';
if(doType==1 && fromType!=2){
$out+=' <a class="" data-action="xeditable" data-value="';
$out+=$escape(_momentFormat(dataInfo.task.endDate,'YYYY-MM-DD'));
$out+='" data-type="10" data-key="endDate" data-min-date="';
$out+=$escape(_momentFormat(dataInfo.task.startDate,'YYYY-MM-DD'));
$out+='" data-init-show="1" data-onpicked-save="1" > ';
if(!_isNullOrBlank(dataInfo.task.endDate)){
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.endDate,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">点击设置</span> ';
}
$out+=' </a> ';
}else{
$out+=' <a class="btn btn-link no-padding" data-action="" disabled="disabled"><span class="fc-v1-grey">点击设置</span></a> ';
}
$out+=' </div> </div> <div class="col-sm-12 m-t-sm ';
$out+=$escape(dataInfo.task.severity?'':'hide');
$out+='" id="tagsBox"> <span class="fa fa-tag pull-left m-r-sm p-t-sm"></span> <div class="pull-left p-t-xs p-l-sm severity"> ';
if(dataInfo.task.severity){
$out+=' ';
if(dataInfo.task.severity=='1'){
$out+=' <label class="label label-danger" data-value="';
$out+=$escape(dataInfo.task.severity);
$out+='"><span>高</span></label> ';
}else if(dataInfo.task.severity=='2'){
$out+=' <label class="label label-success" data-value="';
$out+=$escape(dataInfo.task.severity);
$out+='"><span>中</span></label> ';
}else if(dataInfo.task.severity=='3'){
$out+=' <label class="label label-warning" data-value="';
$out+=$escape(dataInfo.task.severity);
$out+='"><span>低</span></label> ';
}
$out+=' ';
}
$out+=' </div> </div> <div class="col-sm-12 m-t-sm"> <span class="fa fa-file-text-o pull-left m-r-sm p-t-sm"></span> <div class="pull-left width-600"> <a class="task-remark show-span" data-action="xeditable" data-type="11" data-key="remark" data-target-ele="#task-remark-edit" data-is-picture="1" data-placeholder="点击添加描述"> ';
if(!_isNullOrBlank(dataInfo.task.remark)){
$out+=' ';
$out+=$string(dataInfo.task.remark);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">点击添加描述</span> ';
}
$out+=' </a> <div id="task-remark-edit"></div> </div> </div> <div class="col-sm-12 m-t-sm ';
$out+=$escape(dataInfo.checkItemList && dataInfo.checkItemList.length>0?'':'hide');
$out+='" id="checkList"> <span class="icon iconfont icon-renwudiaodu pull-left vertical-top"></span> <div class="pull-left width-600 p-l-sm"> <div class="checklist-progress"> <div class="checklist-progress-num dp-inline-block vertical-top">30%</div> <div class="progress dp-inline-block"> <div style="width: 30%;" aria-valuemax="100" aria-valuemin="0" aria-valuenow="35" role="progressbar" class="progress-bar"></div> </div> </div> <div class="checklist-content m-t-sm"> <ul class="checklist-list" id="checklistList"> ';
if(dataInfo.checkItemList && dataInfo.checkItemList.length>0){
$out+=' ';
$each(dataInfo.checkItemList,function(c,$index){
$out+=' <li class="checklist-item task-item" data-id="';
$out+=$escape(c.id);
$out+='"> <label class="i-checks i-checks-label fw-normal dp-inline-block" data-type="2"> ';
if(!_isNullOrBlank(c.completeDate)){
$out+=' <input name="taskItem" type="checkbox" value="" checked data-id="';
$out+=$escape(c.id);
$out+='"/> ';
}else{
$out+=' <input name="taskItem" type="checkbox" value="" data-id="';
$out+=$escape(c.id);
$out+='"/> ';
}
$out+=' <span class="i-checks-span"></span> </label> <a class="task-name show-span dp-inline-block-1 vertical-top ';
$out+=$escape(!_isNullOrBlank(c.completeDate)?'todo-completed':'');
$out+='" data-action="xeditable" data-edit-type="2" data-value="';
$out+=$escape(c.taskName);
$out+='" data-key="taskName" data-placeholder="请输入核对清单名称" data-type="1" data-valid="1" data-max-length="50"> ';
$out+=$escape(c.taskName);
$out+=' </a> <a class="pull-right" data-action="delCheckItem" title="删除核对清单"> <i class="fa fa-remove"></i> </a> </li> ';
});
$out+=' ';
}
$out+=' </ul> <div> <a class="f-s-xs fc-v3-grey" data-action="showAddCheckList" data-type="2">添加核对清单</a> </div> </div> <div class="add-new-check hide"> <input class="form-control m-b-xs" type="text" name="checkListItemName" placeholder="请输入核对清单内容"/> <button class="btn btn-primary btn-sm" data-action="saveCheckListItem">保存</button> <button class="btn btn-default btn-sm" data-action="cancelCheckListItem">取消</button> </div> </div> </div> <div class="col-sm-12 m-t-sm"> <div> <span class="icon iconfont icon-yaoqing1 m-r-sm"></span> <span>参与人</span> </div> <div class="p-l-l"> ';
if(dataInfo.memberList && dataInfo.memberList.length>0){
$out+=' ';
$each(dataInfo.memberList,function(m,$index){
$out+=' <span class="label label-info label-circle dp-inline-block-1 show-span" title="';
$out+=$escape(m.userName);
$out+='">';
$out+=$escape(_interceptName(m.userName,2));
$out+='</span> ';
});
$out+=' ';
}
$out+=' <button class="btn btn-default btn-circle" type="button" data-action="selectUser" data-type="12" data-key="principalUsrId" data-url-type="3" data-cookies="0" data-edit-type="2"> <i class="fa fa-plus"></i> </button> </div> </div> </div> <div class="row no-margin"> <div class="tabs-container tabs-container-1 p-m"> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="true">评论</a></li> <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">变更历史</a></li> </ul> <div class="tab-content min-h-50"> <div id="tab-1" class="tab-pane active"> <div class="panel-body no-padding" data-type="comment"> </div> </div> <div id="tab-2" class="tab-pane"> <div class="panel-body no-padding" data-type="history"> </div> </div> </div> </div> </div> </div> </div> <div class="footer"> <span class="label label-info label-circle pull-left" title="';
$out+=$escape(currentCompanyUserName);
$out+='">';
$out+=$escape(_interceptName(currentCompanyUserName,2));
$out+='</span> <div class="pull-left p-w-xxs pt-relative"> <div class="content-editable" contenteditable="true" placeholder="" id="contentEditable"></div> <div class="content-editable-placeholder">Enter快速发布</div> </div> <button class="btn btn-primary" data-action="addComment">评论</button> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_task_detail_comment',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_interceptName=$helpers._interceptName,$string=$utils.$string,_momentFormat=$helpers._momentFormat,$out='';$each(dataList,function(p,$index){
$out+=' <div class="row"> <div class="col-sm-12 notice-list-content m-t"> <div class="feed-element"> <div class="media-body "> <div class="col-24-md-2 no-padding" > <span class="label label-info label-circle pull-left" title="';
$out+=$escape(p.commentUser.userName);
$out+='">';
$out+=$escape(_interceptName(p.commentUser.userName,2));
$out+='</span> </div> <div class="col-24-md-19 no-padding" > <span class="dp-block l-h-20">';
$out+=$escape(p.commentUser.userName);
$out+='</span> <span class="dp-block span-company">';
$out+=$string(p.comment);
$out+='</span> </div> <div class="col-24-md-3 text-right m-t" > ';
$out+=$escape(_momentFormat(p.createDate,'YYYY/MM/DD'));
$out+=' </div> </div> </div> </div> </div> ';
});
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_task_detail_history',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_dateSpecFormat=$helpers._dateSpecFormat,_isNullOrBlank=$helpers._isNullOrBlank,$string=$utils.$string,$out='';$out+='<ul class="todo-list m-t small-list"> ';
$each(dataList,function(p,$index){
$out+=' <li class="bg-none"> <div class="timeline-item timeline-item-new"> <div class="row"> <div class="col-xs-4 date p-l-none"> <i class="fa fa-circle"></i> ';
$out+=$escape(_dateSpecFormat(p.createDate));
$out+=' </div> <div class="col-xs-6 content b-t-none"> ';
$out+=$escape(p.userName);
$out+=' 设置 “';
$out+=$escape(p.fieldNameDesc);
$out+='” 为：';
if(_isNullOrBlank(p.newValue)){
$out+='\'空\'';
}else{
$out+=$string(p.newValue);
}
$out+=' </div> <div class="col-xs-2"></div> </div> </div> </li> ';
});
$out+=' </ul>';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_temp_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="ibox m-light-project-temp-add"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-12" id="breadcrumb"></div> </div> </div> <div class="ibox-content"> <div class="m-b-xl"> <h2>创建企业模板</h2> <div class="fc-dark-gray">你可以通过以下方式创建企业共享的项目模板</div> </div> <div> <div class="temp-card m-r-md" data-action="tempSimple"> <div class="temp-card-img"> <img src="';
$out+=$escape(_url('/img/project/template_simple.png'));
$out+='"> </div> <div class="temp-card-text"> <h4>普通模板</h4> <div>从空白普通项目开始创建模板</div> </div> </div> <div class="temp-card" data-action="tempCopy"> <div class="temp-card-img"> <img src="';
$out+=$escape(_url('/img/project/template_copy.png'));
$out+='"> </div> <div class="temp-card-text"> <h4>复制现有项目</h4> <div>包含项目内任务、分组、列表、文件等</div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_temp_add_copy','<form class="form-horizontal m"> <div class="form-group"> <div class="col-xs-12"> <select class="form-control" name="projectList"></select> </div> </div> </form> ');/*v:1*/
template('m_light_project/m_light_project_temp_add_simple',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,_isNullOrBlank=$helpers._isNullOrBlank,coverPath=$data.coverPath,_url=$helpers._url,bgNum=$data.bgNum,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-sm-2 control-label p-r-none">模版名称<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input placeholder="请输入任务名称" class="form-control" type="text" name="projectName" value="';
$out+=$escape(dataInfo?dataInfo.projectName:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label p-r-none">模板分组：</label> <div class="col-sm-9 p-r-none"> <select class="form-control" name="groupId"></select> </div> <div class="col-sm-1 no-padding"> <button class="btn btn-link" data-action="editGroup" title="创建分组"> <i class="fa fa-plus f-s-md"></i> </button> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label p-r-none">模版封面：</label> <div class="col-sm-10 p-t-xs"> <a href="javascript:void(0)" id="filePicker" name="recordAttach" class="upload-icon" title="请上传封面"></a> <div class="m-t-sm"> ';
if(!_isNullOrBlank(coverPath) ){
$out+=' <img class="rounded-5 project-temp-cover" src="';
$out+=$escape(dataInfo.coverPath);
$out+='" width="216" height="122" title="默认封面"/> ';
}else{
$out+=' <img class="rounded-5 project-temp-cover" src="';
$out+=$escape(_url('/img/project/light_project_temp_bg_'+bgNum+'.png'));
$out+='" width="216" height="122" title="默认封面"/> ';
}
$out+=' </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_temp_all',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,d=$data.d,di=$data.di,_getProjectTempIcon=$helpers._getProjectTempIcon,o=$data.o,pi=$data.pi,$index=$data.$index,_url=$helpers._url,$out='';$out+='<form class="form-horizontal m m-light-project-temp-select"> <div class="row m-l-n-xs"> <div class="col-sm-12"> <div class="input-group"> <span class="input-group-addon"><i class="fa fa-search"></i></span> <input type="text" name="keyword" placeholder="搜索任务模板" class="form-control"> </div> </div> </div> <div class="row m-l-n-xs m-t-sm"> <div class="col-sm-3 temp-title-box"> <ul class="list-group no-shadow"> <li class="list-group-item no-borders curp" data-id="1"> <i class="fa fa-codepen m-r-sm"></i>空白模板 <span class="pull-right fc-v1-grey">1</span> </li>  ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <li class="list-group-item no-borders" data-id="';
$out+=$escape(p.id);
$out+='"> ';
$out+=$escape(p.name);
$out+=' </li> ';
$each(p.childList,function(d,di){
$out+=' <li class="list-group-item no-borders curp" data-id="';
$out+=$escape(d.id);
$out+='"> <i class="icon iconfont ';
$out+=$escape(_getProjectTempIcon(d.name));
$out+=' m-r-sm"></i><span class="group-name">';
$out+=$escape(d.name);
$out+='</span> <span class="pull-right fc-v1-grey">';
$out+=$escape(d.childList.length);
$out+='</span> ';
if(i==0 && di!=0){
$out+=' <button class="btn btn-link no-padding pull-right m-r-xs hide" data-action="delTempGroup" title="删除模板分组"> <i class="fa fa-times fc-red"></i> </button> <button class="btn btn-link no-padding pull-right m-r-xs hide" data-action="editTempGroup" title="编辑模板分组"> <i class="fa fa-pencil text-navy"></i></button> ';
}
$out+=' </li> ';
});
$out+=' ';
});
$out+=' ';
}
$out+=' </ul> </div> <div class="col-sm-9 temp-list-box"> <h3 class="fw-normal m-b-xs m-t-sm temp-name" data-id="1">空白模板</h3> <div class="row"> <div class="task-temp-box task-temp-box-1" data-action="addLightProject"> <div class="task-temp-container"> <div class="task-temp-main"> <span class="fa fa-plus f-s-xl task-temp-plus"></span> <div class="task-temp-content"> <div class="task-temp-name"> <div class="task-temp-namewrap">新建协同任务</div> <div class="task-temp-tags"></div> </div> <div class="task-temp-desc">使用勾选框表示任务完成情况，可自由拖拽看板中的任务。</div> </div> </div> </div> </div> </div> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(o,i){
$out+=' <!--<h3 class="title-line m-l-sm">';
$out+=$escape(o.name);
$out+='</h3>--> ';
$each(o.childList,function(p,pi){
$out+=' ';
if(p.childList && p.childList.length>0){
$out+=' <h3 class="fw-normal m-b-xs m-t-sm temp-name" data-id="';
$out+=$escape(p.id);
$out+='"> ';
$out+=$escape(p.name);
$out+=' ';
if(i==0 && pi==0){
$out+=' <div class="dp-inline-block pull-right"> <button class="btn btn-link fc-dark-blue no-padding" data-action="addTaskTemp"><i class="fa fa-plus-circle"></i>&nbsp;新建模板</button> </div> ';
}
$out+=' </h3> <div class="row"> ';
$each(p.childList,function(d,$index){
$out+=' <div class="task-temp-box" data-action="addLightProjectByTemp" data-id="';
$out+=$escape(d.id);
$out+='" data-image="';
$out+=$escape(d.image);
$out+='"> <div class="task-temp-container"> <div class="task-temp-main"> ';
if(d.image && d.image.length>1){
$out+=' <div class="task-temp-cover" style="background-image: url(\'';
$out+=$escape(d.image);
$out+='\');"></div> ';
}else{
$out+=' <div class="task-temp-cover" style="background-image: url(\'';
$out+=$escape(_url('/img/project/light_project_temp_bg_'+(d.image?d.image:'1')+'.png'));
$out+='\');"></div> ';
}
$out+=' <div class="task-temp-mask"></div>  ';
if(i==0){
$out+=' <div class="task-temp-handler"> <button class="btn btn-link no-padding" href="javascript:;" data-action="editProjectTemp"><span class="icon iconfont icon-bianji"></span></button> <button class="btn btn-link no-padding" href="javascript:;" data-action="delProjectTemp"><span class="fa fa-trash-o" data-role="icon"></span></button> </div> ';
}
$out+=' <div class="task-temp-content"> <div class="task-temp-name"> <div class="task-temp-namewrap">';
$out+=$escape(d.name);
$out+='</div> <div class="task-temp-tags"></div> </div>  </div> </div> </div> </div> ';
});
$out+=' </div> ';
}
$out+=' ';
});
$out+=' ';
});
$out+=' ';
}
$out+=' </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_temp_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,projectName=$data.projectName,$out='';$out+='<div class="m-light-project-temp-edit"> <div class="panel panel-default m-b-none"> <div class="panel-heading"> <div class="row"> <div class="col-sm-6"> <span>模板名称：<span class="project-name">';
$out+=$escape(projectName?projectName:'');
$out+='</span></span> <a data-action="editBaseInfo"><i class="icon iconfont icon-bianji"></i>编辑</a> </div> <div class="col-sm-6 text-right"> <button class="btn btn-primary" data-action="saveProjectTemp">保存模板</button> <a class="fc-v3-grey" href="javascript:;" data-action="closeDialog"><i class="icon iconfont icon-quxiao"></i></a> </div> </div> </div> <div class="panel-body p-b-none"> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_temp_search',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,projectName=$data.projectName,dataList=$data.dataList,$each=$utils.$each,d=$data.d,$index=$data.$index,_url=$helpers._url,$out='';$out+='<form class="form-horizontal m m-light-project-temp-select"> <div class="row m-l-n-xs"> <div class="col-sm-9"> <div class="input-group"> <span class="input-group-addon"><i class="fa fa-search"></i></span> <input type="text" name="keyword" placeholder="搜索任务模板" class="form-control" value="';
$out+=$escape(projectName?projectName:'');
$out+='"> </div> </div> <div class="col-sm-3 text-right"> <button class="btn btn-link fc-dark-blue" data-action="addTaskTemp"><i class="fa fa-plus-circle"></i>&nbsp;新建模板</button> <button class="btn btn-link fc-dark-blue" data-action="allTaskTemp"><i class="fa fa-table"></i>&nbsp;全部模板</button> </div> </div> <div class="row m-l-n-xs"> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(d,$index){
$out+=' <div class="task-temp-box" data-action="addLightProjectByTemp" data-id="';
$out+=$escape(d.id);
$out+='"> <div class="task-temp-container"> <div class="task-temp-main"> ';
if(d.image){
$out+=' <div class="task-temp-cover" style="background-image: url(\'';
$out+=$escape(d.image);
$out+='\');"></div> ';
}else{
$out+=' <div class="task-temp-cover" style="background-image: url(\'';
$out+=$escape(_url('/img/task/001.png'));
$out+='\');"></div> ';
}
$out+=' <div class="task-temp-mask"></div>  <div class="task-temp-content"> <div class="task-temp-name"> <div class="task-temp-namewrap">';
$out+=$escape(d.name);
$out+='</div> <div class="task-temp-tags"></div> </div>  </div> </div> </div> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="text-center fc-v1-grey p-t-xxl f-s-xl"> <p>未搜索到与“';
$out+=$escape(projectName?projectName:'');
$out+='”相关的模板</p> <p>尝试其他关键词或查看全部模板</p> <button class="btn btn-default fc-dark-blue" data-action="allTaskTemp">全部模板</button> </div> ';
}
$out+=' </div> </form> ';
return new String($out);
});/*v:1*/
template('m_light_project/m_light_project_temp_select',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,$index=$data.$index,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<form class="form-horizontal m m-light-project-temp-select"> <div class="row m-l-n-xs"> <div class="col-sm-9"> <div class="input-group"> <span class="input-group-addon"><i class="fa fa-search"></i></span> <input type="text" name="keyword" placeholder="搜索任务模板" class="form-control"> </div> </div> <div class="col-sm-3 text-right"> <button class="btn btn-link fc-dark-blue" data-action="addTaskTemp"><i class="fa fa-plus-circle"></i>&nbsp;新建模板</button> <button class="btn btn-link fc-dark-blue" data-action="allTaskTemp"><i class="fa fa-table"></i>&nbsp;全部模板</button> </div> </div> <div class="row m-l-n-xs"> <div class="task-temp-box task-temp-box-1" data-action="addLightProject"> <div class="task-temp-container"> <div class="task-temp-main"> <span class="fa fa-plus f-s-xl task-temp-plus"></span> <div class="task-temp-content"> <div class="task-temp-name"> <div class="task-temp-namewrap">新建协同任务</div> <div class="task-temp-tags"></div> </div> <div class="task-temp-desc">使用勾选框表示任务完成情况，可自由拖拽看板中的任务。</div> </div> </div> </div> </div> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(d,$index){
$out+=' <div class="task-temp-box" data-action="addLightProjectByTemp" data-id="';
$out+=$escape(d.id);
$out+='"> <div class="task-temp-container"> <div class="task-temp-main"> ';
if(d.image && d.image.length>1){
$out+=' <div class="task-temp-cover" style="background-image: url(\'';
$out+=$escape(d.image);
$out+='\');"></div> ';
}else{
$out+=' <div class="task-temp-cover" style="background-image: url(\'';
$out+=$escape(_url('/img/project/light_project_temp_bg_'+(d.image?d.image:'1')+'.png'));
$out+='\');"></div> ';
}
$out+=' <div class="task-temp-mask"></div>  <div class="task-temp-content"> <div class="task-temp-name"> <div class="task-temp-namewrap">';
$out+=$escape(d.name);
$out+='</div> <div class="task-temp-tags"></div> </div>  </div> </div> </div> </div> ';
});
$out+=' ';
}
$out+=' </div> </form> ';
return new String($out);
});/*v:1*/
template('m_message/m_message','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu"> <div class="pull-left"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li class="active fw-bold">消息中心</li> </ol> </div> </div> <a type="button" class="btn btn-w-m btn-link btn-u-sm m-t-sm pull-right " data-action="refreshMsg"> <i class="fa fa-refresh"></i> 刷新数据 </a> </div> </div> </div> <div class="ibox-content no-padding"> <div class="row"> <div class="col-md-12" id="content-box"> <div class="messageList m-l m-r" style="min-height: 690px"> </div> <div class="row margin-bottom-30"> <div class="col-md-12 text-center m-t-sm"> <div class="m-page" style="display: none;"></div> <a class="btnPageNext btn btn-default btn-xs" href="javascript:void(0)" style="display: none;">加载更多</a> </div> </div> </div> </div> </div> </div>');/*v:1*/
template('m_message/m_message_empty',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="headline"> </div> <div class="margin-bottom-30 text-center" style="margin-top: 150px"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/default/without_message.png'));
$out+='"> </div> <span style="color:#337b8e;">暂无消息</span> </div> ';
return new String($out);
});/*v:1*/
template('m_message/m_message_group',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_dateSpecShortFormat=$helpers._dateSpecShortFormat,createDate=$data.createDate,$out='';$out+='<!--<div class="headline"> <h3>';
$out+=$escape(_dateSpecShortFormat(createDate));
$out+='</h3> </div>--> <div class=""> <div class="feed-activity-list m-message-group" data-createDate="';
$out+=$escape(_dateSpecShortFormat(createDate));
$out+='"> </div> </div>';
return new String($out);
});/*v:1*/
template('m_message/m_message_single',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,messageType=$data.messageType,companyId=$data.companyId,sendCompanyId=$data.sendCompanyId,status=$data.status,projectId=$data.projectId,targetId=$data.targetId,projectName=$data.projectName,expNo=$data.expNo,headImg=$data.headImg,_url=$helpers._url,sendUserName=$data.sendUserName,companyName=$data.companyName,$string=$utils.$string,messageContent=$data.messageContent,_momentFormat=$helpers._momentFormat,sendDate=$data.sendDate,$out='';$out+='<div class="row"> <div class="col-24-md-24 col-xl-12 notice-list-content m-t"> <div class="feed-element" data-messageType="';
$out+=$escape(messageType);
$out+='" data-companyId="';
$out+=$escape(companyId);
$out+='" data-send-companyId="';
$out+=$escape(sendCompanyId);
$out+='" data-status="';
$out+=$escape(status);
$out+='" data-projectId="';
$out+=$escape(projectId);
$out+='" data-targetId="';
$out+=$escape(targetId);
$out+='" data-project-name="';
$out+=$escape(projectName);
$out+='" data-expNo="';
$out+=$escape(expNo);
$out+='" > <div class="media-body "> <div class="col-24-md-1" > ';
if(headImg!=null && headImg!=''){
$out+=' <img alt="image" class="img-circle pull-left m-xs" src="';
$out+=$escape(headImg);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/default/default_headPic.png'));
$out+='"> ';
}else{
$out+=' <img alt="image" class="img-circle pull-left m-xs" src="';
$out+=$escape(_url('/img/default/default_headPic.png'));
$out+='"> ';
}
$out+=' </div> <div class="col-24-md-4" > <span class="dp-block l-h-20">';
$out+=$escape(sendUserName);
$out+='</span> <span class="dp-block span-company">';
$out+=$escape(companyName);
$out+='</span> </div> <div class="col-24-md-17 msg-content-box"> <div class="msg-content">';
$out+=$string(messageContent);
$out+='</div> </div> <div class="col-24-md-2 text-right m-t" > ';
$out+=$escape(_momentFormat(sendDate,'YYYY/MM/DD'));
$out+=' </div> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_notice/m_notice','<div class="ibox m_notice"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu"> <div class="pull-left"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li class="active fw-bold">通知公告</li> </ol> </div> </div> <a type="button" class="btn btn-primary btn-submit btn-u-sm m-t-sm pull-right roleControl" roleCode="50000101" flag="2" data-action="sendNotice"> 发送公告 </a> <a type="button" class="btn btn-w-m btn-link btn-u-sm m-t-sm pull-right " data-action="refreshNotice"> <i class="fa fa-refresh"></i> 刷新数据 </a> </div> </div> </div> <div class="ibox-content no-padding"> <div class="row"> <div class="col-md-12" id="content-box"> <div class="noticeList m-l m-r" style="min-height: 690px"> </div> <div class="row margin-bottom-30"> <div class="col-md-12 text-center m-t-sm"> <div class="m-page" style="display: none;"></div> <a class="btnPageNext btn btn-default btn-xs" href="javascript:void(0)" style="display: none;">加载更多</a> </div> </div> </div> </div> </div> </div> ');/*v:1*/
template('m_notice/m_notice_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,notice=$data.notice,_momentFormat=$helpers._momentFormat,$each=$utils.$each,p=$data.p,$index=$data.$index,_fastdfsUrl=$helpers._fastdfsUrl,$out='';$out+='<div class="ibox publicNoticeListOBox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-6">  <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> <a href="#/announcement">通知公告</a> </li> <li class="active fa fa-angle-right"> <strong>查看公告</strong> </li> </ol> </div> </div> <div class="col-md-6"> <a type="button" class="btn btn-primary btn-submit btn-u-sm m-sm pull-right roleControl" roleCode="50000101" flag="2" data-action="sendNotice">发送公告</a> </div> </div> </div> <div class="ibox-content no-padding"> <div class="row"> <div class="col-md-12 " id="content-box"> <div class="mail-box no-borders m-r-xl m-l-xl m-t" style="min-height: 500px;"> <div class="p-m"> <p><h3 class="noticeTitle fc-dark-grey" data-string="';
$out+=$escape(notice.noticeTitle);
$out+='" >';
$out+=$escape(notice.noticeTitle);
$out+='</h3></p> <p class="fc-v4-grey"> <span class="pull-left">发送人：<span title="';
$out+=$escape(notice.companyName);
$out+='">';
$out+=$escape(notice.noticePublisherName);
$out+='</span></span> <span class="pull-right">发送日期：';
$out+=$escape(_momentFormat(notice.noticePublishdate,'YYYY/MM/DD'));
$out+='</span> </p> </div> <div> </div> <div class="mail-body border-no-t fc-v2-grey "> </div> <div class="border-bottom"></div> <div class="m-t-md p-w-m"> ';
if(notice.attachList!=null && notice.attachList.length>0){
$out+=' <span class="fc-v4-grey">';
$out+=$escape(notice.attachList.length);
$out+='个附件：</span> ';
$each(notice.attachList,function(p,$index){
$out+=' <span class="bg-muted b-r-sm p-xxs m-xs"> <a class="fc-dark-blue m-r-sm " href="';
$out+=$escape(_fastdfsUrl(p.fileGroup+'/'+p.filePath));
$out+='" target="_blank">';
$out+=$escape(p.fileName);
$out+='</a> <a class="" data-action="fileDownload" data-id="';
$out+=$escape(p.id);
$out+='"><i class="fa fa-cloud-download"></i></a> </span> ';
});
$out+=' ';
}
$out+=' </div> <div class="clearfix"></div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_notice/m_notice_empty',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="margin-bottom-30 text-center" style="margin-top: 150px"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/default/without_message.png'));
$out+='"> </div> <span style="color:#337b8e;">暂无待办事项</span> </div> ';
return new String($out);
});/*v:1*/
template('m_notice/m_notice_group',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_dateSpecShortFormat=$helpers._dateSpecShortFormat,noticePublishdate=$data.noticePublishdate,$out='';$out+='<div class="feed-activity-list m-message-group" data-createDate="';
$out+=$escape(_dateSpecShortFormat(noticePublishdate));
$out+='"> </div> ';
return new String($out);
});/*v:1*/
template('m_notice/m_notice_publish',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,noticeTitle=$data.noticeTitle,$out='';$out+='<div class="ibox publicNoticeListOBox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-6">  <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> <a href="#/announcement">通知公告</a> </li> <li class="active fa fa-angle-right"> <strong>新增公告</strong> </li> </ol> </div> </div> </div> </div> <div class="ibox-content no-padding"> <div class="row"> <div class="col-md-12" id="content-box"> <div class="animated fadeInRight"> <div class="mail-box no-border"> <div class="mail-body no-border"> <form class="form-horizontal publishPublicNoticeOBox m-t-lg" method="get"> <div class="form-group"> <label class="col-md-1 control-label">标题:</label> <div class="col-md-8"> <input class="form-control" name="noticeTitle" maxlength="300" value="';
$out+=$escape(noticeTitle);
$out+='" type="text"> </div> </div> <div class="form-group"> <label class="col-md-1 control-label">发布范围:</label> <div class="col-md-8"> <input class="form-control curp fc-v1-green" name="choseDepartment" readOnly value="点击设置" data-action="choseDepartment" type="text"> </div> </div> <div class="form-group"> <label class="col-md-1 control-label">发送内容:</label> <div class="col-md-8">     <div class="" id="remarkEditor"></div> </div> </div> <div class="form-group"> <label class="col-md-1 control-label m-t-sm">附件:</label> <div class="col-md-8"> <div class="row"> <div class="col-md-12 m-t-xs m-b-sm"> <span id="showFileLoading"> </span> </div> <div class="col-md-12 m-b-sm"> <span class="uploadmgrContainer"> </span> </div> </div> </div> </div> </form> </div> <div class="mail-body col-md-8 col-md-offset-1 text-right tooltip-demo"> <a class="btn btn-sm btn-primary" data-action="savePublish" >发布</a> <a class="btn btn-white btn-sm" data-action="announcement">返回</a> </div> <div class="clearfix"></div> </div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_notice/m_notice_single',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,messageType=$data.messageType,companyId=$data.companyId,projectId=$data.projectId,targetId=$data.targetId,expNo=$data.expNo,id=$data.id,companyName=$data.companyName,noticeType=$data.noticeType,_url=$helpers._url,noticeTitle=$data.noticeTitle,noticePublisherName=$data.noticePublisherName,_momentFormat=$helpers._momentFormat,noticePublishdate=$data.noticePublishdate,$string=$utils.$string,noticeContent=$data.noticeContent,$out='';$out+='<div class="row curp"> <div class="col-24-md-24 col-xl-12 notice-list-content m-t"> <div class="feed-element" data-messageType="';
$out+=$escape(messageType);
$out+='" data-companyId="';
$out+=$escape(companyId);
$out+='" data-projectId="';
$out+=$escape(projectId);
$out+='" data-targetId="';
$out+=$escape(targetId);
$out+='" data-expNo="';
$out+=$escape(expNo);
$out+='" > <div class="media-body " data-action="toNoticeDetail" data-notice-id="';
$out+=$escape(id);
$out+='" data-company-name="';
$out+=$escape(companyName);
$out+='" > <div class="col-24-md-2 text-center"> <span class="notice-icon-bg ';
$out+=$escape(noticeType==1?'':'project-type');
$out+='"> ';
if(noticeType==1){
$out+=' <img alt="image" class="img-circle pull-left m-xs" src="';
$out+=$escape(_url('/img/common/massNotice.png'));
$out+='"> ';
}else{
$out+=' <img alt="image" class="img-circle pull-left m-xs" src="';
$out+=$escape(_url('/img/common/projectNotice.png'));
$out+='"> ';
}
$out+=' </span> </div> <div class="col-24-md-22 "> <h3 class="noticeTitle fc-dark-grey" data-string="';
$out+=$escape(noticeTitle);
$out+='" >';
$out+=$escape(noticeTitle);
$out+='</h3> <p class="fc-v4-grey">发送人： <span title="';
$out+=$escape(companyName);
$out+='">';
$out+=$escape(noticePublisherName);
$out+='</span> <span class="pull-right">';
$out+=$escape(_momentFormat(noticePublishdate,'YYYY/MM/DD'));
$out+='</span> </p> <div class="fc-v2-grey notice-content-box"> ';
$out+=$string(noticeContent);
$out+=' </div> </div> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_notice/m_onlyGetTeamByTree','<form class="sky-form onlyGetTeamByTreeOBox rounded-4x margin-top-20"> <fieldset> <div class="col-md-12" style="height: 400px;overflow: auto;"> <div id="organization_treeH"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </div> </fieldset> </form>');/*v:1*/
template('m_notice/m_todo','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box"> <ol class="breadcrumb"> <li> <strong>我的待办</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="data-list-box "> <div class="data-list-container of-auto"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> ');/*v:1*/
template('m_notice/m_todo_card',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,p=$data.p,$each=$utils.$each,t=$data.t,ti=$data.ti,$escape=$utils.$escape,tIndex=$data.tIndex,_url=$helpers._url,$out='';$out+=' <table class="tree table table-bordered m-b-none task-list-box"> <thead> <tr> <th class="b-l-none"> <span>待办内容</span> </th> <th class="b-l-none"> <span>所在项目</span> </th> </tr> </thead> <tbody> ';
if(p.childList!=null && p.childList.length>0){
$out+=' ';
$each(p.childList,function(t,ti){
$out+=' <tr class="m-production-content-row ';
$out+=$escape(t.completeDate==null?'':'complete-date-tr');
$out+=' " data-id="';
$out+=$escape(t.id);
$out+='" data-pid="';
$out+=$escape(t.taskPid);
$out+='" data-project-id="';
$out+=$escape(t.projectId);
$out+='" data-project-name="';
$out+=$escape(t.projectName);
$out+='" data-business-type="';
$out+=$escape(t.businessType);
$out+='" data-task-type="';
$out+=$escape(t.taskType);
$out+='" data-i="';
$out+=$escape(tIndex);
$out+='" data-path="';
$out+=$escape(t.taskPath);
$out+='"> <td class="tree-td pt-relative p-r-none b-l-none" > <a href="javascript:void(0);" class="show-span pt-relative " data-string="';
$out+=$escape(t.taskName);
$out+='"> ';
$out+=$escape(t.taskName);
$out+=' </a> </td> ';
if((ti>=0 &&(ti+1)<(p.childList.length) && p.childList[ti+1].projectName==t.projectName)){
$out+=' <td class="tree-td pt-relative p-r-none b-l-none b-t-none" style="border-bottom: 1px #00000000 solid !important;"> ';
if(!(ti-1>=0 && p.childList[ti-1].projectName==t.projectName)){
$out+=' ';
$out+=$escape(t.projectName);
$out+=' ';
}
$out+=' </td> ';
}else{
$out+=' <td class="tree-td pt-relative p-r-none b-l-none b-t-none" > ';
if(!(ti-1>=0 && p.childList[ti-1].projectName==t.projectName)){
$out+=' ';
$out+=$escape(t.projectName);
$out+=' ';
}
$out+=' </td> ';
}
$out+=' </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="2" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有待办事项</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_notice/m_todo_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,p=$data.p,$each=$utils.$each,t=$data.t,ti=$data.ti,$escape=$utils.$escape,tIndex=$data.tIndex,currentCompanyId=$data.currentCompanyId,_isNullOrBlank=$helpers._isNullOrBlank,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<table class="tree table table-bordered m-b-none task-list-box"> <thead> <tr> <th width="30%" class="b-l-none"> <span>待办内容</span> </th> <th width="" >任务角色</th> <th width="30%" class="b-l-none"> <span>所在项目</span> </th> <th width="" >任务占比</th> <th width="" class="w-100">开始时间</th> <th width="" class="w-100">结束时间</th> </tr> </thead> <tbody> ';
if(p.childList!=null && p.childList.length>0){
$out+=' ';
$each(p.childList,function(t,ti){
$out+=' <tr class="m-production-content-row ';
$out+=$escape(t.completeDate==null?'':'complete-date-tr');
$out+=' " data-id="';
$out+=$escape(t.id);
$out+='" data-pid="';
$out+=$escape(t.taskPid);
$out+='" data-i="';
$out+=$escape(tIndex);
$out+='" data-path="';
$out+=$escape(t.taskPath);
$out+='"> <td class="tree-td pt-relative p-r-none b-l-none" > <a href="#/project/production?id=';
$out+=$escape(t.projectId);
$out+='&projectName=';
$out+=$escape(t.projectName);
$out+='&taskId=';
$out+=$escape(t.id);
$out+='&dataCompanyId=';
$out+=$escape(currentCompanyId);
$out+='&businessType=';
$out+=$escape(t.businessType);
$out+='&taskType=';
$out+=$escape(t.taskType);
$out+='&taskPid=';
$out+=$escape(t.taskPid);
$out+='" class="show-span task-name pt-relative " data-string="';
$out+=$escape(t.taskName);
$out+='"> ';
$out+=$escape(t.taskName);
$out+=' </a> </td> <td> <span class="show-span"> ';
if(t.taskType==0){
$out+=' 执行人 ';
}else{
$out+=' 任务负责人 ';
}
$out+=' </span> </td> ';
if((ti>=0 &&(ti+1)<(p.childList.length) && p.childList[ti+1].projectName==t.projectName)){
$out+=' <td class="tree-td pt-relative p-r-none b-l-none b-t-none" style="border-bottom: 1px #00000000 solid !important;"> ';
if(!(ti-1>=0 && p.childList[ti-1].projectName==t.projectName)){
$out+=' ';
$out+=$escape(t.projectName);
$out+=' ';
}
$out+=' </td> ';
}else{
$out+=' <td class="tree-td pt-relative p-r-none b-l-none b-t-none" > ';
if(!(ti-1>=0 && p.childList[ti-1].projectName==t.projectName)){
$out+=' ';
$out+=$escape(t.projectName);
$out+=' ';
}
$out+=' </td> ';
}
$out+=' <td> <span class="show-span"> ';
if(_isNullOrBlank(t.ratio)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(t.ratio);
$out+='% ';
}
$out+=' </span> </td> <td> <span class="show-span"> ';
if(t.role && t.role.edit==1){
$out+=' ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}
$out+=' </span> </td> <td class=""> <span class="show-span"> ';
if(t.role && t.role.edit==1){
$out+=' ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}
$out+=' </span> </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="6" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有待办事项</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_partyBuild/m_party_build',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 信息动态 </li> <li class="active fa fa-angle-right"> <strong>党史学习教育</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <form role="form" class="form-horizontal filter-form"> <div class="row" id="filterBox"> <div class="col-md-12 m-t-xs" id="timeSelect"> </div> <div class="col-md-12 m-t-xs"> <div class=""> <label class="inline">搜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;索：</label> <input class="form-control input-sm width-300 inline v-middle" type="text" name="keyword" placeholder="请输入关键字"> </div> </div> <div class="col-md-12 m-t border-bottom" style="margin-left: 1%;width: 94%;padding: 0px;"> <div class=" col-md-8 p-b-sm" style="padding-left: 0px"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> <div class=" col-md-4 p-b-sm text-right" style="padding-right: 0px;"> <button class="btn btn-primary roleControl" roleCode="10000605" flag="2" data-action="addDynamicsNotice">添加党史学习教育</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class=" col-md-9 filter-result-col "> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> </div> </div> </form> <div class="m-project-dynamics p-t-sm"> <div id="vertical-timeline" class="vertical-container dark-timeline center-orientation"> <div class="project-notice"> </div> </div> <div class="margin-bottom-30 m-t-xl no-data text-center" style="display: none;"> <div class=""> <img src="';
$out+=$escape(_url('/img/default/without_message.png'));
$out+='"> </div> <span class="fc-dark-blue p-l-md">暂无党史学习教育内容</span> </div> <div class="row margin-bottom-30"> <div class="col-md-12 text-center m-t-sm"> <button class="btn btn-default btn-xs" data-action="btnPageNext" href="javascript:void(0)" style="display: none;">加载更多</button> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_partyBuild/m_party_build_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fileName=$data.fileName,$escape=$utils.$escape,fileId=$data.fileId,fileFullPath=$data.fileFullPath,$out='';$out+='<form class="form-horizontal m_cost_collectionPlan_add m "> <div class="form-group "> <label class="col-sm-3 control-label">党史学习教育名称 <span class="fc-red">*</span></label> <div class="col-sm-9"> <input placeholder="请输入名称" class="form-control" type="text" name="remark" style="width: 100%;display: inline-block;"> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">党史学习教育文件 <span class="fc-red">*</span></label> <div class="col-sm-9"> <div class="row" > <div class="col-md-12 m-t-xs"> <span id="showFileLoading"> ';
if(fileName){
$out+=' <span class="label m-r-xs m-b-xs" style="background: #ecf0f1;padding: 5px 10px;display: inline-block;"> <a href="javascript:void(0)" data-action="preview" data-net-file-id="';
$out+=$escape(fileId);
$out+='" data-src="';
$out+=$escape(fileFullPath);
$out+='" data-name="';
$out+=$escape(fileName);
$out+='" name="fileName" data-type=""> ';
$out+=$escape(fileName);
$out+=' </a> </span> ';
}
$out+=' </span> </div> <div class="col-md-12"> <a href="javascript:void(0)" id="filePicker" data-action="recordAttach" class="upload-icon vertical-top m-t-xxs dp-inline-block" title="请上传党史学习教育文件"></a> </div> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_partyBuild/m_party_build_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,$out='';$each(dataList,function(p,$index){
$out+=' <div class="vertical-timeline-block" data-id="';
$out+=$escape(p.id);
$out+='" data-action="fileAction" data-src="';
$out+=$escape(p.fileFullPath);
$out+='"> <div class="vertical-timeline-icon navy-bg"> <i class="fa fa-comments"></i> </div> <div class="vertical-timeline-content"> <h4 data-value="';
$out+=$escape(p.content);
$out+='"> ';
$out+=$escape(p.content);
$out+=' <a href="javascript:void(0);" class="pull-right roleControl" roleCode="10000605" flag="2" data-action="editDynamicsNotice" data-id="';
$out+=$escape(p.id);
$out+='" title="编辑党史学习教育" style="display: none;"> <i class="fa fa-pencil"></i> </a> <a href="javascript:void(0);" class="pull-right m-r-xs roleControl" roleCode="10000605" flag="2" data-action="delDynamicsNotice" data-id="';
$out+=$escape(p.id);
$out+='" title="删除" style="display: none;"> <i class="fa fa-times"></i> </a> </h4> <div class="row"> <div class="col-sm-12"><span class="fc-dark-gray">';
$out+=$escape(_momentFormat(p.createDate,'YYYY/MM/DD'));
$out+='</span></div> </div> </div> </div> ';
});
$out+=' ';
return new String($out);
});/*v:1*/
template('m_org/m_addressBook',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="ibox m-b-none m_addressBook"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-6">  <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> <strong>通讯录</strong> </li> </ol> </div> </div> <div class="col-md-6 text-right p-xs treeSwitch"> <!--<a href="javascript:void(0)" data-action="treeSwitch"> <img src="';
$out+=$escape(_url('/img/whole_org_framework.png'));
$out+='" style="height: 23px;" data-toggle="tooltip" data-placement="top" title="查看完整组织架构" /> </a>--> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content no-padding no-border"> <div class="row"> <div class="col-24-sm-8 col-24-md-8 col-24-lg-6 border-right of-auto" id="org-tree-box" style="height:500px;"> <div class="clearfix margin-bottom-10"></div> <div id="organization_treeH"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </div>  <div class="col-24-sm-16 col-24-md-16 col-24-lg-18 no-padding" id="orgUserListBox"> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_org/m_bulkImport',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,companyName=$data.companyName,$out='';$out+='<div class="ibox white-bg m_bulkImport"> <div class="ibox-content"> <div class="row"> <div class="col-md-12 m-md"> <div class="call-action-v1 call-action-v1-boxed margin-bottom-40"> <div class="call-action-v1-box"> <div class="call-action-v1-in"> <h3 class="color-darker"><strong>组织名称：';
$out+=$escape(companyName);
$out+='</strong></h3> <h4 >通过批量导入的方式快速建立您的组织架构。</h4> <p>您需要先准备好指定格式的Excel文档. <a href="javascript:void(0);" data-action="downLoadTemplate">下载模版文件</a> </p> </div> <div class="call-action-v1-in inner-btn page-scroll"> <div id="filePicker" class="btn-u btn-primary no-padding rounded"> </div> <a class="btn-u btn-u-default rounded" href="javascript:void(0);" data-action="backToLast">返回</a> </div> <div class="progress progress-u progress-xs m-t-md m-r-md hide"> <div class="progress-bar progress-bar-u width-0" role="progressbar" name="div_progress" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"> </div> </div> </div> </div> </div> </div> <div class="row"> <div class="col-md-12" id="errorListBox"> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_org/m_bulkImportListTips',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,userErrorList=$data.userErrorList,u=$data.u,$index=$data.$index,$escape=$utils.$escape,$out='';$out+='<div class="call-action-v1 call-action-v1-boxed tag-box-v3 table"> <div class="alert alert-danger fade in margin-top-20"> <div class="call-action-v1 call-action-v1-boxed tag-box-v3 table"> <table class="table table-responsive"> <thead> <tr> <td>部门</td> <td>姓名</td> <td>手机号码</td> <td>邮箱</td> <td>入职时间</td> <td>联系电话</td> <td>提示</td> </tr> </thead> <tbody> ';
$each(userErrorList,function(u,$index){
$out+=' <tr> <td>';
$out+=$escape(u.departName);
$out+='</td> <td>';
$out+=$escape(u.userName);
$out+='</td> <td>';
$out+=$escape(u.cellphone);
$out+='</td> <td>';
$out+=$escape(u.email);
$out+='</td> <td>';
$out+=$escape(u.entryTime);
$out+='</td> <td>';
$out+=$escape(u.phone);
$out+='</td> <td>';
$out+=$escape(u.remark);
$out+='</td> </tr> ';
});
$out+=' <tr> <td colspan="7"> <b> 以上成员信息存在错误或者已经存在,请重新修改并上传。</b> </td> </tr> </tbody> </table> </div> </div> <div class="row dp-none"> <div class="col-md-12"> <h3 class="text-center"><i class="fa fa-check text-success"></i> 批量导入成功 </h3> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_org/m_createOrg','<div class="container-fluid"> <div id="createOrgBox" class="width-600 m-auto m-t-lg animated fadeInRight"> <form class="createOrgBox"> <div class="headline"> <h2>创建组织</h2> <span class="fc-v1-grey">(创建一个组织，邀请成员加入，通过项目一起高效的协作)</span> </div> <div class="form-group pt-relative"> <label>组织名称<span class="fc-red">*</span></label> <input type="text" class="form-control companyName" id="companyName" name="companyName" placeholder="请输入组织名称" autocomplete=\'off\'>  </div> <div class="form-group" id="citysBox"> <label for="selectRegion">所在地区</label> <div class="input-group" id="selectRegion" name="selectRegion"> <div class="dp-inline-block"> <select class="prov form-control" name="province"></select> </div> <div class="dp-inline-block m-l-xs"> <select class="city form-control" name="city" disabled="disabled" style="display: none"></select> </div> <div class="dp-inline-block m-l-xs"> <select class="dist form-control" name="county" disabled="disabled" style="display: none"></select> </div> </div> </div> <div class="form-group serviceTypeEdit"> <label>经营范围</label> <div id="serviceTypeBox"> </div> </div> <div class="footTools"> <div class="pull-left fc-v1-grey f-s-xs">*选择本组织涉及的服务类型，后续会在人员专业和项目模板中使用。</div> <a type="button" class="btn-u pull-right getClickFun rounded" data-action="saveOrg" href="javascript:void(0)">立即创建</a> </div> </form> </div> </div> ');/*v:1*/
template('m_org/m_editDepart',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,doType=$data.doType,$escape=$utils.$escape,parentDepart=$data.parentDepart,$each=$utils.$each,departList=$data.departList,d=$data.d,$index=$data.$index,departObj=$data.departObj,dataInfo=$data.dataInfo,$out='';$out+='<form class="form-horizontal editDepartOBox"> <div class="panel-body"> <div class="form-group"> ';
if(doType=='edit'){
$out+=' <label class="col-24-md-5 control-label">上级部门<span class="fc-red">*</span>：</label> <div class="col-24-md-19 p-l-none"> <select class="form-control" name="pid" data-depart-id="';
$out+=$escape(parentDepart.id);
$out+='"> <option value="">请选择</option> ';
$each(departList,function(d,$index){
$out+=' ';
if(parentDepart.id==d.id){
$out+=' <option value="';
$out+=$escape(d.id);
$out+='" selected> ';
$out+=$escape(d.departName);
$out+='</option> ';
}
$out+=' ';
if(parentDepart.id!=d.id){
$out+=' <option value="';
$out+=$escape(d.id);
$out+='"> ';
$out+=$escape(d.departName);
$out+='</option> ';
}
$out+=' ';
});
$out+=' </select> </div> ';
}else{
$out+=' <label class="col-24-md-5 control-label"> ';
if(parentDepart.orgType==4 || (parentDepart.orgType==0 && parentDepart.departName=='本部')){
$out+=' 部门分组： ';
}else{
$out+=' 上级部门： ';
}
$out+=' </label> <div class="col-24-md-19 p-l-none p-t-7"> ';
$out+=$escape(parentDepart.departName);
$out+=' </div> ';
}
$out+=' </div> <div class="form-group"> <label class="col-24-md-5 control-label">部门名称<span class="fc-red">*</span>：</label> <div class="col-24-md-19 p-l-none"> <input type="text" class="form-control" name="departName" value="';
$out+=$escape(departObj.departName);
$out+='"/> </div> </div> <div class="form-group"> <label class="col-24-md-5 control-label">部门类型：</label> <div class="col-24-md-19 p-l-none"> <select class="form-control" name="departType"> <option value="1">业务型部门</option> <option value="2">研究型部门</option> <option value="3">管理型部门</option> <option value="0">其他</option> </select> </div> </div>    <!--<textarea class="form-control" name="departDesc" rows="4">';
$out+=$escape(departObj.departDesc);
$out+='</textarea>-->   <div class="form-group"> <label class="col-24-md-5 control-label">部门封面：</label> <div class="col-24-md-19 p-l-none"> <div class="row"> <div class="col-md-12 m-t-xs"> <span id="showFileLoading"> ';
if(dataInfo && dataInfo.cover){
$out+=' <span class="label m-r-xs m-b-xs" style="background: #ecf0f1;padding: 5px 10px;display: inline-block;"> <a href="javascript:void(0)" data-action="preview" data-net-file-id="';
$out+=$escape(dataInfo.cover.id);
$out+='" data-src="';
$out+=$escape(dataInfo.cover.fileFullPath);
$out+='" data-name="';
$out+=$escape(dataInfo.cover.fileName);
$out+='" data-type=""> ';
$out+=$escape(dataInfo.cover.fileName);
$out+=' </a> </span> ';
}
$out+=' </span> </div> <div class="col-md-12"> <a href="javascript:void(0)" id="filePicker" data-action="recordAttach" class="upload-icon vertical-top m-t-xxs dp-inline-block" title="请上传部门封面"></a> </span> </div> </div> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_org/m_editDepartIntroduction',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fileName=$data.fileName,$escape=$utils.$escape,fileId=$data.fileId,fileFullPath=$data.fileFullPath,projectList=$data.projectList,$each=$utils.$each,p=$data.p,$index=$data.$index,_url=$helpers._url,$out='';$out+='<div class="ibox m_organizational no-margins">  <div class="ibox-content no-padding"> <div class="col-24-md-24"> <div class="row text-right p-xs"> <a class="btn btn-default btn-sm" href="javascript:void(0);" data-action="backToLast">返回</a> <a class="btn btn-primary btn-sm" href="javascript:void(0);" data-action="preview">预览</a> <a class="btn btn-primary btn-sm" href="javascript:void(0);" data-action="save">保存</a> </div> </div> <div class="col-md-12"> <div class="row"> <div class="col-md-8 " style="width:73%; padding: 1% 15% 1% 1%;"> <form class="form-horizontal "> <div class="form-group"> <label class=" control-label" style="float:left ;padding-left: 15px">封面</label> <div class=" " style="float:left;padding-left: 5px"> <div class="row"> <div class="col-md-12 m-t-xs"> <span id="showFileLoading"> ';
if(fileName){
$out+=' <span class="label m-r-xs m-b-xs" style="background: #ecf0f1;padding: 5px 10px;display: inline-block;"> <a href="javascript:void(0)" data-action="preview" data-net-file-id="';
$out+=$escape(fileId);
$out+='" data-src="';
$out+=$escape(fileFullPath);
$out+='" data-name="';
$out+=$escape(fileName);
$out+='" data-type=""> ';
$out+=$escape(fileName);
$out+=' </a> </span> ';
}
$out+=' </span> </div> <div class="col-md-12"> <a href="javascript:void(0)" id="filePicker" data-action="recordAttach" class="upload-icon vertical-top m-t-xxs dp-inline-block" title="请上传部门封面"></a> </div> </div> </div> </div> </form> <form class="form-horizontal "> <div class="form-group"> <div class="col-sm-12"> <div id="remarkEditor"></div> </div> </div> </form> </div> <div class="col-md-4 " style="width:27%; padding: 0px;"> <div class="middleLine" style="width:1px;height:750px;background:#e2e2e2;float:left;position:relative"></div> <div class="right-panel "> <div class="panel-heading"> 课题名称 </div> <div> ';
if(projectList && projectList.length>0){
$out+=' ';
$each(projectList,function(p,$index){
$out+=' <div style=" padding: 10px 10px 0px 15px;border-bottom: 1px solid #e2e2e2;"> <p> <a href="javascript:void(0);" data-action="projectAction" data-key="';
$out+=$escape(p.id);
$out+='" data-value="';
$out+=$escape(p.projectName);
$out+='">';
$out+=$escape(p.projectName);
$out+='</a> </p> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="notice-row"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </div> ';
}
$out+=' </div> </div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_org/m_editDepartIntroductionPreview',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_isNullOrBlank=$helpers._isNullOrBlank,fileFullPath=$data.fileFullPath,_url=$helpers._url,$string=$utils.$string,explainDesc=$data.explainDesc,projectList=$data.projectList,$each=$utils.$each,p=$data.p,$index=$data.$index,$out='';$out+='<div class="ibox m_organizational no-margins">  <div class="ibox-content no-padding"> <a class="close-btn" href="javascript:void(0)" data-action="backToLastDepartIntroduction" title="退出预览"> <i class="fa fa-times fc-red"></i> </a> <div class="col-md-12"> <div class="row"> <div class="col-md-8 " style="width:73%; padding: 1% 15% 1% 1%;" > <div id="js-bg" class="pt-relative"> <img alt="image" src="';
$out+=$escape(_isNullOrBlank(fileFullPath)?_url('/img/depart_introduction_default_img.png'):fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/depart_introduction_default_img.png'));
$out+='" style="width: 50vw; height: 25vw;"> </div> <div style="width: 50vw; padding:0px;margin:0px; line-height: 25px;letter-spacing: 0px;word-break: break-all;"> <div> <p> ';
$out+=$string(explainDesc);
$out+=' </p> </div> </div> </div> <div class="col-md-4 " style="width:27%; padding: 0px;" > <div class="middleLine" style="width:1px;height:750px;background:#e2e2e2;float:left;position:relative"></div> <div class="right-panel "> <div class="panel-heading"> 课题名称 </div> <div > ';
if(projectList && projectList.length>0){
$out+=' ';
$each(projectList,function(p,$index){
$out+=' <div style=" padding: 10px 10px 0px 15px;border-bottom: 1px solid #e2e2e2;"> <p> <a href="javascript:void(0);" data-action="projectAction" data-key="';
$out+=$escape(p.id);
$out+='" data-value="';
$out+=$escape(p.projectName);
$out+='">';
$out+=$escape(p.projectName);
$out+='</a> </p> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="notice-row"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </div> ';
}
$out+=' </div> </div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_org/m_editDepartSubject',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_styleTypeEdit=$helpers._styleTypeEdit,styleType=$data.styleType,data=$data.data,$out='';$out+='<div class="ibox m_organizational no-margins">  <div class="ibox-content no-padding"> <div class="col-24-md-24"> <div class="row text-right p-xs"> <a class="btn btn-default btn-sm" href="javascript:void(0);" data-action="backToLast">返回</a> <a class="btn btn-primary btn-sm" href="javascript:void(0);" data-action="switchMode">切换展示模式</a> <a class="btn btn-primary btn-sm" href="javascript:void(0);" data-action="preview">预览</a> <a class="btn btn-primary btn-sm" href="javascript:void(0);" data-action="saveDetails">保存</a> </div> </div> <div class="col-md-12"> <form class="form-horizontal p-w-xs" id="basicInfo"> <div class="row"> <div class="';
$out+=$escape(_styleTypeEdit(styleType,'1'));
$out+='" > <div id="remarkEditorLeft"></div> </div> <div class="';
$out+=$escape(_styleTypeEdit(styleType,'2'));
$out+=' p-l-none" > <div class="form-group"> <label class="col-sm-12 control-label m-t-xs f-s-m-v1" style="text-align: left;height: 29px ;padding-top: 0px ;margin-top: 0px">课题名称</label> <div class="col-sm-12"> <textarea placeholder="请输入课题名称" class="form-control f-s-m-v1" maxlength="200" style="min-height: 150px;padding: 0px" type="text" name="projectName" id="projectName" >';
$out+=$escape(data.projectName);
$out+='</textarea> <div id = "projectNameCount">';
$out+=$escape(data.projectName==null?'0':data.projectName.length);
$out+=' /200</div> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1" style="text-align: left ;height: 36px">课题目标</label> <div class="col-sm-12"> <textarea placeholder="请输入课题目标" class="form-control f-s-m-v1" maxlength="500" style="min-height: 200px;padding: 0px" type="text" name="projectTarget" id="projectTarget">';
$out+=$escape(data.projectTarget);
$out+='</textarea> <div id = "projectTargetCount">';
$out+=$escape(data.projectTarget==null?'0':data.projectTarget.length);
$out+=' /500</div> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1" style="text-align: left;height: 36px">课题内容</label> <div class="col-sm-12"> <textarea placeholder="请输入课题内容" class="form-control f-s-m-v1" maxlength="500" style="min-height: 200px;padding: 0px" type="text" name="projectContent" id="projectContent">';
$out+=$escape(data.projectContent);
$out+='</textarea> <div id = "projectContentCount">';
$out+=$escape(data.projectContent==null?'0':data.projectContent.length);
$out+=' /500</div> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1" style="text-align: left;height: 36px">课题成果</label> <div class="col-sm-12"> <textarea placeholder="请输入课题成果" class="form-control f-s-m-v1" maxlength="500" style="min-height: 200px;padding: 0px" type="text" name="projectResult" id="projectResult">';
$out+=$escape(data.projectResult);
$out+='</textarea> <div id = "projectResultCount">';
$out+=$escape(data.projectResult==null?'0':data.projectResult.length);
$out+=' /500</div> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1" style="text-align: left;height: 36px">荣&nbsp; &nbsp; &nbsp; &nbsp;誉</label> <div class="col-sm-12"> <textarea placeholder="请输入荣誉" class="form-control f-s-m-v1" maxlength="500" style="min-height: 200px;padding: 0px" type="text" name="projectHonour" id="projectHonour">';
$out+=$escape(data.projectHonour);
$out+='</textarea> <div id = "projectHonourCount">';
$out+=$escape(data.projectHonour==null?'0':data.projectHonour.length);
$out+=' /500</div> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1" style="text-align: left;height: 36px">团队成员</label> <div class="col-sm-12"> <textarea placeholder="请输入团队成员" class="form-control f-s-m-v1" maxlength="200" style="min-height: 200px;padding: 0px" type="text" name="projectMember" id="projectMember">';
$out+=$escape(data.projectMember);
$out+='</textarea> <div id = "projectMemberCount">';
$out+=$escape(data.projectMember==null?'0':data.projectMember.length);
$out+='/200</div> </div> </div> </div> </div> </form> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_org/m_editDepartSubjectPreview',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_styleType=$helpers._styleType,styleType=$data.styleType,$string=$utils.$string,leftExplainDesc=$data.leftExplainDesc,_styleTypeEdit=$helpers._styleTypeEdit,data=$data.data,$out='';$out+='<div class="ibox m_organizational no-margins">  <div class="ibox-content no-padding"> <a class="close-btn" href="javascript:void(0)" data-action="backToLast" title="退出预览"> <i class="fa fa-times fc-red"></i> </a> <div class="col-md-12"> <div class="row"> <div class="';
$out+=$escape(_styleType(styleType,'1'));
$out+='"> <div style="padding:0px;margin:0px; line-height: 25px;letter-spacing: 0px;word-break: break-all;"> <div> <p> ';
$out+=$string(leftExplainDesc);
$out+=' </p> </div> </div> </div> <div class="middleLine col-custom-2" style="width:1px;height:750px;background:#e2e2e2;float:left;position:relative"></div> <div class="';
$out+=$escape(_styleTypeEdit(styleType,'2'));
$out+=' p-l-none l-h-18"> <div class="form-group"> <label class="col-sm-12 control-label m-t-xs f-s-m-v1">课题名称</label> <div class="col-sm-12"> <p class="line-feed f-s-m-v1">';
$out+=$escape(data.projectName);
$out+='</p> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1">课题目标</label> <div class="col-sm-12"> <p class="line-feed f-s-m-v1">';
$out+=$escape(data.projectTarget);
$out+='</p> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1">课题内容</label> <div class="col-sm-12"> <p class="line-feed f-s-m-v1">';
$out+=$escape(data.projectContent);
$out+='</p> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1">课题成果</label> <div class="col-sm-12"> <p class="line-feed f-s-m-v1">';
$out+=$escape(data.projectResult);
$out+='</p> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1">荣&nbsp; &nbsp; &nbsp; &nbsp;誉</label> <div class="col-sm-12"> <p class="line-feed f-s-m-v1">';
$out+=$escape(data.projectHonour);
$out+='</p> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1">团队成员</label> <div class="col-sm-12"> <p class="line-feed f-s-m-v1">';
$out+=$escape(data.projectMember);
$out+='</p> </div> </div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_org/m_editUser',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,adminFlag=$data.adminFlag,$each=$utils.$each,org=$data.org,i=$data.i,orgList=$data.orgList,d=$data.d,$index=$data.$index,$out='';$out+='<div class=" m m-edit-user"> <h4 class="title-line m-t">基本信息</h4> <div class="hr-line-dashed m-t-none"></div> <form class="form-horizontal p-w-xs" id="basicInfo"> <div class="form-group"> <label class="col-24-sm-3 control-label">姓名<span class="fc-red">*</span>：</label> <div class="col-24-sm-9"> <input type="text" class="form-control" id="userName" name="userName" value="';
$out+=$escape(dataInfo.userName);
$out+='"> </div> <label class="col-24-sm-3 control-label">手机号码<span class="fc-red">*</span>：</label> <div class="col-24-sm-9"> ';
if(dataInfo.cellphone!='' && dataInfo.cellphone!=null){
$out+=' ';
if(adminFlag==1){
$out+=' <input type="text" class="form-control" name="cellphone" value="';
$out+=$escape(dataInfo.cellphone);
$out+='" maxlength="11" > ';
}else{
$out+=' <input type="text" class="form-control" name="cellphone" value="';
$out+=$escape(dataInfo.cellphone);
$out+='" maxlength="11" disabled="disabled" > ';
}
$out+=' ';
}
$out+=' ';
if(dataInfo.cellphone=='' || dataInfo.cellphone==null){
$out+=' <input type="text" class="input-autofill-selected form-control" name="cellphone" value="';
$out+=$escape(dataInfo.cellphone);
$out+='" maxlength="11"> ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-24-sm-3 control-label">入职时间：</label> <div class="col-24-sm-9"> <div class="input-group"> <input type="text" class="form-control" name="entryTime" onfocus="WdatePicker();" readonly value="';
$out+=$escape(dataInfo.entryTime);
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> <label class="col-24-sm-3 control-label">专业：</label> <div class="col-24-sm-9"> <div> <select class="form-control" name="major"></select> </div> </div> </div> <div class="form-group"> <label class="col-24-sm-3 control-label">职称：</label> <div class="col-24-sm-9"> <input type="text" class="input-autofill-selected form-control" name="positionalTitle" value="';
$out+=$escape(dataInfo.positionalTitle);
$out+='"> </div> </div> </form> <h4 class="title-line m-t">所属部门与职位</h4> <div class="hr-line-dashed m-t-none"></div>  <form class="form-horizontal"> ';
$each(dataInfo.departList,function(org,i){
$out+=' <div class="depart-item p-xs m-b-xs bg-v5-grey" data-i="';
$out+=$escape(i);
$out+='"> <div class="form-group"> <label class="col-24-sm-3 control-label">所属部门<span class="fc-red">*</span>：</label> <div class="col-24-sm-9"> <select class="form-control" name="departIdSel" data-depart-id="';
$out+=$escape(org.id);
$out+='"> <option value="">请选择</option> ';
$each(orgList,function(d,$index){
$out+=' ';
if(org.departId==d.id){
$out+=' <option value="';
$out+=$escape(d.id);
$out+='" selected> ';
$out+=$escape(d.departName);
$out+='</option> ';
}
$out+=' ';
if(org.departId!=d.id){
$out+=' <option value="';
$out+=$escape(d.id);
$out+='"> ';
$out+=$escape(d.departName);
$out+='</option> ';
}
$out+=' ';
});
$out+=' </select> </div> <label class="col-24-sm-3 control-label">职位：</label> <div class="col-24-sm-7"> <input type="text" class="form-control" name="serverStation" placeholder="职位" value="';
$out+=$escape(org.serverStation);
$out+='"/> </div> <div class="col-24-sm-2 text-right"> <a class="btn btn-danger rounded" data-action="delDepartServerStation"> <i class="fa fa-close"></i> </a> </div> </div>  </div> ';
});
$out+=' <div class="form-group"> <div class="col-sm-12"> <div class="tag-box-v4 rounded text-center p-t-sm p-b-sm"> <a href="javascript:void(0);" data-action="addDepartServerStation" title="删除当前所属部门信息"> <i class="fa fa-plus fa-2x color-dark-blue"></i> </a> </div> </div> </div> </form>  </div> ';
return new String($out);
});/*v:1*/
template('m_org/m_editUserByMySelf',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<div class=" m m-edit-user"> <h4 class="title-line m-t">基本信息</h4> <div class="hr-line-dashed m-t-none"></div> <form class="form-horizontal p-w-xs" id="basicInfo"> <div class="form-group"> <label class="col-24-sm-3 control-label">姓名<span class="fc-red">*</span>：</label> <div class="col-24-sm-9"> <input type="text" class="form-control" id="userName" name="userName" value="';
$out+=$escape(dataInfo.userName);
$out+='"> </div> <label class="col-24-sm-3 control-label">手机号码<span class="fc-red">*</span>：</label> <div class="col-24-sm-9"> ';
if(dataInfo.cellphone!='' && dataInfo.cellphone!=null){
$out+=' <input type="text" class="form-control" name="cellphone" value="';
$out+=$escape(dataInfo.cellphone);
$out+='" maxlength="11" disabled="disabled" > ';
}
$out+=' </div> </div> <div class="form-group"> <label class="col-24-sm-3 control-label">入职时间：</label> <div class="col-24-sm-9"> <div class="input-group"> <input type="text" class="form-control" name="entryTime" onfocus="WdatePicker();" readonly value="';
$out+=$escape(dataInfo.entryTime);
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> <label class="col-24-sm-3 control-label">专业：</label> <div class="col-24-sm-9"> <div> <select class="form-control" name="major"></select> </div> </div> </div> <div class="form-group"> <label class="col-24-sm-3 control-label">职称：</label> <div class="col-24-sm-9"> <input type="text" class="input-autofill-selected form-control" name="positionalTitle" value="';
$out+=$escape(dataInfo.positionalTitle);
$out+='"> </div> </div> </form> </div> ';
return new String($out);
});/*v:1*/
template('m_org/m_firstCreateOrg_pre','<div class="ibox"> <div class="ibox-title"> <span class="f-s-xl fw-400 l-h-20">欢迎使用</span> </div> <div class="ibox-content"> <p class="f-s-md l-h-16"> <span class="dp-inline-block" style="width: 16px;"><i class="fc-dark-blue fa fa-info-circle"></i></span> 温馨提示</p> <p class="f-s-m m-t-sm l-h-28">初次使用系统且无组织邀请的用户，可进行以下两个操作：</p> <ul style="padding: 0 20px 15px;"> <li> <p class="f-s-m l-h-14">若你是组织管理者，可进行创建组织</p> </li> <li> <p class="f-s-m l-h-14">若你是组织普通成员，可等待你组织的邀请，将你加入到组织中</p> </li> </ul> <div class="footTools"> <a type="button" class="btn btn-primary btn-sm pull-right" data-action="startCreateOrg" href="javascript:void(0)">开始创建</a> <a type="button" class="btn btn-default btn-sm pull-right disabled m-r-sm" href="javascript:void(0)">等待邀请</a> </div> </div> </div>');/*v:1*/
template('m_org/m_inviteCorp',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,inviteType=$data.inviteType,$out='';$out+='<div class="container-fluid inviteCorpBox"> <div class="row"> <div class="col-md-12" style="padding: 25px 15px 15px 15px"> <div class="form-group"> <!--请输入';
$out+=$escape(inviteType===1?'分支机构':'事业合伙人');
$out+='的手机号：--> 请输入被邀请组织负责人的手机号： </div> <div class="inviteCorpPart form-group input-group"> <input name="bPartnerPhone" class="form-control"> <span class="input-group-btn"> <a class="btn btn-primary pull-right" data-action="sendMessage">发送邀请</a>  </span> </div>  </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_org/m_inviteCorp_part','<div class="inviteCorpPart form-group input-group"> <input class="form-control"> <span class="input-group-btn"> <a class="btn btn-primary" data-action="addCorp"><i class="fa fa-plus"></i></a> <a class="btn btn-danger" data-action="removeCorp" style="display: none;"><i class="fa fa-close"></i></a> </span> </div>');/*v:1*/
template('m_org/m_inviteUser',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,inivteUserUrl=$data.inivteUserUrl,$out='';$out+='<div class="container-fluid invitePersonelOBox"> <div class=" panel-invite"> <div class="panel-body no-pd" id="qqShareDiv"> <div class="bdsharebuttonbox hide" data-tag="share_1"> <a id="share" target="_blank"><i class="fa fa-qq"></i></a> </div> </div> <div class="col-md-12 p-h-xs"> <div class="form-group"> <div class="input-group" style="width: 100%;"> 请复制以下链接发送给你想邀请的人员 </div> </div> <div class="form-group"> <div class="input-group full-width"> <input class="form-control left" id="url" style="width: 78%;height: 31px;" value="';
$out+=$escape(inivteUserUrl);
$out+='"> <button type="button" class="btn btn-primary" left data-action="copyUrl" style="margin: -1px 0 0 8px;">复制链接</button> </div> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_org/m_organizational',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,companyVersion=$data.companyVersion,departName=$data.departName,$out='';$out+='<div class="ibox m_organizational no-margins">  <div class="ibox-content no-padding"> <div class="col-24-md-24"> <div class="row org-btn-box"> <div class="treeSwitch" style=""> <!--<a class="m-t-sm" href="javascript:void(0)" data-action="treeSwitch"> <img src="';
$out+=$escape(_url('/img/whole_org_framework.png'));
$out+='" style="height: 23px;" data-toggle="tooltip" data-placement="top" title="查看完整组织架构" /> </a>--> </div> <div class="col-24-md-23 col-24-sm-23 col-24-xs-23 headContent"> <a href="javascript:void(0)" class=" roleControl" roleCode="10000101" flag="2" data-action="addDepart"> <i class="iconfont rounded icon-2fengongsi m-r-xs"></i>添加部门 </a> <span class="divice roleControl" roleCode="10000101" flag="2" >|</span> <a href="javascript:void(0)" class="roleControl p-r-none" roleCode="10000101" flag="2" data-action="addUser">添加人员</a> <a href="javascript:void(0)" class="roleControl" roleCode="10000101" flag="2" data-action="bulkImport">批量导入成员</a>  <!--';
if(companyVersion!='03'){
$out+=' <span class="divice ">|</span> <a href="javascript:void(0)" data-action="addOrgType"><i class="iconfont rounded icon-2fengongsi1 m-r-xs"></i>添加部门分组</a> ';
}
$out+='--> </div> </div> </div> <div class="col-24-sm-8 col-24-md-8 col-24-lg-6 border-right of-auto" id="org-tree-box" style="height: 500px;"> <div class="clearfix margin-bottom-10"></div> <div id="organization_treeH"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </div>  <div class="col-24-sm-16 col-24-md-16 col-24-lg-18 no-padding" > <div class="col-sm-12 no-padding editDepartTop" > <div class="col-sm-10 no-padding m"> <span id="departName">';
$out+=$escape(departName);
$out+='</span> </div> <div class="col-sm-2 text-right p-xxs"> <button type="button" class="btn btn-primary btn-sm roleControl" roleCode="20030601" flag="2" data-action="editDepartIntroduction" style="display:none;">编辑部门介绍</button> </div> </div> <div class="col-sm-12 no-padding" id="orgUserListBox"> </div> </div> <div class="clearfix"></div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_org/m_orgByTree','<style> #userlist-pagination-container{position: absolute;right: 8px;bottom: -46px;height: auto;margin-top: 0} .orgUserTreeOBox .ibox-content{border-top: none;} .orgUserTreeOBox .ibox{margin-bottom: 0} </style> <form class="form-horizontal orgUserTreeOBox rounded-4x"> <div class="ibox"> <div class="ibox-content">  <div class="row"> <div class="col-md-5" style="height: 320px;overflow: auto;"> <div id="organization_treeH"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </div> <div class="col-md-7 " > <div data-list="userList" style="height: 270px;overflow: auto"></div> <div id="userlist-pagination-container" class="m-pagination pull-right m-r"></div> </div> </div> <div class="row"> <div class="col-md-12"> <div class="panel panel-default m-b-none" style="min-height: 50px;"> <div class="panel-body selectedUserBox" style="height: 100%"> </div> </div> </div> </div> </div> </div> </form>');/*v:1*/
template('m_org/m_orgByTree_selected_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,selectedUserList=$data.selectedUserList,u=$data.u,ui=$data.ui,$escape=$utils.$escape,c=$data.c,ci=$data.ci,isASingleSelectUser=$data.isASingleSelectUser,$out='';$each(selectedUserList,function(u,ui){
$out+=' <span class="selected-user m-r-xs" data-type="';
$out+=$escape(u.orgType);
$out+='" data-i="';
$out+=$escape(ui);
$out+='"> <span class="label label-light m-t-xs dp-inline-block" > ';
if(u.candidateUserList && u.candidateUserList.length>0){
$out+=' <span class="selected-user-list" id="sortableUser';
$out+=$escape(u.orgType);
$out+='"> ';
$each(u.candidateUserList,function(c,ci){
$out+=' <span class="user-item" data-sort-id="';
$out+=$escape(ci);
$out+='">[';
$out+=$escape(c.name);
$out+=']</span> ';
});
$out+=' </span> <span>-第';
$out+=$escape(u.level);
$out+='级主管(';
$out+=$escape(u.orgType==3?'多级':'单级');
$out+=')</span> ';
}else{
$out+=' ';
$out+=$escape(u.userName);
$out+=' ';
}
$out+=' ';
if(isASingleSelectUser!=2){
$out+=' <a class="curp" href="javascript:void(0)" data-id="';
$out+=$escape(u.id);
$out+='" data-action="delUser"><i class="fa fa-times fc-red"></i></a> ';
}
$out+=' </span> </span> ';
});
return new String($out);
});/*v:1*/
template('m_org/m_orgInfomation',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,type=$data.type,$out='';if(type == 1){
$out+=' <div class="ibox ibox-shadow ibox_min_height profile" id="mainContain"> <div class="ibox-content no-padding"> <div class="col-md-3 col-md-offset-9 col-xl-4 col-xl-offset-8 text-right m-b-xs m-t-xs p-w-md">  &nbsp; </div> <div class="row"> <div class="col-xs-7 col-xl-6" id="infoMainOBox"> </div> <div class="col-xs-5 col-xl-6 p-w-xl" id="teamPicShow"> </div> </div> <div class="clearfix"></div> </div> </div> ';
}else{
$out+=' <div class="ibox m-b-none profile"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-6">  <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 通讯录 </li> <li class="active fa fa-angle-right"> <strong>组织信息</strong> </li> </ol> </div> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content no-padding no-border"> <div class="row m-t-xl"> <div class="col-xs-7 col-xl-6" id="infoMainOBox"> </div>  </div> </div> </div> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_org/m_orgUserList',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,isEdit=$data.isEdit,orgUserList=$data.orgUserList,$escape=$utils.$escape,_url=$helpers._url,$each=$utils.$each,u=$data.u,ui=$data.ui,d=$data.d,$index=$data.$index,p=$data.p,pi=$data.pi,$out='';$out+='<table class="table table-responsive table-striped table-bordered orgUserOBox dataTable"> <thead> <tr> <th width="6%">序号</th> <th width="8%">姓名</th>  <th width="10%">手机号码</th>   <th width="14%" class="sorting_desc w-100" data-action="sort" data-code="majorName">专业</th> <th width="14%">职称</th> ';
if(isEdit){
$out+=' <th width="8%"></th> <th width="7%"></th> ';
}else{
$out+=' <th width="15%">职位</th> ';
}
$out+=' </tr> </thead> ';
if(orgUserList==null || orgUserList.length==0){
$out+=' <tbody> <tr class="no-data"> <td colspan="';
$out+=$escape(isEdit==true?7:5);
$out+='" align="center"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无数据</span> </div> </td> </tr> </tbody> ';
}
$out+=' <tbody id="sortItemBox"> ';
$each(orgUserList,function(u,ui){
$out+=' <tr class="userListTr curp" data-id="';
$out+=$escape(u.userId);
$out+='" data-org-userid="';
$out+=$escape(u.orgUserId);
$out+='" data-sort-id="';
$out+=$escape(ui);
$out+='"> <td>';
$out+=$escape(ui+1);
$out+='</td> <td class="word-break td-first"> ';
$out+=$escape(u.userName);
$out+=' </td> <!--<td class="word-break">';
$out+=$escape(u.orgServerStation);
$out+='</td>--> <td class="word-break">';
$out+=$escape(u.cellphone);
$out+='</td> <!--<td class="word-break">';
$out+=$escape(u.phone);
$out+='</td>--> <!--<td class="word-break">';
$out+=$escape(u.email);
$out+='</td>--> <td class="word-break">';
$out+=$escape(u.majorName);
$out+='</td> <td class="word-break">';
$out+=$escape(u.positionalTitle);
$out+='</td> ';
if(isEdit){
$out+=' <td> <div class="btn-group btnReturnFalse"> <a type="button" class="btn btn-default btn-xs dropdown-toggle btnReturnFalse roleControl" roleCode="10000301" flag="2" data-toggle="dropdown" aria-expanded="true"> 操作 <i class="fa fa-angle-down btnReturnFalse"></i> </a> <ul class="dropdown-menu " role="menu"> <li> <a class="no-margins" href="javascript:void(0)" data-i="';
$out+=$escape(ui);
$out+='" data-action="editOrgUser"><span>编辑</span></a> </li> ';
if(u.adminFlag==null||u.adminFlag==''){
$out+=' <li> <a class="no-margins" href="javascript:void(0)" data-id="';
$out+=$escape(u.id);
$out+='" data-action="delOrgUser"><span>删除</span></a> </li> ';
}
$out+=' </ul> </div> </td> <td class="lastTd"> ';
if(ui>0){
$out+=' <a class="btnReturnFalse curp roleControl" roleCode="10000301" flag="2" title="向上排序" style="text-decoration: none" data-i="';
$out+=$escape(ui);
$out+='" data-action="upSorting"> <i class="iconfont icon-xiangshang"></i> </a> ';
}
$out+=' ';
if(ui < orgUserList.length-1){
$out+=' <a class="btnReturnFalse curp roleControl" roleCode="10000301" flag="2" title="向下排序" style="text-decoration: none" data-i="';
$out+=$escape(ui);
$out+='" data-action="downSorting"> <i class="iconfont icon-xiangxia"></i> </a> ';
}
$out+=' </td> ';
}else{
$out+=' <td class="word-break">';
$out+=$escape(u.orgServerStation);
$out+='</td> ';
}
$out+=' </tr> <tr class="userInfoTr" style="display: none;"> <td colspan="9" class="no-padding"> <div> <table class="table table-hover m-b-none "> <thead> <tr> <th width="33%">所属部门</th> <th width="33%">职位</th> <th width="34%">职责</th> </tr> </thead> <tbody> ';
$each(u.departList,function(d,$index){
$out+=' <tr> <td class="word-break"><span data-obj="currOrgObj" data-key="text">';
$out+=$escape(d.departName);
$out+='</span></td> <td class="word-break">';
$out+=$escape(d.serverStation);
$out+='</td> <td class="word-break"> ';
if(d.roleList && d.roleList.length>0){
$out+=' ';
$each(d.roleList,function(p,pi){
$out+=' ';
$out+=$escape(p.name);
$out+=' ';
if(pi < d.roleList.length-1 ){
$out+=' , ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </td> </tr> ';
});
$out+=' </tbody> </table> </div> </td> </tr> ';
});
$out+=' </tbody> </table> <div id="pagination-container" class="m-pagination pull-right"></div> ';
return new String($out);
});/*v:1*/
template('m_org/m_org_chose_byTree',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,renderType=$data.renderType,$escape=$utils.$escape,isBtnFullWidth=$data.isBtnFullWidth,buttonStyle=$data.buttonStyle,spanStyle=$data.spanStyle,companyList=$data.companyList,$out='';$out+='<style> .m_org_chose_byTree #orgTreeH{ display: block; position: absolute; top: 0px; border: 1px solid #e7eaec; padding: 10px; border-radius: 4px; height: 300px; overflow: auto; z-index: 9; background-color: #fff; } .m_org_chose_byTree.btn-full-width{ width:100%; } .m_org_chose_byTree.btn-full-width button{ width:100%; text-align: left; line-height: 22px; } .m_org_chose_byTree.btn-full-width button .caret{ float: right; margin-top: 10sspx; line-height: 30px; } </style> ';
if(renderType==1){
$out+=' <div id="orgTreeH" > <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> ';
}else{
$out+=' <div class="btn-group m_org_chose_byTree ';
$out+=$escape(isBtnFullWidth?'btn-full-width':'');
$out+='"> <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-action="selectOrg" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-stopPropagation="true" style="';
$out+=$escape(buttonStyle==null?'':buttonStyle);
$out+='"> <span class="company-name" style="';
$out+=$escape(spanStyle==null?'':spanStyle);
$out+='">';
$out+=$escape(companyList.text);
$out+='</span> <span class="caret"></span> </button> <ul class="dropdown-menu"> <li> <div id="orgTreeH" > <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </li> </ul> </div> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_org/m_org_partner_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,companyObj=$data.companyObj,$out='';$out+='<form class="form-horizontal m">  <div class="form-group"> <label class="col-md-3 control-label">组织名称<span class="fc-red">*</span>：</label> <div class="col-md-9"> <input type="text" class="form-control" id="companyName" name="companyName" value="';
$out+=$escape(companyObj.companyName);
$out+='" placeholder="请输入组织名称" autocomplete=\'off\'>  </div> </div> ';
if(companyObj.editType==1){
$out+=' <div class="form-group"> <label class="col-md-3 control-label">负责人手机号<span class="fc-red">*</span>：</label> <div class="col-md-9"> <input type="text" class="form-control" name="cellphone" maxlength="11"> </div> </div> <div class="form-group"> <label class="col-md-3 control-label">负责人姓名<span class="fc-red">*</span>：</label> <div class="col-md-9"> <input type="text" class="form-control" name="userName"> </div> </div> ';
}
$out+=' </form> ';
return new String($out);
});/*v:1*/
template('m_org/m_org_partner_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,_isNullOrBlank=$helpers._isNullOrBlank,enterpriseId=$data.enterpriseId,$escape=$utils.$escape,companyOriginalName=$data.companyOriginalName,relationTypeId=$data.relationTypeId,$out='';$out+='<div class="of-hidden" style="padding:15px;"> <form class="editAliasForm" style="font-size: 12px;"> <div class="row form-group"> <label class="col-md-3 text-right m-t-xs">组织名称<span class="fc-red">*</span>：</label> <div class="col-md-9"> ';
if(_isNullOrBlank(enterpriseId)){
$out+=' <input type="text" class="form-control input-sm" id="companyName" name="companyName" value="';
$out+=$escape(companyOriginalName);
$out+='" placeholder="请输入组织名称" autocomplete=\'off\'>  ';
}else{
$out+=' <span class="dp-inline-block p-t-xs">';
$out+=$escape(companyOriginalName);
$out+='</span> <span class="dp-inline-block"><i class="iconfont icon-v"></i></span> ';
}
$out+=' </div> </div> <!--<div class="row"> <label class="col-md-3 text-right m-t-xs">类型标示： <span class="fc-red">*</span></label> <div class="col-md-9 m-t-xs"> <div class="radio radio-inline m-t-none "> ';
if(relationTypeId==null || relationTypeId==1){
$out+=' <input id="t1" class="curp" value="1" name="roleType" type="radio" checked> ';
}else{
$out+=' <input id="t1" class="curp" value="1" name="roleType" type="radio"> ';
}
$out+=' <label class="r-blue-bg" for="t1">&lt;!&ndash;独立组织型&ndash;&gt;</label> </div> <div class="radio radio-inline curp"> ';
if(relationTypeId!=null && relationTypeId==2){
$out+=' <input id="t2" class="curp" value="2" name="roleType" type="radio" checked> ';
}else{
$out+=' <input id="t2" class="curp" value="2" name="roleType" type="radio"> ';
}
$out+=' <label class="r-green-bg" for="t2">&lt;!&ndash;独立财务型&ndash;&gt;</label> </div> <div class="radio radio-inline curp hide"> ';
if(relationTypeId!=null && relationTypeId==3){
$out+=' <input id="t3" class="curp" value="3" name="roleType" type="radio" checked> ';
}else{
$out+=' <input id="t3" class="curp" value="3" name="roleType" type="radio"> ';
}
$out+=' <label class="r-red-bg" for="t3">&lt;!&ndash;非独立组织型&ndash;&gt;</label> </div> <span><a class="btn-link" data-action="roleRightsPreView">权限预览</a></span> </div> </div>--> </form> </div>';
return new String($out);
});/*v:1*/
template('m_org/m_org_role_select',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,isShowRole=$data.isShowRole,$each=$utils.$each,selectedUserList=$data.selectedUserList,u=$data.u,$index=$data.$index,$escape=$utils.$escape,$out='';$out+='<div class="m"> <div class="tabs-container"> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-role-select-1" aria-expanded="true">成员</a></li> ';
if(isShowRole==1){
$out+=' <li class=""><a data-toggle="tab" href="#tab-role-select-2" aria-expanded="false">主管</a></li> <li class=""> <a data-toggle="tab" href="#tab-role-select-3" aria-expanded="false"> 连续多级主管 <i class="fa fa-info-circle" data-toggle="tooltip" data-container="body" data-original-title="发起人向上的各级主管依次审批"></i> </a> </li> ';
}
$out+=' </ul> <div class="tab-content"> <div id="tab-role-select-1" class="tab-pane active"> <div class="panel-body"> <div class="row m-b-sm"> <div class="col-md-12"> <div class="input-group"> <input class="form-control" type="text" name="keyword" placeholder="搜索成员"> <span class="input-group-btn"> <button type="button" class="btn btn-primary" data-action="search"> <i class="fa fa-search"></i> </button> </span> </div> </div> </div> <div class="row"> <div class="col-md-5" style="height: 320px;overflow: auto;"> <div id="organization_treeH"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </div> <div class="col-md-7 " > <div data-list="userList" style="height: 270px;overflow: auto"></div> <div id="userlist-pagination-container" class="m-pagination pull-right m-r"></div> </div> </div> </div> </div> ';
if(isShowRole==1){
$out+=' <div id="tab-role-select-2" class="tab-pane" data-key="singleLevel"> <div class="panel-body"> <div class="row m-b-sm"> <label class="col-sm-2 control-label p-r-none">确定主管：</label> <div class="col-sm-10"> <label class="i-checks i-checks-label fw-normal m-b-none"> <input name="managerCK" type="checkbox" value="departManager"/> <span class="i-checks-span" >部门主管</span> </label> <label class="i-checks i-checks-label fw-normal m-b-none"> <input name="managerCK" type="checkbox" value="financeManager"/> <span class="i-checks-span" >部门财务主管</span> </label> <label class="i-checks i-checks-label fw-normal m-b-none"> <input name="managerCK" type="checkbox" value="adminManager"/> <span class="i-checks-span" >部门行政主管</span> </label> <label class="i-checks i-checks-label fw-normal m-b-none"> <input name="managerCK" type="checkbox" value="projectManager"/> <span class="i-checks-span" >部门项目主管</span> </label> </div> </div> <div class="row m-b-sm"> <label class="col-sm-2 control-label p-r-none">审批终点：</label> <div class="col-sm-10"> <label class="i-checks i-checks-label fw-normal m-b-none"> <input name="levelCK1" type="radio" value="" checked/> <span class="i-checks-span" >发起人的</span> </label> <div class="dp-inline-block"> <select class="form-control" name="level"> <option value="1">第1级主管</option> <option value="2">第2级主管</option> <option value="3">第3级主管</option> <option value="4">第4级主管</option> <option value="5">第5级主管</option> <option value="6">第6级主管</option> <option value="7">第7级主管</option> <option value="8">第8级主管</option> <option value="9">第9级主管</option> <option value="10">第10级主管</option> <option value="11">第11级主管</option> <option value="12">第12级主管</option> <option value="13">第13级主管</option> <option value="14">第14级主管</option> <option value="15">第15级主管</option> <option value="16">第16级主管</option> <option value="17">第17级主管</option> <option value="18">第18级主管</option> <option value="19">第19级主管</option> <option value="20">第20级主管</option> </select> </div> </div> </div>  <div class="fc-v1-grey f-s-xs"> <p>*部门主管等可在组织架构部门中进行设置。</p> <p>*已选的主管可在选择面板进行拖拽排序。</p> </div> </div> </div> <div id="tab-role-select-3" class="tab-pane" data-key="multiLevel"> <div class="panel-body"> <div class="row m-b-sm"> <label class="col-sm-2 control-label p-r-none">确定主管：</label> <div class="col-sm-10"> <label class="i-checks i-checks-label fw-normal m-b-none"> <input name="managerCK" type="checkbox" value="departManager" /> <span class="i-checks-span" >部门主管</span> </label> <label class="i-checks i-checks-label fw-normal m-b-none"> <input name="managerCK" type="checkbox" value="financeManager" /> <span class="i-checks-span" >部门财务主管</span> </label> <label class="i-checks i-checks-label fw-normal m-b-none"> <input name="managerCK" type="checkbox" value="adminManager" /> <span class="i-checks-span" >部门行政主管</span> </label> <label class="i-checks i-checks-label fw-normal m-b-none"> <input name="managerCK" type="checkbox" value="projectManager" /> <span class="i-checks-span" >部门项目主管</span> </label> </div> </div> <div class="row m-b-sm"> <label class="col-sm-2 control-label p-r-none">审批终点：</label> <div class="col-sm-10"> <label class="i-checks i-checks-label fw-normal m-b-none"> <input name="levelCK2" type="radio" value="" checked/> <span class="i-checks-span" >同时不超过发起人的</span> </label> <div class="dp-inline-block"> <select class="form-control" name="level"> <option value="1">第1级主管</option> <option value="2">第2级主管</option> <option value="3">第3级主管</option> <option value="4">第4级主管</option> <option value="5">第5级主管</option> <option value="6">第6级主管</option> <option value="7">第7级主管</option> <option value="8">第8级主管</option> <option value="9">第9级主管</option> <option value="10">第10级主管</option> <option value="11">第11级主管</option> <option value="12">第12级主管</option> <option value="13">第13级主管</option> <option value="14">第14级主管</option> <option value="15">第15级主管</option> <option value="16">第16级主管</option> <option value="17">第17级主管</option> <option value="18">第18级主管</option> <option value="19">第19级主管</option> <option value="20">第20级主管</option> </select> </div> </div> </div> <div class="row m-b-sm"> <label class="col-sm-2 control-label p-r-none">审批人为空时：</label> <div class="col-sm-10"> <label class="i-checks i-checks-label fw-normal m-b-none"> <input name="autoPassCK" type="radio" value="" checked/> <span class="i-checks-span" > 自动通过 <i class="fa fa-info-circle" data-toggle="tooltip" data-container="body" data-original-title="当该角色或主管没有人的时候，审批单将自动通过"></i> </span> </label> </div> </div> <div class="fc-v1-grey f-s-xs"> <p>*部门主管等可在组织架构部门中进行设置。</p> <p>*已选的主管可在选择面板进行拖拽排序。</p> </div> </div> </div> ';
}
$out+=' </div> <div class="panel panel-default m-b-none m-t-sm no-borders" style="min-height: 50px;"> <div class="panel-body selectedUserBox" style="height: 100%"> ';
$each(selectedUserList,function(u,$index){
$out+=' <span class="selected-user m-r-xs"> <span class="label label-light m-r-xs dp-inline-block"> ';
$out+=$escape(u.userName);
$out+=' <a class="curp" href="javascript:void(0)" data-id="';
$out+=$escape(u.id);
$out+='" data-action="delChosedUser"><i class="fa fa-times fc-red"></i></a> </span> </span> ';
});
$out+=' </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_org/m_org_select',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,isBtnSm=$data.isBtnSm,dataInfo=$data.dataInfo,$each=$utils.$each,allCompanyList=$data.allCompanyList,s=$data.s,$index=$data.$index,currentCompanyId=$data.currentCompanyId,departList=$data.departList,d=$data.d,$out='';$out+='<style> .org-select-box .open-depart-btn{position: absolute;right: 0px;top: 0px;width: 30px;height: 30px;line-height: 25px;text-align: center;cursor: pointer;} .org-select-box .btn-default{text-align: left;} .org-select-box .dropdown-menu .dropdown-menu{display: none; position: relative;box-shadow: none;width: 100%;} .org-select-box .dropdown-menu .dropdown-menu a{padding-left:25px;} </style> <div class="btn-group org-select-box full-width"> <button class="btn btn-default ';
$out+=$escape(isBtnSm?'btn-sm':'');
$out+=' dropdown-toggle full-width b-r-xs" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <span class="company-name" data-company-id="';
$out+=$escape(dataInfo.companyId);
$out+='" data-depart-id="';
$out+=$escape(dataInfo&&dataInfo.departId?dataInfo.departId:'');
$out+='"> ';
$out+=$escape(dataInfo.orgName);
$out+=' </span> <span class="caret pull-right" style="margin-top: 8px;"></span> </button> <ul class="dropdown-menu full-width" style="max-height: 155px;overflow-y: auto;overflow-x: hidden;"> ';
$each(allCompanyList,function(s,$index){
$out+=' <li> <a class="';
$out+=$escape(currentCompanyId == s.id && departList!=null && departList.length>1?'p-r-lg':'');
$out+='" href="javascript:void(0);" data-action="choseOrg" data-type="';
$out+=$escape(s.companyType);
$out+='" data-chose-type="company" data-company-id="';
$out+=$escape(s.id);
$out+='"> ';
$out+=$escape(s.companyName);
$out+=' </a> ';
if(currentCompanyId == s.id && departList!=null && departList.length>1){
$out+=' <a class="open-depart-btn" title="选择部门"> <i class="fa fa-angle-double-down"></i> </a> <ul class="dropdown-menu"> ';
$each(departList,function(d,$index){
$out+=' ';
if(currentCompanyId!=d.id){
$out+=' <li> <a href="javascript:void(0);" data-action="choseOrg" data-chose-type="depart" data-company-id="';
$out+=$escape(d.id);
$out+='">';
$out+=$escape(d.departName);
$out+='</a> </li> ';
}
$out+=' ';
});
$out+=' </ul> ';
}
$out+=' </li> ';
});
$out+=' </ul> </div>';
return new String($out);
});/*v:1*/
template('m_org/m_org_select_multiple',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,tipsStr=$data.tipsStr,$string=$utils.$string,$out='';$out+='<form class="sky-form m-org-select-multiple rounded-4x margin-top-20"> <fieldset> ';
if(tipsStr){
$out+=' <div class="col-md-12" > <p class="fc-v1-grey">';
$out+=$string(tipsStr);
$out+='</p> </div> ';
}
$out+=' <div class="col-md-12" style="height: 400px;overflow: auto;"> <div id="organization_treeH"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </div> </fieldset> </form>';
return new String($out);
});/*v:1*/
template('m_org/m_org_service_type_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,serverTypeList=$data.serverTypeList,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,$out='';$out+='<style> .service-type-box .service-type .i-checks-span-default.text-ellipsis{width:120px;} </style> <div class="service-type-box"> <div class="input-group dp-block"> ';
$each(serverTypeList,function($value,$index){
$out+=' <div class="service-type pull-left m-r-xs m-b-xs "> <label class="i-checks i-checks-label checkbox-inline fw-normal" title="';
$out+=$escape($value.name);
$out+='"> <input name="serverType" id="serverType-';
$out+=$escape($value.id);
$out+='" value="';
$out+=$escape($value.id);
$out+='" data-name="';
$out+=$escape($value.name);
$out+='" type="checkbox"> <span class="i-checks-span-default text-ellipsis" for="serverType-';
$out+=$escape($value.id);
$out+='">';
$out+=$escape($value.name);
$out+='</span> </label> </div> ';
});
$out+=' </div> <div class="clearfix"></div> <div class="input-group dp-block " id="customServerTypeBox"> </div> <div class="clearfix"></div> <button class="btn btn-link no-padding" data-action="addServerType" title="添加自定义经营范围"><i class="fa fa-plus"></i>自定义</button> </div>  ';
return new String($out);
});/*v:1*/
template('m_org/m_org_tree_select',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,treeBoxClass=$data.treeBoxClass,$out='';$out+='<div id="orgTreeH" class="m-org-tree-select ';
$out+=$escape(treeBoxClass);
$out+='"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div>';
return new String($out);
});/*v:1*/
template('m_org/m_org_type_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-24-md-5 control-label">部门分组<span class="fc-red">*</span>：</label> <div class="col-24-md-19 p-l-none"> <input type="text" class="form-control" name="orgName" value="';
$out+=$escape(dataInfo?dataInfo.text:'');
$out+='" placeholder="请输入部门分组"/> </div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_org/m_selectedOrgTree','<div class="chose-user-tree hide" id="organizationTree" > <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div>');/*v:1*/
template('m_org/m_select_org_users','<div class="row no-margin m-select-org-users"> <div class="col-md-7 full-height border-right">  <div class="m-t-md hide" id="orgUserSearch"></div> <div class="m-t-md" id="orgUsersTree"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </div> <div class="col-md-5 full-height"> <div class="row m-t-sm"> <div class="col-md-12"> 已选择的部门或成员 </div> </div> <div class="row m-t-sm" id="selectedOrgUsersList">  </div> </div> </div> ');/*v:1*/
template('m_org/m_select_org_users_search','<ul class="list-group"> <li class="list-group-item item-title"><span class="fc-dark-gray">人员</span></li> <li class="list-group-item active">wangrubin</li> <li class="list-group-item item-title"><span class="fc-dark-gray">部门</span></li> <li class="list-group-item"> <i class="icon iconfont icon-zuzhijiagou dp-inline-block m-r-xs"></i> <span class="dp-inline-block vertical-text-bottom">技术部</span> </li> <li class="list-group-item"> <i class="icon iconfont icon-zuzhijiagou dp-inline-block m-r-xs"></i> <span class="dp-inline-block vertical-text-bottom">技术部</span> </li> <li class="list-group-item"> <i class="icon iconfont icon-zuzhijiagou dp-inline-block m-r-xs"></i> <span class="dp-inline-block vertical-text-bottom">技术部</span> </li> </ul>');/*v:1*/
template('m_org/m_userList',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,orgUserList=$data.orgUserList,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,$out='';$out+='<div class="userListBox m-userList"> <table class="table table-striped table-hover table-responsive m-b-none" > <thead> <tr> <th>姓名</th> <th>手机号</th> <th></th> </tr> </thead> <tbody> ';
$each(orgUserList,function($value,$index){
$out+=' <tr> <td>';
$out+=$escape($value.userName);
$out+='</td> <td>';
$out+=$escape($value.cellphone);
$out+='</td> <td> <a href="javascript:void(0)" data-action="selectUser" data-companyUserId="';
$out+=$escape($value.id);
$out+='" data-userId="';
$out+=$escape($value.userId);
$out+='" data-head-img="';
$out+=$escape($value.headImgUrl);
$out+='" class="btn-u btn-u-xs rounded">选择</a> </td> </tr> ';
});
$out+=' ';
if(orgUserList==null || orgUserList.length==0){
$out+=' <tr> <td colspan="3" align="center">暂无数据</td> </tr> ';
}
$out+=' </tbody> <tfoot><tr><td colspan="3" id="userList"></td></tr></tfoot> </table> </div>';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_detail_menu',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,isHasChildOrg=$data.isHasChildOrg,$out='';$out+='<div class="ibox no-margins"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right"> <ul class="secondary-menu-ul pull-right"> <li class="active" id="ledger"> <a href="#/paymentsDetail/ledger">收支明细</a> </li> <li class="" id="ledger2"> <a href="#/paymentsDetail/ledger2">分类统计</a> </li> ';
if(isHasChildOrg=='1'){
$out+=' <li class="" id="ledger3"> <a href="#/paymentsDetail/ledger3">部门帐期收支</a> </li> <li class="" id="ledger4"> <a href="#/paymentsDetail/ledger4">部门分类收支</a> </li> ';
}
$out+='  </ul> </div> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content p-b-none" id="content-box"> </div> </div>';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_ledger','<div class="m_payments_ledger m-project-cost"> <form role="form" class="form-horizontal"> <div class="row" id="filterBox"> </div> <div class="row m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-primary btn-sm roleControl" roleCode="40001303" flag="2" data-action="balancePoint">扎账与账期</button> <button class="btn btn-white btn-sm roleControl" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box"> <div class="data-list-container of-auto"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div>');/*v:1*/
template('m_payments/m_payments_ledger2','<div class="m_payments_ledger m-project-cost"> <form role="form" class="form-horizontal m-b-sm"> <div class="row" id="filterBox"> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-white btn-sm pull-right roleControl" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box"> <div class="data-list-container"></div>  </div> </div>');/*v:1*/
template('m_payments/m_payments_ledger2_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,title=$data.title,p=$data.p,i=$data.i,$escape=$utils.$escape,list=$data.list,d=$data.d,di=$data.di,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="table table-striped table-bordered table-hover text-nowrap" id="ledger2_list" style="width:100%;"> <thead> <tr> <th></th> ';
$each(title,function(p,i){
$out+=' <th>';
$out+=$escape(p.expTypeParentName);
$out+='</th> ';
});
$out+=' </tr> </thead> <tbody> ';
$each(list,function(p,i){
$out+=' <tr data-id="" data-i="';
$out+=$escape(i);
$out+='" class="curp"> <td>';
$out+=$escape(p.companyName);
$out+='</td> ';
$each(p.list,function(d,di){
$out+=' <td>';
$out+=$escape(_expNumberFilter(d.paymentFee));
$out+='</td> ';
});
$out+=' </tr> ';
});
$out+=' ';
if(!(list && list.length>0)){
$out+=' <tr class="no-data"> <td colspan="';
$out+=$escape(title?title.length:'14');
$out+='" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_ledger3','<div class="m_payments_ledger m-project-cost"> <form role="form" class="form-horizontal m-b-sm"> <div class="row" id="filterBox"> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-white btn-sm pull-right roleControl" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box"> <div class="data-list-container"></div>  </div> </div>');/*v:1*/
template('m_payments/m_payments_ledger3_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,title=$data.title,all=$data.all,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,d=$data.d,di=$data.di,_expNumberFilter=$helpers._expNumberFilter,list=$data.list,_url=$helpers._url,$out='';$out+='<table class="table table-striped table-bordered table-hover text-nowrap" id="ledger3_list" style="width:100%;"> ';
if(title!=null || all!=null){
$out+=' <thead> <tr> ';
if(all && all.list && all.list.length>0){
$out+=' <th ></th> ';
}
$out+=' <th ></th> ';
$each(title,function(p,i){
$out+=' <th>';
$out+=$escape(p.expTypeParentName);
$out+='</th> ';
});
$out+=' </tr> </thead> ';
}
$out+=' <tbody> ';
if(all && all.list && all.list.length>0){
$out+=' <tr data-id="" data-i="';
$out+=$escape(i);
$out+='" > ';
if(all && all.list && all.list.length>0){
$out+=' <td></td> ';
}
$out+=' <td>';
$out+=$escape(all.companyName);
$out+='</td> ';
$each(all.list,function(d,di){
$out+=' <td>';
$out+=$escape(_expNumberFilter(d.paymentFee));
$out+='</td> ';
});
$out+=' </tr> ';
}
$out+=' ';
$each(list,function(p,i){
$out+=' <tr data-id="" data-i="';
$out+=$escape(i);
$out+='" data-rowspan="';
$out+=$escape(list.length);
$out+='"> ';
if(all && all.list && all.list.length>0){
$out+=' <td data-rowspan="';
$out+=$escape(list.length);
$out+='">其中：</td> ';
}
$out+=' <td>';
$out+=$escape(p.companyName);
$out+='</td> ';
$each(p.list,function(d,di){
$out+=' <td>';
$out+=$escape(_expNumberFilter(d.paymentFee));
$out+='</td> ';
});
$out+=' </tr> ';
});
$out+=' ';
if((all==null || all.list==null || all.list.length==0) && (list==null || list.length==0)){
$out+=' <tr class="no-data"> <td colspan="';
$out+=$escape(all&&all.list&&all.list.length>0?(title&&title.length>0?title.length+2:2):(title&&title.length>0?title.length+1:1));
$out+='" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_ledger4','<div class="m_payments_ledger m-project-cost"> <form role="form" class="form-horizontal m-b-sm"> <div class="row" id="filterBox"> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-white btn-sm pull-right roleControl" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box"> <div class="data-list-container"></div>  </div> </div>');/*v:1*/
template('m_payments/m_payments_ledger4_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,title=$data.title,all=$data.all,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,d=$data.d,di=$data.di,_expNumberFilter=$helpers._expNumberFilter,list=$data.list,_url=$helpers._url,$out='';$out+='<table class="table table-striped table-bordered table-hover text-nowrap" id="ledger4_list" style="width:100%;"> ';
if(title!=null || all!=null){
$out+=' <thead> <tr> ';
if(all && all.list && all.list.length>0){
$out+=' <th ></th> ';
}
$out+=' <th ></th> ';
$each(title,function(p,i){
$out+=' <th>';
$out+=$escape(p.expTypeParentName);
$out+='</th> ';
});
$out+=' </tr> </thead> ';
}
$out+=' <tbody> ';
if(all && all.list && all.list.length>0){
$out+=' <tr data-id="" data-i="';
$out+=$escape(i);
$out+='" > ';
if(all && all.list && all.list.length>0){
$out+=' <td></td> ';
}
$out+=' <td>';
$out+=$escape(all.companyName);
$out+='</td> ';
$each(all.list,function(d,di){
$out+=' <td>';
$out+=$escape(_expNumberFilter(d.paymentFee));
$out+='</td> ';
});
$out+=' </tr> ';
}
$out+=' ';
$each(list,function(p,i){
$out+=' <tr data-id="" data-i="';
$out+=$escape(i);
$out+='" > ';
if(all && all.list && all.list.length>0){
$out+=' <td data-rowspan="';
$out+=$escape(list.length);
$out+='">其中：</td> ';
}
$out+=' <td>';
$out+=$escape(p.companyName);
$out+='</td> ';
$each(p.list,function(d,di){
$out+=' <td>';
$out+=$escape(_expNumberFilter(d.paymentFee));
$out+='</td> ';
});
$out+=' </tr> ';
});
$out+=' ';
if((all==null || all.list==null || all.list.length==0) && (list==null || list.length==0)){
$out+=' <tr class="no-data"> <td colspan="';
$out+=$escape(all&&all.list&&all.list.length>0?(title&&title.length>0?title.length+2:2):(title&&title.length>0?title.length+1:1));
$out+='" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_ledger_balance_point',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,year=$data.year,$out='';$out+='<div class="m-payments-ledger-balance-point m"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">年份：</label> <span class="dp-inline-block curp" id="yearSelect">';
$out+=$escape(year);
$out+='年</span> <button class="btn btn-link dp-inline-block no-padding vertical-align" data-action="selectDate"> <i class="caret"></i> </button> </div> </form> <div id="content"> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_ledger_balance_point_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_isBlank=$helpers._isBlank,_expNumberFilter=$helpers._expNumberFilter,_expPositiveNumberFilter=$helpers._expPositiveNumberFilter,_url=$helpers._url,$out='';$out+='<table class="table table-hover table-bordered table-responsive dataTable" > <thead> <tr> <th width="10%">日期</th> <th width="15%"><span>收入</span></th> <th width="15%"><span>支出</span></th> <th width="15%"><span>合计</span></th> <th width="15%"><span>当月余额值变更</span></th> <th width="15%"><span>本月余额</span></th> <th width="*">操作</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,$index){
$out+=' <tr data-id="';
$out+=$escape(p.id);
$out+='" data-month="';
$out+=$escape(p.month);
$out+='"> <td>';
$out+=$escape(_momentFormat(p.month,'YYYY/MM'));
$out+='</td> <td> ';
if(_isBlank(p.receiveAmount)){
$out+=' <span class="fc-v1-green">0</span> ';
}else if( (p.receiveAmount+'').indexOf('-')>-1){
$out+=' <span class="fc-v1-red">';
$out+=$escape(_expNumberFilter(p.receiveAmount));
$out+='</span> ';
}else{
$out+=' <span class="fc-v1-green">';
$out+=$escape(_expNumberFilter(p.receiveAmount));
$out+='</span> ';
}
$out+=' </td> <td> ';
if(_isBlank(p.payAmount)){
$out+=' <span class="fc-v1-green">0</span> ';
}else if( ((0-p.payAmount)+'').indexOf('-')>-1){
$out+=' <span class="fc-v1-red">';
$out+=$escape(_expPositiveNumberFilter(p.payAmount));
$out+='</span> ';
}else{
$out+=' <span class="fc-v1-green">';
$out+=$escape(_expNumberFilter(p.payAmount));
$out+='</span> ';
}
$out+=' </td> <td> ';
if(_isBlank(p.profit)){
$out+=' <span class="fc-v1-green">0</span> ';
}else if( (p.profit+'').indexOf('-')>-1){
$out+=' <span class="fc-v1-red">';
$out+=$escape(_expNumberFilter(p.profit));
$out+='</span> ';
}else{
$out+=' <span class="fc-v1-green">';
$out+=$escape(_expNumberFilter(p.profit));
$out+='</span> ';
}
$out+=' </td> <td> ';
if(_isBlank(p.changeAmount)){
$out+=' <span class="fc-v1-green">0</span> ';
}else if( (p.changeAmount+'').indexOf('-')>-1){
$out+=' <span class="fc-v1-red">';
$out+=$escape(_expNumberFilter(p.changeAmount));
$out+='</span> ';
}else{
$out+=' <span class="fc-v1-green">';
$out+=$escape(_expNumberFilter(p.changeAmount));
$out+='</span> ';
}
$out+=' </td> <td> ';
if(_isBlank(p.balance)){
$out+=' <span class="fc-v1-green">0</span> ';
}else if( (p.balance+'').indexOf('-')>-1){
$out+=' <span class="fc-v1-red">';
$out+=$escape(_expNumberFilter(p.balance));
$out+='</span> ';
}else{
$out+=' <span class="fc-v1-green">';
$out+=$escape(_expNumberFilter(p.balance));
$out+='</span> ';
}
$out+=' </td> <td> ';
if(p.flag==2 ){
$out+=' <button class="btn btn-default btn-sm roleControl" roleCode="40001303" flag="2" data-action="cancelBill">取消扎账</button> ';
}else if(p.flag==1 ){
$out+=' <button class="btn btn-primary btn-sm roleControl" roleCode="40001303" flag="2" data-action="tieBill">确认扎账</button> ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="7" class="text-center v-middle"> <div > <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_ledger_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,feeType=$data.feeType,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,profitDate=$data.profitDate,paymentDetail=$data.paymentDetail,profitFee=$data.profitFee,_expPositiveNumberFilter=$helpers._expPositiveNumberFilter,_expNumberFilter=$helpers._expNumberFilter,feeTypeParentName=$data.feeTypeParentName,feeTypeName=$data.feeTypeName,toCompanyName=$data.toCompanyName,cost=$data.cost,fromCompanyName=$data.fromCompanyName,projectName=$data.projectName,operatorName=$data.operatorName,profitType=$data.profitType,point=$data.point,pointDetailInfo=$data.pointDetailInfo,auditList=$data.auditList,$each=$utils.$each,s=$data.s,i=$data.i,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,typeStr=$data.typeStr,ccCompanyUserList=$data.ccCompanyUserList,u=$data.u,ui=$data.ui,$out='';$out+='<form class="form-horizontal p-sm overflow-y-auto m-dialog-resize"> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">日期：</label> <div class="col-md-10"> ';
if(feeType==7 || feeType==8){
$out+=' ';
$out+=$escape(_momentFormat(profitDate,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(paymentDetail.createDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">金额（元）：</label> <div class="col-md-10"> ';
if((profitFee+'').indexOf('-')>-1 ){
$out+=' <span class="fc-v1-red">';
$out+=$escape(_expPositiveNumberFilter(profitFee));
$out+='</span> ';
}else{
$out+=' <span class="fc-v1-green">';
$out+=$escape(_expNumberFilter(profitFee));
$out+='</span> ';
}
$out+=' </div> </div> <div class="hr-line-dashed m-t-none m-b-sm" ></div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">收支分类：</label> <div class="col-md-10">';
$out+=$escape(feeTypeParentName);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">分类子项：</label> <div class="col-md-10">';
$out+=$escape(feeTypeName);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">收款组织：</label> <div class="col-md-10"> ';
if(feeType==7 || feeType==8){
$out+=' ';
if(toCompanyName!=null && toCompanyName!=''){
$out+=' ';
$out+=$escape(toCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' ';
}else{
$out+=' ';
if(cost.toCompanyName!=null && cost.toCompanyName!=''){
$out+=' ';
$out+=$escape(cost.toCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' ';
}
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">付款组织：</label> <div class="col-md-10"> ';
if(feeType==7 || feeType==8){
$out+=' ';
if(fromCompanyName!=null && fromCompanyName!=''){
$out+=' ';
$out+=$escape(fromCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' ';
}else{
$out+=' ';
if(cost.fromCompanyName!=null && cost.fromCompanyName!=''){
$out+=' ';
$out+=$escape(cost.fromCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' ';
}
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">关联项目：</label> <div class="col-md-10"> ';
if(feeType==7 || feeType==8){
$out+=' ';
$out+=$escape(projectName);
$out+=' ';
}else{
$out+=' ';
$out+=$escape(cost.projectName);
$out+=' ';
}
$out+=' </div> </div> <div class="hr-line-dashed m-t-none m-b-sm" ></div> ';
if(feeType==7 || feeType==8){
$out+=' <div class="form-group m-b-xs"> <label class="col-md-2 text-right">财务人员：</label> <div class="col-md-10">';
$out+=$escape(operatorName);
$out+='</div> </div> ';
}else{
$out+=' <div class="form-group m-b-xs"> <label class="col-md-2 text-right">';
$out+=$escape(profitType==1?'收款':'付款');
$out+='节点：</label> <div class="col-md-10">';
$out+=$escape(point.feeDescription);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">比例：</label> <div class="col-md-10">';
$out+=$escape(point.feeProportion);
$out+='%</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">节点金额：</label> <div class="col-md-10">';
$out+=$escape(point.fee);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">申请人：</label> <div class="col-md-10">';
$out+=$escape(pointDetailInfo.userName);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">申请金额：</label> <div class="col-md-10">';
$out+=$escape(pointDetailInfo.fee);
$out+='</div> </div> ';
if(profitType==1){
$out+=' <div class="form-group m-b-xs"> <label class="col-md-2 text-right">到账金额：</label> <div class="col-md-10">';
$out+=$escape(_expNumberFilter(pointDetailInfo.sumPaidFee));
$out+='</div> </div> ';
}else{
$out+=' <div class="form-group m-b-xs"> <label class="col-md-2 text-right">付款金额：</label> <div class="col-md-10">';
$out+=$escape(_expNumberFilter(pointDetailInfo.sumPayFee));
$out+='</div> </div> ';
}
$out+=' ';
}
$out+=' ';
if(auditList!=null && auditList.length>0){
$out+=' <h4 class="title-line m-l-sm">审批流程</h4> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r" ></div> <div class="form-group"> <div class="col-sm-12 p-w-md"> <table class="table table-hover table-bordered m-b-xs" > <thead> <tr> <th width="40%">审批</th> <th width="40%">操作</th> <th width="20%">审批时间</th> </tr> </thead> <tbody> ';
$each(auditList,function(s,i){
$out+=' <tr> <td> ';
if(_isNullOrBlank(s.fileFullPath)){
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30"/> ';
}else{
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(s.fileFullPath);
$out+='" width="30" > ';
}
$out+=' <span class="dp-inline-block"> <p class="m-b-none">';
$out+=$escape(s.userName);
$out+='</p> <p class="m-b-none fc-v1-grey">';
$out+=$escape(s.companyName);
$out+='</p> </span> </td> <td> ';
if(s.approveStatus=='1'){
$out+=' <p class="text-success m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}else if(s.approveStatus=='2' || s.approveStatus=='3'){
$out+=' <p class="text-danger m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}else{
$out+=' <p class="m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}
$out+=' ';
if(s.approveStatusName=='发起申请' && !_isNullOrBlank(s.remark)){
$out+=' <p class="fc-v1-grey m-b-none">';
$out+=$escape(typeStr);
$out+='备注：';
$out+=$escape(s.remark);
$out+='</p> ';
}
$out+=' ';
if(s.approveStatusName=='退回'  && !_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">退回原因：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}
$out+=' </td> <td> ';
$out+=$escape(_momentFormat(s.approveDate,'YYYY/MM/DD'));
$out+=' </td> </tr> ';
});
$out+=' </tbody> </table> </div> </div> ';
}
$out+=' ';
if(ccCompanyUserList!=null && ccCompanyUserList.length>0){
$out+=' <h4 class="title-line m-l-sm">抄送人</h4> <div class="hr-line-dashed m-t-none m-b-sm m-l m-r"></div> <div class="form-group"> <div class="col-sm-12 p-w-md approval-out-box"> ';
$each(ccCompanyUserList,function(u,ui){
$out+=' <div class="approver-outbox"> <div class="approver-box "> <div class="img-circle"> <img alt="image" class="img-circle" src="';
$out+=$escape(_isNullOrBlank(u.fileFullPath)?_url('/img/head_default.png'):u.fileFullPath);
$out+='" width="30" height="30"> </div> <div class="m-t-xs">';
$out+=$escape(u.userName);
$out+='</div> </div> </div> ';
});
$out+=' </div> </div> ';
}
$out+=' </form> ';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_ledger_filter',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,doType=$data.doType,isMyDataFlag=$data.isMyDataFlag,$out='';$out+=' ';
if(doType==3){
$out+=' ';
if(isMyDataFlag == 2){
$out+=' <div class="col-md-12"> <div class="z-index-1"> <label class="inline">当前组织：</label> <div class="dp-inline-block vertical-middle p-l-sm"> <label class="i-checks i-checks-label fw-normal dp-inline-block roleControl" style="width: auto;" > <input type="radio" name="isMyData" value="0" checked/> </label> <div class="btn-group vertical-baseline roleControl" id="selectOrg" > </div> <label class="i-checks i-checks-label fw-normal dp-inline-block roleControl" > <input type="radio" name="isMyData" value="1"/> <span class="i-checks-span">我负责的项目</span> </label> </div> </div> </div> ';
}else if(isMyDataFlag == 0){
$out+=' <div class="col-md-12"> <div class="z-index-1"> <label class="inline">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> </div> ';
}
$out+='  ';
}else{
$out+=' <div class="col-md-12"> <div class="z-index-1"> <label class="inline">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> </div> ';
}
$out+=' <div class="col-md-12" id="timeSelect"> </div> ';
if(doType==3){
$out+=' <div class="col-md-12" id="projectStatusSelect"> </div> <div class="col-md-12" id="signDateStatusSelect"> </div> ';
}
$out+=' <div class="col-md-12"> <div class="z-index-1 p-t-xs"> <label class="inline">选择分类：</label> <div class="dp-inline-block vertical-text-top p-l-sm"> <label class="i-checks i-checks-label fw-normal width-160"> <input type="radio" name="feeSelectType" value="1" checked/> <span class="i-checks-span">收支分类</span> </label> <label class="i-checks i-checks-label fw-normal "> <input type="radio" name="feeSelectType" value="2"/> <span class="i-checks-span">分类子项</span> </label> </div> </div> </div> <div class="col-md-12 fee-type-parent-box"> </div> <div class="col-md-12 fee-type-box hide"> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-click-action="search">查询</button> <button class="btn btn-default" data-click-action="refreshBtn">重置条件</button> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_ledger_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,_isBlank=$helpers._isBlank,summary=$data.summary,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,changeList=$data.changeList,$each=$utils.$each,dataList=$data.dataList,d=$data.d,i=$data.i,_momentFormat=$helpers._momentFormat,_expPositiveNumberFilter=$helpers._expPositiveNumberFilter,_url=$helpers._url,$out='';$out+='<div class="m-b-sm"> <span>当前余额：</span> <span> ';
if(_isBlank(summary.sumBalance)){
$out+=' <span class="fc-v1-green">0</span> ';
}else if( (summary.sumBalance+'').indexOf('-')>-1){
$out+=' <span class="fc-v1-red">';
$out+=$escape(_expNumberFilter(summary.sumBalance));
$out+='</span> ';
}else{
$out+=' <span class="fc-v1-green">';
$out+=$escape(_expNumberFilter(summary.sumBalance));
$out+='</span> ';
}
$out+=' 元 &nbsp; ';
if(changeList && changeList.length>0){
$out+=' <button class="btn btn-link no-padding fc-dark-blue vertical-baseline" data-action="viewSumBalanceChangeList" title="余额变更记录"><i class="fa fa-info-circle"></i></button> ';
}
$out+=' </span> </div> <table class="table table-bordered table-hover table-responsive text-nowrap m-b-none"> <thead> <tr> <th>日期</th> <th width="12%">  金额（元）  <a class="icon-filter pull-right" id="filter_profitType"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th> 收支分类 </th> <th> 分类子项 </th> <th>备注</th> <th> 收款组织 <a class="icon-filter pull-right" id="filter_toCompanyName"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th> 付款组织 <a class="icon-filter pull-right" id="filter_fromCompanyName"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th> 关联项目 <a class="icon-filter pull-right" id="filter_projectName"><i class="icon iconfont icon-shaixuan"></i></a> </th> </tr> </thead> <tbody> ';
$each(dataList,function(d,i){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" class="curp"> <td>';
$out+=$escape(_momentFormat(d.profitDate,'YYYY/MM/DD'));
$out+='</td> <td> ';
if((d.profitFee+'').indexOf('-')>-1 ){
$out+=' <span class="fc-v1-red ">';
$out+=$escape(_expPositiveNumberFilter(d.profitFee));
$out+='</span> ';
}else{
$out+=' <span class="fc-v1-green ">';
$out+=$escape(_expNumberFilter(d.profitFee));
$out+='</span> ';
}
$out+=' </td> <td>';
$out+=$escape(d.feeTypeParentName);
$out+='</td> <td>';
$out+=$escape(d.feeTypeName);
$out+='</td> <td class="max-width-v1"> <div class="text-ellipsis-2 text-wrap" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(d.feeName);
$out+='"> ';
$out+=$escape(d.feeName);
$out+=' </div> </td> <td> ';
if(d.toCompanyName!=null && d.toCompanyName!=''){
$out+=' ';
$out+=$escape(d.toCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </td> <td> ';
if(d.fromCompanyName!=null && d.fromCompanyName!=''){
$out+=' ';
$out+=$escape(d.fromCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </td> <td class="max-width-v1"> <div class="text-ellipsis-2 text-wrap" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(d.projectName);
$out+='"> ';
$out+=$escape(d.projectName);
$out+=' </div> </td> </tr> ';
});
$out+=' ';
if(!(dataList && dataList.length>0)){
$out+=' <tr class="no-data"> <td colspan="8" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> <div class="pt-absolute m-t-sm p-l-sm"> <span>合计金额：</span> <span> ';
if(_isBlank(summary.amount)){
$out+=' <span class="fc-v1-green">0</span> ';
}else if( (summary.amount+'').indexOf('-')>-1){
$out+=' <span class="fc-v1-red">';
$out+=$escape(_expNumberFilter(summary.amount));
$out+='</span> ';
}else{
$out+=' <span class="fc-v1-green">';
$out+=$escape(_expNumberFilter(summary.amount));
$out+='</span> ';
}
$out+=' 元 &nbsp;&nbsp; </span> <span>收入：</span> <span> ';
if(_isBlank(summary.gain)){
$out+=' <span class="fc-v1-green">0</span> ';
}else if( (summary.gain+'').indexOf('-')>-1){
$out+=' <span class="fc-v1-red">';
$out+=$escape(_expNumberFilter(summary.gain));
$out+='</span> ';
}else{
$out+=' <span class="fc-v1-green">';
$out+=$escape(_expNumberFilter(summary.gain));
$out+='</span> ';
}
$out+=' 元 &nbsp;&nbsp; </span> <span>支出：</span> <span> ';
if(_isBlank(summary.pay)){
$out+=' <span class="fc-v1-green">0</span> ';
}else if( (summary.pay+'').indexOf('-')>-1){
$out+=' <span class="fc-v1-red">';
$out+=$escape(_expPositiveNumberFilter(summary.pay));
$out+='</span> ';
}else{
$out+=' <span class="fc-v1-green">';
$out+=$escape(_expNumberFilter(summary.pay));
$out+='</span> ';
}
$out+=' 元 &nbsp;&nbsp; </span> </div>';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_list_detail',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,detailData=$data.detailData,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,type=$data.type,$each=$utils.$each,d=$data.d,$index=$data.$index,_url=$helpers._url,$out='';$out+='<form class="form-horizontal m"> <div class="form-group m-b-xs"> <label class="col-24-sm-3 text-right p-r-none">节点信息：</label> <div class="col-24-sm-21">';
$out+=$escape(detailData.feeName);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-24-sm-3 text-right p-r-none">关联项目：</label> <div class="col-24-sm-21">';
$out+=$escape(detailData.projectName);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-24-sm-3 text-right p-r-none">收支类型：</label> <div class="col-24-sm-21">';
$out+=$escape(detailData.feeTypeName);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-24-sm-3 text-right p-r-none">发起时间：</label> <div class="col-24-sm-21">';
$out+=$escape(_momentFormat(detailData.createDate,'YYYY/MM/DD'));
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-24-sm-3 text-right p-r-none">节点金额：</label> <div class="col-24-sm-21">';
$out+=$escape(_expNumberFilter(detailData.nodeFee));
$out+='元</div> </div> <div class="form-group m-b-xs"> <label class="col-24-sm-3 text-right p-r-none">发起金额：</label> <div class="col-24-sm-21">';
$out+=$escape(_expNumberFilter(detailData.launchFee));
$out+='元</div> </div> <div class="form-group m-b-xs"> <label class="col-24-sm-3 text-right p-r-none"> ';
if(type==2){
$out+=' 付款金额： ';
}else{
$out+=' 到账金额： ';
}
$out+=' </label> <div class="col-24-sm-21">';
$out+=$escape(_expNumberFilter(detailData.accountFee));
$out+='元</div> </div> <div class="form-group m-b-xs"> <label class="col-24-sm-3 text-right p-r-none"> ';
if(type==2){
$out+=' 应付金额： ';
}else{
$out+=' 应收金额： ';
}
$out+=' </label> <div class="col-24-sm-21">';
$out+=$escape(_expNumberFilter(detailData.receivableFee));
$out+='元</div> </div> <div class="p-w-sm"> <label class="m-b-xs"> ';
if(type==2){
$out+=' 付款明细： ';
}else{
$out+=' 到账明细： ';
}
$out+=' </label> <div style="max-height: 200px;overflow: auto;"> <table class="table table-bordered table-responsive"> <thead> <tr> <th> ';
if(type==2){
$out+=' 付款日期 ';
}else{
$out+=' 到账日期 ';
}
$out+=' </th> <th> ';
if(type==2){
$out+=' 付账金额（元） ';
}else{
$out+=' 到账金额（元） ';
}
$out+=' </th> <th>收支类型</th> </tr> </thead> <tbody> ';
$each(detailData.paymentDetailDTOList,function(d,$index){
$out+=' <tr data-action="viewDetail" data-id="';
$out+=$escape(d.id);
$out+='"> <td>';
$out+=$escape(_momentFormat(d.createDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(_expNumberFilter(d.accountFee));
$out+=' </td> <td>';
$out+=$escape(d.feeTypeName);
$out+='</td> </tr> ';
});
$out+=' ';
if(!(detailData.paymentDetailDTOList && detailData.paymentDetailDTOList.length>0)){
$out+=' <tr class="no-data"> <td colspan="3" class="text-center v-middle"> <div class=""> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='" height="100"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_payable','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"></div> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content" id="content-box"> <div> <form role="form" class="form-horizontal m-b-sm"> <div class="row"> <div class="col-md-12"> <div class="z-index-1"> <label class="inline">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> </div> <div class="col-md-12" id="timeSelect"> </div> <div class="col-md-12"> <div class="z-index-1 m-b-sm"> <label class="inline">项目搜索：</label> <div class="dp-inline-block"> <input type="text" class="form-control input-sm width-300" name="projectName" value=""/> </div> </div> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-white btn-sm pull-right roleControl" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box"> <div class="data-list-container of-auto"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> </div> ');/*v:1*/
template('m_payments/m_payments_payable_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,d=$data.d,$index=$data.$index,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,_isBlank=$helpers._isBlank,paymentSum=$data.paymentSum,$out='';$out+='<table class="table table-bordered table-hover table-responsive text-nowrap"> <thead> <tr> <th width="13%">日期</th> <th width="13%"><span>应付（元）</span></th> <th width="14%"> 收支分类子项 <a class="icon-filter pull-right" id="filter_feeType" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th width="">备注</th> <th width=""> 收款组织 <a class="icon-filter pull-right" id="filter_toCompanyId"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th width=""> 付款组织 <a class="icon-filter pull-right" id="filter_fromCompanyId"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th width=""> 关联项目  </th> </tr> </thead> <tbody> ';
$each(dataList,function(d,$index){
$out+=' <tr class="curp" data-id="';
$out+=$escape(d.id);
$out+='"> <td>';
$out+=$escape(_momentFormat(d.createDate,'YYYY/MM/DD'));
$out+='</td> <td> <span>';
$out+=$escape(_expNumberFilter(d.profitFee));
$out+='</span> </td> <td>';
$out+=$escape(d.feeTypeName);
$out+='</td> <td class="max-width-v1"> <div class="text-ellipsis-2 text-wrap" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(d.feeName);
$out+='"> ';
$out+=$escape(d.feeName);
$out+=' </div> </td> <td> ';
if(d.toCompanyName!=null && d.toCompanyName!=''){
$out+=' ';
$out+=$escape(d.toCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </td> <td> ';
if(d.fromCompanyName!=null && d.fromCompanyName!=''){
$out+=' ';
$out+=$escape(d.fromCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </td> <td class="max-width-v1"> <a href="javascript:void(0);" data-action="goExpensesPage" data-project-id="';
$out+=$escape(d.projectId);
$out+='" data-type="';
$out+=$escape(d.feeType);
$out+='" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(d.projectName);
$out+='"> ';
$out+=$escape(d.projectName);
$out+=' </a> </td> </tr> ';
});
$out+=' ';
if(!(dataList && dataList.length>0)){
$out+=' <tr class="no-data"> <td colspan="7" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> <div class="pt-absolute m-t-sm"> <span>总应付金额：</span> <span> ';
if(_isBlank(paymentSum)){
$out+=' <span class="fc-v1-green">0</span> ';
}else{
$out+=' <span class="fc-v1-red">';
$out+=$escape(_expNumberFilter(paymentSum));
$out+='</span> ';
}
$out+=' 元 </span> </div>';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_profitStatement',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,currentYear=$data.currentYear,$out='';$out+='<div class="ibox m_payments_profitStatement"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-6">  <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 费用管理 </li> <li class="active fa fa-angle-right"> <strong>利润报表</strong> </li> </ol> </div> </div> <div class="col-md-6 text-right p-w-sm"> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label>当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> <div class="form-group"> <label class="m-t-xs">时间：</label> <div class="btn-group pull-right"> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-type="0">今年</a> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-type="-1">去年</a> </div> </div> <div class="form-group"> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm " id="ipt_date" name="date" placeholder="年份" readonly="" value="';
$out+=$escape(currentYear);
$out+='年" style="width: 110px;"> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> </div> <button class="btn btn-white btn-sm" data-action="refreshBtn">刷新数据</button> </form> <div class="" id="profitBox"> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_profitStatement_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,profitData=$data.profitData,p=$data.p,i=$data.i,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,s=$data.s,si=$data.si,$out='';$out+='<table class="table table-bordered table-responsive"> <thead> <tr> <th colspan="2">月份</th> <th>1月</th> <th>2月</th> <th>3月</th> <th>4月</th> <th>5月</th> <th>6月</th> <th>7月</th> <th>8月</th> <th>9月</th> <th>10月</th> <th>11月</th> <th>12月</th> <th>合计（元）</th> </tr> </thead> <tbody> ';
$each(profitData,function(p,i){
$out+=' <tr data-type="';
$out+=$escape(p.arrowsFlag==1?'':p.code);
$out+='" style="';
$out+=$escape(p.flag==1?'':'display: none;');
$out+='"> <td width="11.5%" class="';
$out+=$escape(p.flag==1?'bg-title':'');
$out+=' v-middle" rowspan="';
$out+=$escape(p.list.length);
$out+='" > ';
if(p.arrowsFlag==1){
$out+=' <a href="javascript:void(0);" class="icon-angle" data-action="expand" data-type="';
$out+=$escape(p.code);
$out+='"><i class="fa fa-angle-right"></i></a> ';
}
$out+=' <span class="';
$out+=$escape(p.arrowsFlag==1?'':'m-l');
$out+='">';
$out+=$escape(p.key);
$out+='</span> </td> ';
if(p.list.length>0){
$out+=' <td width="10.5%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(p.list[0].expTypeName);
$out+='：</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].januaryData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].februaryData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].marchData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].aprilData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].mayData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].juneData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].julyData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].augustData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].septemberData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].octoberData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].novemberData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].decemberData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(p.list[0].totalData));
$out+='</td> ';
}
$out+=' </tr> ';
if( p.list.length>1){
$out+=' ';
$each(p.list,function(s,si){
$out+=' ';
if(si>0){
$out+=' <tr data-type="';
$out+=$escape(p.code);
$out+='" style="';
$out+=$escape(p.flag==1?'':'display: none;');
$out+='"> <td width="10.5%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(s.expTypeName);
$out+='：</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.januaryData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.februaryData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.marchData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.aprilData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.mayData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.juneData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.julyData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.augustData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.septemberData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.octoberData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.novemberData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.decemberData));
$out+='</td> <td width="6%" class="';
$out+=$escape(p.flag==1?'bg-value':'');
$out+='">';
$out+=$escape(_expNumberFilter(s.totalData));
$out+='</td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' ';
});
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_receivable','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"></div> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content" id="content-box"> <div> <form role="form" class="form-horizontal m-b-sm"> <div class="row"> <div class="col-md-12"> <div class="z-index-1"> <label class="inline">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> </div> <div class="col-md-12" id="timeSelect"> </div> <div class="col-md-12"> <div class="z-index-1 m-b-sm"> <label class="inline">项目搜索：</label> <div class="dp-inline-block"> <input type="text" class="form-control input-sm width-300" name="projectName" value=""/> </div> </div> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-white btn-sm pull-right roleControl" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box"> <div class="data-list-container of-auto"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> </div> ');/*v:1*/
template('m_payments/m_payments_receivable_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,d=$data.d,$index=$data.$index,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,_isBlank=$helpers._isBlank,receivaleSum=$data.receivaleSum,$out='';$out+='<table class="table table-bordered table-hover table-responsive text-nowrap"> <thead> <tr> <th width="13%">日期</th> <th width="13%"><span>应收（元）</span></th> <th width="14%"> 收支分类子项 <a class="icon-filter pull-right" id="filter_feeType" ><i class="icon iconfont icon-shaixuan"></i></a> </th> <th width="">备注</th> <th width=""> 收款组织 <a class="icon-filter pull-right" id="filter_toCompanyId"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th width=""> 付款组织 <a class="icon-filter pull-right" id="filter_fromCompanyId"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th width=""> 关联项目  </th> </tr> </thead> <tbody> ';
$each(dataList,function(d,$index){
$out+=' <tr class="curp" data-id="';
$out+=$escape(d.id);
$out+='"> <td>';
$out+=$escape(_momentFormat(d.createDate,'YYYY/MM/DD'));
$out+='</td> <td> <span>';
$out+=$escape(_expNumberFilter(d.profitFee));
$out+='</span> </td> <td>';
$out+=$escape(d.feeTypeName);
$out+='</td> <td class="max-width-v1"> <div class="text-ellipsis-2 text-wrap" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(d.feeName);
$out+='"> ';
$out+=$escape(d.feeName);
$out+=' </div> </td> <td> ';
if(d.toCompanyName!=null && d.toCompanyName!=''){
$out+=' ';
$out+=$escape(d.toCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </td> <td> ';
if(d.fromCompanyName!=null && d.fromCompanyName!=''){
$out+=' ';
$out+=$escape(d.fromCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </td> <td class="max-width-v1"> <a class="text-ellipsis-2 text-wrap" href="javascript:void(0);" data-action="goExpensesPage" data-project-id="';
$out+=$escape(d.projectId);
$out+='" data-type="';
$out+=$escape(d.feeType);
$out+='" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(d.projectName);
$out+='"> ';
$out+=$escape(d.projectName);
$out+=' </a> </td> </tr> ';
});
$out+=' ';
if(!(dataList && dataList.length>0)){
$out+=' <tr class="no-data"> <td colspan="7" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> <div class="pt-absolute m-t-sm"> <span>总应收金额：</span> <span> ';
if(_isBlank(receivaleSum)){
$out+=' <span class="fc-v1-green">0</span> ';
}else if( (receivaleSum+'').indexOf('-')>-1){
$out+=' <span class="fc-v1-red">';
$out+=$escape(_expNumberFilter(receivaleSum));
$out+='</span> ';
}else{
$out+=' <span class="fc-v1-green">';
$out+=$escape(_expNumberFilter(receivaleSum));
$out+='</span> ';
}
$out+=' 元 </span> </div>';
return new String($out);
});/*v:1*/
template('m_payments/m_payments_statistics','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-6">  <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 费用管理 </li> <li class="active fa fa-angle-right"> <strong>分类统计</strong> </li> </ol> </div> </div> <div class="col-md-6 text-right p-w-sm"> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content" > <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> <div class="form-group"> <label class="m-t-xs">时间单位：</label> <div class="btn-group pull-right"> <a class="btn btn-primary btn-sm m-r-none " href="javascript:void(0)" data-action="setTime" data-type="month">月</a> <a class="btn btn-default btn-sm m-r-none" href="javascript:void(0)" data-action="setTime" data-type="year">年</a> </div> </div> <div class="form-group time-box"> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm " id="timeStart" name="timeStart" placeholder="开始月份" readonly style="width: 110px;" > <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> <div class="input-group dp-inline-block"> <input type="text" class="form-control input-sm " id="timeEnd" name="timeEnd" placeholder="结束月份" readonly style="width: 110px;" > <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().click();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> </div> <button class="btn btn-white btn-sm" data-action="refreshBtn">刷新数据</button> </form> <div class="m-b-sm"> <div><h4>分类统计范围：</h4></div> <div id="categoryTypeBox"> </div> </div> <div> <div> 单位： <a class="btn btn-link text-info p-w-xxs" data-action="amountUnit" data-action-type="1">元</a>/ <a class="btn btn-link p-w-xxs" data-action="amountUnit" data-action-type="2">万元</a> </div> <div class="" id="barChartBox"> </div> </div> </div> </div> <script> </script>');/*v:1*/
template('m_payments/m_payments_statistics_barChart','<div class="col-md-12 m-b-md"> <div id="barChart1" style="width: 100%;height: 400px;"></div> </div> <div class="col-md-12 m-b-md"> <div id="barChart2" style="width: 100%;height: 400px;"></div> </div>');/*v:1*/
template('m_payments/m_payments_statistics_categoryType',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,categoryTypeList=$data.categoryTypeList,$each=$utils.$each,c=$data.c,ci=$data.ci,$escape=$utils.$escape,t=$data.t,ti=$data.ti,$out='';$out+='<table class="table table-bordered table-responsive m-b-none"> ';
if(categoryTypeList!=null && categoryTypeList.length>0){
$out+=' ';
$each(categoryTypeList,function(c,ci){
$out+=' <tr class="';
$out+=$escape(ci==0?'gray-bg':'');
$out+='"> ';
$each(c,function(t,ti){
$out+=' <td colspan="';
$out+=$escape(t.level);
$out+='" class="text-center"> ';
if(t.expTypeValue!=null && t.expTypeValue!=''){
$out+=' <div> <label class="i-checks i-checks-label"> ';
if(t.selected==1){
$out+=' <input name="itemCk" type="checkbox" data-pid="';
$out+=$escape(t.pid);
$out+='" data-id="';
$out+=$escape(t.id);
$out+='" data-value="';
$out+=$escape(t.expTypeValue);
$out+='" checked/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" data-pid="';
$out+=$escape(t.pid);
$out+='" data-id="';
$out+=$escape(t.id);
$out+='" data-value="';
$out+=$escape(t.expTypeValue);
$out+='"/> ';
}
$out+=' <span class="i-checks-span">';
$out+=$escape(t.expTypeValue);
$out+='</span> </label> </div> ';
}
$out+=' </td> ';
});
$out+=' </tr> ';
});
$out+=' ';
}
$out+=' </table>';
return new String($out);
});/*v:1*/
template('m_production/m_confirmCompletion',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,currDate=$data.currDate,$out='';$out+='<form class="form-horizontal m_confirmCompletion m"> <div class="form-group "> <label class="col-md-3 control-label p-l-none m-t-xs">完成时间：</label> <div class="col-md-8 p-r-none"> <div class="input-group"> <input type="text" class="form-control input-sm " name="completeDate" onclick="WdatePicker()" value="';
$out+=$escape(currDate);
$out+='"> <span class="input-group-addon no-padding" onclick="javascript:$(this).prev().focus();"> <i class="icon-sm icon-append fa fa-calendar"></i> </span> </div> </div> </div> <div class="form-group "> <label class="col-md-3 control-label p-l-none m-t-xs">完成情况：</label> <div class="col-md-8 p-r-none"> <textarea class="form-control" name="completion" style="height: 50px;width: 100%;"></textarea> </div> </div>  </form>';
return new String($out);
});/*v:1*/
template('m_production/m_production',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,isView=$data.isView,$out='';if(isView==false){
$out+=' <div class="ibox m-production"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-9" id="breadcrumb"></div> <div class="col-md-3 text-right" style="padding: 15px 15px 0;"> <span id="designManagerBox"> </span> </div> </div> </div> <div class="ibox-content dp-flex"> <div class="col-sm-3 no-padding product-left-tab "> </div> <div class="col-sm-9"> <div id="tabList" class="list-box"> </div> </div> </div> </div> ';
}else{
$out+=' <div class="dp-flex m-production row p-w-xs"> <div class="col-sm-3 no-padding product-left-tab "> </div> <div class="col-sm-9 p-w-xxs"> <div id="tabList" class="list-box"> </div> </div> </div> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_production/m_production_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,personInChargeInfo=$data.personInChargeInfo,appointmentStartTime=$data.appointmentStartTime,appointmentEndTime=$data.appointmentEndTime,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-24-sm-5 control-label">设计任务<span class="fc-red">*</span>：</label> <div class="col-24-sm-19 row-edit-item"> <input placeholder="设计任务" class="form-control" type="text" name="taskName" value=""> </div> </div> <div class="form-group"> <label class="col-24-sm-5 control-label">任务负责人<span class="fc-red">*</span>：</label> <div class="col-24-sm-19 row-edit-item"> <span class="show-span"> <span class="fc-v1-grey">';
$out+=$escape(personInChargeInfo.personInCharge);
$out+='</span> </span> <a class="btn btn-default btn-circle" data-action="setTaskLeader" data-user-name="';
$out+=$escape(personInChargeInfo.personInCharge);
$out+='" data-id="';
$out+=$escape(personInChargeInfo.personInChargeId);
$out+='"><i class="fa fa-plus"></i></a> </div> </div> <div class="form-group"> <label class="col-24-sm-5 control-label">开始时间<span class="fc-red">*</span>：</label> <div class="col-24-sm-19"> <div class="input-group"> <input type="text" class="form-control" id="ipt_startTime" name="leaveStartTime" placeholder="开始时间" readonly onFocus="startTimeFun(this)" data-appointmentStartTime = "" value="';
$out+=$escape(appointmentStartTime);
$out+='"> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> </div> <div class="form-group"> <label class="col-24-sm-5 control-label">结束时间<span class="fc-red">*</span>：</label> <div class="col-24-sm-19 row-edit-item"> <div class="input-group"> <input type="text" class="form-control" id="ipt_endTime" name="leaveEndTime" placeholder="开始时间" readonly onFocus="endTimeFun(this)" data-appointmentEndTime = "" value="';
$out+=$escape(appointmentEndTime);
$out+='"> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_add_child_row',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,taskId=$data.taskId,colspan=$data.colspan,appointmentStartTime=$data.appointmentStartTime,appointmentEndTime=$data.appointmentEndTime,$out='';$out+='<tr class="task-add-row content-row-edit" data-pid="';
$out+=$escape(taskId);
$out+='"> <td colspan="';
$out+=$escape(colspan?colspan:'12');
$out+='"> <form> <div class="pull-left row-edit-item p-r-xs"> <textarea placeholder="请输入子任务名称" class="form-control" type="text" name="taskName" style="width: 88%;display: inline-block;"></textarea> <span><span class="wordCount">0</span>/<span>50</span></span> </div> <div class="pull-left row-edit-item p-r-xs" > <div class="input-group"> <input type="text" class="form-control timeInput startTime" id="ipt_startTime" name="startTime" placeholder="开始日期" readonly onFocus="startTimeFun(this)" data-appointmentStartTime = "" value="';
$out+=$escape(appointmentStartTime);
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> <div class="pull-left row-edit-item p-r-xs"> <div class="input-group"> <input type="text" class="form-control timeInput endTime" id="ipt_endTime" name="endTime" placeholder="结束日期" readonly onFocus="endTimeFun(this)" data-appointmentEndTime = "" value="';
$out+=$escape(appointmentEndTime);
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> <div class="pull-left row-edit-item"> <button class="btn btn-primary" data-action="submit">创建</button> <button class="btn btn-default" data-action="cancel">取消</button> </div> </form> </td> </tr> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_add_mult',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,tempItemList=$data.tempItemList,$each=$utils.$each,p=$data.p,$index=$data.$index,$escape=$utils.$escape,$out='';$out+='<div class="m-production-add-mult"> <div class="col-md-6"> <div class="ibox"> <div class="ibox-title no-borders p-h-sm min-h-50">数据模板</div> <div class="ibox-content border-darker-grey box-left"> ';
if(tempItemList!=null && tempItemList.length>0){
$out+=' <h4>模板标签库</h4> <div class="m-b-sm"> <label class="i-checks i-checks-label fw-normal"> <input name="itemCk" type="checkbox" value=""/> <span class="i-checks-span">全选</span> </label> </div> <div class="row" id="tempItemBox"> ';
$each(tempItemList,function(p,$index){
$out+=' <div class="col-md-6 p-r-none"> <label class="i-checks i-checks-label fw-normal"> <input name="itemCk" type="checkbox" value="';
$out+=$escape(p.id);
$out+='" data-name="';
$out+=$escape(p.name);
$out+='" data-is-custom="0"/> <span class="i-checks-span">';
$out+=$escape(p.name);
$out+='</span> </label> </div> ';
});
$out+=' <div class="clearfix"></div> </div> ';
}
$out+=' <h4>自定义添加</h4> <div class="row"> <form class="addItemForm"> <div class="col-md-10"> <input class="form-control p-r-none" type="text" name="itemName"> </div> <div class="col-md-2"> <button type="button" class="btn btn-primary btn-sm" data-action="addItemBtn">添加</button> </div> <div class="col-md-12"></div> <div class="clearfix"></div> </form> </div> <div class="row m-t-sm" id="customItemBox"> </div> </div> </div> </div> <div class="col-md-6"> <div class="ibox"> <div class="ibox-title no-borders p-h-sm min-h-50">已选择项 (拖拽进行调整顺序)</div> <div class="ibox-content border-darker-grey box-right"> <div class="row list-group" id="selectedItemBox"> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_add_mult_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,name=$data.name,isCustom=$data.isCustom,$out='';$out+='<div class="col-md-6 p-r-none m-b-xs"> <label class="i-checks i-checks-label fw-normal"> <input name="itemCk" type="checkbox" value="';
$out+=$escape(id);
$out+='" data-name="';
$out+=$escape(name);
$out+='" data-is-custom="';
$out+=$escape(isCustom);
$out+='"/> <span class="i-checks-span"> <span class="item-span m-r-xs bg-muted p-xxs f-s-xs" > <span class="item-name" data-toggle="tooltip" data-original-title="';
$out+=$escape(name);
$out+='"> ';
$out+=$escape(name);
$out+=' </span> <a class="curp" href="javascript:void(0)" data-id="';
$out+=$escape(id);
$out+='" data-action="delCusItem"> <i class="fa fa-times fc-red"></i> </a> </span> </span> </label> </div>';
return new String($out);
});/*v:1*/
template('m_production/m_production_add_mult_select',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,isCustom=$data.isCustom,name=$data.name,$out='';$out+='<div class="col-md-6 p-r-none m-b list-group-item" data-sort-id="';
$out+=$escape(id);
$out+='" data-id="';
$out+=$escape(id);
$out+='" data-is-custom="';
$out+=$escape(isCustom);
$out+='" data-name="';
$out+=$escape(name);
$out+='"> <span class="item-span m-r-xs bg-muted p-xxs f-s-xs" > <span class="item-name" data-toggle="tooltip" data-original-title="';
$out+=$escape(name);
$out+='"> ';
$out+=$escape(name);
$out+=' </span> <a class="curp" href="javascript:void(0)" data-id="';
$out+=$escape(id);
$out+='" data-action="delSelectedItem"> <i class="fa fa-times fc-red"></i> </a> </span> </div> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_add_row',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,taskId=$data.taskId,colspan=$data.colspan,taskOptionList=$data.taskOptionList,$each=$utils.$each,t=$data.t,$index=$data.$index,personInChargeInfo=$data.personInChargeInfo,appointmentStartTime=$data.appointmentStartTime,appointmentEndTime=$data.appointmentEndTime,$out='';$out+='<tr class="task-add-row content-row-edit" data-pid="';
$out+=$escape(taskId);
$out+='"> <td colspan="';
$out+=$escape(colspan?colspan:'12');
$out+='"> <form> <div class="pull-left row-edit-item p-r-xs"> <textarea placeholder="请输入任务名称" class="form-control" type="text" name="taskName" style="width: 88%;display: inline-block;"></textarea> <span><span class="wordCount">0</span>/<span>50</span></span> </div> <div class="pull-left row-edit-item p-r-xs">  <div class="';
$out+=$escape(taskOptionList && taskOptionList.length>0?'input-group':'');
$out+='"> ';
if(taskOptionList && taskOptionList.length>0){
$out+=' <div class="input-group-btn"> <button data-toggle="dropdown" class="btn btn-white dropdown-toggle" type="button" aria-expanded="false"><span class="caret"></span></button> <ul class="dropdown-menu pt-relative hide"> ';
$each(taskOptionList,function(t,$index){
$out+=' <li><a href="javascript:void(0);" data-action="selectTaskOption" data-id="';
$out+=$escape(t.id);
$out+='">';
$out+=$escape(t.name);
$out+='</a></li> ';
});
$out+=' </ul> </div> ';
}
$out+=' </div> </div> <!--<div class="pull-left row-edit-item p-t-xs"> <span class="show-span"> <span class="fc-v1-grey">';
$out+=$escape(personInChargeInfo.personInCharge);
$out+='</span> </span> <a href="javascript:void(0);" data-action="setTaskLeader" data-user-name="';
$out+=$escape(personInChargeInfo.personInCharge);
$out+='" data-id="';
$out+=$escape(personInChargeInfo.personInChargeId);
$out+='"> <i class="fa fa-pencil-square-o"></i> </a> </div>--> <div class="pull-left row-edit-item p-r-xs" > <div class="input-group"> <input type="text" class="form-control timeInput startTime" id="ipt_startTime" name="startTime" placeholder="开始日期" readonly onFocus="startTimeFun(this)" data-appointmentStartTime = "" value="';
$out+=$escape(appointmentStartTime);
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> <div class="pull-left row-edit-item p-r-xs"> <div class="input-group"> <input type="text" class="form-control timeInput endTime" id="ipt_endTime" name="endTime" placeholder="结束日期" readonly onFocus="endTimeFun(this)" data-appointmentEndTime = "" value="';
$out+=$escape(appointmentEndTime);
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> <div class="pull-left row-edit-item"> <button class="btn btn-primary" data-action="submit">创建</button> <button class="btn btn-default" data-action="cancel">取消</button> </div>  </form> </td> </tr> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_approval_opinion',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,doType=$data.doType,dataList=$data.dataList,$each=$utils.$each,t=$data.t,ti=$data.ti,_isNullOrBlank=$helpers._isNullOrBlank,e=$data.e,ei=$data.ei,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<div class="m-production-details-approval-opinion task-list-box"> <table class="table table-striped ';
$out+=$escape(doType==1 || doType==2?'table-bordered':'');
$out+=' "> <thead> <tr> ';
if(doType==0 || doType==2){
$out+=' <th width="5%"> <label class="i-checks fw-normal m-b-none dp-inline-block"> <input name="approvalOpinionCk" type="checkbox" value="" /> <span class="i-checks-span"></span> </label> <div class="btn-group batchOperation dp-inline-block vertical-bottom"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="批量操作"> <span class="ic-operation-batch"></span> </button> <ul class="dropdown-menu"> <li> <a href="javascript:void(0);" class="" data-action="batchStateFlow" data-canbedelete="">批量流转</a> <a href="javascript:void(0);" class="" data-action="batchDel" data-canbedelete="">批量删除</a> </li> </ul> </div> </th> ';
}
$out+=' <th>名称</th> <th>关联图纸</th>  <th>严重程度</th> <th>状态</th> <th>处理人</th> <th>创建人</th> <th>创建时间</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(t,ti){
$out+=' <tr class="curp ';
$out+=$escape(t.status=='status_4'?'complete-date-tr':'');
$out+='" data-id="';
$out+=$escape(t.id);
$out+='" data-task-id="';
$out+=$escape(t.taskId);
$out+='" data-file-id="';
$out+=$escape(t.fileId);
$out+='"> ';
if(doType==0 || doType==2){
$out+=' <td> <label class="i-checks fw-normal m-b-none dp-inline-block"> <input name="approvalOpinionCk" type="checkbox" value="';
$out+=$escape(t.id);
$out+='" data-status="';
$out+=$escape(t.status);
$out+='"/> <span class="i-checks-span"></span> </label> <div class="list-action-box dp-inline-block vertical-bottom"> <div class="btn-group singleOperation" style="display: none;"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"> <span class="ic-operation"></span> </button> <ul class="dropdown-menu"> <li><a href="javascript:void(0);" data-action="deleteItem">删除</a></li> </ul> </div> </div> </td> ';
}
$out+=' <td> <span class="show-span"> ';
$out+=$escape(t.auditName);
$out+=' </span> </td> <td> <span class="show-span"> ';
if(!_isNullOrBlank(t.fileName)){
$out+=' ';
$out+=$escape(t.fileName);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> </td> <td> <span class="show-span ';
$out+=$escape(t.severity==1||t.severity==2?'fc-red':'');
$out+='"> <!--';
$out+=$escape(t.severityName);
$out+='--> ';
if(t.severity==0){
$out+=' 空 ';
}else if(t.severity==1){
$out+=' 致命 ';
}else if(t.severity==2){
$out+=' 严重 ';
}else if(t.severity==3){
$out+=' 一般 ';
}else if(t.severity==4){
$out+=' 提示 ';
}else if(t.severity==5){
$out+=' 建议 ';
}
$out+=' </span> <a href="javascript:void(0);" class="btn-edit" data-action="xeditableByApprovalOpinion" data-key="severity" data-value="';
$out+=$escape(t.severity);
$out+='" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> <span class="show-span"> ';
if(!_isNullOrBlank(t.statusName)){
$out+=' <button class="btn btn-white btn-rounded btn-status no-hover selected"> ';
$out+=$escape(t.statusName);
$out+=' </button> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" class="btn-edit" data-action="xeditableStatusByApprovalOpinion" data-key="status" data-value="';
$out+=$escape(t.status);
$out+='" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> <span class="show-span"> ';
if(t.executers && t.executers.length>0){
$out+=' ';
$each(t.executers,function(e,ei){
$out+=' ';
if(ei>0){
$out+=' ,';
$out+=$escape(e.userName);
$out+=' ';
}else{
$out+=' ';
$out+=$escape(e.userName);
$out+=' ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" class="btn-edit" data-action="xeditableUserByApprovalOpinion" data-key="handler" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> ';
$out+=$escape(t.creatorName);
$out+=' </td> <td> ';
$out+=$escape(_momentFormat(t.createTime,'YYYY/MM/DD HH:mm:ss'));
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="8" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_approval_opinion_add','<tr class="content-row-edit" data-id=""> <td colspan="1" width="5%"> </td> <td colspan="2" width="55%"> <form> <div class="row"> <div class="col-sm-7 row-edit-item p-l-none"> <div class="m-r-xs"> <input placeholder="请输入名称" class="form-control input-sm" type="text" name="auditName"> </div> </div> <div class="col-sm-5 row-edit-item"> <button class="btn btn-primary btn-sm" data-action="submit">创建</button> <button class="btn btn-default btn-sm" data-action="cancel">取消</button> </div> </div> </form> </td> <td colspan="5"></td> </tr> ');/*v:1*/
template('m_production/m_production_approval_opinion_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,query=$data.query,dataInfo=$data.dataInfo,$string=$utils.$string,$each=$utils.$each,c=$data.c,ci=$data.ci,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,_momentFormat=$helpers._momentFormat,currentCompanyUserId=$data.currentCompanyUserId,t=$data.t,i=$data.i,$out='';$out+='<div class="ibox no-margins"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-6" id="breadcrumb"></div> <div class="col-md-6 text-right" style="padding: 9px 15px;"> </div> </div> </div> <div class="ibox-content no-padding"> <div class="row p-l p-t-sm p-b-sm"> <div class="col-md-8">  <a href="#/project/production/details?&id=';
$out+=$escape(query.id);
$out+='&projectName=';
$out+=$escape(query.projectName);
$out+='&dataCompanyId=';
$out+=$escape(query.dataCompanyId);
$out+='&taskId=';
$out+=$escape(query.taskId);
$out+='" class="btn btn-default">返回</a> <button class="btn btn-danger" data-action="deleteItem">删除</button> </div> </div> <div class="border-bottom no-margin"></div> <div class=""> <div class="col-md-9 border-right" id="leftBox"> <div class="m-t-sm"> <span class="font-bold"> ';
$out+=$escape(dataInfo.approvalOpinion.auditName);
$out+=' </span> <span class="m-l-lg"> 校审状态： <button class="btn btn-white btn-rounded btn-status no-hover selected" data-action="" data-end-status=""> ';
$out+=$escape(dataInfo.approvalOpinion.statusName);
$out+=' </button> </span> </div> <div class="tabs-container m-t"> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="false">详细信息</a></li> <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">变更历史</a></li> </ul> <div class="tab-content"> <div id="tab-1" class="tab-pane active"> <div class="panel-body"> <form class="form-horizontal details-edit"> <div class="form-group "> <label class="col-sm-12"> 描 述： <a href="javascript:void(0);" data-action="xeditable" data-type="11" data-key="auditDesc" data-target-ele="#audit-desc-edit" data-is-picture="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </label> <div class="col-sm-12"> <div class="show-span">';
$out+=$string(dataInfo.approvalOpinion.auditDesc);
$out+='</div> <div id="audit-desc-edit"></div> </div> </div> </form> </div> </div> <div id="tab-2" class="tab-pane" data-type="changeHistory"> <div class="panel-body"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> </div> </div> <div class="row"> <div class="col-md-12"> <h4 class="title-line m-t pull-left">附件&nbsp;&nbsp;</h4> </div> <div class="col-md-12"> <div class="row"> <div class="col-md-12 m-t-xs m-b-sm"> <span id="showFileLoading"></span> </div> <div class="col-md-12 m-b-sm"> <span class="uploadmgrContainer"></span> </div> </div> </div> </div> <div class="row"> <div class="col-md-12"> <h4 class="title-line m-t pull-left">评论&nbsp;&nbsp;</h4> </div> ';
if(dataInfo.commentList!=null && dataInfo.commentList.length>0){
$out+=' ';
$each(dataInfo.commentList,function(c,ci){
$out+=' <div class="col-md-12 comment-box"> ';
if(c.commentUser && !_isNullOrBlank(c.commentUser.fileFullPath)){
$out+=' <img alt="image" class="img-circle m-t-n-xs" src="';
$out+=$escape(c.commentUser.fileFullPath);
$out+='" width="30" height="30"> ';
}else{
$out+=' <img alt="image" class="img-circle m-t-n-xs" src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" height="30"> ';
}
$out+=' <span class="fc-v1-grey m-l-sm">';
$out+=$escape(c.commentUser.userName);
$out+=' &nbsp; ';
$out+=$escape(_momentFormat(c.createDate,'YYYY/MM/DD HH:mm'));
$out+='</span> ';
if(c.commentUser && currentCompanyUserId==c.commentUser.companyUserId){
$out+=' <a href="javascript:void(0);" class="btn btn-link no-padding hide" data-action="delComment" data-id="';
$out+=$escape(c.id);
$out+='">删除</a> ';
}
$out+=' <p class="p-w-xl">';
$out+=$escape(c.comment);
$out+='</p> </div> ';
});
$out+=' ';
}
$out+=' </div> <div class="row"> <form class="form-horizontal m-r-lg" id="commentForm"> <div class="col-md-12 m-b-sm f-s-lg">下一状态</div> <div class="col-md-12"> ';
$each(dataInfo.nodeList,function(t,i){
$out+=' <button class="btn btn-white btn-rounded btn-status ';
$out+=$escape(i==0?'selected':'fc-v1-grey');
$out+='" data-node-type="1" data-status="';
$out+=$escape(t.nodeValue);
$out+='"> ';
if(i==0){
$out+=' ';
$out+=$escape(dataInfo.approvalOpinion.status==t.nodeValue?'保持为':'');
$out+=$escape(t.nodeName);
$out+=' ';
}else{
$out+=' ';
$out+=$escape(t.nodeName);
$out+=' ';
}
$out+=' </button> ';
});
$out+=' </div> <div class="col-xs-12 bg-v2-grey p-m m"> <div class="form-group"> <label class="col-24-xs-3 fw-normal fc-v2-grey p-t-xs">处理人：</label> <div class="col-24-xs-21"> <select class="form-control" name="handler"></select> </div> </div> <div class="form-group"> <label class="col-24-xs-3 fw-normal fc-v2-grey p-t-xs">评论：</label> <div class="col-24-xs-21"> <textarea placeholder="请输入评论" class="form-control" type="text" name="comment" rows="5"></textarea> </div> </div> </div> <div class="col-xs-12"> <div class="form-group"> <div class="col-24-xs-21"> <button class="btn btn-primary btn-w-m" data-action="submitComment">流转</button> </div> </div> </div> <div class="clearfix"></div> </form> </div> </div> <div class="col-md-3" id="rightBox"> <h4 class="title-line m-t-sm">基本信息</h4> <div class="row m-b-sm"> <div class="col-sm-4 p-r-none">关联任务：</div> <div class="col-sm-8 p-l-none">';
$out+=$escape(dataInfo.approvalOpinion.taskName);
$out+='</div> </div> <div class="row m-b-sm"> <div class="col-sm-4 p-r-none">关联图纸：</div> <div class="col-sm-8 p-l-none">';
$out+=$escape(dataInfo.approvalOpinion.fileNames);
$out+='</div> </div> <div class="row m-b-sm"> <div class="col-sm-4 p-r-none">处理人：</div> <div class="col-sm-8 p-l-none">';
$out+=$escape(dataInfo.approvalOpinion.handlerNames);
$out+='</div> </div> <div class="row m-b-sm"> <div class="col-sm-4 p-r-none">创建人：</div> <div class="col-sm-8 p-l-none">';
$out+=$escape(dataInfo.approvalOpinion.createUserName);
$out+='</div> </div> <div class="row m-b-sm"> <div class="col-sm-4 p-r-none">创建时间：</div> <div class="col-sm-8 p-l-none">';
$out+=$escape(_momentFormat(dataInfo.approvalOpinion.createDate,'YYYY/MM/DD HH:mm'));
$out+='</div> </div> </div> <div class="clearfix"></div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_approval_opinion_state_flow',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,statusList=$data.statusList,t=$data.t,i=$data.i,$escape=$utils.$escape,status=$data.status,$out='';$out+='<form class="form-horizontal file-state-flow"> <div class="row no-margin"> <div class="col-md-12 p-t p-b bg-v2-grey "> ';
$each(statusList,function(t,i){
$out+=' <button class="btn btn-white btn-rounded btn-status m-b-xs ';
$out+=$escape(i==0?'selected':'');
$out+='" data-status="';
$out+=$escape(t.nodeValue);
$out+='" data-role-type="';
$out+=$escape(t.roleType);
$out+='"> ';
if(i==0){
$out+=' ';
$out+=$escape(status==t.nodeValue?'保持为':'');
$out+=$escape(t.nodeName);
$out+=' ';
}else{
$out+=' ';
$out+=$escape(t.nodeName);
$out+=' ';
}
$out+=' </button> ';
});
$out+=' </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,productionList=$data.productionList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,projectId=$data.projectId,projectNameCode=$data.projectNameCode,dataCompanyId=$data.dataCompanyId,_isNullOrBlank=$helpers._isNullOrBlank,_momentFormat=$helpers._momentFormat,managerInfo=$data.managerInfo,currentCompanyUserId=$data.currentCompanyUserId,_url=$helpers._url,$out='';$out+='<form class="task-list-box"> ';
if(productionList!=null && productionList.length>0){
$out+=' ';
$each(productionList,function(p,i){
$out+=' <div class="panel panel-default no-border" data-id="';
$out+=$escape(p.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" data-company-id="';
$out+=$escape(p.companyId);
$out+='"> <div class="panel-heading border border-v1-grey"> <div class="row"> <div class="col-sm-3 p-l-none"> <a href="javascript:void(0);" data-action="expander"><span class="ic-open vertical-text-bottom m-l-sm m-r-sm"></span></a> <a href="#/project/production/details?id=';
$out+=$escape(projectId);
$out+='&projectName=';
$out+=$escape(projectNameCode);
$out+='&taskId=';
$out+=$escape(p.id);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='" class="text-ellipsis task-full-name" data-container="body" data-toggle="tooltip" data-original-title="';
$out+=$escape(p.taskName);
$out+='"> ';
$out+=$escape(p.taskName);
$out+=' </a> </div> <div class="col-sm-7"> <span class="">任务负责人：</span> <span class="p-handler"> <span class="show-span"> ';
if(p.designer==null){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(p.designer.userName);
$out+=' ';
}
$out+=' </span> ';
if(p.role && p.role.changeDesignerManager==1){
$out+=' <a href="javascript:void(0);" data-action="xeditableByHandlerUser" data-type="12" data-url-type="2" data-key="personInCharge" data-do-type="2" data-multiple="0" data-cookies="0" data-id="';
$out+=$escape(p.designer?p.designer.companyUserId:'');
$out+='" data-task-id="';
$out+=$escape(p.id);
$out+='" data-user-name="';
$out+=$escape(p.designer?p.designer.userName:'');
$out+='" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </span> &nbsp;&nbsp; <span class="">任务状态：</span> <a href="javascript:void(0);" class="font-bold ';
$out+=$escape(p.role && p.role.changeStatus==1?'':'a-span');
$out+='" data-action="';
$out+=$escape(p.role && p.role.changeStatus==1?'taskStateFlow':'');
$out+='" data-end-status="';
$out+=$escape(p.endStatus);
$out+='">  ';
if(p.endStatus ==3 || p.endStatus ==4){
$out+=' <span class="text-danger">';
$out+=$escape(p.stateHtml);
$out+='</span> ';
}else if(p.endStatus ==2){
$out+=' <span class="text-success">';
$out+=$escape(p.stateHtml);
$out+='</span> ';
}else{
$out+=' <span>';
$out+=$escape(p.stateHtml);
$out+='</span> ';
}
$out+=' </a> &nbsp;&nbsp; </span> <span> 开始时间： ';
if(!_isNullOrBlank(p.startTime)){
$out+=' ';
$out+=$escape(_momentFormat(p.startTime,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' &nbsp;&nbsp; </span> <span> 结束时间： ';
if(!_isNullOrBlank(p.endTime)){
$out+=' ';
$out+=$escape(_momentFormat(p.endTime,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </span> </div> <div class="col-sm-2 text-right"> ';
if((managerInfo.projectManager && managerInfo.projectManager.companyUserId==currentCompanyUserId)
                    || (managerInfo.assistant && managerInfo.assistant.companyUserId==currentCompanyUserId)
                    || (p.designer  && p.designer.companyUserId==currentCompanyUserId)){
$out+=' <!--<a class="btn btn-dotted-default btn-xs" data-action="downloadFile" data-id="';
$out+=$escape(p.id);
$out+='" >导出图纸</a>--> <a href="javascript:void(0);" class="btn btn-primary btn-xs" data-action="distributionRatio">分配工作内容占比</a> <a class="btn btn-dotted-default btn-xs" data-action="addProjectMember"><i class="fa fa-plus f-s-m" ></i>&nbsp;人员</a> ';
}
$out+=' </div> </div> </div> <div class="panel-body no-padding no-borders of-auto min-h-300"> </div> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="row no-data-tr"> <div class="text-center col-md-12"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关生产安排</span> </div> </div> </div> ';
}
$out+=' </form> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_content_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,doType=$data.doType,p=$data.p,$each=$utils.$each,t=$data.t,ti=$data.ti,$string=$utils.$string,_include=$helpers._include,tIndex=$data.tIndex,tLength=$data.tLength,projectId=$data.projectId,projectNameCode=$data.projectNameCode,currentCompanyUserId=$data.currentCompanyUserId,dataCompanyId=$data.dataCompanyId,taskStatus=$data.taskStatus,_url=$helpers._url,$out='';$out+='<table class="tree table table-bordered ';
$out+=$escape(doType==3 || doType==4?'':'no-borders');
$out+=' m-b-none"> <thead> <tr> <th width="3%" class="b-r-none"> <div class="list-check-box"> <label class="i-checks fw-normal m-b-none"> <input name="taskAllCk" type="checkbox" /> <span class="i-checks-span"></span> </label> </div> </th> <th width="3%" class="b-r-none b-l-none"> <div class="list-action-box"> <div class="btn-group batchOperation" id="batchAllOperation"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="批量操作"> <span class="ic-operation-batch"></span> </button> <ul class="dropdown-menu"> <li> ';
if(p.childList!=null && p.childList.length>0&&p.role && p.role.add==1){
$out+=' <a href="javascript:void(0);" class="" data-action="batchTaskStateFlow">批量变更状态</a> <a href="javascript:void(0);" class="" data-action="batchDelTask">批量删除</a> <a href="javascript:void(0);" class="" data-action="batchCopy">批量复制</a> ';
}
$out+=' </li> </ul> </div> </div> </th> <th width="25%" class="b-l-none"> <span>工作安排</span> ';
if(p.role && p.role.add==1){
$out+=' <button class="btn btn-link" data-action="addSubTask" title="添加工作安排" data-type="root"><i class="fa fa-plus"></i></button>  ';
}
$out+=' </th> <th width="" class="w-100">任务状态</th> <th width="20%" >执行人</th> <th>占比</th> <th width="" class="w-100">开始时间</th> <th width="" class="w-100">结束时间</th> <th width="" >完成时间</th> </tr> </thead> <tbody> ';
if(p.childList!=null && p.childList.length>0){
$out+=' ';
$each(p.childList,function(t,ti){
$out+=' ';
$out+=$string(_include('m_production/m_production_content_row',{t:t,tIndex:ti,tLength:p.childList.length,p:p,projectId:projectId,projectNameCode:projectNameCode,doType:doType,currentCompanyUserId:currentCompanyUserId,dataCompanyId:dataCompanyId,taskStatus:taskStatus}));
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="9" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关子任务</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_content_row',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,t=$data.t,tIndex=$data.tIndex,doType=$data.doType,projectId=$data.projectId,taskStatus=$data.taskStatus,projectNameCode=$data.projectNameCode,dataCompanyId=$data.dataCompanyId,_isNullOrBlank=$helpers._isNullOrBlank,_getStatusColor=$helpers._getStatusColor,_momentFormat=$helpers._momentFormat,$out='';$out+='<tr class="m-production-content-row tree-box-tr treegrid-';
$out+=$escape(t.id);
$out+=' ';
if(t.taskPid!=null && t.taskPid!=''){
$out+=' treegrid-parent-';
$out+=$escape(t.taskPid);
$out+=' ';
}
$out+=' ';
$out+=$escape(t.completeDate==null?'':'complete-date-tr');
$out+=' " data-id="';
$out+=$escape(t.id);
$out+='" data-pid="';
$out+=$escape(t.taskPid);
$out+='" data-i="';
$out+=$escape(tIndex);
$out+='" data-path="';
$out+=$escape(t.taskPath);
$out+='" data-handler="';
$out+=$escape(t.handler?t.handler.companyUserId:'');
$out+='"> <td class=" b-r-none"> <div class="list-check-box vertical-sub"> <label class="i-checks fw-normal m-b-none"> <input name="taskCk" type="checkbox" data-is-can1="';
$out+=$escape(t.role.delete);
$out+='" value="';
$out+=$escape(t.id);
$out+='" data-end-status="';
$out+=$escape(t.endStatus);
$out+='"/> <span class="i-checks-span"></span> </label> </div> </td> <td class="b-r-none b-l-none v-middle"> <div class="list-action-box"> ';
if(doType!=3 && t.role && (t.role.add==1 || t.role.edit==1 || t.role.edit==1 || t.role.delete==1)){
$out+=' <div class="btn-group singleOperation" style="display: none;"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"> <span class="ic-operation"></span> </button> <ul class="dropdown-menu pt-relative hide">  ';
if(t.role && t.role.edit==1){
$out+=' <li><a href="javascript:void(0);" data-action="moveUp">向上移动</a></li> ';
}
$out+='  ';
if(t.role && t.role.edit==1){
$out+=' <li><a href="javascript:void(0);" data-action="moveDown">向下移动</a></li> ';
}
$out+=' ';
if(t.role && (t.role.delete==1||(t.role.edit==1&&t.taskType==6))){
$out+=' <li><a href="javascript:void(0);" data-action="delTask" data-canbedelete="">删除</a></li> ';
}
$out+=' </ul> </div> ';
}
$out+=' </div> </td> <td class="tree-td pt-relative p-r-none b-l-none"> ';
if(doType==3){
$out+=' <a href="#/myTask/details?id=';
$out+=$escape(t.id);
$out+='&projectId=';
$out+=$escape(projectId);
$out+='&status=';
$out+=$escape(taskStatus);
$out+='" class="show-span task-name pt-relative " data-string="';
$out+=$escape(t.taskName);
$out+='"> ';
$out+=$escape(t.taskName);
$out+=' </a> ';
}else{
$out+=' <a href="#/project/production/details?id=';
$out+=$escape(projectId);
$out+='&projectName=';
$out+=$escape(projectNameCode);
$out+='&taskId=';
$out+=$escape(t.id);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='&fromType=';
$out+=$escape(doType);
$out+='" class="show-span task-name pt-relative " data-string="';
$out+=$escape(t.taskName);
$out+='"> ';
$out+=$escape(t.taskName);
$out+=' </a> ';
}
$out+=' ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.taskName);
$out+='" data-key="taskName" data-placeholder="请输入任务名称" title="编辑任务名称" data-type="2" data-valid="1" data-max-length="50" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(!_isNullOrBlank(t.endStatusName)){
$out+=' <button class="btn ';
$out+=$escape(_getStatusColor(t.endStatus));
$out+=' btn-rounded btn-status no-hover">';
$out+=$escape(t.endStatusName);
$out+='</button> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span>  ';
if(t.taskType==0 && t.role && t.role.changeStatus==1){
$out+=' <a href="javascript:void(0);" data-action="xeditableByClick" data-key="endStatus" data-value="';
$out+=$escape(t.endStatus);
$out+='" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(t.handler){
$out+=' ';
$out+=$escape(t.handler.userName);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> ';
if(t.role && t.role.changeDesigner==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-type="12" data-url-type="1" data-key="handlerUser" data-do-type="2" data-multiple="0" data-cookies="0" data-value="';
$out+=$escape(t.handler?t.handler.companyUserId:'');
$out+='" data-name="';
$out+=$escape(t.handler?t.handler.userName:'');
$out+='" data-task-id="';
$out+=$escape(t.id);
$out+='" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(_isNullOrBlank(t.ratio)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(t.ratio);
$out+='% ';
}
$out+=' </span> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.ratio);
$out+='" data-key="ratio" data-placeholder="请输入占比" data-unit="%" data-type="1" data-valid="7" data-valid-title="占比" data-limit-min="0" data-limit-max="';
$out+=$escape(t.lessRatio);
$out+='" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(t.role && t.role.edit==1){
$out+=' ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.startTime);
$out+='" data-type="10" data-key="startTime" data-max-date="';
$out+=$escape(t.endTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td class=""> <span class="show-span"> ';
if(t.role && t.role.edit==1){
$out+=' ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.endTime);
$out+='" data-type="10" data-key="endTime" data-min-date="';
$out+=$escape(t.startTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td class=""> <span class="show-span"> ';
if(t.completeDate!=null &&  t.completeDate!=''){
$out+=' ';
$out+=$escape(_momentFormat(t.completeDate,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </span> ';
if(t.taskType==0 && t.role && t.role.changeStatus==1&&t.endStatus=='status_complete'){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.completeDate);
$out+='" data-type="10" data-key="completeDate" data-min-date="';
$out+=$escape(t.startTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> </tr> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_copy','<form class="form-horizontal m"> <div class="form-group"> <label class="col-24-sm-7 control-label">请选择项目<span class="fc-red">*</span>：</label> <div class="col-24-sm-17"> <select class="form-control" name="projectId"></select> </div> </div> <div class="form-group"> <label class="col-24-sm-7 control-label">请选择工作内容<span class="fc-red">*</span>：</label> <div class="col-24-sm-17"> <select class="form-control" name="targetId"></select> </div> </div> </form> ');/*v:1*/
template('m_production/m_production_design_file',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,doType=$data.doType,dataInfo=$data.dataInfo,$each=$utils.$each,a=$data.a,ai=$data.ai,baBieUserId=$data.baBieUserId,pageIndex=$data.pageIndex,_isNullOrBlank=$helpers._isNullOrBlank,u=$data.u,ui=$data.ui,_momentFormat=$helpers._momentFormat,_fileSizeFormat=$helpers._fileSizeFormat,_url=$helpers._url,$out='';$out+='<div class="task-list-box"> <table class="table table-striped ';
$out+=$escape(doType==4?'table-bordered':'');
$out+='"> <thead> <tr> <th width="7%"> <label class="i-checks fw-normal m-b-none dp-inline-block"> <input name="taskFileCk" type="checkbox" value="" /> <span class="i-checks-span"></span> </label> <div class="btn-group batchOperation dp-inline-block vertical-bottom"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="批量操作"> <span class="ic-operation-batch"></span> </button> <ul class="dropdown-menu"> <li> <a href="javascript:void(0);" class="" data-action="batchStateFlow" data-canbedelete="">批量流转</a> <a href="javascript:void(0);" class="" data-action="batchDel" data-canbedelete="">批量删除</a> <a href="javascript:void(0);" class="" data-action="batchDownload" data-canbedelete="">批量下载</a> </li> </ul> </div> </th> <th width="7%">序号</th> <th width="30%">名称</th> ';
if(doType==4){
$out+=' <th>关联任务</th> ';
}
$out+=' <th>状态</th> <th>处理人</th> <th>创建人</th> <th>创建时间</th> <th>修改时间</th> <th>大小</th> </tr> </thead> <tbody> ';
if(dataInfo.attachList!=null && dataInfo.attachList.length>0){
$out+=' ';
$each(dataInfo.attachList,function(a,ai){
$out+=' <tr class="';
$out+=$escape(a.isComplete == 1?'complete-date-tr':'');
$out+='" data-id="';
$out+=$escape(a.id);
$out+='"> <td class=""> <label class="i-checks fw-normal m-b-none dp-inline-block"> <input name="taskFileCk" type="checkbox" value="';
$out+=$escape(a.id);
$out+='" data-status="';
$out+=$escape(a.fileStatus);
$out+='" data-is-del="';
$out+=$escape(baBieUserId == a.creator?'1':'0');
$out+='"/> <span class="i-checks-span"></span> </label> <div class="list-action-box dp-inline-block vertical-bottom"> <div class="btn-group singleOperation" style="display: none;"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"> <span class="ic-operation"></span> </button> <ul class="dropdown-menu"> ';
if(baBieUserId == a.creator){
$out+=' <li><a href="javascript:void(0);" data-action="deleteItem">删除</a></li> ';
}
$out+=' <li><a href="javascript:void(0);" data-action="fileDownload">下载</a></li> </ul> </div> </div> </td> <td>';
$out+=$escape(ai+1+pageIndex*10);
$out+='</td> <td><a href="javascript:void(0);" data-action="filePreview" class="btn btn-link fc-dark-blue no-padding">';
$out+=$escape(a.fileName);
$out+='</a></td> ';
if(doType==4){
$out+=' <td class="max-width-v1"> <div class="text-ellipsis-2 text-wrap" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(a.taskName);
$out+='"> ';
$out+=$escape(a.taskName);
$out+=' </div> </td> ';
}
$out+=' <td> <span class="show-span"> ';
if(!_isNullOrBlank(a.fileStatusName)){
$out+=' <button class="btn btn-white btn-rounded btn-status no-hover selected">';
$out+=$escape(a.fileStatusName);
$out+='</button> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" class="btn-edit" data-action="xeditableByDesignClick" data-key="fileStatus" data-value="';
$out+=$escape(a.fileStatus);
$out+='" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> <span class="show-span"> ';
if(a.handlerUser && a.handlerUser.userList && a.handlerUser.userList.length>0){
$out+=' ';
$each(a.handlerUser.userList,function(u,ui){
$out+=' ';
if(ui < a.handlerUser.userList.length-1){
$out+=' ';
$out+=$escape(u.userName);
$out+=', ';
}else{
$out+=' ';
$out+=$escape(u.userName);
$out+=' ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" class="btn-edit" data-action="xeditableUserByDesign" data-key="handler" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td>';
$out+=$escape(a.creatorName);
$out+='</td> <td>';
$out+=$escape(_momentFormat(a.createTime,'YYYY/MM/DD HH:ss'));
$out+='</td> <td>';
$out+=$escape(_momentFormat(a.updateDate,'YYYY/MM/DD HH:ss'));
$out+='</td> <td>';
$out+=$escape(_fileSizeFormat(a.fileSize));
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="10" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_design_file_flow',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,initiator=$data.initiator,_momentFormat=$helpers._momentFormat,initiationDate=$data.initiationDate,taskInfo=$data.taskInfo,$each=$utils.$each,attachList=$data.attachList,p=$data.p,i=$data.i,fileStatus=$data.fileStatus,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-24-xs-3 text-right">发起人：</label> <div class="col-24-xs-21"> ';
$out+=$escape(initiator);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">发起时间：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_momentFormat(initiationDate,'YYYY/MM/DD'));
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">任务路径：</label> <div class="col-24-xs-21"> ';
$out+=$escape(taskInfo.taskFullName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">关联任务：</label> <div class="col-24-xs-21"> ';
$out+=$escape(taskInfo.taskName);
$out+=' </div> </div> <h4 class="title-line fc-dark-grey">设计文件</h4> <div class="form-group"> <div class="col-sm-12"> <table class="table"> <thead> <tr> <th>设计文件</th> <th class="text-right"><button class="btn btn-primary btn-xs">下载全部</button></th> </tr> </thead> <tbody> ';
$each(attachList,function(p,i){
$out+=' <tr> <td>';
$out+=$escape(p.fileName);
$out+='</td> <td>12K</td> </tr> ';
});
$out+=' </tbody> </table> </div> </div> <div class="form-group"> <div class="col-md-12 m-b-sm"> <span id="showFileLoading"></span> </div> <div class="col-md-12 m-b-sm"> <span class="uploadmgrContainer"></span> </div> </div> <h4 class="title-line fc-dark-grey">流转记录</h4> <div class="form-group"> <div class="col-sm-12"> <table class="table"> <thead> <tr> <th>发起人</th> <th>发起时间</th> <th>附件</th> <th>发起事项</th> <th>处理人</th> </tr> </thead> <tbody> <tr> <th>张三</th> <th>2019/02/12</th> <th>总体规划校对意见.xlsx</th> <th>审核</th> <th>2019/02/12</th> </tr> </tbody> </table> </div> </div> <h4 class="title-line fc-dark-grey">任务流转</h4> <div class="form-group"> <label class="col-24-xs-3 text-right">任务流转：</label> <div class="col-24-xs-21"> <div class="pull-left m-r-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(fileStatus==1){
$out+=' <input type="radio" name="fileStatus" value="1" checked/> ';
}else{
$out+=' <input type="radio" name="fileStatus" value="1"/> ';
}
$out+=' <span class="i-checks-span">设计中</span> </label> </div> <div class="pull-left m-r-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(fileStatus==2){
$out+=' <input type="radio" name="fileStatus" value="2" checked/> ';
}else{
$out+=' <input type="radio" name="fileStatus" value="2"/> ';
}
$out+=' <span class="i-checks-span">校对中</span> </label> </div> <div class="pull-left m-r-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(fileStatus==3){
$out+=' <input type="radio" name="fileStatus" value="3" checked/> ';
}else{
$out+=' <input type="radio" name="fileStatus" value="3"/> ';
}
$out+=' <span class="i-checks-span">审核中</span> </label> </div> <div class="pull-left m-r-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(fileStatus==4){
$out+=' <input type="radio" name="fileStatus" value="4" checked/> ';
}else{
$out+=' <input type="radio" name="fileStatus" value="4"/> ';
}
$out+=' <span class="i-checks-span">验收中</span> </label> </div> <div class="row"><div class="col-24-xs-21"></div></div> </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">处理人：</label> <div class="col-24-xs-21"> <select class="form-control" name="designUserList" > </select> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_design_manager',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,doType=$data.doType,$escape=$utils.$escape,title=$data.title,projectManager=$data.projectManager,currentCompanyId=$data.currentCompanyId,dataCompanyId=$data.dataCompanyId,assistant=$data.assistant,currentCompanyUserId=$data.currentCompanyUserId,$out='';$out+=' ';
if(doType!=3){
$out+=' <span class="">';
$out+=$escape(title);
$out+='：</span> ';
}
$out+=' <span class="m-r-sm"> ';
$out+=$escape(projectManager?projectManager.companyUserName:'');
$out+=' ';
if(projectManager!=null && projectManager.isUpdateOperator==1 && currentCompanyId==dataCompanyId){
$out+=' <a href="javascript:void(0)" data-action="changeOperatorPerson" data-i="0" data-id="';
$out+=$escape(projectManager.companyUserId);
$out+='" data-company-id="';
$out+=$escape(projectManager.companyId);
$out+='" data-user-name="';
$out+=$escape(projectManager.companyUserName);
$out+='" class="showTooltip" data-placement="top" data-toggle="tooltip" data-original-title="更换';
$out+=$escape(title);
$out+='"> <i class="fa fa-retweet"></i> </a> ';
}
$out+=' </span> <!-- <span>';
$out+=$escape(title);
$out+='助理：</span> <span class="m-r-sm"> ';
$out+=$escape(assistant==null || assistant.companyUserName==null?'未设置':assistant.companyUserName);
$out+=' ';
if( projectManager!=null && projectManager.companyUserId==currentCompanyUserId && currentCompanyId==dataCompanyId){
$out+=' ';
if(assistant!=null){
$out+=' <a href="javascript:void(0)" data-action="changeManagerPerson" data-i="0" data-id="';
$out+=$escape(assistant.companyUserId);
$out+='" data-user-name="';
$out+=$escape(assistant.companyUserName);
$out+='" data-company-id="';
$out+=$escape(assistant.companyId);
$out+='" class="showTooltip" data-placement="top" data-toggle="tooltip" data-original-title="更换';
$out+=$escape(title);
$out+='助理"> <i class="fa fa-retweet"></i> </a> ';
}else{
$out+=' <a href="javascript:void(0)" data-action="changeManagerPerson" data-i="0" data-id="" data-user-name="" data-company-id="" class="showTooltip" data-placement="left" data-toggle="tooltip" data-original-title="更换助理"> <i class="fa fa-retweet"></i> </a> ';
}
$out+=' ';
}
$out+=' </span>--> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$string=$utils.$string,_isNullOrBlank=$helpers._isNullOrBlank,_getStatusColor=$helpers._getStatusColor,_momentFormat=$helpers._momentFormat,$out='';$out+='<div class="ibox no-margins m-production-details"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-12" id="breadcrumb"></div> </div> </div> <div class="ibox-content no-padding"> <div class="row no-margins p-t-xs"> <div class="col-md-8 p-t-xs"> <span class="font-bold"> ';
$out+=$escape(dataInfo.task.taskFullName);
$out+=' </span> </div> <div class="col-md-4 text-right"> <a href="javascript:;" data-action="returnBack" class="btn btn-default">返回</a> </div> </div> <div class="border-bottom m-t-xs"></div> <div class=""> <div class="col-md-9 p-t-sm p-l p-r-none border-right" id="leftBox"> <div class="tabs-container m-t"> <ul class="nav nav-tabs">  <li class="active"><a data-toggle="tab" href="#tab-5" aria-expanded="false">子任务</a></li> <li class=""><a data-toggle="tab" href="#tab-4" aria-expanded="false">变更历史</a></li> </ul> <div class="tab-content"> <!-- <div id="tab-3" class="tab-pane active"> <div class="panel-body"> <form class="form-horizontal details-edit"> <div class="form-group "> <label class="col-sm-12"> 描 述： <a href="javascript:void(0);" data-action="xeditable" data-type="11" data-key="taskRemark" data-target-ele="#task-remark-edit" data-is-picture="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </label> <div class="col-sm-12"> <div class="show-span">';
$out+=$string(dataInfo.task.taskRemark);
$out+='</div> <div id="task-remark-edit"></div> </div> </div> </form> </div> </div>--> <div id="tab-4" class="tab-pane " data-type="changeHistory"> <div class="panel-body"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> <div id="tab-5" class="tab-pane active" data-type="subTask"> <div class="panel-body"> <div class="data-list-box"> <div class="data-list-container2"></div> <div class="p-w-sm"> <div id="data-pagination-container2" class="m-pagination pull-right "></div> </div> </div> </div> </div> </div> </div> </div> <div class="col-md-3 p-t-sm" id="rightBox"> <h4 class="title-line m-b-sm">基本信息</h4> <div class="row m-b-sm"> <label class="col-sm-5">任务状态：</label> <div class="col-sm-7"> ';
if(!_isNullOrBlank(dataInfo.task.endStatusName)){
$out+=' <button class="btn ';
$out+=$escape(_getStatusColor(dataInfo.task.endStatus));
$out+=' btn-rounded btn-status no-hover">';
$out+=$escape(dataInfo.task.endStatusName);
$out+='</button> ';
}else{
$out+=' -- ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">占比：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.task.ratio?dataInfo.task.ratio+'%':'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">团队：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.task.departName?dataInfo.task.departName:'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">任务负责人：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.task.designer?dataInfo.task.designer.userName:'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">开始时间：</label> <div class="col-sm-7"> ';
if(_isNullOrBlank(dataInfo.task.startTime)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">结束时间：</label> <div class="col-sm-7"> ';
if(_isNullOrBlank(dataInfo.task.endTime)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">完成时间：</label> <div class="col-sm-7"> ';
if(_isNullOrBlank(dataInfo.task.completeDate)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.completeDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> </div> <div class="clearfix"></div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<div class="row"> <div class="col-md-9"> <form class="form-horizontal m"> <div class="form-group "> <div class="col-sm-12 row-edit-item"> <input placeholder="请输入生产任务名称" class="form-control" type="text" name="taskName" value="';
$out+=$escape(dataInfo?dataInfo.taskName:'');
$out+='"> </div> </div> <div class="form-group"> <div class="col-sm-12" id="remarkEditor"> </div> </div> <div class="form-group bg-v2-grey p-h-m no-margins"> <div class="col-sm-12 m-b-sm"> <label class="pull-left control-label">任务负责人：</label> <div class="col-sm-6 row-edit-item" style="padding-top: 4px;"> <span class="show-span"> <span class="fc-v1-grey">';
$out+=$escape(dataInfo?dataInfo.personInCharge:'');
$out+='</span> </span> <a href="javascript:void(0);" class="btn btn-default btn-circle" data-action="setTaskLeader" data-id="';
$out+=$escape(dataInfo?dataInfo.personInChargeId:'');
$out+='"><i class="fa fa-plus"></i></a> </div> </div> <div class="col-sm-6"> <label class="pull-left control-label">开始时间</label> <div class="col-sm-6 row-edit-item"> <div class="input-group pull-left"> <input type="text" class="form-control timeInput startTime" id="ipt_startTime" name="startTime" placeholder="开始日期" readonly onFocus="startTimeFun(this)" data-appointmentStartTime = "" value="';
$out+=$escape(dataInfo?dataInfo.startTime:'');
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar" ></i></span> </div> </div> </div> <div class="col-sm-6"> <label class="pull-left control-label">结束时间</label> <div class="col-sm-6 row-edit-item"> <div class="input-group"> <input type="text" class="form-control timeInput endTime" id="ipt_endTime" name="endTime" placeholder="结束日期" readonly onFocus="endTimeFun(this)" data-appointmentEndTime="" value="';
$out+=$escape(dataInfo?dataInfo.endTime:'');
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> </div> <div class="clearfix"></div> </div> <div class="form-group m-t-sm"> <div class="col-sm-12"> <button class="btn btn-primary" data-action="submit">提交</button> <button class="btn btn-default" data-action="cancel">取消</button> </div> </div> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_file_status',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fileStatus=$data.fileStatus,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-sm-2 control-label">状态：</label> <div class="col-sm-10"> <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(fileStatus==1){
$out+=' <input type="radio" name="fileStatus" value="1" checked/> ';
}else{
$out+=' <input type="radio" name="fileStatus" value="1"/> ';
}
$out+=' <span class="i-checks-span">设计中</span> </label> </div> <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(fileStatus==2){
$out+=' <input type="radio" name="fileStatus" value="2" checked/> ';
}else{
$out+=' <input type="radio" name="fileStatus" value="2"/> ';
}
$out+=' <span class="i-checks-span">校对中</span> </label> </div> <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(fileStatus==3){
$out+=' <input type="radio" name="fileStatus" value="3" checked/> ';
}else{
$out+=' <input type="radio" name="fileStatus" value="3"/> ';
}
$out+=' <span class="i-checks-span">审核中</span> </label> </div> <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(fileStatus==4){
$out+=' <input type="radio" name="fileStatus" value="4" checked/> ';
}else{
$out+=' <input type="radio" name="fileStatus" value="4"/> ';
}
$out+=' <span class="i-checks-span">验收中</span> </label> </div> <div class="row"><div class="col-sm-10"></div></div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">人员：</label> <div class="col-sm-10"> <select class="form-control" name="designUserList" > </select> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_left_tab',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,p1=$data.p1,i1=$data.i1,_isNullOrBlank=$helpers._isNullOrBlank,_interceptName=$helpers._interceptName,$out='';$out+='<div class="m-product-left-tab border full-height"> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <div class="task-box" data-relation-id="';
$out+=$escape(p.taskRelationId);
$out+='"> <div class="p-xs bg-v5-grey"> <div class="row"> <div class="col-sm-8 task-name">';
$out+=$escape(p.taskName);
$out+='</div> <div class="col-sm-4 text-right p-r-md"> <div class="status-box">  ';
if(p.endStatus ==3 || p.endStatus ==4){
$out+=' <span class="text-danger">';
$out+=$escape(p.stateHtml);
$out+='</span> ';
}else if(p.endStatus ==2){
$out+=' <span class="text-success">';
$out+=$escape(p.stateHtml);
$out+='</span> ';
}else{
$out+=' <span>';
$out+=$escape(p.stateHtml);
$out+='</span> ';
}
$out+=' </div> </div> </div> </div> ';
if(p.childList && p.childList.length>0 ){
$out+=' ';
$each(p.childList,function(p1,i1){
$out+=' <div class="m-xs border"> <ul class="list-group" data-relation-id="';
$out+=$escape(p1.taskRelationId);
$out+='"> <li class="list-group-item" data-id="';
$out+=$escape(p1.id);
$out+='" data-relation-id="';
$out+=$escape(p1.taskRelationId);
$out+='" data-index="';
$out+=$escape(i1);
$out+='"> <div class="profession dp-flex"> <div class="profession-left"> <span class="label label-info label-circle dp-inline-block-1 pull-right m-t-xs" title="';
$out+=$escape(p1.designer.companyUserName);
$out+='"> ';
if(p1.designer==null || _isNullOrBlank(p1.designer.companyUserName)){
$out+=' 空 ';
}else{
$out+=' ';
$out+=$escape(_interceptName(p1.designer.companyUserName,2));
$out+=' ';
}
$out+=' </span> </div> <div class="profession-right m-l-xs of-hidden"> <div class="row m-l-none"> <div class="col-sm-8 p-h-xxs"> <span class="text-ellipsis full-width" title="';
$out+=$escape(p1.taskName);
$out+='">专业：';
$out+=$escape(p1.taskName);
$out+='</span> <div class="row no-margin p-b-xs f-s-xxs"> <div class="width-40 pull-left"><span class="fc-v3-grey">';
$out+=$escape(p1.progressRate-0);
$out+='%</span></div> <div class="progress pull-left"> <div style="width: ';
$out+=$escape(p1.progressRate-0);
$out+='%" aria-valuemax="100" aria-valuemin="0" class="progress-bar"></div> </div> </div> </div> <div class="col-sm-4 status-box text-right p-t-xs p-l-none">  ';
if(p1.endStatus ==3 || p1.endStatus ==4){
$out+=' <span class="text-danger">';
$out+=$escape(p1.stateHtml);
$out+='</span> ';
}else if(p1.endStatus ==2){
$out+=' <span class="text-success">';
$out+=$escape(p1.stateHtml);
$out+='</span> ';
}else{
$out+=' <span>';
$out+=$escape(p1.stateHtml);
$out+='</span> ';
}
$out+=' </div> </div> </div> <div class="clearfix"></div> </div> </li> </ul> </div> ';
});
$out+=' ';
}
$out+=' </div> ';
});
$out+=' ';
}
$out+=' </div> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_member_task_tracking',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataInfo=$data.dataInfo,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,t=$data.t,ti=$data.ti,$string=$utils.$string,_include=$helpers._include,tIndex=$data.tIndex,projectId=$data.projectId,projectNameCode=$data.projectNameCode,currentCompanyUserId=$data.currentCompanyUserId,dataCompanyId=$data.dataCompanyId,_url=$helpers._url,$out='';$out+='<form class="task-list-box"> ';
if(dataInfo!=null && dataInfo.length>0){
$out+=' ';
$each(dataInfo,function(p,i){
$out+=' <div class="panel panel-default no-border" data-id="';
$out+=$escape(p.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='"> <div class="panel-heading border border-v1-grey"> <div class="row"> <div class="col-sm-6 p-l-none"> <a href="javascript:void(0);" data-action="expander"><span class="ic-open vertical-text-bottom m-l-sm m-r-sm"></span></a> <span>';
$out+=$escape(p.user.userName);
$out+='</span> </div> <div class="col-sm-6"> </div> </div> </div> <div class="panel-body no-padding no-borders of-auto"> <table class="tree table table-bordered m-b-none"> <thead> <tr> <th width="3%" class="b-r-none"> <div class="list-check-box"> <label class="i-checks fw-normal m-b-none"> <input name="taskAllCk" type="checkbox" /> <span class="i-checks-span"></span> </label> </div> </th> <th width="3%" class="b-r-none b-l-none"> <div class="list-action-box"> <div class="btn-group batchOperation" id="batchAllOperation"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="批量操作"> <span class="ic-operation-batch"></span> </button> <ul class="dropdown-menu"> <li> <a href="javascript:void(0);" class="" data-action="batchDelTask" data-canbedelete="">批量删除</a> </li> </ul> </div> </div> </th> <th width="25%" class="b-l-none"> <span>生产任务</span> </th> <th width="" class="w-100">任务状态</th> <th width="25%" >处理人</th> <th width="" class="w-100">开始时间</th> <th width="" class="w-100">结束时间</th> <th width="" >完成时间</th> </tr> </thead> <tbody> ';
if(p.taskList!=null && p.taskList.length>0){
$out+=' ';
$each(p.taskList,function(t,ti){
$out+=' ';
$out+=$string(_include('m_production/m_production_member_task_tracking_row',{t:t,tIndex:ti,projectId:projectId,projectNameCode:projectNameCode,currentCompanyUserId:currentCompanyUserId,dataCompanyId:dataCompanyId}));
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="8" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关任务</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="row no-data-tr"> <div class="text-center col-md-12"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无相关数据</span> </div> </div> </div> ';
}
$out+=' </form>';
return new String($out);
});/*v:1*/
template('m_production/m_production_member_task_tracking_row',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,t=$data.t,tIndex=$data.tIndex,projectId=$data.projectId,projectNameCode=$data.projectNameCode,dataCompanyId=$data.dataCompanyId,doType=$data.doType,_isNullOrBlank=$helpers._isNullOrBlank,_getStatusColor=$helpers._getStatusColor,$string=$utils.$string,_include=$helpers._include,userList=$data.userList,role=$data.role,currentCompanyUserId=$data.currentCompanyUserId,_momentFormat=$helpers._momentFormat,$out='';$out+='<tr class="m-production-content-row tree-box-tr treegrid-';
$out+=$escape(t.id);
$out+=' ';
if(t.taskPid!=null && t.taskPid!=''){
$out+=' treegrid-parent-';
$out+=$escape(t.taskPid);
$out+=' ';
}
$out+=' ';
$out+=$escape(t.completeDate==null?'':'complete-date-tr');
$out+=' " data-id="';
$out+=$escape(t.id);
$out+='" data-pid="';
$out+=$escape(t.taskPid);
$out+='" data-i="';
$out+=$escape(tIndex);
$out+='" data-path="';
$out+=$escape(t.taskPath);
$out+='"> <td class=" b-r-none p-t-9"> <div class="list-check-box"> <label class="i-checks fw-normal m-b-none"> <input name="taskCk" type="checkbox" data-is-can1="';
$out+=$escape(t.role.delete);
$out+='" /> <span class="i-checks-span"></span> </label> </div> </td> <td class="b-r-none b-l-none v-middle"> <div class="list-action-box"> ';
if(t.role && t.role.delete==1){
$out+=' <div class="btn-group singleOperation" style="display: none;"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"> <span class="ic-operation"></span> </button> <ul class="dropdown-menu pt-relative hide"> ';
if(t.role && t.role.delete==1){
$out+=' <li><a href="javascript:void(0);" data-action="delTask" data-canbedelete="">删除</a></li> ';
}
$out+=' </ul> </div> ';
}
$out+=' </div> </td> <td class="tree-td pt-relative p-r-none b-l-none" > <a href="#/project/production/details?id=';
$out+=$escape(projectId);
$out+='&projectName=';
$out+=$escape(projectNameCode);
$out+='&taskId=';
$out+=$escape(t.id);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='&fromType=';
$out+=$escape(doType);
$out+='" class="show-span task-name pt-relative" data-string="';
$out+=$escape(t.taskName);
$out+='" > ';
$out+=$escape(t.taskName);
$out+=' </a> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.taskName);
$out+='" data-key="taskName" data-placeholder="请输入任务名称" data-type="1" data-valid="1" data-max-length="50" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(t.taskType==0 && !_isNullOrBlank(t.endStatusName)){
$out+=' <button class="btn ';
$out+=$escape(_getStatusColor(t.endStatus));
$out+=' btn-rounded btn-status no-hover">';
$out+=$escape(t.endStatusName);
$out+='</button> ';
}else if(t.taskType!=0 && !_isNullOrBlank(t.endStatusName)){
$out+=' <button class="btn btn-default btn-rounded btn-status no-hover">';
$out+=$escape(t.stateHtml);
$out+='</button> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> ';
if(t.taskType==0 && t.role && t.role.changeStatus==1){
$out+=' <a href="javascript:void(0);" data-action="xeditableByClick" data-key="endStatus" data-value="';
$out+=$escape(t.endStatus);
$out+='" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}else if(t.taskType==3 && t.role && t.role.changeStatus==1){
$out+=' <a href="javascript:void(0);" data-action="stateFlow" data-end-status="';
$out+=$escape(t.endStatus);
$out+='" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td > <span class="show-span"> ';
$out+=$string(_include('m_production/m_production_users_display',{userList:t.handlerUser.userList,role:t.role.changeDesigner,currentCompanyUserId:currentCompanyUserId}));
$out+=' </span> ';
if(t.role && t.role.changeDesigner==1){
$out+=' <a href="javascript:void(0);" data-action="xeditableUser" data-key="handlerUser" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(t.role && t.role.edit==1){
$out+=' ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.startTime);
$out+='" data-type="10" data-key="startTime" data-max-date="';
$out+=$escape(t.endTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td class=""> <span class="show-span"> ';
if(t.role && t.role.edit==1){
$out+=' ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.endTime);
$out+='" data-type="10" data-key="endTime" data-min-date="';
$out+=$escape(t.startTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td class=""> <span> ';
if(t.completeDate!=null &&  t.completeDate!=''){
$out+=' ';
$out+=$escape(_momentFormat(t.completeDate,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </span> </td> </tr>';
return new String($out);
});/*v:1*/
template('m_production/m_production_professional_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,projectId=$data.projectId,projectNameCode=$data.projectNameCode,dataInfo=$data.dataInfo,dataCompanyId=$data.dataCompanyId,_isNullOrBlank=$helpers._isNullOrBlank,_momentFormat=$helpers._momentFormat,majorDesignRelationId=$data.majorDesignRelationId,stageDesignRelationId=$data.stageDesignRelationId,functionTypeRelationId=$data.functionTypeRelationId,_getPercentage=$helpers._getPercentage,$out='';$out+='<div class="ibox no-margins m-production-professional-details"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-12" id="breadcrumb"></div> </div> </div> <div class="ibox-content"> <div class="panel panel-default no-border"> <div class="panel-heading border border-v1-grey"> <div class="row"> <div class="col-sm-4"> <span>专业：</span> <a href="#/project/production/details?id=';
$out+=$escape(projectId);
$out+='&projectName=';
$out+=$escape(projectNameCode);
$out+='&taskId=';
$out+=$escape(dataInfo.task.id);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='" class="pt-relative text-ellipsis vertical-sub" data-container="body" data-toggle="tooltip" data-original-title=""> ';
$out+=$escape(dataInfo.task.taskName);
$out+=' </a> <span class="font-bold">订单负责人：</span> <span class="p-handler font-bold"> <span class="show-span"> ';
if(dataInfo.designer==null){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(dataInfo.designer.companyUserName);
$out+=' ';
}
$out+=' </span> ';
if(dataInfo.task.role && dataInfo.task.role.changeDesignerManager==1){
$out+=' <a href="javascript:void(0);" data-action="xeditableByHandlerUser" data-type="12" data-url-type="2" data-key="personInCharge" data-do-type="2" data-multiple="0" data-cookies="0" data-id="';
$out+=$escape(dataInfo.designer?dataInfo.designer.companyUserId:'');
$out+='" data-task-id="';
$out+=$escape(dataInfo.task.id);
$out+='" data-user-name="';
$out+=$escape(dataInfo.designer?dataInfo.designer.companyUserName:'');
$out+='" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </span> </div> <div class="col-sm-4 text-right"> <span> 开始时间： ';
if(!_isNullOrBlank(dataInfo.task.startTime)){
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.startTime,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </span> <span> 结束时间： ';
if(!_isNullOrBlank(dataInfo.task.endTime)){
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.endTime,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </span> </div> <div class="col-sm-2"> <a href="javascript:void(0);" class="font-bold ';
$out+=$escape(dataInfo.task.role && dataInfo.task.role.changeStatus==1?'':'a-span');
$out+='" data-action="';
$out+=$escape(dataInfo.task.role && dataInfo.task.role.changeStatus==1?'taskStateFlow':'');
$out+='" data-end-status="';
$out+=$escape(dataInfo.task.endStatus);
$out+='">  ';
if(dataInfo.task.endStatus ==3 || dataInfo.task.endStatus ==4){
$out+=' <span class="text-danger">';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}else if(dataInfo.task.endStatus ==2){
$out+=' <span class="text-success">';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}else{
$out+=' <span>';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}
$out+=' </a> </div> <div class="col-sm-2 text-right"> <a class="btn btn-dotted-default btn-xs" href="#/project/production/processSettings/list?id=';
$out+=$escape(projectId);
$out+='&projectName=';
$out+=$escape(projectNameCode);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='&processType=1&taskId=';
$out+=$escape(dataInfo.task.id);
$out+='&majorDesignRelationId=';
$out+=$escape(majorDesignRelationId);
$out+='&stageDesignRelationId=';
$out+=$escape(stageDesignRelationId);
$out+='&functionTypeRelationId=';
$out+=$escape(functionTypeRelationId);
$out+='" >流程设置</a> <a class="btn btn-dotted-default btn-xs" data-action="addProjectMember"><i class="fa fa-plus f-s-m" ></i>&nbsp;人员</a> </div> </div> </div> <div class="panel-body no-padding"> <div class="row dp-flex m-t"> <div class="col-sm-6"> <div class="bg-v3-grey p-sm full-height"> <div> <span class="icon-sm icon-append fa fa-calendar"></span> <span> ';
if(!_isNullOrBlank(dataInfo.task.startTime) || !_isNullOrBlank(dataInfo.task.endTime)){
$out+=' ';
if(!_isNullOrBlank(dataInfo.task.startTime)){
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.startTime,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' - ';
if(!_isNullOrBlank(dataInfo.task.endTime)){
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.endTime,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' ';
}
$out+=' </span> <span class="m-l-sm" >进度：';
$out+=$escape(_getPercentage(dataInfo.taskCompleteCount,dataInfo.taskCount));
$out+='%&nbsp;</span> <div class="progress dp-inline-block width-200 height-10 m-b-none "> <div style="width: ';
$out+=$escape(_getPercentage(dataInfo.taskCompleteCount,dataInfo.taskCount));
$out+='%" aria-valuemax="100" aria-valuemin="0" class="progress-bar"></div> </div> </div> <div class="row m-t-lg"> <div class="col-sm-4 text-center"> <span class="dp-block">任务数量</span> <span class="dp-block">';
$out+=$escape(dataInfo.taskCompleteCount);
$out+='/';
$out+=$escape(dataInfo.taskCount);
$out+='</span> </div> <div class="col-sm-4 text-center"> <span class="dp-block">图纸数量</span> <span class="dp-block">';
$out+=$escape(dataInfo.designFileCompleteCount);
$out+='/';
$out+=$escape(dataInfo.designFileCount);
$out+='</span> </div> <div class="col-sm-4 text-center"> <span class="dp-block">校审任务</span> <span class="dp-block">';
$out+=$escape(dataInfo.opinionCompleteCount);
$out+='/';
$out+=$escape(dataInfo.opinionCount);
$out+='</span> </div> </div> </div> </div> <div class="col-sm-6"> <div class="bg-v3-grey p-sm full-height"> <span>描述：</span> <p>根据各个专业情况，把相关任务图纸分配到个人手中，权责分明并及时更新图纸任务状况。</p> </div> </div> </div> <div class="tabs-container m-t"> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="false">任务</a></li> <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">图纸</a></li> <li class=""><a data-toggle="tab" href="#tab-3" aria-expanded="false">校审意见</a></li> <li class=""><a data-toggle="tab" href="#tab-4" aria-expanded="false">成员任务跟踪</a></li> <li class=""><a data-toggle="tab" href="#tab-5" aria-expanded="false">仪表盘</a></li> </ul> <div class="tab-content"> <div id="tab-1" class="tab-pane active" data-type="productionTask"> <div class="panel-body task-list-box"> </div> </div> <div id="tab-2" class="tab-pane" data-type="designFile"> <div class="panel-body"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div class="m-pagination pull-right "></div> </div> </div> </div> </div> <div id="tab-3" class="tab-pane" data-type="approvalOpinion"> <div class="panel-body"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div class="m-pagination pull-right "></div> </div> </div> </div> </div> <div id="tab-4" class="tab-pane" data-type="memberTaskTracking"> <div class="panel-body"> </div> </div> <div id="tab-5" class="tab-pane" data-type="dashBoard"> <div class="panel-body"> </div> </div> </div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_production/m_production_tab',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,tabList=$data.tabList,$each=$utils.$each,t=$data.t,ti=$data.ti,$escape=$utils.$escape,projectId=$data.projectId,projectName=$data.projectName,_url=$helpers._url,$out='';if(tabList && tabList.length>0){
$out+=' <div class="tabs-container pt-relative"> <ul class="nav nav-tabs" style="padding-right: 200px;"> ';
$each(tabList,function(t,ti){
$out+=' <li class="';
$out+=$escape(ti==0?'active':'');
$out+='" data-relation-id="';
$out+=$escape(t.taskRelationId);
$out+='"> <a class="text-ellipsis" data-toggle="tab" href="#tab-';
$out+=$escape(ti);
$out+='" data-i="';
$out+=$escape(ti);
$out+='" data-id="';
$out+=$escape(t.id);
$out+='" title="';
$out+=$escape(t.taskName);
$out+='"> ';
$out+=$escape(t.taskName);
$out+=' </a> </li> ';
});
$out+=' </ul> <div class="absolute-top-right"> <!--<button class="btn btn-primary" onclick="javascript:window.location.href=\'#/project/production/processSettings?id=';
$out+=$escape(projectId);
$out+='&projectName=';
$out+=$escape(projectName);
$out+='\'">流程设置</button>--> <button class="btn btn-primary" data-action="addProjectMember"><i class="fa fa-plus f-s-m" ></i>&nbsp;人员</button> </div> <div class="tab-content"> ';
$each(tabList,function(t,ti){
$out+=' <div id="tab-';
$out+=$escape(ti);
$out+='" class="tab-pane ';
$out+=$escape(ti==0?'active':'');
$out+='"> <div class="panel-body"> </div> </div> ';
});
$out+=' </div> </div> ';
}else{
$out+=' <div class="row no-data-tr"> <div class="text-center col-md-12"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关生产安排</span> </div> </div> </div> ';
}
return new String($out);
});/*v:1*/
template('m_production/m_production_users_display',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,userList=$data.userList,user=$data.user,$escape=$utils.$escape,currentCompanyUserId=$data.currentCompanyUserId,$each=$utils.$each,u=$data.u,ui=$data.ui,role=$data.role,$out='';if(userList!=null && userList.length>0){
$out+=' ';
if(user && user.userName){
$out+=' <span class="';
$out+=$escape(user.companyUserId == currentCompanyUserId?'text-navy':'');
$out+='">';
$out+=$escape(user.userName);
$out+='</span> ';
}
$out+=' ';
$each(userList,function(u,ui){
$out+=' ';
if(user && user.userName){
$out+=' ';
if(u.id!=user.id){
$out+=' ,<span>';
$out+=$escape(u.userName);
$out+='</span> ';
}
$out+=' ';
}else{
$out+=' ';
if(ui>0){
$out+=' ,<span>';
$out+=$escape(u.userName);
$out+='</span> ';
}else{
$out+=' <span>';
$out+=$escape(u.userName);
$out+='</span> ';
}
$out+=' ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' ';
if(role && role==1){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' <span class="fc-v1-grey">--</span> ';
}
$out+=' ';
}
return new String($out);
});/*v:1*/
template('m_project/m_editCustomPropertyTemp',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,projectPropertyData=$data.projectPropertyData,$each=$utils.$each,p=$data.p,$index=$data.$index,$escape=$utils.$escape,u=$data.u,$out='';$out+='<div class="m_editCustomPropertyTemp"> <div class="col-md-6"> <div class="ibox"> <div class="ibox-title no-borders p-h-sm min-h-50">数据模板</div> <div class="ibox-content border-darker-grey box-left"> <h4>模板标签库</h4> <div class="m-b-sm"> <label class="i-checks i-checks-label fw-normal"> <input name="allProjectFieldCK" type="checkbox" value="0"/> <span class="i-checks-span">全选</span> </label> </div> <div class="row"> ';
if(projectPropertyData.basicPropertyList!=null && projectPropertyData.basicPropertyList.length>0){
$out+=' ';
$each(projectPropertyData.basicPropertyList,function(p,$index){
$out+=' <div class="col-md-6 p-r-none"> <label class="i-checks i-checks-label fw-normal"> <input name="projectFieldCk" type="checkbox" value="';
$out+=$escape(p.id);
$out+='" data-field-name="';
$out+=$escape(p.fieldName);
$out+='" data-unit-name="';
$out+=$escape(p.unitName);
$out+='"/> <span class="i-checks-span"> ';
$out+=$escape(p.fieldName);
$out+='&nbsp; ';
$out+=$escape(p.unitName!=null&& p.unitName!=''?'('+p.unitName+')':'');
$out+=' </span> </label> </div> ';
});
$out+=' ';
}
$out+=' <div class="clearfix"></div> </div> <h4>自定义库</h4> <div class="row"> <form class="addPropertyForm"> <div class="col-md-6"> <input class="form-control p-r-none" type="text" name="fieldName"> </div> <div class="col-md-4 p-r-none p-l-none"> <!--<select class="form-control p-xxs" name="unitName"> <option value="">选择单位</option> ';
if(projectPropertyData.unitNameList!=null && projectPropertyData.unitNameList.length>0){
$out+=' ';
$each(projectPropertyData.unitNameList,function(u,$index){
$out+=' <option value="';
$out+=$escape(u);
$out+='">';
$out+=$escape(u);
$out+='</option> ';
});
$out+=' ';
}
$out+=' </select>--> <div class="input-group"> <input type="text" class="form-control" name="unitName" placeholder="请输入或选择" maxlength="8"> <div class="input-group-btn"> <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button> <ul class="dropdown-menu dropdown-menu-right" style="right: 0;left: inherit;max-height: 208px;overflow: auto;"> ';
if(projectPropertyData.unitNameList!=null && projectPropertyData.unitNameList.length>0){
$out+=' ';
$each(projectPropertyData.unitNameList,function(u,$index){
$out+=' ';
if(u!=null && u!=''){
$out+=' <li><a href="javascript:void(0);" style="padding:0px 20px;">';
$out+=$escape(u);
$out+='</a></li> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </ul> </div> </div> </div> <div class="col-md-2"> <button type="button" class="btn btn-primary btn-sm" data-action="addPropertyBtn">添加</button> </div> <div class="col-md-12"></div> <div class="clearfix"></div> </form> </div> <div class="row m-t-sm" id="customPropertyBox"> </div> </div> </div> </div> <div class="col-md-6"> <div class="ibox"> <div class="ibox-title no-borders p-h-sm min-h-50">已选择项 (拖拽进行调整顺序)</div> <div class="ibox-content border-darker-grey box-right"> <div class="row list-group" id="selectPropertyBox"> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project/m_editCustomPropertyTempAdd',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,customPropertyList=$data.customPropertyList,$each=$utils.$each,s=$data.s,si=$data.si,$escape=$utils.$escape,$out='';if(customPropertyList!=null && customPropertyList.length>0 ){
$out+=' ';
$each(customPropertyList,function(s,si){
$out+=' <div class="col-md-6 p-r-none m-b-xs"> <label class="i-checks i-checks-label fw-normal"> <input name="cusProjectFieldCk" type="checkbox" value="';
$out+=$escape(s.id);
$out+='" data-field-name="';
$out+=$escape(s.fieldName);
$out+='" data-unit-name="';
$out+=$escape(s.unitName);
$out+='"/> <span class="i-checks-span"> <span class=" property-span m-r-xs bg-muted p-xxs f-s-xs" > <span class="field-name text-ellipsis" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(s.fieldName);
$out+=' ';
$out+=$escape(s.unitName!=null&& s.unitName!=''?'('+s.unitName+')':'');
$out+='"> ';
$out+=$escape(s.fieldName);
$out+='&nbsp; ';
$out+=$escape(s.unitName!=null&& s.unitName!=''?'('+s.unitName+')':'');
$out+=' </span> <a class="curp" href="javascript:void(0)" data-id="';
$out+=$escape(s.id);
$out+='" data-index=';
$out+=$escape(si);
$out+=' data-field-name="';
$out+=$escape(s.fieldName);
$out+='" data-unit-name="';
$out+=$escape(s.unitName);
$out+='" data-action="delCusProperty"> <i class="fa fa-times fc-red"></i></a> </span> </span> </label> </div> ';
});
$out+=' ';
}
return new String($out);
});/*v:1*/
template('m_project/m_editCustomPropertyTempSelect',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,selectedPropertyList=$data.selectedPropertyList,$each=$utils.$each,s=$data.s,si=$data.si,$escape=$utils.$escape,$out='';if(selectedPropertyList!=null && selectedPropertyList.length>0 ){
$out+=' ';
$each(selectedPropertyList,function(s,si){
$out+=' <div class="col-md-6 p-r-none m-b list-group-item" data-sortId="';
$out+=$escape(si);
$out+='"> <span class=" property-span m-r-xs bg-muted p-xxs f-s-xs" > <span class="field-name text-ellipsis" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(s.fieldName);
$out+=' ';
$out+=$escape(s.unitName!=null&& s.unitName!=''?'('+s.unitName+')':'');
$out+='"> ';
$out+=$escape(s.fieldName);
$out+='&nbsp; ';
$out+=$escape(s.unitName!=null&& s.unitName!=''?'('+s.unitName+')':'');
$out+=' </span> <a class="curp" href="javascript:void(0)" data-id="';
$out+=$escape(s.id);
$out+='" data-field-name="';
$out+=$escape(s.fieldName);
$out+='" data-unit-name="';
$out+=$escape(s.unitName);
$out+='" data-action="delSelectedProperty"> <i class="fa fa-times fc-red"></i></a> </span> </div> ';
});
$out+=' ';
}
return new String($out);
});/*v:1*/
template('m_project/m_entryAddress',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,$detailAddress=$data.$detailAddress,$out='';$out+='<div class="selectRegionOBox no-borders p-b-none" style="width: 370px;"> <fieldset> <section> <div class="form-group m-b-xs col-md-12 p-r-none p-l-none" style="margin: 0 0 5px 0"> <label for="selectRegion">所在地区</label> <div class="input-group cityBox" id="selectRegion" name="selectRegion"> <div class="dp-inline-block"> <select class="prov form-control" name="province"></select> </div> <div class="dp-inline-block m-l-xs"> <select class="city form-control" name="city" disabled="disabled" style="display: none;"></select> </div> <div class="dp-inline-block m-l-xs"> <select class="dist form-control" name="county" disabled="disabled" style="display: none;"></select> </div> </div> </div> <div class="form-group m-b-xs col-md-12 p-r-none p-l-none" style="margin: 0 0 5px 0"> <label for="detailAddress">详细地址：</label> <input type="text" class="form-control" style="width: 100%;" name="detailAddress" id="detailAddress" maxlength="255" value="';
$out+=$escape($detailAddress);
$out+='"> </div> </section> </fieldset> <div class="col-md-12 m-b-xs p-r-none"> <button type="button" class="btn btn-default btn-sm m-popover-close pull-right "> <i class="glyphicon glyphicon-remove"></i> </button> <button type="button" class="btn btn-primary btn-sm m-popover-submit pull-right m-r-xs"> <i class="fa fa-check"></i> </button> <div class="clearfix"></div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project/m_projectBasicInfo',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,isView=$data.isView,doType=$data.doType,editFlag=$data.editFlag,project=$data.project,deleteFlag=$data.deleteFlag,$string=$utils.$string,_include=$helpers._include,updateProjectStatus=$data.updateProjectStatus,_momentFormat=$helpers._momentFormat,_isNullOrBlank=$helpers._isNullOrBlank,_expNumberFilter=$helpers._expNumberFilter,_isNull=$helpers._isNull,_expNumberDecimalFilter=$helpers._expNumberDecimalFilter,$out='';$out+='<div class="ibox m-projectBasicInfo ';
$out+=$escape(isView==true?'min-h':'');
$out+='"> <div class="ibox-title secondary-menu-outbox ';
$out+=$escape(isView==true?'hide':'');
$out+='"> <div class="row"> <div class="col-md-12" id="breadcrumb">  </div> </div> </div> <div class="ibox-content p-b-none no-borders"> <form class="sky-form no-margins"> <div class="row"> <div class="col-md-6"> <h4> 基本信息 </h4> </div> <div class="col-md-6 text-right"> ';
if(doType==1 && editFlag){
$out+=' ';
if(project.status==4){
$out+=' <a type="button" class="btn btn-primary btn-sm m-t-n-xs" data-action="publishProject"> ';
if(project.businessType==1){
$out+=' 发布项目信息 ';
}else{
$out+=' 发布课题信息 ';
}
$out+=' </a> ';
}
$out+=' ';
}
$out+=' ';
if(doType==1 && deleteFlag==1 && isView==false){
$out+=' <a class="btn btn-default btn-sm m-r-none m-t-n-xs fc-red" data-toggle="tooltip" data-placement="top" data-action="deleteProject" data-id="';
$out+=$escape(project.id);
$out+='" title="删除"><span> ';
if(project.businessType==1){
$out+=' 删除项目 ';
}else{
$out+=' 删除课题 ';
}
$out+=' </span> </a> ';
}
$out+=' </div> </div> <table class="table table-bordered info m-b-xs"> <tbody> ';
if(project.businessType==1){
$out+=' ';
$out+=$string(_include('m_project/m_projectBasicInfo_field_1',{project:project,updateProjectStatus:updateProjectStatus}));
$out+=' ';
}else{
$out+=' ';
$out+=$string(_include('m_project/m_projectBasicInfo_field_2',{project:project,updateProjectStatus:updateProjectStatus}));
$out+=' ';
}
$out+=' </tbody> </table> <div class="row"> <div class="col-md-6"> <h4 class="pull-left"> <span class="dp-block m-t-xs"> ';
$out+=$escape(project.businessType==1?'主合同信息':'课题研究信息');
$out+=' </span> </h4> </div> <div class="col-md-6 text-right p-b-xs"> </div> </div> <table class="table table-bordered info m-b-xs"> <tbody> <tr> <td width="12%"><b>';
$out+=$escape(project.businessType==1?'合同签订':'启动时间');
$out+='</b></td> <td width="37%"> ';
if(editFlag){
$out+=' <a href="javascript:void(0);" id="editSignDate" data-action="edit_signDate" class="editable editable-click ';
$out+=$escape((project.contractDate!=null && project.contractDate!='')?'':'unSign');
$out+='"> ';
if(project.contractDate!=null && project.contractDate!=''){
$out+=' ';
$out+=$escape(_momentFormat(project.contractDate,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' 未签订</a> ';
}
$out+=' ';
}else{
$out+=' <span>';
$out+=$escape(project.contractDate!=null && project.contractDate!=''?_momentFormat(project.contractDate,'YYYY/MM/DD'):'未签订');
$out+='</span> ';
}
$out+=' </td> <td width="12%"><b>';
$out+=$escape(project.businessType==1?'合同金额':'研究经费');
$out+='</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-placeholder="请输入合同金额" data-key="totalContractAmount" data-type="1" data-unit="元" data-value="';
$out+=$escape(project.totalContractAmount);
$out+='"> ';
if(!_isNullOrBlank(project.totalContractAmount+'')){
$out+=' ';
$out+=$escape(_expNumberFilter(project.totalContractAmount));
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> </tr> <tr> <td><b>';
$out+=$escape(project.businessType==1?'外协预算':'外部合作预算');
$out+='</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-placeholder="';
$out+=$escape(project.businessType==1?'请输入外协预算':'请输入外部合作预算');
$out+='" data-key="investmentEstimation" data-type="1" data-unit="元" data-value="';
$out+=$escape(project.investmentEstimation);
$out+='"> ';
if(!_isNull(project.investmentEstimation+'')){
$out+=' ';
$out+=$escape(_expNumberFilter(project.investmentEstimation));
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> <td><b>';
$out+=$escape(project.businessType==1?'外协率':'占比');
$out+='</b></td> <td> ';
if(!_isNull(project.investmentEstimationRatio)){
$out+=' ';
$out+=$escape(_expNumberDecimalFilter(project.investmentEstimationRatio));
$out+='% ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </td> </tr> </tbody> </table> <div class="row"> <div class="col-md-6"> <h4 class="pull-left"> <span class="dp-block m-t-xs"> 院内团队协同 </span> </h4> </div> <div class="col-md-6 text-right p-b-xs"> </div> <div class="col-sm-12" id="listTaskOrder"> </div> </div> <div class="row"> <div class="col-md-6"> <h4 class="pull-left"> <span class="dp-block m-t-xs"> ';
$out+=$escape(project.businessType==1?'外部协作单位':'外部合作单位');
$out+=' ';
if(doType==1 && editFlag){
$out+=' <a href="javascript:void(0);" data-action="editProjectPartner" title=" ';
$out+=$escape(project.businessType==1?'编辑外部协作单位':'编辑外部合作单位');
$out+='"> <i class="fa fa-pencil"></i> </a> ';
}
$out+=' </span> </h4> </div> <div class="col-md-6 text-right p-b-xs"> </div> <div class="col-sm-12" id="projectPartner"> </div> </div> <div class="row"> <div class="col-md-6"> <h4 class="pull-left"> <span class="dp-block m-t-xs"> ';
$out+=$escape(project.businessType==1?'项目进度':'课题进度');
$out+=' <!-- ';
if(doType==1 && editFlag){
$out+=' <a href="javascript:void(0);" data-action="editProjectProcess" title="编辑项目进度"> <i class="fa fa-pencil"></i> </a> ';
}
$out+='--> </span> </h4> </div> <div class="col-md-6 text-right p-b-xs"> </div> <div id="projectProcess"> </div> </div> <div class="row"> <div class="col-md-6"> <h4 class="pull-left"> <span class="dp-block m-t-xs"> ';
$out+=$escape(project.businessType==1?'项目动态':'课题动态');
$out+=' <a href="javascript:void(0);" class="roleControl" roleCode="10000604" flag="2" data-action="addProjectNotice" title="添加动态"> <i class="fa fa-plus"></i> </a> </span> </h4> </div> <div class="col-md-6 text-right p-b-xs"> </div> <div class="col-sm-12" id="projectNotice"> </div> </div> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project/m_projectBasicInfo_field_1',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,project=$data.project,updateProjectStatus=$data.updateProjectStatus,_isNullOrBlank=$helpers._isNullOrBlank,_momentFormat=$helpers._momentFormat,$out='';$out+='<tr> <td width="12%"> <b>项目名称</b> </td> <td width="37%"> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-placeholder="请输入项目名称" data-key="projectName" data-type="1" data-valid="1" data-value="';
$out+=$escape(project.projectName);
$out+='" data-role="';
$out+=$escape(project.auditFlag==1?0:1);
$out+='"> ';
$out+=$escape(project.projectName);
$out+=' </a> </td> <td width="12%"><b>项目状态</b></td> <td> <!-- <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-key="status" data-type="5" data-container-class="select-sm" data-value="';
$out+=$escape(project.projectStatus?project.projectStatus.valueId:'');
$out+='" data-role="';
$out+=$escape(project.status==4 || updateProjectStatus==0?0:1);
$out+='">--> ';
if(project.projectStatus && !_isNullOrBlank(project.projectStatus.content)){
$out+=' ';
$out+=$escape(project.projectStatus.content);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+='  </td> </tr> <tr> <td><b>项目类型</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-key="projectTypeId" data-type="5" data-container-class="select-sm" data-value="';
$out+=$escape(project.projectType?project.projectType.id:'');
$out+='" data-role="';
$out+=$escape(project.auditFlag==1?0:1);
$out+='"> ';
if(project.projectType && !_isNullOrBlank(project.projectType.content)){
$out+=' ';
$out+=$escape(project.projectType.content);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> <td><b>项目编号</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-placeholder="请输入项目编号" data-key="projectNo" data-type="1" data-value="';
$out+=$escape(project.projectNo?project.projectNo:'');
$out+='"> ';
if(!_isNullOrBlank(project.projectNo)){
$out+=' ';
$out+=$escape(project.projectNo);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> </tr> <tr> <td><b>所属公司</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="edit_projectZone" data-key="orgId" data-type="5" data-container-class="select-sm" data-value="';
$out+=$escape(project.projectZone?project.projectZone.id:'');
$out+='" data-role="';
$out+=$escape(project.auditFlag==1?0:1);
$out+='"> ';
if(project.projectZone && !_isNullOrBlank(project.projectZone.companyName)){
$out+=' ';
$out+=$escape(project.projectZone.companyName);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> <td><b>立项时间</b></td> <td> <a href="javascript:void(0);" id="editProjectCreateDate" data-action="edit_projectCreateDate" class="editable editable-click"> ';
if(project.projectCreateDate){
$out+=' ';
$out+=$escape(_momentFormat(project.projectCreateDate,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> </tr> <tr> <td><b>分管院长</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="edit_projectDean" data-key="companyUserId" data-type="5" data-container-class="select-sm" data-value="';
$out+=$escape(project.projectDean?project.projectDean.companyUserId:'');
$out+='" data-role="';
$out+=$escape(project.auditFlag==1?0:1);
$out+='"> ';
if(project.projectDean && !_isNullOrBlank(project.projectDean.companyUserName)){
$out+=' ';
$out+=$escape(project.projectDean.companyUserName);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> <td><b>项目负责人</b></td> <td> <span id="designManagerBox"> </span> </td> </tr> <tr> <td><b>所属组</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-key="companyId" data-type="1" data-valid="1" data-container-class="select-sm" data-value="';
$out+=$escape(project.creatorCompany?project.creatorCompany.companyName:'');
$out+='" data-id="';
$out+=$escape(project.creatorCompany?project.creatorCompany.id:'');
$out+='"> ';
if(project.creatorCompany && !_isNullOrBlank(project.creatorCompany.companyName)){
$out+=' ';
$out+=$escape(project.creatorCompany.companyName);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> <td><b>甲方</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-placeholder="请输入甲方名称，多个请用“/”隔开" data-key="constructCompany" data-type="1" data-value="';
$out+=$escape(project.constructCompany?project.constructCompany:'');
$out+='"> ';
if(!_isNullOrBlank(project.constructCompany)){
$out+=' ';
$out+=$escape(project.constructCompany);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> </tr> <tr> <td><b>创新技术委员会审核</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-key="isAudit" data-type="5" data-container-class="select-sm" data-value="';
$out+=$escape(project.isAudit!=null?project.isAudit:'');
$out+='"> ';
if(project.isAudit==1){
$out+=' 是 ';
}else{
$out+=' 否 ';
}
$out+=' </a> </td> <td><b>乙方</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-placeholder="请输入乙方名称，多个请用“/”隔开" data-key="companyBid" data-type="6" data-value="';
$out+=$escape(project.companyBid?project.companyBid:'');
$out+='"> ';
if(!_isNullOrBlank(project.companyBid)){
$out+=' ';
$out+=$escape(project.companyBid);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> </tr> <tr> <td><b>项目所在地</b></td> <td colspan="3"> <span> ';
if(project.auditFlag==1){
$out+=' ';
if(project.projectLocation!=null){
$out+=' ';
if(project.projectLocation.province && project.projectLocation.province!=''){
$out+=' ';
$out+=$escape(project.projectLocation.province);
$out+='&nbsp;&nbsp; ';
}
$out+=' ';
if(project.projectLocation.city && project.projectLocation.city!=''){
$out+=' ';
$out+=$escape(project.projectLocation.city);
$out+='&nbsp;&nbsp; ';
}
$out+=' ';
if(project.projectLocation.county && project.projectLocation.county!=''){
$out+=' ';
$out+=$escape(project.projectLocation.county);
$out+='&nbsp;&nbsp; ';
}
$out+=' ';
if(project.projectLocation.detailAddress && project.projectLocation.detailAddress!=''){
$out+=' ';
$out+=$escape(project.projectLocation.detailAddress);
$out+=' ';
}
$out+=' ';
}
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable editable-click" data-action="edit_address" data-valid="1" id="address" data-original-title title> ';
if(project.projectLocation!=null){
$out+=' ';
if(project.projectLocation.province && project.projectLocation.province!=''){
$out+=' ';
$out+=$escape(project.projectLocation.province);
$out+='&nbsp;&nbsp; ';
}
$out+=' ';
if(project.projectLocation.city && project.projectLocation.city!=''){
$out+=' ';
$out+=$escape(project.projectLocation.city);
$out+='&nbsp;&nbsp; ';
}
$out+=' ';
if(project.projectLocation.county && project.projectLocation.county!=''){
$out+=' ';
$out+=$escape(project.projectLocation.county);
$out+='&nbsp;&nbsp; ';
}
$out+=' ';
if(project.projectLocation.detailAddress && project.projectLocation.detailAddress!=''){
$out+=' ';
$out+=$escape(project.projectLocation.detailAddress);
$out+=' ';
}
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </span> </td> </tr> ';
return new String($out);
});/*v:1*/
template('m_project/m_projectBasicInfo_field_2',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,project=$data.project,updateProjectStatus=$data.updateProjectStatus,_isNullOrBlank=$helpers._isNullOrBlank,_momentFormat=$helpers._momentFormat,$out='';$out+='<tr> <td width="12%"> <b>创新研究</b> </td> <td width="37%"> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-placeholder="请输入创新研究" data-key="projectName" data-type="1" data-valid="1" data-value="';
$out+=$escape(project.projectName);
$out+='" data-role="';
$out+=$escape(project.auditFlag==1?0:1);
$out+='"> ';
$out+=$escape(project.projectName);
$out+=' </a> </td> <td width="12%"><b>课题状态</b></td> <td> <!--<a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-key="status" data-type="5" data-container-class="select-sm" data-value="';
$out+=$escape(project.projectStatus?project.projectStatus.valueId:'');
$out+='" data-role="';
$out+=$escape(project.status==4 || updateProjectStatus==0?0:1);
$out+='">--> ';
if(project.projectStatus && !_isNullOrBlank(project.projectStatus.content)){
$out+=' ';
$out+=$escape(project.projectStatus.content);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+='  </td> </tr> <tr> <td><b>课题类型</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-key="projectTypeId" data-type="5" data-container-class="select-sm" data-value="';
$out+=$escape(project.projectType?project.projectType.id:'');
$out+='" data-role="';
$out+=$escape(project.auditFlag==1?0:1);
$out+='"> ';
if(project.projectType && !_isNullOrBlank(project.projectType.content)){
$out+=' ';
$out+=$escape(project.projectType.content);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> <td><b>课题编号</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-placeholder="请输入课题编号" data-key="projectNo" data-type="1" data-value="';
$out+=$escape(project.projectNo?project.projectNo:'');
$out+='"> ';
if(!_isNullOrBlank(project.projectNo)){
$out+=' ';
$out+=$escape(project.projectNo);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> </tr> <tr> <td><b>所属公司</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="edit_projectZone" data-key="orgId" data-type="5" data-container-class="select-sm" data-value="';
$out+=$escape(project.projectZone?project.projectZone.id:'');
$out+='" data-role="';
$out+=$escape(project.auditFlag==1?0:1);
$out+='"> ';
if(project.projectZone && !_isNullOrBlank(project.projectZone.companyName)){
$out+=' ';
$out+=$escape(project.projectZone.companyName);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> <td><b>立项时间</b></td> <td> <a href="javascript:void(0);" id="editProjectCreateDate" data-action="edit_projectCreateDate" class="editable editable-click"> ';
if(project.projectCreateDate){
$out+=' ';
$out+=$escape(_momentFormat(project.projectCreateDate,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> </tr> <tr> <td><b>分管院长</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="edit_projectDean" data-key="companyUserId" data-type="5" data-container-class="select-sm" data-value="';
$out+=$escape(project.projectDean?project.projectDean.companyUserId:'');
$out+='" data-role="';
$out+=$escape(project.auditFlag==1?0:1);
$out+='"> ';
if(project.projectDean && !_isNullOrBlank(project.projectDean.companyUserName)){
$out+=' ';
$out+=$escape(project.projectDean.companyUserName);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> <td><b>项目负责人</b></td> <td> <span id="designManagerBox"> </span> </td> </tr> <tr> <td><b>所属组</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-key="companyId" data-type="1" data-valid="1" data-container-class="select-sm" data-value="';
$out+=$escape(project.creatorCompany?project.creatorCompany.companyName:'');
$out+='" data-id="';
$out+=$escape(project.creatorCompany?project.creatorCompany.id:'');
$out+='"> ';
if(project.creatorCompany && !_isNullOrBlank(project.creatorCompany.companyName)){
$out+=' ';
$out+=$escape(project.creatorCompany.companyName);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> <td><b>甲方</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-placeholder="请输入甲方名称，多个请用“/”隔开" data-key="constructCompany" data-type="1" data-value="';
$out+=$escape(project.constructCompany?project.constructCompany:'');
$out+='"> ';
if(!_isNullOrBlank(project.constructCompany)){
$out+=' ';
$out+=$escape(project.constructCompany);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> </tr> <tr> <td><b>课题所在地</b></td> <td> <span> ';
if(project.auditFlag==1){
$out+=' ';
if(project.projectLocation!=null){
$out+=' ';
if(project.projectLocation.province && project.projectLocation.province!=''){
$out+=' ';
$out+=$escape(project.projectLocation.province);
$out+='&nbsp;&nbsp; ';
}
$out+=' ';
if(project.projectLocation.city && project.projectLocation.city!=''){
$out+=' ';
$out+=$escape(project.projectLocation.city);
$out+='&nbsp;&nbsp; ';
}
$out+=' ';
if(project.projectLocation.county && project.projectLocation.county!=''){
$out+=' ';
$out+=$escape(project.projectLocation.county);
$out+='&nbsp;&nbsp; ';
}
$out+=' ';
if(project.projectLocation.detailAddress && project.projectLocation.detailAddress!=''){
$out+=' ';
$out+=$escape(project.projectLocation.detailAddress);
$out+=' ';
}
$out+=' ';
if( (project.projectLocation.province==''|| project.projectLocation.province==null)
                 &&(project.projectLocation.city==''|| project.projectLocation.city==null)
               &&(project.projectLocation.county==''|| project.projectLocation.county==null)){
$out+=' -- ';
}
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable editable-click" data-action="edit_address" id="address" data-original-title title> ';
if(project.projectLocation!=null){
$out+=' ';
if(project.projectLocation.province && project.projectLocation.province!=''){
$out+=' ';
$out+=$escape(project.projectLocation.province);
$out+='&nbsp;&nbsp; ';
}
$out+=' ';
if(project.projectLocation.city && project.projectLocation.city!=''){
$out+=' ';
$out+=$escape(project.projectLocation.city);
$out+='&nbsp;&nbsp; ';
}
$out+=' ';
if(project.projectLocation.county && project.projectLocation.county!=''){
$out+=' ';
$out+=$escape(project.projectLocation.county);
$out+='&nbsp;&nbsp; ';
}
$out+=' ';
if(project.projectLocation.detailAddress && project.projectLocation.detailAddress!=''){
$out+=' ';
$out+=$escape(project.projectLocation.detailAddress);
$out+=' ';
}
$out+=' ';
if( (project.projectLocation.province==''|| project.projectLocation.province==null)
                     &&(project.projectLocation.city==''|| project.projectLocation.city==null)
                     &&(project.projectLocation.county==''|| project.projectLocation.county==null)){
$out+=' -- ';
}
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </a> ';
}
$out+=' </span> </td> <td><b>乙方</b></td> <td> <a href="javascript:void(0);" class="editable-click" data-action="xeditable" data-placeholder="请输入乙方名称，多个请用“/”隔开" data-key="companyBid" data-type="6" data-value="';
$out+=$escape(project.companyBid?project.companyBid:'');
$out+='"> ';
if(!_isNullOrBlank(project.companyBid)){
$out+=' ';
$out+=$escape(project.companyBid);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </a> </td> </tr> ';
return new String($out);
});/*v:1*/
template('m_project/m_projectMenu',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,projectName=$data.projectName,dataCompanyId=$data.dataCompanyId,businessType=$data.businessType,fileId=$data.fileId,projectOperator=$data.projectOperator,$out='';$out+='<ul class="nav nav-third-level collapse in project-second-menu"> <li> <a id="basicInfo" href="#/project/basicInfo?id=';
$out+=$escape(id);
$out+='&projectName=';
$out+=$escape(projectName);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='&businessType=';
$out+=$escape(businessType);
$out+='"> <span>基本信息</span> </a> <input type="hidden" id="projectFileId" value="';
$out+=$escape(fileId);
$out+='"/> </li> ';
if(projectOperator.issueModule==1){
$out+=' <li class="roleControl" roleCode="2001" flag="2"> <a id="taskIssue" href="#/project/taskIssue?id=';
$out+=$escape(id);
$out+='&projectName=';
$out+=$escape(projectName);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='&businessType=';
$out+=$escape(businessType);
$out+='"> <span>工作内容</span> </a> </li> ';
}
$out+=' ';
if(projectOperator.productModule==1){
$out+=' <li class="roleControl" roleCode="2002" flag="2"> <a id="production" href="#/project/production?id=';
$out+=$escape(id);
$out+='&projectName=';
$out+=$escape(projectName);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='&businessType=';
$out+=$escape(businessType);
$out+='"> <span>任务分配</span> </a> </li> ';
}
$out+=' ';
if(projectOperator.paymentModule==1 || projectOperator.receiveModule==1 || projectOperator.payModule==1 ){
$out+=' <li class="roleControl" roleCode="2003" flag="2"> <a id="cost" href="#/project/cost?id=';
$out+=$escape(id);
$out+='&projectName=';
$out+=$escape(projectName);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='&businessType=';
$out+=$escape(businessType);
$out+='"> <span>费用管理</span> </a> </li> ';
}
$out+=' <!--';
if(projectOperator.projectDocModule==1){
$out+=' <li> <a id="projectDocumentLib" href="#/project/projectDocumentLib?id=';
$out+=$escape(id);
$out+='&projectName=';
$out+=$escape(projectName);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='" > 项目文档 </a> </li> ';
}
$out+='--> ';
if(projectOperator.projectMemberModule==1){
$out+=' <li class="roleControl" roleCode="2004" flag="2"> <a id="projectMember" href="#/project/projectMember?id=';
$out+=$escape(id);
$out+='&projectName=';
$out+=$escape(projectName);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='&businessType=';
$out+=$escape(businessType);
$out+='"> <span>工作效能</span> </a> </li> ';
}
$out+=' </ul> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$string=$utils.$string,_isNullOrBlank=$helpers._isNullOrBlank,_momentFormat=$helpers._momentFormat,$out='';$out+='<div class="ibox m-task-issue-details no-margins"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-12" id="breadcrumb"></div> </div> </div> <div class="ibox-content no-padding"> <div class="row no-margins p-t-xs"> <div class="col-sm-8 p-t-xs"> <span class="font-bold">  ';
$out+=$escape(dataInfo.project.projectName);
$out+=' </span> </div> <div class="col-sm-4 text-right"> <a href="javascript:;" data-action="returnBack" class="btn btn-default">返回</a> </div> </div> <div class="border-bottom m-t-xs"></div> <div class=""> <div class="col-md-9 p-t-sm p-l p-r-none border-right" id="leftBox"> <div class="tabs-container m-t"> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-4" aria-expanded="false">项目描述</a></li> <li class=""><a data-toggle="tab" href="#tab-3" aria-expanded="false">变更历史</a></li> </ul> <div class="tab-content"> <div id="tab-4" class="tab-pane active"> <div class="panel-body"> <form class="form-horizontal details-edit"> <div class="form-group "> <label class="col-sm-12"> 描 述： <a href="javascript:void(0);" data-action="xeditable" data-type="11" data-key="projectRemark" data-target-ele="#task-remark-edit" data-is-picture="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </label> <div class="col-sm-12"> <div class="show-span">';
$out+=$string(dataInfo.project.projectRemark);
$out+='</div> <div id="task-remark-edit"></div> </div> </div> </form> </div> </div> <div id="tab-3" class="tab-pane" data-type="changeHistory"> <div class="panel-body"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> </div> </div> </div> <div class="col-md-3 p-t-sm" id="rightBox"> <h4 class="title-line m-b-sm">基本信息</h4> <div class="row m-b-sm"> <label class="col-sm-5">项目状态：</label> <div class="col-sm-7">  ';
if(dataInfo.project.status =='0' ){
$out+=' <span class="">进行中</span> ';
}else if(dataInfo.project.status =='1' ){
$out+=' <span class="text-danger">已暂停</span> ';
}else if(dataInfo.project.status =='2'){
$out+=' <span class="text-success">已完成</span> ';
}else if(dataInfo.project.status =='3'){
$out+=' <span class="text-danger">已终止</span> ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">项目编号：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.project.projectNo);
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">项目类型：</label> <div class="col-sm-7"> ';
if(dataInfo.project.projectType && !_isNullOrBlank(dataInfo.project.projectType.content)){
$out+=' ';
$out+=$escape(dataInfo.project.projectType.content);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">所属公司：</label> <div class="col-sm-7"> ';
if(dataInfo.project.projectZone && !_isNullOrBlank(dataInfo.project.projectZone.companyName)){
$out+=' ';
$out+=$escape(dataInfo.project.projectZone.companyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">立项时间：</label> <div class="col-sm-7"> ';
$out+=$escape(_momentFormat(dataInfo.project.projectCreateDate,'YYYY/MM/DD'));
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">分管院长：</label> <div class="col-sm-7"> ';
if(dataInfo.project.projectDean && !_isNullOrBlank(dataInfo.project.projectDean.companyUserName)){
$out+=' ';
$out+=$escape(dataInfo.project.projectDean.companyUserName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">立项人：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.project.projectCreator?dataInfo.project.projectCreator.companyUserName:'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">所属组：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.project.creatorCompany?dataInfo.project.creatorCompany.companyName:'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">甲方：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.project.constructCompany?dataInfo.project.constructCompany:'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">乙方：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.project.companyBid?dataInfo.project.companyBid:'--');
$out+=' </div> </div> </div> <div class="clearfix"></div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_details_content_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,p=$data.p,$each=$utils.$each,t=$data.t,ti=$data.ti,$string=$utils.$string,_include=$helpers._include,tIndex=$data.tIndex,tLength=$data.tLength,projectId=$data.projectId,projectNameCode=$data.projectNameCode,doType=$data.doType,dataCompanyId=$data.dataCompanyId,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<table class="table table-bordered no-borders m-b-none"> <thead> <tr> <th width="50%" class="b-l-none"> <span>项目/子项</span> </th> <th width="18%" >开始时间</th> <th width="18%" >结束时间</th> <th width="14%" >任务状态</th> </tr> </thead> <tbody> ';
if(p.childList!=null && p.childList.length>0){
$out+=' ';
$each(p.childList,function(t,ti){
$out+=' ';
$out+=$string(_include('m_project/m_project_details_content_row',{t:t,tIndex:ti,tLength:p.childList.length,p:p,projectId:projectId,projectNameCode:projectNameCode,doType:doType,dataCompanyId:dataCompanyId}));
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="4" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关项目/子项</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_project/m_project_details_content_row',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,t=$data.t,tIndex=$data.tIndex,projectId=$data.projectId,projectNameCode=$data.projectNameCode,dataCompanyId=$data.dataCompanyId,_isNullOrBlank=$helpers._isNullOrBlank,_momentFormat=$helpers._momentFormat,$out='';$out+='<tr class="content-row " data-id="';
$out+=$escape(t.id);
$out+='" data-i="';
$out+=$escape(tIndex);
$out+='" data-pid="';
$out+=$escape(t.taskPid);
$out+='" data-company-id="';
$out+=$escape(t.companyId);
$out+='" data-publish-id="';
$out+=$escape(t.publishId);
$out+='"> <td class="b-l-none pt-relative"> <a href="#/project/taskIssue/details?id=';
$out+=$escape(projectId);
$out+='&projectName=';
$out+=$escape(projectNameCode);
$out+='&taskId=';
$out+=$escape(t.id);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='" class="show-span task-name pt-relative" data-string="';
$out+=$escape(t.taskName);
$out+='" > ';
$out+=$escape(t.taskName);
$out+=' </a> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.taskName);
$out+='" data-key="taskName" data-placeholder="请输入项目/子项名称" data-type="1" data-valid="1" data-max-length="50" style="display: none;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td class=""> <span class="show-span"> ';
if(t.role && t.role.edit==1){
$out+=' ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.startTime);
$out+='" data-type="10" data-key="startTime" data-max-date="';
$out+=$escape(t.endTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="display: none;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td class=""> <span class="show-span"> ';
if(t.role && t.role.edit==1){
$out+=' ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.endTime);
$out+='" data-type="10" data-key="endTime" data-min-date="';
$out+=$escape(t.startTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="display: none;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <a href="javascript:void(0);" class="';
$out+=$escape(t.role && t.role.changeStatus==1?'':'a-span');
$out+='" data-action="';
$out+=$escape(t.role && t.role.changeStatus==1?'stateFlow':'');
$out+='" data-end-status="';
$out+=$escape(t.endStatus);
$out+='">  ';
if(t.endStatus ==3 || t.endStatus ==4){
$out+=' <span class="text-danger">';
$out+=$escape(t.stateHtml);
$out+='</span> ';
}else if(t.endStatus ==2){
$out+=' <span class="text-success">';
$out+=$escape(t.stateHtml);
$out+='</span> ';
}else{
$out+=' <span>';
$out+=$escape(t.stateHtml);
$out+='</span> ';
}
$out+=' </a> </td> </tr>';
return new String($out);
});/*v:1*/
template('m_project/m_project_details_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,title=$data.title,dataInfo=$data.dataInfo,$out='';$out+='<div class="row"> <div class="col-md-9"> <form class="form-horizontal m-task-issue-edit"> <div class="form-group "> <div class="col-sm-12 row-edit-item"> <input placeholder="请输入';
$out+=$escape(title);
$out+='名称" class="form-control" type="text" name="projectName" disabled value="';
$out+=$escape(dataInfo?dataInfo.projectName:'');
$out+='"> </div> </div> <div class="form-group"> <div class="col-sm-12" id="remarkEditor"> </div> </div> <div class="form-group m-t-sm"> <div class="col-sm-12"> <button class="btn btn-primary" data-action="submit">提交</button> <button class="btn btn-default" data-action="cancel">取消</button> </div> </div> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_dynamics',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 信息动态 </li> <li class="active fa fa-angle-right"> <strong>动态快讯</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <form role="form" class="form-horizontal filter-form"> <div class="row" id="filterBox"> <div class="col-md-12"> <div class=""> <label class="inline">项目类型：</label> <select class="from-control inline" name="projectTypeId"></select> </div> </div> <div class="col-md-12 m-t-xs"> <div class=""> <label class="inline">所属公司：</label> <select class="from-control inline" name="orgId"></select> </div> </div> <div class="col-md-12 m-t-xs" id="timeSelect"> </div> <div class="col-md-12 m-t-xs"> <div class=""> <label class="inline">搜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;索：</label> <input class="form-control input-sm width-300 inline v-middle" type="text" name="keyword" placeholder="请输入关键字"> </div> </div> <div class="col-md-12 m-t" style="padding-right:5%"> <div class=" col-md-8 border-bottom p-b-sm" style="padding-left: 0px"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> <div class=" col-md-4 border-bottom p-b-sm text-right" style="padding-right: 0px;" > <button class="btn btn-primary" data-action="exportDetails">导出</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> </div> </div> </form> <div class="m-project-dynamics p-t-sm"> <div id="vertical-timeline" class="vertical-container dark-timeline center-orientation"> <div class="project-notice"> </div> </div> <div class="margin-bottom-30 m-t-xl no-data text-center" style="display: none;"> <div class=""> <img src="';
$out+=$escape(_url('/img/default/without_message.png'));
$out+='"> </div> <span class="fc-dark-blue p-l-md">暂无动态</span> </div> <div class="row margin-bottom-30"> <div class="col-md-12 text-center m-t-sm"> <button class="btn btn-default btn-xs" data-action="btnPageNext" href="javascript:void(0)" style="display: none;">加载更多</button> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_dynamics_all',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 信息动态 </li> <li class="active fa fa-angle-right"> <strong>动态总览</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <form role="form" class="form-horizontal filter-form"> <div class="row" id="filterBox"> <div class="col-md-12 m-t-xs" id="timeSelect"> </div> <div class="col-md-12 m-t-xs"> <div class=""> <label class="inline">搜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;索：</label> <input class="form-control input-sm width-300 inline v-middle" type="text" name="keyword" placeholder="请输入关键字"> </div> </div> <div class="col-md-12 m-t border-bottom" style="margin-left: 1%;width: 94%;padding: 0px;"> <div class=" col-md-8 p-b-sm" style="padding-left: 0px"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> <div class=" col-md-4 p-b-sm text-right" style="padding-right: 0px;"> <button class="btn btn-primary roleControl" roleCode="10000611" flag="2" data-action="addDynamicsNotice">添加动态</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class=" col-md-9 filter-result-col "> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> </div> </div> </form> <div class="m-project-dynamics p-t-sm"> <div id="vertical-timeline" class="vertical-container dark-timeline center-orientation"> <div class="project-notice"> </div> </div> <div class="margin-bottom-30 m-t-xl no-data text-center" style="display: none;"> <div class=""> <img src="';
$out+=$escape(_url('/img/default/without_message.png'));
$out+='"> </div> <span class="fc-dark-blue p-l-md">暂无动态</span> </div> <div class="row margin-bottom-30"> <div class="col-md-12 text-center m-t-sm"> <button class="btn btn-default btn-xs" data-action="btnPageNext" href="javascript:void(0)" style="display: none;">加载更多</button> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_dynamics_all_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,$out='';$each(dataList,function(p,$index){
$out+=' <div class="vertical-timeline-block" data-id="';
$out+=$escape(p.id);
$out+='" data-action="fileAction" data-src="';
$out+=$escape(p.fileFullPath);
$out+='"> <div class="vertical-timeline-icon navy-bg"> <i class="fa fa-comments"></i> </div> <div class="vertical-timeline-content"> <h4 data-value="';
$out+=$escape(p.content);
$out+='"> ';
$out+=$escape(p.content);
$out+=' <a href="javascript:void(0);" class="pull-right roleControl" roleCode="10000611" flag="2" data-action="editDynamicsNotice" data-id="';
$out+=$escape(p.id);
$out+='" title="编辑动态" style="display: none;"> <i class="fa fa-pencil"></i> </a> <a href="javascript:void(0);" class="pull-right m-r-xs roleControl" roleCode="10000611" flag="2" data-action="delDynamicsNotice" data-id="';
$out+=$escape(p.id);
$out+='" title="删除动态" style="display: none;"> <i class="fa fa-times"></i> </a> </h4> <div class="row"> <div class="col-sm-12"><span class="fc-dark-gray">';
$out+=$escape(_momentFormat(p.createDate,'YYYY/MM/DD'));
$out+='</span></div> </div> </div> </div> ';
});
$out+=' ';
return new String($out);
});/*v:1*/
template('m_project/m_project_dynamics_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fileName=$data.fileName,$escape=$utils.$escape,fileId=$data.fileId,fileFullPath=$data.fileFullPath,$out='';$out+='<form class="form-horizontal m_cost_collectionPlan_add m "> <div class="form-group "> <label class="col-sm-2 control-label">动态名称 <span class="fc-red">*</span></label> <div class="col-sm-10"> <input placeholder="请输入动态名称" class="form-control" type="text" name="remark" style="width: 100%;display: inline-block;"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">动态文件 <span class="fc-red">*</span></label> <div class="col-sm-10"> <div class="row" > <div class="col-md-12 m-t-xs"> <span id="showFileLoading"> ';
if(fileName){
$out+=' <span class="label m-r-xs m-b-xs" style="background: #ecf0f1;padding: 5px 10px;display: inline-block;"> <a href="javascript:void(0)" data-action="preview" data-net-file-id="';
$out+=$escape(fileId);
$out+='" data-src="';
$out+=$escape(fileFullPath);
$out+='" data-name="';
$out+=$escape(fileName);
$out+='" name="fileName" data-type=""> ';
$out+=$escape(fileName);
$out+=' </a> </span> ';
}
$out+=' </span> </div> <div class="col-md-12"> <a href="javascript:void(0)" id="filePicker" data-action="recordAttach" class="upload-icon vertical-top m-t-xxs dp-inline-block" title="请上传动态文件"></a> </div> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_dynamics_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,$out='';$each(dataList,function(p,$index){
$out+=' <div class="vertical-timeline-block" data-id="';
$out+=$escape(p.id);
$out+='"> <div class="vertical-timeline-icon navy-bg"> <i class="fa fa-comments"></i> </div> <div class="vertical-timeline-content"> <h4 data-value="';
$out+=$escape(p.noticeTitle);
$out+='"> ';
$out+=$escape(p.noticeTitle);
$out+=' </h4> <p class="noticeContent"> ';
$out+=$escape(p.noticeContent);
$out+=' </p> <div class="row"> <div class="col-sm-4"><span class="fc-dark-gray">';
$out+=$escape(_momentFormat(p.noticePublishdate,'YYYY/MM/DD'));
$out+='</span></div> <div class="col-sm-8 text-right"> <span class="fc-dark-gray m-r-xs">';
$out+=$escape(p.projectName);
$out+='</span> <span class="fc-dark-gray m-r-xs"> ';
$out+=$escape(p.businessType==1?'项目类型':'课题组');
$out+='：';
$out+=$escape(p.projectTypeName);
$out+='</span> <span class="fc-dark-gray m-r-xs">所属公司：';
$out+=$escape(p.orgName);
$out+='</span> <span class="fc-dark-gray m-r-xs">发布者：';
$out+=$escape(p.userName);
$out+='</span> </div> </div> </div> </div> ';
});
$out+=' ';
return new String($out);
});/*v:1*/
template('m_project/m_project_manager_settings',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,isDialog=$data.isDialog,$out='';$out+='<div class="m-project-manager-settings ';
$out+=$escape(isDialog?'p-sm':'');
$out+='"> <form class="form-horizontal" id="fieldForm"> <div class="form-group"> <label class="col-24-md-3 control-label p-r-none"> 商务秘书<span class="fc-red">*</span>： </label> <div class="col-24-md-21"> <select class="form-control" name="operatorManager"></select> </div> </div>  <div class="form-group"> <label class="col-24-md-3 control-label p-r-none"> 项目负责人<span class="fc-red">*</span>： </label> <div class="col-24-md-21"> <select class="form-control" name="designManager"></select> </div> </div>  </form> </div> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_notice',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="m-project-notice"> <div id="vertical-timeline" class="vertical-container dark-timeline center-orientation" style="width: 50%;margin-left: 110px;"> <div class="project-notice"> </div> </div> <div class="margin-bottom-30 m-t-xl no-data text-center v-middle" style="display: none;"> <div class=""> <img src="';
$out+=$escape(_url('/img/default/without_message.png'));
$out+='"> </div> <span class="fc-dark-blue ">暂无动态</span> </div> <div class="row margin-bottom-30"> <div class="col-md-6 text-center m-t-sm"> <a class="btn btn-default btn-xs" data-action="btnPageNext" href="javascript:void(0)" style="display: none;">加载更多</a> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_notice_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,noticeTitle=$data.noticeTitle,_momentFormat=$helpers._momentFormat,noticePublishdate=$data.noticePublishdate,noticeContent=$data.noticeContent,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-md-2 control-label">标题:</label> <div class="col-md-10"> <input class="form-control" name="noticeTitle" maxlength="300" value="';
$out+=$escape(noticeTitle);
$out+='" type="text"> </div> </div> <div class="form-group"> <label class="col-md-2 control-label">时间:</label> <div class="col-md-10"> <div class="input-group"> <input type="text" class="form-control" name="noticePublishdate" placeholder="请选择日期" readonly onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" value="';
$out+=$escape(_momentFormat(noticePublishdate,'YYYY-MM-DD'));
$out+='"> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> </div> <div class="form-group"> <label class="col-md-2 control-label">内容:</label> <div class="col-md-10"> <textarea class="form-control" rows="5" name="noticeContent">';
$out+=$escape(noticeContent);
$out+='</textarea> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_notice_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_dateSpecShortFormat=$helpers._dateSpecShortFormat,$out='';$each(dataList,function(p,$index){
$out+=' <div class="vertical-timeline-block" data-id="';
$out+=$escape(p.id);
$out+='"> <div class="vertical-timeline-icon navy-bg"> <i class="fa fa-comments"></i> </div> <div class="vertical-timeline-content"> <h4 data-value="';
$out+=$escape(p.noticeTitle);
$out+='"> ';
$out+=$escape(p.noticeTitle);
$out+=' <a href="javascript:void(0);" class="pull-right roleControl" roleCode="10000604" flag="2" data-action="editProjectNotice" title="编辑项目动态" style="display: none;"> <i class="fa fa-pencil"></i> </a> <a href="javascript:void(0);" class="pull-right m-r-xs roleControl" roleCode="10000604" flag="2" data-action="delProjectNotice" title="删除项目动态" style="display: none;"> <i class="fa fa-times"></i> </a> </h4> <p class="noticeContent"> ';
$out+=$escape(p.noticeContent);
$out+=' </p> <p class="noticePublishdate" data-value="';
$out+=$escape(p.noticePublishdate);
$out+='">';
$out+=$escape(_dateSpecShortFormat(p.noticePublishdate));
$out+='</p> </div> </div> ';
});
$out+=' ';
return new String($out);
});/*v:1*/
template('m_project/m_project_partner_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,businessType=$data.businessType,$out='';$out+='<div class="m-project-partner-edit m"> <div class="item-box"> </div> <button class="btn btn-primary btn-sm" data-action="addItem"> ';
if(businessType==1){
$out+=' 添加外部协作单位 ';
}else{
$out+=' 添加外部合作单位 ';
}
$out+='</button> </div> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_partner_edit_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,businessType=$data.businessType,num=$data.num,outerCompany=$data.outerCompany,contractName=$data.contractName,fee=$data.fee,_momentFormat=$helpers._momentFormat,signDate=$data.signDate,$out='';$out+='<div class="panel panel-default" data-type="panel-item" data-id="';
$out+=$escape(id);
$out+='"> <div class="panel-body"> <form class="form-horizontal" > <h4 class="title-line"> ';
if(businessType==1){
$out+=' 协作单位 ';
}else{
$out+=' 合作单位 ';
}
$out+=' （<span class="num">';
$out+=$escape(num);
$out+='</span>） <a href="javascript:void(0);" class="pull-right fc-red f-s-lg" data-action="delItem"><i class="fa fa-times"></i></a> </h4> <div class="form-group"> <label class="col-sm-2 control-label">单位名称<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input class="form-control input-sm" name="outerCompany" placeholder="请输入单位名称" value="';
$out+=$escape(outerCompany);
$out+='"/> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">合同名称<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input class="form-control input-sm" name="contractName" placeholder="请输入合同名称" value="';
$out+=$escape(contractName);
$out+='"/> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">合同金额<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input class="form-control input-sm" name="fee" placeholder="请输入合同金额" value="';
$out+=$escape(fee);
$out+='"/> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">签订日期<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <div class="input-group"> <input type="text" class="form-control input-sm" name="signDate" placeholder="请选择签订日期" readonly onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" value="';
$out+=$escape(_momentFormat(signDate,'YYYY-MM-DD'));
$out+='"> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> </div> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_partner_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-hover m-b-xs"> <thead> <tr> <th width="40%">单位名称</th> <th width="20%">合同名称</th> <th width="20%">合同金额</th> <th width="20%">签订日期</th> </tr> </thead> <tbody> ';
$each(dataList,function(p,$index){
$out+=' <tr> <td>';
$out+=$escape(p.outerCompany);
$out+='</td> <td>';
$out+=$escape(p.contractName);
$out+='</td> <td>';
$out+=$escape(_expNumberFilter(p.fee));
$out+='</td> <td>';
$out+=$escape(_momentFormat(p.signDate,'YYYY/MM/DD'));
$out+='</td> </tr> ';
});
$out+=' ';
if(dataList==null || dataList.length==0){
$out+=' <tr class="no-data"> <td colspan="4" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_project/m_project_process',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,totalRatio=$data.totalRatio,businessType=$data.businessType,dataInfo=$data.dataInfo,_expNumberFilter=$helpers._expNumberFilter,$out='';$out+='<div class="col-md-12"> <div class="progress progress-drag"> <div style="width: ';
$out+=$escape(totalRatio);
$out+='%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="';
$out+=$escape(totalRatio);
$out+='" role="progressbar" class="progress-bar b-r-sm text-right"> <span class="">';
$out+=$escape(totalRatio);
$out+='%</span>&nbsp; <div class="dot" title="拖拽修改"></div> </div> </div> </div> ';
if(businessType==1){
$out+=' <div class="col-md-12"> <table class="table table-bordered info m-b-xs"> <tbody> <tr> <td width="12%"><b>计划收款</b></td> <td width="37%"> ';
if(dataInfo.summary){
$out+=' ';
$out+=$escape(_expNumberFilter(dataInfo.summary.planReceiveFee));
$out+=' ';
}else{
$out+=' 0.00 ';
}
$out+=' </td> <td width="12%"><b>计划付款</b></td> <td> ';
if(dataInfo.summary){
$out+=' ';
$out+=$escape(_expNumberFilter(dataInfo.summary.planPayFee));
$out+=' ';
}else{
$out+=' 0.00 ';
}
$out+=' </td> </tr> <tr> <td><b>到账金额</b></td> <td> ';
if(dataInfo.summary){
$out+=' ';
$out+=$escape(_expNumberFilter(dataInfo.summary.receiveFee));
$out+=' ';
}else{
$out+=' 0.00 ';
}
$out+=' </td> <td><b>付款金额</b></td> <td> ';
if(dataInfo.summary){
$out+=' ';
$out+=$escape(_expNumberFilter(dataInfo.summary.payFee));
$out+=' ';
}else{
$out+=' 0.00 ';
}
$out+=' </td> </tr> </tbody> </table> </div> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_project/m_project_process_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,progressRate=$data.progressRate,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-xs-3 control-label"> 项目进度<span class="fc-red">*</span>： </label> <div class="col-xs-9"> <div class="input-group"> <input placeholder="请输入" class="form-control" type="text" name="progressRate" value="';
$out+=$escape(progressRate);
$out+='"> <span class="input-group-addon">%</span> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_submit_tips',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,doType=$data.doType,businessType=$data.businessType,$out='';$out+='<div class="m"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/project/project_approval_1.png'));
$out+='" width="60"/> </div> <div class="p-sm"> ';
if(doType==1){
$out+=' ';
if(businessType ==1){
$out+=' 项目信息填写完成后，需发布项目以便进行下一步的项目工作。 ';
}else{
$out+=' 课题信息填写完成后，需发布课题以便进行下一步的项目工作。 ';
}
$out+=' ';
}else{
$out+=' ';
if(businessType ==1){
$out+=' 项目信息填写完成后，需提交相关人员审批，审批通过后才可以进行下一步的项目工作。 ';
}else{
$out+=' 课题信息填写完成后，需提交相关人员审批，审批通过后才可以进行下一步的课题工作。 ';
}
$out+=' ';
}
$out+=' </div> <div class="row"> <div class="col-sm-6"> <label class="i-checks i-checks-label m-l"> <input name="itemCk" type="checkbox"/> <span class="i-checks-span fc-dark-gray">以后不再提示</span> </label> </div> <div class="col-sm-6 text-center"> <button class="btn btn-primary" data-action="knowIt">知道了</button> </div> </div> <div style="position: absolute;top: 20px;right: -100px;"> <span class="ic-tip-arrow"></span> </div> </div> <script> $(\'.i-checks\').iCheck({ checkboxClass: \'icheckbox_square-green\', radioClass: \'iradio_square-green\' }); </script> ';
return new String($out);
});/*v:1*/
template('m_project/m_project_task_order',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,businessType=$data.businessType,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,d=$data.d,di=$data.di,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<table class="table table-bordered m-b-xs"> <thead> <tr> <th width="15%"> ';
if(businessType==1){
$out+=' 项目/子项 ';
}else{
$out+=' 课题/子项 ';
}
$out+=' </th> <th width="10%">所属年度</th> <th width="25%">工作内容</th> <th width="15%">占比</th> <th width="20%">团队</th> <th width="15%">分管院长</th> </tr> </thead> <tbody> ';
$each(dataList,function(p,$index){
$out+=' ';
if(p.childList && p.childList.length>0){
$out+=' ';
$each(p.childList,function(d,di){
$out+=' <tr> ';
if(di==0){
$out+=' <td class="vertical-middle" rowspan="';
$out+=$escape(p.childList.length);
$out+='">';
$out+=$escape(p.taskName);
$out+='</td> <td class="vertical-middle" rowspan="';
$out+=$escape(p.childList.length);
$out+='">';
$out+=$escape(p.year?p.year+'年':'--');
$out+='</td> ';
}
$out+=' <td>';
$out+=$escape(d.taskName);
$out+='</td> <td>';
$out+=$escape(d.ratio?d.ratio+'%':'--');
$out+='</td> <td>';
$out+=$escape(d.departName);
$out+='</td> <td>';
$out+=$escape(d.orderDean?d.orderDean.companyUserName:'--');
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr> <td>';
$out+=$escape(p.taskName);
$out+='</td> <td>';
$out+=$escape(p.year?p.year+'年':'--');
$out+='</td> <td></td> <td></td> <td></td> <td></td> </tr> ';
}
$out+=' ';
});
$out+=' ';
if(dataList==null || dataList.length==0){
$out+=' <tr class="no-data"> <td colspan="6" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_personal/m_bindEmail','<form class="form-horizontal rounded-bottom bindEmailBox"> <div class="ibox"> <div class="ibox-content"> <div class="col-md-12 m-b-sm"> <label>邮箱地址</label> <div class="input-group"> <input type="text" class="form-control" name="bindEmailDtoEmail" maxlength="100"> <span class="input-group-btn"> <button class="btn-u rounded" type="button" data-action="sendValidationEemail">发送验证邮件</button> </span> </div> <div class="note">请输入您要绑定的邮箱地址。</div> </div> </div> </div> <div class="clearfix"></div> </form>');/*v:1*/
template('m_personal/m_bindPhone','<form class="form-horizontal rounded-bottom bindPhoneBox"> <div class="panel-body"> <div class="col-md-12 receiveCodeDiv"> <div class="form-group">  <div class="input-group"> <input placeholder="手机号" class="input form-control" type="text" id="cellphone" name="bindCellPhoneDtoCellphone" maxlength="11"> <span class="input-group-btn"> <a type="button" class="btn btn-u" data-action="receiveCode" style="width:96px;">获取验证码</a> </span> </div> </div> </div> <div class="col-md-12"> <div class="form-group">  <input class="form-control" type="text" placeholder="验证码" name="bindCellPhoneDtoCode"> </div> </div> <div class="note"><b>注：</b>更换绑定手机号，即为更改登录账号！</div> </div>      </form>');/*v:1*/
template('m_personal/m_safety',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,userDto=$data.userDto,$out='';$out+='<div class="ibox"> <div class="ibox-content"> <div class="row"> <!--<div class="col-md-12"> <div class="headline"><h4>绑定邮箱</h4></div> <div class="col-md-12"> <p> <span>当前绑定邮箱: <span data-show name="email">';
$out+=$escape(userDto.email);
$out+='</span></span> <a href="JavaScript:void(0);" class="" data-action="bindEmail">修改</a> </p> </div> </div>--> <div class="col-md-12"> <div class="headline"><h4>绑定手机</h4></div> <div class="col-md-12"> <p>当前绑定手机: <span data-show name="cellphone">';
$out+=$escape(userDto.cellphone);
$out+='</span> <a href="JavaScript:void(0);" data-action="bindPhone">修改</a> </p> </div> </div> <div class="col-md-12"> <div class="headline"><h4>修改密码</h4></div> <div class="col-md-12"> <p>修改当前用户的登录密码: <a href="JavaScript:void(0);" data-action="changePwd">修改</a> </p> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_personal/m_uptPassword','<form class="form-horizontal rounded-bottom changePassWordOBox"> <input type="password" style="display:none;"> <div class="panel-body"> <div class="col-md-12"> <div class="form-group"> <label class="col-sm-3 control-label">旧密码<span class="fc-red">*</span></label> <div class="col-sm-9"> <input type="password" class="form-control changePwdDtoOldPwd" name="oldPassword" > </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">新密码<span class="fc-red">*</span></label> <div class="col-sm-9"> <input type="password" class="form-control changePwdDtoPwd" name="password" id="password"> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">确认新密码<span class="fc-red">*</span></label> <div class="col-sm-9"> <input type="password" class="form-control changePwdDtoRePwd" name="rePassword"> </div> </div> </div> </div>     </form> ');/*v:1*/
template('m_personal/m_userInfo',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,userDto=$data.userDto,_url=$helpers._url,$each=$utils.$each,p=$data.p,i=$data.i,d=$data.d,di=$data.di,r=$data.r,$index=$data.$index,$out='';$out+='<div class="ibox m_userInfo"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu"> <div class="pull-left"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li class="active fw-bold">个人设置</li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <div class="row"> <div class="col-md-12" id="content-box"> <div class=" user-info col-lg-12 no-padding"> <div class="ibox"> <div class="ibox-content content-basic-info"> <div class="row cube-portfolio editableInfo"> <div class="col-lg-1 cbp-l-grid-agency cbp-caption-active cbp-caption-zoom cbp-ready"> <div class="imgContent cbp-item-wrapper pt-relative pull-left pt-relative" style="width: 110px;height: 110px;overflow: hidden; left:-30px;top:-30px; border:5px solid rgb(255,255,255);box-shadow:0 0 2px #e5e6e7;"> <div class="cbp-caption"> <img alt="image" id="headImage" class=" pull-left" src="';
$out+=$escape(userDto.headImgUrl);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/default/default_headPic.png'));
$out+='" style="width: 100%;height: 100%;min-height:100px;"> <!--<span class="btnFilePicker" style="display: none">';
$out+=$escape(userDto.headImg!=null && userDto.headImg!=''?'替换头像':'上传头像');
$out+='</span>--> <div class="cbp-caption-activeWrap dark-transparent-hover"> <div class="btnFilePicker cbp-l-caption-body" title="上传头像"><i class="fa fa-camera" style="color: rgba(255,255,255,0.9);"></i></div> </div> </div> </div> </div> <div class="col-lg-8 m-t-xs"> <h3 class="p-t-15 currentCompanyName f-s-xl fc-dark-blue"> <a href="javascript:void(0);" class="editable-click m-l-xs" data-placeholder="请输入姓名" data-key="userName" data-type="1" data-valid="1" > ';
$out+=$escape(userDto.userName==null || userDto.userName==''?'':userDto.userName);
$out+=' </a> </h3> <div class="editableInfo m-t-lg m-l-xs"> <div class="row"> <div class="col-md-12"> <p class="f-s-md"> <span class="title-span">绑定手机:</span> <span data-show name="cellphone">';
$out+=$escape(userDto.cellphone);
$out+='</span> <a href="JavaScript:void(0);" data-action="bindPhone">修改</a> </p> </div> <div class="col-md-12"> <p class="f-s-md"> <span class="title-span">用户密码:</span> <a href="JavaScript:void(0);" data-action="changePwd">修改</a> </p> </div> </div> </div> </div> </div> </div> <div class="ibox-content border-no-t"> <div class="row"> <div class="col-md-12"> <div class="" ><h4 class="title-line">个人权限</h4></div> <div class=""> ';
$each(userDto.orgpermissionList,function(p,i){
$out+=' <div class="clearfix">  <!--<h4 class="dp-inline-block col1" >';
$out+=$escape(p.companyName);
$out+='</h4>-->  <!--';
if(p.departList && p.departList.length>0){
$out+='-->  <!--';
$each(p.departList,function(d,di){
$out+='--> <!--';
if(di==p.departList.length-1){
$out+='--> <!--';
$out+=$escape(d.departName);
$out+=' ';
$out+=$escape(d.serverStation==null||d.serverStation==''?'':'- '+d.serverStation);
$out+='--> <!--';
}else{
$out+='--> <!--';
$out+=$escape(d.departName);
$out+=' ';
$out+=$escape(d.serverStation==null||d.serverStation==''?'':'- '+d.serverStation);
$out+=' &nbsp;|&nbsp;--> <!--';
}
$out+='--> <!--';
});
$out+='-->  <!--';
}
$out+='-->   ';
if(p.roleList && p.roleList.length>0){
$out+=' <ul class="authority-list"> ';
$each(p.roleList,function(r,$index){
$out+=' <li class="m-b-xs"> <span class="font-bold f-s-m role-name" > ';
$out+=$escape(r.name);
$out+=' <a href="javascript:void(0);" data-action="viewRole" data-id="';
$out+=$escape(r.id);
$out+='"><i class="fa fa-info-circle" ></i></a> </span> <span class="text-muted f-s-m"> ';
$out+=$escape(r.description);
$out+=' </span> </li> ';
});
$out+=' </ul> ';
}
$out+=' </div> <div class="headline"></div> ';
});
$out+=' </div> </div> </div> ';
if(userDto.cellphone=='18688836108'){
$out+=' <div class="row"> <div class="col-md-12"> <div class=""> <h4 class="title-line"> <a href="JavaScript:void(0);" data-action="choiceMyTaskHandler">查看我的任务</a> </h4> </div> </div> </div> ';
}
$out+=' </div> </div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_personal/m_userInfo_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,userDto=$data.userDto,$out='';$out+='<form class="userInfoForm form-horizontal no-borders"> <div class="ibox"> <div class="ibox-content"> <div class="row"> <div class="col-md-12 margin-top-20"> <div class="row cube-portfolio margin-top-20"> <div class="col-sm-offset-1 col-md-offset-1 col-md-3 cbp-l-grid-agency cbp-caption-active cbp-caption-zoom cbp-ready"> <div class="thumbnails thumbnail-style cbp-item-wrapper text-center width-200" style="box-sizing:border-box;padding:9px;border: solid 1px #eee;"> <div class="cbp-caption"> <img class="img-responsive" alt="Picture" src="';
$out+=$escape(userDto.headImgUrl);
$out+='" style="width: 180px;height: 180px;" > <div class="cbp-caption-activeWrap"> <div class="cbp-l-caption-alignCenter"> <div class="cbp-l-caption-body"> <ul class="link-captions no-bottom-space"> <li> <a href="javascript:void(0)" class="btn-u btn-u-primary rounded" id="comUpload" data-action="changeHeadPic" title="点击设置头像">';
$out+=$escape(userDto.headImg!=null && userDto.headImg!=''?'替换头像':'上传头像');
$out+='</a> </li> </ul> </div> </div> </div> </div> </div> </div> <div class="col-sm-offset-1 col-md-offset-1 col-md-5 col-lg-offset-0"> <div class="form-group"> <label class="col-sm-2 control-label">姓名<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input type="text" class="form-control" name="userName" value="';
$out+=$escape(userDto.userName);
$out+='"> <input type="hidden" name="id" value="';
$out+=$escape(userDto.id);
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">性别：</label> <div class="col-sm-10"> <select class="form-control" name="sex"> <option value="男" ';
if(userDto.sex=='男'){
$out+='selected';
}
$out+='>男</option> <option value="女" ';
if(userDto.sex=='女'){
$out+='selected';
}
$out+='>女</option> </select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">出生日期：</label> <div class="col-sm-10 "> <div class="input-group"> <input type="text" class="form-control" name="birthday" onFocus="WdatePicker()" value="';
$out+=$escape(userDto.birthday);
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> </div> </div> <div class="col-sm-offset-1 col-md-offset-0 col-md-2 col-lg-offset-1"> <label class="input"> <a href="javascript:void(0)" data-action="cancelEditUserInfo" class="btn-u btn-u-dark-blue rounded">取消</a> <a href="javascript:void(0)" data-action="saveUserInfo" class="btn-u btn-u-dark-blue rounded">保存</a> </label> </div> </div> </div> </div> </div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_personal/m_userInfo_edit2',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,userDto=$data.userDto,$out='';$out+='<form class="userInfoForm sky-form no-borders"> <div class="col-md-12 userInfoOBox cube-portfolio"> <div class="col-md-3 margin-top-20 cbp-l-grid-agency cbp-caption-active cbp-caption-zoom cbp-ready" > <div class="note"> <b>注</b>：请点击头像进行上传操作！ </div> </div> <div class="col-md-9 margin-top-20"> <div class="col-md-12"> <div class="col-md-5 "> <label class="label">姓名<span class="fc-red">*</span></label> <label class="input"> <input type="text" name="userName" value="';
$out+=$escape(userDto.userName);
$out+='"> <input type="hidden" name="id" value="';
$out+=$escape(userDto.id);
$out+='"> </label> </div> <div class="col-md-7 text-right"> <a href="javascript:void(0)" data-action="cancelEditUserInfo" class="btn-u btn-u-default rounded" >取消</a> <a href="javascript:void(0)" data-action="saveUserInfo" class="btn-u rounded" >保存</a> </div> </div> <div class="col-md-12"> <div class="col-md-5"> <label class="label">性别</label> <label class="select"> <select class="curp" name="sex"> <option value="男" ';
if(userDto.sex=='男'){
$out+='selected';
}
$out+='>男</option> <option value="女" ';
if(userDto.sex=='女'){
$out+='selected';
}
$out+='>女</option> </select> <i></i> <span class="whiteMask"></span> </label> </div> </div> <div class="col-md-12"> <div class="col-md-5"> <label class="label">出生日期</label> <label class="input"> <i class="icon-append fa fa-calendar"></i> <input type="text" name="birthday" onFocus="WdatePicker()" value="';
$out+=$escape(userDto.birthday);
$out+='"> </label> </div> </div> </div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_personal/m_userInfo_major_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,majorList=$data.majorList,m=$data.m,i=$data.i,majorId=$data.majorId,$escape=$utils.$escape,$out='';$out+='<form class="userInfo_profession_edit no-borders"> <div> <div class="row"> ';
$each(majorList,function(m,i){
$out+=' <div class="col-sm-3"> <div class="radio radio-inline"> ';
if(majorId==m.id){
$out+=' <input id="t';
$out+=$escape(i);
$out+='" value="';
$out+=$escape(m.id);
$out+='" name="major" type="radio" checked> ';
}else{
$out+=' <input id="t';
$out+=$escape(i);
$out+='" value="';
$out+=$escape(m.id);
$out+='" name="major" type="radio" > ';
}
$out+=' <label for="t';
$out+=$escape(i);
$out+='"> ';
$out+=$escape(m.name);
$out+=' </label> </div> </div> ';
});
$out+=' <div class="col-md-12"> </div> <div class="clearfix"></div> </div>  </div> </form>';
return new String($out);
});/*v:1*/
template('m_projectAdd/m_designContent_template',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,contentList=$data.contentList,$each=$utils.$each,c=$data.c,ci=$data.ci,$escape=$utils.$escape,$out='';if(contentList && contentList.length>0){
$out+=' ';
$each(contentList,function(c,ci){
$out+=' <span class="design_item designContentDiv" data-i=""> <label class="i-checks dp-inline-block" style="margin-bottom: 0;"> <input name="designContent" class="checkbox dinline" data-id="';
$out+=$escape(c.id);
$out+='" type="checkbox" value="" data-name="';
$out+=$escape(c.name);
$out+='"/> </label> <div class="pull-left"> <span> ';
$out+=$escape(c.name);
$out+=' </span> <a href="javascript:void(0)" class="editable editable-click editable-empty dp-block" data-action="edit_setDesignContentTime" data-startTime="" data-endTime="">设置合同进度 </a> </div> </span> ';
});
$out+=' ';
}
return new String($out);
});/*v:1*/
template('m_projectAdd/m_partyA','<div class="m-partyA"> <div class="col-md-12 border-bottom" style="padding: 5px 0;"> <button type="button" class="btn btn-w-m btn-link" data-action="searchPartyA"> <i class="fa fa-search"></i> 在工商注册名中搜索 </button> </div> <div class="col-md-12"> <div class="fc-v1-grey m-t-xs ">搜索结果</div> <div class="" id="partyAList" style="min-height: 10px;max-height: 200px;overflow: auto;"> </div> </div> <div class="clearfix"></div> </div>');/*v:1*/
template('m_projectAdd/m_partyA_info',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,corpname=$data.corpname,address=$data.address,taxNumber=$data.taxNumber,$out='';$out+='<form class="form-horizontal m viewPartyACompany-box" style="width:430px;"> <div class="form-group m-b-xs"> <label class="col-sm-3 text-right p-r-none">企业名称：</label> <div class="col-sm-9">';
$out+=$escape(corpname);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-sm-3 text-right p-r-none">地址：</label> <div class="col-sm-9">';
$out+=$escape(address);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-sm-3 text-right p-r-none">纳税人识别号：</label> <div class="col-sm-9">';
$out+=$escape(taxNumber);
$out+='</div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_projectAdd/m_partyA_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,partyAList=$data.partyAList,$each=$utils.$each,p=$data.p,pi=$data.pi,$escape=$utils.$escape,$string=$utils.$string,$out='';if(partyAList!=null && partyAList.length>0){
$out+=' <ul class="dropdown-menu" style="display: block;position: relative;border: 0;box-shadow: none;width: 100%;top: 0px;left:-20px;"> ';
$each(partyAList,function(p,pi){
$out+=' <li> <a href="javascript:void(0);" data-action="selectPartyA" data-id="';
$out+=$escape(p.companyid);
$out+='"> ';
$out+=$string(p.corpname);
$out+=' </a> </li> ';
});
$out+=' </ul> ';
}else{
$out+=' <span class="fc-v1-grey m-t-xs m-b-xs dp-block">未找到相关单位，试试输入更详细关键字查询</span> ';
}
return new String($out);
});/*v:1*/
template('m_projectAdd/m_projectAdd',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,currentDate=$data.currentDate,$detailAddress=$data.$detailAddress,$out='';$out+='<div class="ibox m_projectAdd"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu"> <div class="pull-left"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li class="active fw-bold">项目立项</li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content addProjectOBox"> <form role="form " class="form-horizontal projectAddForm m-t-md"> <div class="form-group"> <label class="col-24-sm-4 col-24-lg-3 text-right m-t-sm p-l-none">项目类型<span class="fc-red">*</span>：</label> <div class="col-24-sm-9 col-24-lg-8"> <select class="form-control" name="projectTypeId"></select> </div> </div> <div class="form-group"> <label class="col-24-sm-4 col-24-lg-3 text-right m-t-sm p-l-none">所属组<span class="fc-red">*</span>：</label> <div class="col-24-sm-9 col-24-lg-8"> <input class="form-control" name="companyId" data-id="" readonly placeholder="请点击选择所属组"/> </div> </div> <div class="form-group"> <label class="col-24-sm-4 col-24-lg-3 text-right m-t-sm p-l-none">所属公司<span class="fc-red">*</span>：</label> <div class="col-24-sm-9 col-24-lg-8"> <select class="form-control" name="orgId"></select> </div> </div> <div class="form-group"> <label class="col-24-sm-4 col-24-lg-3 text-right m-t-sm p-l-none">立项时间<span class="fc-red">*</span>：</label> <div class="col-24-sm-9 col-24-lg-8"> <input type="text" class="form-control" name="projectCreateDate" onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" value="';
$out+=$escape(currentDate);
$out+='"> </div> </div> <div class="form-group"> <label class="col-24-sm-4 col-24-lg-3 text-right m-t-sm"><span class="label-projectName">创新研究</span><span class="fc-red">*</span>：</label> <div class="col-24-sm-9 col-24-lg-8"> <input type="text" class="form-control" name="projectName" id="projectName" maxlength="50" placeholder="请输入创新研究"> </div> </div> <div class="form-group" data-type="1" style="display: none"> <label class="col-24-sm-4 col-24-lg-3 text-right m-t-sm p-l-none">甲方<span class="fc-red">*</span>：</label> <div class="col-24-sm-9 col-24-lg-8"> <input type="text" class="form-control" name="constructCompany" id="constructCompany" placeholder="请输入甲方名称" autocomplete="off" data-id=""> </div> </div> <div class="form-group" data-type="1" style="display: none"> <label class="col-24-sm-4 col-24-lg-3 text-right m-t-sm p-l-none" for="selectRegion">项目所在地<span class="fc-red">*</span>：</label></label> <div class="col-24-sm-9 col-24-lg-8"> <div class="input-group cityBox" id="selectRegion" name="selectRegion"> <div class="dp-inline-block"> <select class="prov form-control" name="province"></select> </div> <div class="dp-inline-block m-l-xs"> <select class="city form-control" name="city" disabled="disabled" style="display: none;"></select> </div> <div class="dp-inline-block m-l-xs"> <select class="dist form-control" name="county" disabled="disabled" style="display: none;"></select> </div> </div> </div> </div> <div class="form-group" data-type="1" style="display: none"> <label class="col-24-sm-4 col-24-lg-3 text-right m-t-sm p-l-none" for="detailAddress">详细地址：</label> <div class="col-24-sm-9 col-24-lg-8"> <input type="text" class="input-autofill-selected form-control" style="width: 100%;" name="detailAddress" id="detailAddress" maxlength="255" value="';
$out+=$escape($detailAddress?$detailAddress:'');
$out+='"> </div> </div>  <div class="row"> <div class="col-24-sm-9 col-24-lg-8 col-24-sm-offset-4 col-24-lg-offset-3"> <a type="button" class="btn btn-primary btn-submit " data-action="submit">保存</a> <a type="button" class="btn btn-default btn-cancel m-l-xs" data-action="cancel">取消</a> </div> </div> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_projectExternalCooperation/m_inviteCooperation',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,filePath=$data.filePath,$escape=$utils.$escape,_url=$helpers._url,companyName=$data.companyName,systemManager=$data.systemManager,cellphone=$data.cellphone,$out='';$out+='<div class="ibox"> <div class="ibox-title border-fff"> <span class="f-s-md dp-inline-block l-h-16">外部合作邀请组织</span> </div> <div class="ibox-content text-center"> <div class="m-b-sm"> ';
if(filePath!='' && filePath!=null){
$out+=' <img alt="image" class="img-circle width-100 height-100" src="';
$out+=$escape(filePath);
$out+='"> ';
}else{
$out+=' <img alt="image" class="img-circle width-100 height-100" src="';
$out+=$escape(_url('/img/default/org_default_headPic.png'));
$out+='"> ';
}
$out+=' </div> <p class="f-s-lg">';
$out+=$escape(companyName);
$out+='</p> <p class="f-s-m fc-v1-grey">企业负责人:';
$out+=$escape(systemManager);
$out+='</p> </div> <div class="ibox-content"> <div class="row"> <div class="col-sm-12"> <form role="form"> <div class="form-group"> <label class="f-s-m fw-400">您的手机号：</label> <p class="f-s-m fc-dark-blue fw--600">';
$out+=$escape(cellphone);
$out+='</p> </div> <div class="form-group"> <label class="f-s14 fw-400">输入完整手机号校验身份：</label> <input name="cellphone" id=\'cellphone\' placeholder="手机号" class="form-control"></div> <div class="form-group"> <a class="btn btn-primary btn-block btn-ok">确定</a> </div> </form> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_projectExternalCooperation/m_inviteCooperation_create_has',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,a_companyName=$data.a_companyName,$out='';$out+='<div class="ibox"> <div class="ibox-title border-fff"> <span class="f-s-md l-h-16 dp-inline-block">创建新组织</span> </div> <div class="ibox-content"> <p class="f-s-m l-h-14 p-h-xs">该组织创建后将会自动成为&nbsp;<span class="fc-v1-yellow">';
$out+=$escape(a_companyName);
$out+='</span>&nbsp;的外部合作组织</p> <div class="row"> <div class="col-sm-12"> <form class="create-form"> <div class="form-group"> <input name="companyName" placeholder="组织名称" class="form-control"> </div> <div class="form-group pt-fixed" style="bottom: 0;left: 20px;right: 20px;"> <a class="btn btn-primary btn-lg btn-block btn-ok" data-action="createOrgSubmit">立即创建</a> </div> </form> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_projectExternalCooperation/m_inviteCooperation_create_hasNo',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,a_companyName=$data.a_companyName,$out='';$out+='<div class="ibox"> <div class="ibox-title border-fff"> <span class="f-s-md l-h-16 dp-inline-block">创建账号和组织</span> </div> <div class="ibox-content"> <p class="f-s-m l-h-14 p-h-xs">该组织创建后将会自动成为&nbsp;<span class="fc-v1-yellow">';
$out+=$escape(a_companyName);
$out+='</span>&nbsp;的外部合作组织</p> <div class="row"> <div class="col-sm-12"> <form class="create-form" role="form"> <div class="form-group"> <label class="f-s-m fw-400 dp-block">个人信息：</label> <input name="userName" placeholder="姓名" class="form-control m-b-xs"> <input name="adminPassword" placeholder="密码" type="password" class="form-control m-b-xs"> <br /> <label class="f-s-m fw-400 dp-block">组织信息：</label> <input name="companyName" placeholder="组织名称" class="form-control m-b-xs"> </div> <div class="form-group pt-fixed" style="bottom: 0;left: 20px;right: 20px;"> <a class="btn btn-primary btn-lg btn-block btn-ok" data-action="createOrgAndAccountSubmit">立即创建</a> </div> </form> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_projectExternalCooperation/m_inviteCooperation_org',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,a_companyName=$data.a_companyName,projectName=$data.projectName,$each=$utils.$each,companyList=$data.companyList,c=$data.c,i=$data.i,_url=$helpers._url,$out='';$out+='<div class="ibox"> <div class="ibox-title border-fff"> <span class="f-s-md l-h-16 dp-inline-block">组织选择</span> </div> <div class="ibox-content no-pd"> <ul class="todo-list small-list m-invite-group"> <li> <p class="f-s-m l-h-14 m-t-sm"> 请选择&nbsp;<span class="fc-v1-yellow">已有的组织</span>&nbsp;或&nbsp; <span class="fc-v1-yellow">创建一个新组织</span>&nbsp;成为&nbsp; <span class="fc-v1-yellow">“';
$out+=$escape(a_companyName);
$out+='”</span>&nbsp;的 <span class="fc-v1-yellow">“';
$out+=$escape(projectName);
$out+='”</span>&nbsp;项目外部合作组织 </p> </li> ';
$each(companyList,function(c,i){
$out+=' ';
if(c.flag===1){
$out+=' <li class="unselectable" data-action="selectOrg" data-memo="';
$out+=$escape(c.memo);
$out+='"> <div class="ibox-content box-shadow border" style="padding: 10px 20px 5px;height:90px;"> <div class="dp-inline-block p-h-sm"> <p class="f-s-md l-h-16 fc-v1-grey">';
$out+=$escape(c.companyName);
$out+='</p> <p class="f-s-xs l-h-12 fc-v1-grey">';
$out+=$escape(c.memo);
$out+='</p> </div> ';
if(c.filePath!=null && c.filePath!=''){
$out+=' <img alt="image" class="img-circle pull-right img-responsive hidden-xs" width="90" src="';
$out+=$escape(c.filePath);
$out+='"> ';
}else{
$out+=' <img alt="image" class="img-circle pull-right img-responsive hidden-xs" width="90" src="';
$out+=$escape(_url('/img/default/org_default_headPic.png'));
$out+='"> ';
}
$out+=' </div> </li> ';
}else{
$out+=' <li class="selectable" data-action="selectOrgApply" data-company-id="';
$out+=$escape(c.id);
$out+='" data-company-name="';
$out+=$escape(c.companyName);
$out+='"> <div class="ibox-content box-shadow border" style="padding: 10px 20px 5px;height:90px;"> <div class="dp-inline-block p-h-sm"> <p class="f-s-md l-h-16">';
$out+=$escape(c.companyName);
$out+='</p> <p class="f-s-xs l-h-12 fc-v1-grey">企业负责人:';
$out+=$escape(c.systemManager);
$out+='</p> </div> ';
if(c.filePath!=null && c.filePath!=''){
$out+=' <img alt="image" class="img-circle pull-right img-responsive hidden-xs" width="90" src="';
$out+=$escape(c.filePath);
$out+='"> ';
}else{
$out+=' <img alt="image" class="img-circle pull-right img-responsive hidden-xs" width="90" src="';
$out+=$escape(_url('/img/default/org_default_headPic.png'));
$out+='"> ';
}
$out+=' </div> </li> ';
}
$out+=' ';
});
$out+=' <li class="selectable"> <a href="javascript:void(0)"> <div class="ibox-content box-shadow border" style="padding: 0;"> <p class="f-s-md l-h-16"> <a href="javascript:void(0)" data-action="createOrg" style="padding: 20px 20px 15px;display: inline-block;width: 100%;">创建新组织</a> </p> </div> </a> </li> </ul> </div> </div>';
return new String($out);
});/*v:1*/
template('m_projectExternalCooperation/m_inviteCooperation_org_hasNo',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="ibox"> <div class="ibox-content text-center no-border p-l-none p-r-none"> <div class="m-b-md m-t-lg"> <img alt="image" class="img-circle width-200" src="';
$out+=$escape(_url('/img/default/defaultpage_pic_data.png'));
$out+='" > </div> <p class="f-s-lg m-t-md">你还没有组织，请先创建组织</p> <div class="form-group"> <a class="btn btn-primary btn-lg btn-ok" href="javascript:void(0)" data-action="createOrg">创建组织</a> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_projectExternalCooperation/m_inviteCooperation_success',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,companyName=$data.companyName,a_companyName=$data.a_companyName,$out='';$out+='<div class="ibox"> <div class="ibox-content text-center no-border p-r-none p-l-none"> <div class="m-b-sm"> <img alt="image" class="img-circle width-100" src="';
$out+=$escape(_url('/img/default/invite_success.png'));
$out+='" > </div> <p class="f-s-lg">恭喜！</p> <p class="f-s-m fc-v1-grey">';
$out+=$escape(companyName);
$out+=' 已经成为 ';
$out+=$escape(a_companyName);
$out+=' 的外部合作组织</p> </div> </div>';
return new String($out);
});/*v:1*/
template('m_projectExternalCooperation/m_inviteExternalCooperation','<div class="container-fluid inviteCorpBox"> <div class="row"> <div class="col-md-12" style="padding: 25px 15px 15px 15px"> <div class="form-group"> 请输入被邀请组织负责人的手机号： </div> <div class="inviteCorpPart form-group input-group"> <input name="bPartnerPhone" class="form-control"> <span class="input-group-btn"> <a class="btn btn-primary pull-right" data-action="sendMessage">发送邀请</a> </span> </div> </div> </div> </div>');/*v:1*/
template('m_projectExternalCooperation/m_projectExternalCooperation',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,inviteOuterCooperation=$data.inviteOuterCooperation,$each=$utils.$each,projectPartnerList=$data.projectPartnerList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="ibox m_contractPayment"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-6" id="breadcrumb"></div> <div class="col-md-6 text-right "> ';
if(inviteOuterCooperation==1){
$out+=' <a href="javascript:void(0)" class="btn btn-primary btn-xs pull-right m-t roleControl" roleCode="20000501" flag="2" data-action="inviteExternalCooperation" >邀请合作设计组织</a> ';
}
$out+=' </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content"> <table class="table table-bordered"> <thead> <tr> <th class="text-center ">联系方式</th> <th class="text-center ">合作组织</th> <th class="text-center ">负责人</th> <th class="text-center ">合作内容</th> <th class="text-center ">经营负责人</th> <th class="text-center ">操作</th> </tr> </thead> <tbody class="border-no-t"> ';
$each(projectPartnerList,function(p,$index){
$out+=' <tr class="';
$out+=$escape(p.companyId!=null && p.companyId!=''?'':'gray-bg');
$out+='"> <td class="text-center">';
$out+=$escape(p.phone);
$out+='</td> <td class="text-center">';
$out+=$escape(p.companyName);
$out+='</td> <td class="text-center">';
$out+=$escape(p.companyManagerName);
$out+='</td> <td class="text-center">';
$out+=$escape(p.taskNameSplice);
$out+='</td> <td class="text-center">';
$out+=$escape(p.projectManagerName);
$out+='</td> <td class="text-center"> ';
if(inviteOuterCooperation==1){
$out+=' <a href="javascript:void(0);" class="btn btn-primary btn-xs m-r-xs autoMargin" data-action="relieveRelationship" data-id="';
$out+=$escape(p.id);
$out+='">解除合作</a> ';
}
$out+=' ';
if(p.companyId==null || p.companyId==''){
$out+=' <span class="badge">未建立合作关系</span> ';
if(inviteOuterCooperation==1){
$out+=' <a href="javascript:void(0);" class="btn btn-danger btn-xs pull-right m-r-xs autoMargin" data-action="resendSMS" data-id="';
$out+=$escape(p.id);
$out+='">重新推送短信</a> ';
}
$out+=' ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
if(projectPartnerList==null || projectPartnerList.length==0){
$out+=' <tr class="no-data"> <td colspan="10" align="center"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/default/without_exp.png'));
$out+='"> </div> <span style="color:#337b8e">暂无合作设计组织</span> </td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_projectList/m_projectList',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,type=$data.type,$out='';$out+='<div class="m_projectList"> <div class="row"> <div class="col-sm-12"> <div class="row"> ';
if(type==1||type==4){
$out+=' <div class="col-md-12"> <div class="form-group z-index-1"> <label class="inline">项目范围：</label> <select class="from-control width-300 inline" name="listCompany"></select> </div> </div> ';
}
$out+=' <div class="col-md-12" id="timeSelect"> </div> <div class="col-md-12" id="statusSelect"> </div> <div class="col-md-12" id="signDateStatusSelect"> </div> <div class="col-md-12"> <div class="form-group z-index-1"> <label class="inline">搜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;索：</label> <input class="form-control input-sm width-300 inline v-middle" type="text" name="keyword" placeholder="请输入关键字"> </div> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 个项目</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-white" data-action="exportDetails">导出</button> <button type="button" class="btn btn-primary" data-action="setField" title="设置字段"> <span><i class="fa fa-list"></i> <span class="caret m-t-n-xs"></span></span> </button> </div> </div> <div class="data-list-box"> <div class="data-list-container"> <div class="project-list of-auto m-scroll-box"> <table class="table table-bordered table-hover cell-border dataTable"> <thead></thead> <tbody></tbody> </table> </div> </div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_projectList/m_projectList_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,columnCodes=$data.columnCodes,projectList=$data.projectList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,columnLen=$data.columnLen,$out='';$out+='<div class="project-list of-auto"> <table class="table table-bordered table-hover cell-border dataTable" > <thead> <th>项目编号</th> <th>项目名称</th> <th> 立项组织/立项人 <a class="icon-filter pull-right" id="filterCreateBy"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
if(columnCodes.indexOf('projectCreateDate')>-1){
$out+=' <th class="sorting_desc" data-action="sort" data-sort-type="createDate"> 立项时间 <a class="icon-filter pull-right" id="filterCreateDate"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+=' ';
if(columnCodes.indexOf('signDate')>-1){
$out+=' <th class="sorting" data-action="sort" data-sort-type="signDate"> 合同签订 <a class="icon-filter pull-right" id="filterSignDate"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+=' ';
if(columnCodes.indexOf('status')>-1){
$out+=' <th> 项目状态 <a class="icon-filter pull-right" id="filterStatus"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+=' ';
if(columnCodes.indexOf('buildName')>-1){
$out+=' <th> 功能分类 <a class="icon-filter pull-right" id="filterBuildName"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+=' ';
if(columnCodes.indexOf('address')>-1){
$out+=' <th> 地点 <a class="icon-filter pull-right" id="filterAddress"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+=' ';
if(columnCodes.indexOf('partyA')>-1){
$out+=' <th> 甲方 <a class="icon-filter pull-right" id="filterPartyA"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+=' ';
if(columnCodes.indexOf('partyB')>-1){
$out+=' <th> 乙方 <a class="icon-filter pull-right" id="filterPartyB"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+=' ';
if(columnCodes.indexOf('designCompanyName')>-1){
$out+=' <th> 合作组织 <a class="icon-filter pull-right" id="filterDesignCompanyName"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+=' <!--';
if(columnCodes.indexOf('busPersonInCharge')>-1){
$out+=' <th> 商务秘书 <a class="icon-filter pull-right" id="filterBusPersonInCharge"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+=' ';
if(columnCodes.indexOf('busPersonInChargeAssistant')>-1){
$out+=' <th style="min-width: 130px;"> 经营助理 <a class="icon-filter pull-right" id="filterBusAss"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+=' ';
if(columnCodes.indexOf('designPersonInCharge')>-1){
$out+=' <th> 项目负责人 <a class="icon-filter pull-right" id="filterDesignPersonInCharge"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+=' ';
if(columnCodes.indexOf('designPersonInChargeAssistant')>-1){
$out+=' <th style="min-width: 130px;"> 设计助理 <a class="icon-filter pull-right" id="filterDesignAss"><i class="icon iconfont icon-shaixuan"></i></a> </th> ';
}
$out+='--> </thead> <tbody> ';
if(projectList&&projectList.length>0){
$out+=' ';
$each(projectList,function(p,i){
$out+=' <tr> <td > ';
$out+=$escape(p.projectNo==null?'--':p.projectNo);
$out+=' </td> <td > <a href="javascript:void(0)" data-action="gotoProject" businessType="';
$out+=$escape(p.businessType);
$out+='" data-pId="';
$out+=$escape(p.id);
$out+='" data-pName="';
$out+=$escape(p.projectName);
$out+='" style="font-size: 14px;"> ';
$out+=$escape(p.projectName);
$out+=' </a> </td> <td > ';
$out+=$escape(p.companyName);
$out+='/';
$out+=$escape(p.createBy);
$out+=' </td> ';
if(columnCodes.indexOf('projectCreateDate')>-1){
$out+=' <td >';
$out+=$escape(_momentFormat(p.projectCreateDate,'YYYY/MM/DD'));
$out+='</td> ';
}
$out+=' ';
if(columnCodes.indexOf('signDate')>-1){
$out+=' <td >';
$out+=$escape(p.signDate==null?'--':_momentFormat(p.signDate,'YYYY/MM/DD'));
$out+='</td> ';
}
$out+=' ';
if(columnCodes.indexOf('status')>-1){
$out+=' <td > ';
if(p.status == 0){
$out+=' 进行中 ';
}else if(p.status == 2 ){
$out+=' 已完成-未结清 ';
}else if(p.status == 4 ){
$out+=' 已完成-已结清 ';
}else if(p.status == 1){
$out+=' 已暂停-未结清 ';
}else if(p.status == 5){
$out+=' 已暂停-已结清 ';
}else if(p.status == 3 ){
$out+=' 已终止-未结清 ';
}else if(p.status == 6 ){
$out+=' 已终止-已结清 ';
}else{
$out+=' -- ';
}
$out+=' </td> ';
}
$out+=' ';
if(columnCodes.indexOf('buildName')>-1){
$out+=' <td >';
$out+=$escape(p.buildName==null?'--':p.buildName);
$out+='</td> ';
}
$out+=' ';
if(columnCodes.indexOf('address')>-1){
$out+=' <td >';
$out+=$escape(p.address==null?'--':p.address);
$out+='</td> ';
}
$out+=' ';
if(columnCodes.indexOf('partyA')>-1){
$out+=' <td >';
$out+=$escape(p.partyA==null?'--':p.partyA);
$out+='</td> ';
}
$out+=' ';
if(columnCodes.indexOf('partyB')>-1){
$out+=' <td >';
$out+=$escape(p.partyB==null?'--':p.partyB);
$out+='</td> ';
}
$out+=' ';
if(columnCodes.indexOf('designCompanyName')>-1){
$out+=' <td >';
$out+=$escape(p.designCompanyName==null?'--':p.designCompanyName);
$out+='</td> ';
}
$out+=' <!--';
if(columnCodes.indexOf('busPersonInCharge')>-1){
$out+=' <td >';
$out+=$escape(p.busPersonInCharge==null?'&#45;&#45;':p.busPersonInCharge);
$out+='</td> ';
}
$out+=' ';
if(columnCodes.indexOf('busPersonInChargeAssistant')>-1){
$out+=' <td >';
$out+=$escape(p.busPersonInChargeAssistant==null?'&#45;&#45;':p.busPersonInChargeAssistant);
$out+='</td> ';
}
$out+=' ';
if(columnCodes.indexOf('designPersonInCharge')>-1){
$out+=' <td >';
$out+=$escape(p.designPersonInCharge==null?'&#45;&#45;':p.designPersonInCharge);
$out+='</td> ';
}
$out+=' ';
if(columnCodes.indexOf('designPersonInChargeAssistant')>-1){
$out+=' <td >';
$out+=$escape(p.designPersonInChargeAssistant==null?'&#45;&#45;':p.designPersonInChargeAssistant);
$out+='</td> ';
}
$out+='--> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr> <td colspan="';
$out+=$escape(3+columnLen);
$out+='" align="center">暂无数据</td> </tr> ';
}
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_projectList/m_projectList_depart',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_url=$helpers._url,$out='';if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(p,$index){
$out+=' <div class="section-row curp" data-action="selectDepart" data-id="';
$out+=$escape(p.id);
$out+='"> <h4>';
$out+=$escape(p.departName);
$out+='</h4> <p> ';
$out+=$escape(p.departDesc);
$out+=' </p> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="section-row"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </div> ';
}
return new String($out);
});/*v:1*/
template('m_projectList/m_projectList_empty','<div class="ibox ibox-shadow"> <div class="ibox-content" style="padding: 150px 20px 250px;"> <div class="projectList-content"> <div class="row"> <div class="col-lg-12"> <div class="text-center m-t-lg"> <h1> 你的组织还没建立任何项目 </h1> <p style="margin-top:16px;"> 点击 <button href="javascript:void(0)" class="btn btn-primary btn-xs m-b-xs" data-action="addProject">开始立项</button> 为你的组织建立第一个项目 </p> </div> </div> </div> </div> </div> </div>');/*v:1*/
template('m_projectList/m_projectList_index',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,studyTypeList=$data.studyTypeList,$each=$utils.$each,p=$data.p,$index=$data.$index,_momentFormat=$helpers._momentFormat,businessTypeList=$data.businessTypeList,$out='';$out+='<div class="ibox m-projectList-index"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right"> </div> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content" id="content-box"> <div class="row"> <div class="col-sm-6"> <h3>创新研究</h3> </div> <div class="col-sm-6"> <h3>业务项目</h3> </div> </div> <div class="row"> <div class="col-sm-6"> <img class="curp" src="';
$out+=$escape(_url('/img/website/index/banner1.jpg'));
$out+='" width="100%" onclick="javascript:window.location.href=\'#/myProjectList?businessType=2\';return;"/> </div> <div class="col-sm-6"> <img class="curp" src="';
$out+=$escape(_url('/img/website/index/banner1.jpg'));
$out+='" width="100%" onclick="javascript:window.location.href=\'#/myProjectList?businessType=1\';return;"/> </div> </div> <div class="row m-t-sm"> <div class="col-sm-6"> <div class="panel panel-default b-r-none"> <div class="panel-heading"> 创新研究动态 </div> <div class="panel-body no-padding"> ';
if(studyTypeList && studyTypeList.length>0){
$out+=' ';
$each(studyTypeList,function(p,$index){
$out+=' <div class="notice-row curp" onclick="javascript:window.location.href=\'#/projectDynamics\';return;"> <h4>';
$out+=$escape(p.noticeTitle);
$out+='</h4> <p> ';
$out+=$escape(p.noticeContent);
$out+=' </p> <span class="fc-dark-gray">';
$out+=$escape(_momentFormat(p.noticePublishdate,'YYYY/MM/DD'));
$out+='</span> <span class="fc-dark-gray pull-right">';
$out+=$escape(p.projectName);
$out+='</span> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="notice-row"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </div> ';
}
$out+=' </div> </div> </div> <div class="col-sm-6"> <div class="panel panel-default b-r-none"> <div class="panel-heading"> 业务项目动态 </div> <div class="panel-body no-padding"> ';
if(businessTypeList && businessTypeList.length>0){
$out+=' ';
$each(businessTypeList,function(p,$index){
$out+=' <div class="notice-row curp" onclick="javascript:window.location.href=\'#/projectDynamics\';return;"> <h4>';
$out+=$escape(p.noticeTitle);
$out+='</h4> <p> ';
$out+=$escape(p.noticeContent);
$out+=' </p> <span class="fc-dark-gray">';
$out+=$escape(_momentFormat(p.noticePublishdate,'YYYY/MM/DD'));
$out+='</span> <span class="fc-dark-gray pull-right">';
$out+=$escape(p.projectName);
$out+='</span> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="notice-row"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </div> ';
}
$out+=' </div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_projectList/m_projectList_menu',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,viewAllProject=$data.viewAllProject,$out='';$out+='<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right"> ';
if(viewAllProject==1){
$out+=' <ul class="secondary-menu-ul" > <li class="active" id="projectOverview" ><a href="#/projectOverview">项目总览</a></li> <li id="myProjectList" ><a href="#/myProjectList">我的项目</a></li> </ul> ';
}
$out+=' </div> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content" id="content-box"> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_projectMember/m_projectMember',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,parts=$data.parts,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,d=$data.d,di=$data.di,t=$data.t,ti=$data.ti,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-12" id="breadcrumb"></div> </div> </div> <div class="ibox-content"> ';
if(parts && parts.length>0){
$out+=' ';
$each(parts,function(p,i){
$out+=' <table class="table table-bordered"> <thead> <tr> <th colspan="8"> <div class="row"> <div class="col-md-3"> ';
$out+=$escape(p.childTask?p.childTask.taskName:'');
$out+=' </div> <div class="col-md-3"> <span>所属年度：</span> <span>';
$out+=$escape(p.childTask?p.childTask.year:'');
$out+='</span> </div> <div class="col-md-3"> <span>任务状态：</span> <span>';
$out+=$escape(p.childTask?p.childTask.stateHtml:'');
$out+='</span> </div> </div> </th> </tr> <tr> <th class="border-no-l">姓名</th> <th>工作内容</th> <th>工作占比</th> <th>任务分配</th> <th>任务占比</th> <th>占比计算</th> <th>效能值</th>  </tr> </thead> <tbody class="border-no-t"> ';
if(p.personList && p.personList.length>0){
$out+=' ';
$each(p.personList,function(d,di){
$out+=' ';
if(d.taskList && d.taskList.length>0){
$out+=' ';
$each(d.taskList,function(t,ti){
$out+=' <tr class=""> ';
if(ti==0){
$out+=' <td rowspan="';
$out+=$escape(d.taskList&&d.taskList.length>1?d.taskList.length:'1');
$out+='" class="vertical-middle"> ';
$out+=$escape(d.userName);
$out+=' </td> ';
}
$out+=' <td>';
$out+=$escape(t.contentName);
$out+='</td> <td>';
$out+=$escape(t.contentRatio?t.contentRatio+'%':'');
$out+='</td> <td>';
$out+=$escape(t.taskName);
$out+='</td> <td>';
$out+=$escape(t.taskRatio?t.taskRatio+'%':'');
$out+='</td> <td>';
$out+=$escape(t.personalRatio?t.personalRatio+'%':'');
$out+='</td> ';
if(ti==0){
$out+=' <td rowspan="';
$out+=$escape(d.taskList&&d.taskList.length>1?d.taskList.length:'1');
$out+='" class="vertical-middle">';
$out+=$escape(_expNumberFilter(d.personalRatio/100));
$out+='</td> <!-- <td rowspan="';
$out+=$escape(d.taskList&&d.taskList.length>1?d.taskList.length:'1');
$out+='" class="vertical-middle">';
$out+=$escape(_expNumberFilter(d.outPutValue));
$out+='</td>--> ';
}
$out+=' </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class=""> <td>';
$out+=$escape(d.userName);
$out+='</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td>';
$out+=$escape(d.personalRatio?d.personalRatio+'%':'');
$out+='</td> <!-- <td>';
$out+=$escape(_expNumberFilter(d.outPutValue));
$out+='</td>--> </tr> ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr> <td colspan="8" class="text-center">暂无数据</td> </tr> ';
}
$out+=' </tbody> </table> ';
});
$out+=' ';
}else{
$out+=' <div class="panel panel-default no-borders m-t-xs"> <div class="panel-body text-center no-borders"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </div> ';
}
$out+=' </div> </div> ';
return new String($out);
});/*v:1*/
template('m_projectMember/m_projectMember_add','<form class="form-horizontal m-projectMember-add rounded-4x"> <div class="ibox m-b-none"> <div class="ibox-content p-b-none">  <div class="row"> <div class="col-md-5" style="height: 320px;overflow: auto;"> <div id="organization_treeH"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </div> <div class="col-md-7 " > <div data-list="userList" style="height: 270px;overflow: auto"></div> <div id="userlist-pagination-container" class="m-pagination pull-right m-r"></div> </div> </div> <table class="table table-bordered m-b-none"> <tr class="active" data-type="designUserList" title="点击选中"> <td width="10%">设计人</td> <td class="selectedUserBox"></td> </tr> <tr data-type="checkUserList" title="点击选中"> <td>校对人</td> <td class="selectedUserBox"></td> </tr> <tr data-type="examineUserList" title="点击选中"> <td>审核人</td> <td class="selectedUserBox"></td> </tr> <tr data-type="examineApproveUserList" title="点击选中"> <td>审定人</td> <td class="selectedUserBox"></td> </tr> </table> </div> </div> </form>');/*v:1*/
template('m_project_cost/m_project_cost','<div> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> <div class="time-combination form-group"> </div> <button class="btn btn-white btn-sm" data-action="refreshBtn">刷新数据</button> <button class="btn btn-white btn-sm pull-right roleControl" data-action="exportDetails">导出</button> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div>');/*v:1*/
template('m_project_cost/m_project_cost_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-responsive"> <thead> <tr> <th width="5%" rowspan="2" class="text-center v-middle">立项时间</th> <th width="15%" rowspan="2" class="text-center v-middle">项目名称</th> <th rowspan="2" class="text-center v-middle">项目状态</th> <th colspan="2">合同回款</th> <th colspan="2">合作设计费</th> <th colspan="2">技术审查费</th> <th colspan="2">其他收入</th> <th colspan="2">合作设计费</th> <th colspan="2">技术审查费</th> <th colspan="2">其他支出</th> </tr> <tr> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>付款金额</th> <th>计划金额</th> <th>付款金额</th> <th>计划金额</th> <th>付款金额</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' <tr> <td >';
$out+=$escape(_momentFormat(d.projectCreateDate,'YYYY/MM/DD'));
$out+='</td> <td> ';
$out+=$escape(d.projectName);
$out+=' </td> <td > ';
if(d.status == 0){
$out+=' 进行中 ';
}else if(d.status == 1 ){
$out+=' 已暂停 ';
}else if(d.status == 2 ){
$out+=' 已完成 ';
}else if(d.status == 3){
$out+=' 已终止 ';
}else{
$out+=' -- ';
}
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.contract));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.contractReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.technical));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.technicalReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.cooperateGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.cooperateGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.otherGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.otherGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.technicalPay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.technicalPayReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.cooperatePay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.cooperateGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.otherPay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.otherPayReal));
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="17" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_project_cost/m_project_cost_menu',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,viewProjectCostForOrg=$data.viewProjectCostForOrg,$out='';$out+='<div class="ibox no-margins"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right">        <!--';
if(viewProjectCostForOrg=='1'){
$out+='-->       <!--';
}
$out+='-->  </div> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content p-b-none" id="content-box"> </div> </div>';
return new String($out);
});/*v:1*/
template('m_project_cost/m_project_cost_table1','<div class="m-project-cost"> <form role="form" class="form-horizontal"> <div class="row" id="filterBox"> <div class="col-md-12"> <div class=""> <label class="inline">分管院长：</label> <select class="from-control inline" name="deanName"></select> </div> </div> <div class="col-md-12 m-t-xs"> <div class=""> <label class="inline">所属公司：</label> <select class="from-control inline" name="orgId"></select> </div> </div> <div class="col-md-12" id="timeSelect"> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-white roleControl" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box m-t-sm"> <div class="data-list-container of-auto"></div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> ');/*v:1*/
template('m_project_cost/m_project_cost_table1_fee_type_filter',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,feeTypeNameList=$data.feeTypeNameList,p=$data.p,i=$data.i,$escape=$utils.$escape,c=$data.c,ci=$data.ci,$out='';$out+='<div class="z-index-1 p-t-xs"> <label class="inline pull-left">分类子项：</label> <div class="dp-block m-l-70 p-r-xxl max-h-200 of-auto fee-type-panel p-l-sm"> ';
$each(feeTypeNameList,function(p,i){
$out+=' <div class="col-sm-12 no-padding ';
$out+=$escape(i>3?'hide':'');
$out+='" data-index="';
$out+=$escape(i);
$out+='"> <label class="i-checks i-checks-label fw-normal"> <input type="checkbox" name="feeType" value="0" /> <span class="i-checks-span fc-dark-grey text-bold" title="';
$out+=$escape(p.expTypeValue);
$out+='">';
$out+=$escape(p.expTypeValue);
$out+='</span> </label> ';
if(p.childList && p.childList.length>0){
$out+=' ';
$each(p.childList,function(c,ci){
$out+=' <label class="i-checks i-checks-label fw-normal m-r-xs"> <input type="checkbox" name="feeType" value="';
$out+=$escape(c.expTypeValue);
$out+='" data-parent-name="';
$out+=$escape(p.expTypeValue);
$out+='"/> <span class="i-checks-span" title="';
$out+=$escape(p.expTypeValue);
$out+='">';
$out+=$escape(c.expTypeValue);
$out+='</span> </label> ';
});
$out+=' ';
}
$out+=' </div> ';
});
$out+=' <div class="clearfix"></div> </div> ';
if(feeTypeNameList && feeTypeNameList.length>4){
$out+=' <div style="position: absolute;right: 50px;top: 0;"> <button class="btn btn-default btn-sm" data-click-action="moreFeeType"><span>更多</span>&nbsp;<i class="fa fa-angle-down"></i></button> </div> ';
}
$out+=' </div>';
return new String($out);
});/*v:1*/
template('m_project_cost/m_project_cost_table1_fee_type_parent_filter',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,feeTypeParentNameList=$data.feeTypeParentNameList,p=$data.p,i=$data.i,$escape=$utils.$escape,$out='';$out+='<div class="z-index-1 p-t-xs"> <label class="inline pull-left">收支分类：</label> <div class="dp-block m-l-70 fee-type-parent-box p-l-sm"> <label class="i-checks i-checks-label fw-normal dp-inline"> <input type="checkbox" name="feeTypeParent" value="0"/> <span class="i-checks-span fc-dark-grey text-bold">全部</span> </label> <div class="dp-block m-l-162"> ';
$each(feeTypeParentNameList,function(p,i){
$out+=' <label class="i-checks i-checks-label fw-normal "> <input type="checkbox" name="feeTypeParent" value="';
$out+=$escape(p.expTypeValue);
$out+='" /> <span class="i-checks-span" title="';
$out+=$escape(p.expTypeValue);
$out+='">';
$out+=$escape(p.expTypeValue);
$out+='</span> </label> ';
});
$out+=' </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_project_cost/m_project_cost_table1_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,data=$data.data,i=$data.i,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,proData=$data.proData,j=$data.j,payData=$data.payData,liData=$data.liData,k=$data.k,_url=$helpers._url,$out='';$out+=' <table class="table table-bordered" style="table-layout : fixed ;width: 2310px"> <thead> <tr> <th width="40px" rowspan="2" class="text-center v-middle">序号</th> <th width="100px" rowspan="2" class="text-center v-middle">编号</th> <th width="100px" rowspan="2" class="text-center v-middle" >项目类型</th> <th width="120px" rowspan="2" class="text-center v-middle" >分管院长、项目负责人</th> <th width="280px" rowspan="2" class="text-center v-middle" >项目名称</th> <th width="130px" rowspan="2" class="text-center v-middle">甲方</th> <th width="550px" colspan="5" class="text-center v-middle">主合同</th> <th width="990px" colspan="9" class="text-center v-middle">外协合同</th> </tr> <tr> <th class="text-center v-middle">合同日期</th> <th class="text-center v-middle">合同总额</th> <th class="text-center v-middle">收款金额</th> <th class="text-center v-middle">收款日期</th> <th class="text-center v-middle">余额</th> <th class="text-center v-middle">外协成本预算</th> <th class="text-center v-middle">预算分包率</th> <th class="text-center v-middle">合同编号</th> <th colspan="2" class="text-center v-middle">合同名称</th> <th class="text-center v-middle">合同日期</th> <th class="text-center v-middle">合同总额</th> <th class="text-center v-middle">付款金额</th> <th class="text-center v-middle"> 付款日期</th> </tr> </thead> <tbody> ';
if(dataList != null && dataList.length > 0){
$out+=' ';
$each(dataList,function(data,i){
$out+=' <tr data-id="';
$out+=$escape(data.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" class="curp" style="height:';
$out+=$escape(data.maxCount*40);
$out+='px"> <td style="vertical-align: middle; text-align: center">';
$out+=$escape(data.index);
$out+='</td> <td style="vertical-align: middle; text-align: center">';
$out+=$escape(data.projectNo);
$out+='</td> <td style="text-overflow: ellipsis ;vertical-align: middle; text-align: center">';
$out+=$escape(data.projectType);
$out+='</td> <td style="text-overflow: ellipsis ;vertical-align: middle; text-align: center">';
$out+=$escape(data.leaderName);
$out+='</td> <td style="text-overflow: ellipsis ;vertical-align: middle; text-align: center">';
$out+=$escape(data.projectName);
$out+='</td> <td style="text-overflow: ellipsis ;vertical-align: middle; text-align: center">';
$out+=$escape(data.constructCompany);
$out+='</td> <td style="vertical-align: middle; text-align: center">';
$out+=$escape(_momentFormat(data.contractDate,'YYYY/MM/DD'));
$out+='</td> <td style="vertical-align: middle; text-align: center">';
$out+=$escape(_expNumberFilter(data.totalContractAmount));
$out+='</td> <td class="no-padding viewTemplateTd"> ';
if(data.proceedsList != null && data.proceedsList.length > 0){
$out+=' <div class="item-box" style="height:100%"> ';
$each(data.proceedsList,function(proData,j){
$out+=' ';
if(j != data.proceedsList.length - 1){
$out+=' <div class="row no-margin border-bottom dp-flex " > <div class="col-sm-2 p-xs hover-event text-center2" style=" display: table; text-align: center; width: 110px; height:';
$out+=$escape(data.maxCount/data.processCount * 39);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle"> ';
$out+=$escape(proData!=null&&proData.profitFee!=null?_expNumberFilter(proData.profitFee):'');
$out+='</div> </div> </div> ';
}else{
$out+=' <div class="row no-margin dp-flex "> <div class="col-sm-2 p-xs hover-event text-center2" style="display: table;text-align: center; width: 110px;height: ';
$out+=$escape(data.maxCount/data.processCount * 40);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle"> ';
$out+=$escape(proData!=null&&proData.profitFee!=null?_expNumberFilter(proData.profitFee):'');
$out+='</div> </div> </div> ';
}
$out+=' ';
});
$out+=' </div> ';
}
$out+=' </td> <td class="no-padding viewTemplateTd"> ';
if(data.proceedsList != null && data.proceedsList.length > 0){
$out+=' <div class="item-box" style="height: 100%"> ';
$each(data.proceedsList,function(proData,j){
$out+=' ';
if(j != data.proceedsList.length - 1){
$out+=' <div class="row no-margin border-bottom dp-flex "> <div class="col-sm-2 p-xs hover-event text-center2" style="display: table;text-align: center; width: 110px; height: ';
$out+=$escape(data.maxCount/data.processCount  * 39);
$out+='px ;vertical-align: center" > ';
if(proData!=null&&proData.profitDate!=null){
$out+=' <div style="display: table-cell;vertical-align: middle"> ';
$out+=$escape(_momentFormat(proData.profitDate,'YYYY/MM/DD'));
$out+='</div> ';
}else{
$out+=' <div style="display: table-cell;vertical-align: middle"> </div> ';
}
$out+=' </div> </div> ';
}else{
$out+=' <div class="row no-margin dp-flex "> <div class="col-sm-2 p-xs hover-event text-center2" style="display: table;text-align: center; width: 110px; height: ';
$out+=$escape(data.maxCount/data.processCount  * 40);
$out+='px ;vertical-align: center"> ';
if(proData!=null&&proData.profitDate!=null){
$out+=' <div style="display: table-cell;vertical-align: middle"> ';
$out+=$escape(_momentFormat(proData.profitDate,'YYYY/MM/DD'));
$out+='</div> ';
}else{
$out+=' <div style="display: table-cell;vertical-align: middle"> </div> ';
}
$out+=' </div> </div> ';
}
$out+=' ';
});
$out+=' </div> ';
}
$out+=' </td> <td style="vertical-align: middle; text-align: center">';
$out+=$escape(_expNumberFilter(data.balance));
$out+='</td> <td style="vertical-align: middle; text-align: center">';
$out+=$escape(_expNumberFilter(data.investmentEstimation));
$out+='</td> ';
if(data.investmentEstimationRatio != null){
$out+=' <td style="vertical-align: middle; text-align: center">';
$out+=$escape(data.investmentEstimationRatio);
$out+=' % </td> ';
}else{
$out+=' <td style="vertical-align: middle; text-align: center"> </td> ';
}
$out+=' ';
if(data.paymentList != null && (data.paymentList.length > 1 || data.payListCount > 1) ){
$out+=' <td colspan="7" class="no-padding viewTemplateTd"> <div class="item-box" style="height: 100% ;width: 770px"> ';
$each(data.paymentList,function(payData,j){
$out+=' ';
if(j != data.paymentList.length - 1){
$out+=' <div class="row no-margin no-padding border-bottom dp-flex " > <div class="col-sm-2 p-xs border-right text-center2" style="display: table;text-align: center; width: 110px ; height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 39);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle ; text-overflow: ellipsis ;height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 39);
$out+='px"> ';
$out+=$escape(payData.contractNo);
$out+='</div> </div> <div class="col-sm-2 p-xs border-right text-center2" style="display: table;text-align: center; width: 220px ; height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 39);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle ; text-overflow: ellipsis ;height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 39);
$out+='px"> ';
$out+=$escape(payData.contractName);
$out+='</div> </div> <div class="col-sm-2 p-xs border-right text-center2"style="display: table;text-align: center; width: 110px; height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 39);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle">';
$out+=$escape(_momentFormat(payData.contractDate,'YYYY/MM/DD'));
$out+='</div> </div> <div class="col-sm-2 p-xs border-right text-center2" style="display: table;text-align: center; width: 110px ;height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 39);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle">';
$out+=$escape(_expNumberFilter(payData.costFee));
$out+='</div> </div> ';
if(payData.list != null && payData.list.length > 0){
$out+=' <div class="item-box" style="width: 220px"> ';
$each(payData.list,function(liData,k){
$out+=' ';
if(k != payData.list.length - 1){
$out+=' <div class="row no-margin border-bottom dp-flex " > <div class="col-sm-2 p-xs border-right text-center2" style="display: table;text-align: center; width: 110px; height: ';
$out+=$escape(data.maxCount/data.payListCount  * 39);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle">';
$out+=$escape(_expNumberFilter(liData.payFee));
$out+='</div> </div> <div class="col-sm-2 p-xs text-center2" style="display: table;text-align: center; width: 110px ; height: ';
$out+=$escape(data.maxCount/data.payListCount  * 39);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle">';
$out+=$escape(_momentFormat(liData.profitDate,'YYYY/MM/DD'));
$out+='</div> </div> </div> ';
}else{
$out+=' <div class="row no-margin dp-flex " > <div class="col-sm-2 p-xs border-right text-center2" style="display: table;text-align: center; width: 110px ; height: ';
$out+=$escape(data.maxCount/data.payListCount  * 40);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle">';
$out+=$escape(_expNumberFilter(liData.payFee));
$out+='</div> </div> <div class="col-sm-2 p-xs text-center2" style="display: table;text-align: center; width: 110px ; height: ';
$out+=$escape(data.maxCount/data.payListCount  * 40);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle">';
$out+=$escape(_momentFormat(liData.profitDate,'YYYY/MM/DD'));
$out+='</div> </div> </div> ';
}
$out+=' ';
});
$out+=' </div> ';
}else{
$out+=' <div class="col-sm-2 p-xs border-right hover-event text-center2" style="width: 110px ;height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 40);
$out+='px ;vertical-align: center"> </div> <div class="col-sm-2 p-xs" style="width: 110px ;height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 40);
$out+='px ;vertical-align: center"> </div> ';
}
$out+=' </div> ';
}else{
$out+=' <div class="row no-margin no-padding dp-flex "> <div class="col-sm-2 p-xs border-right text-center2" style="display: table;text-align: center;width: 110px ; height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 40);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle ; text-overflow: ellipsis ; height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 40);
$out+='px"> ';
$out+=$escape(payData.contractNo);
$out+=' </div> </div> <div class="col-sm-2 p-xs border-right text-center2" style="display: table;text-align: center;width: 220px ; height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 40);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle ; text-overflow: ellipsis ; height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 40);
$out+='px"> ';
$out+=$escape(payData.contractName);
$out+=' </div> </div> <div class="col-sm-2 p-xs border-right text-center2"style="display: table;text-align: center; width: 110px; height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 40);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle">';
$out+=$escape(_momentFormat(payData.contractDate,'YYYY/MM/DD'));
$out+='</div> </div> <div class="col-sm-2 p-xs border-right text-center2" style="display: table;text-align: center; width: 110px ;height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 40);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle">';
$out+=$escape(_expNumberFilter(payData.costFee));
$out+='</div> </div> ';
if(payData.list != null && payData.list.length > 0){
$out+=' <div class="item-box" style="width: 220px"> ';
$each(payData.list,function(liData,k){
$out+=' ';
if(k != payData.list.length - 1){
$out+=' <div class="row no-margin border-bottom dp-flex " > <div class="col-sm-2 p-xs border-right text-center2" style="display: table;text-align: center; width: 110px; height: ';
$out+=$escape(data.maxCount/data.payListCount  * 39);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle">';
$out+=$escape(_expNumberFilter(liData.payFee));
$out+='</div> </div> <div class="col-sm-2 p-xs text-center2" style="display: table;text-align: center; width: 110px ; height: ';
$out+=$escape(data.maxCount/data.payListCount  * 39);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle">';
$out+=$escape(_momentFormat(liData.profitDate,'YYYY/MM/DD'));
$out+='</div> </div> </div> ';
}else{
$out+=' <div class="row no-margin dp-flex " > <div class="col-sm-2 p-xs border-right text-center2" style="display: table;text-align: center; width: 110px ; height: ';
$out+=$escape(data.maxCount/data.payListCount  * 40);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle">';
$out+=$escape(_expNumberFilter(liData.payFee));
$out+='</div> </div> <div class="col-sm-2 p-xs text-center2" style="display: table;text-align: center; width: 110px ; height: ';
$out+=$escape(data.maxCount/data.payListCount  * 40);
$out+='px ;vertical-align: center"> <div style="display: table-cell;vertical-align: middle">';
$out+=$escape(_momentFormat(liData.profitDate,'YYYY/MM/DD'));
$out+='</div> </div> </div> ';
}
$out+=' ';
});
$out+=' </div> ';
}else{
$out+=' <div class="col-sm-2 p-xs border-right hover-event text-center2" style="width: 110px ;height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 40);
$out+='px ;vertical-align: center"> </div> <div class="col-sm-2 p-xs" style="width: 110px ;height: ';
$out+=$escape(data.maxCount/data.payListCount * payData.listCount * 40);
$out+='px ;vertical-align: center"> </div> ';
}
$out+=' </div> ';
}
$out+=' ';
});
$out+=' </div> </td> ';
}else if( data.paymentList != null && data.paymentList.length == 1 && data.paymentList[0].list.length == 1 ){
$out+=' <td style=" text-overflow: ellipsis;vertical-align: middle;text-align: center">';
$out+=$escape(data.paymentList[0].contractNo);
$out+='</td> <td colspan="2" style=" text-overflow: ellipsis;vertical-align: middle;text-align: center">';
$out+=$escape(data.paymentList[0].contractName);
$out+='</td> <td style="vertical-align: middle;text-align: center">';
$out+=$escape(_momentFormat(data.paymentList[0].contractDate,'YYYY/MM/DD'));
$out+='</td> <td style="vertical-align: middle;text-align: center">';
$out+=$escape(_expNumberFilter(data.paymentList[0].costFee));
$out+=' </td> <td style="vertical-align: middle;text-align: center">';
$out+=$escape(_expNumberFilter(data.paymentList[0].list[0].payFee));
$out+='</td> <td style="vertical-align: middle;text-align: center">';
$out+=$escape(_momentFormat(data.paymentList[0].list[0].profitDate,'YYYY/MM/DD'));
$out+='</td> ';
}else if( data.paymentList != null && data.paymentList.length == 1 ){
$out+=' <td style=" text-overflow: ellipsis;vertical-align: middle;text-align: center">';
$out+=$escape(data.paymentList[0].contractNo);
$out+='</td> <td colspan="2" style=" text-overflow: ellipsis;vertical-align: middle;text-align: center">';
$out+=$escape(data.paymentList[0].contractName);
$out+='</td> <td style="vertical-align: middle;text-align: center">';
$out+=$escape(_momentFormat(data.paymentList[0].contractDate,'YYYY/MM/DD'));
$out+='</td> <td style="vertical-align: middle;text-align: center">';
$out+=$escape(_expNumberFilter(data.paymentList[0].costFee));
$out+=' </td> <td style="vertical-align: middle;text-align: center"></td> <td style="vertical-align: middle;text-align: center"></td> ';
}else{
$out+=' <td></td> <td colspan="2"></td> <td></td> <td></td> <td></td> <td></td> ';
}
$out+=' </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="8" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_project_cost/m_project_cost_table2',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,isMyDataFlag=$data.isMyDataFlag,$out='';$out+='<div class="m-project-cost"> <form role="form" class="form-inline m-b-sm"> <div class="row"> ';
if(isMyDataFlag == 2){
$out+=' <div class="col-md-12"> <div class="z-index-1"> <label class="inline">当前组织：</label> <div class="dp-inline-block vertical-middle p-l-sm"> <label class="i-checks i-checks-label fw-normal dp-inline-block roleControl" style="width: auto;" > <input type="radio" name="isMyData" value="0" checked/> </label> <div class="btn-group vertical-baseline roleControl" id="selectOrg" > </div> <label class="i-checks i-checks-label fw-normal dp-inline-block roleControl" > <input type="radio" name="isMyData" value="1"/> <span class="i-checks-span">我负责的项目</span> </label> </div> </div> </div> ';
}else if(isMyDataFlag == 0){
$out+=' <div class="col-md-12"> <div class="z-index-1"> <label class="inline">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> </div> ';
}
$out+=' <div class="col-md-12" id="timeSelect"> </div> <div class="col-md-12" id="statusSelect"> </div> <div class="col-md-12" id="signDateStatusSelect"> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-primary btn-sm" data-action="collectionPlan">收款计划</button> <button class="btn btn-white btn-sm" data-action="paymentPlan">付款计划</button> <button class="btn btn-white btn-sm roleControl" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_project_cost/m_project_cost_table2_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="table table-striped table-bordered table-hover text-nowrap" id="cost2_list" style="width:100%;"> <thead> <tr> <th rowspan="2" class="vertical-middle">立项时间</th> <th rowspan="2" class="vertical-middle">项目名称</th> <th rowspan="2" class="vertical-middle">立项组织</th> <th rowspan="2" class="vertical-middle">项目状态</th> <th colspan="2" class="text-center">合同回款</th> <th colspan="2" class="text-center">合作设计费</th> <th colspan="2" class="text-center">技术审查费</th> <th colspan="2" class="text-center">其他收入</th> <th colspan="2" class="text-center">合作设计费</th> <th colspan="2" class="text-center">技术审查费</th> <th colspan="2" class="text-center">其他支出</th> </tr> <tr> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>付款金额</th> <th>计划金额</th> <th>付款金额</th> <th>计划金额</th> <th>付款金额</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' ';
if(d!=null){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" class="curp"> <td > ';
if(i==dataList.length-1){
$out+=' 合计 ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(d.projectCreateDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </td> <td> ';
$out+=$escape(d.projectName);
$out+=' </td> <td>';
$out+=$escape(d.createCompany);
$out+='</td> <td > ';
$out+=$escape(d.statusName);
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.contract));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.contractReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.cooperateGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.cooperateGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.technicalGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.technicalGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.otherGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.otherGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.cooperatePay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.cooperatePayReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.technicalPay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.technicalPayReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.otherPay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.otherPayReal));
$out+=' </td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="18" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_project_cost/m_project_cost_table2_list1',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="table table-striped table-bordered table-hover text-nowrap" id="cost2_list" style="width:100%;"> <thead> <tr> <th rowspan="2" class="vertical-middle">立项时间</th> <th rowspan="2" class="vertical-middle">项目名称</th> <th rowspan="2" class="vertical-middle">立项组织</th> <th rowspan="2" class="vertical-middle">项目状态</th> <th colspan="2" class="text-center">合同回款</th> <th colspan="2" class="text-center">合作设计费</th> <th colspan="2" class="text-center">技术审查费</th> <th colspan="2" class="text-center">其他收入</th> <th colspan="3" class="text-center">合计</th> <th rowspan="2" class="vertical-middle">应收</th> </tr> <tr> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>发起金额</th> <th>到账金额</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' ';
if(d!=null){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" class="curp"> <td > ';
if(i==dataList.length-1){
$out+=' 合计 ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(d.projectCreateDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </td> <td> ';
$out+=$escape(d.projectName);
$out+=' </td> <td>';
$out+=$escape(d.createCompany);
$out+='</td> <td > ';
$out+=$escape(d.statusName);
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.contract));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.contractReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.cooperateGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.cooperateGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.technicalGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.technicalGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.otherGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.otherGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumPlanFee));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumStartFee));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumFee));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumNeedFee));
$out+=' </td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="16" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_project_cost/m_project_cost_table2_list2',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="table table-striped table-bordered table-hover text-nowrap" id="cost2_list" style="width:100%;"> <thead> <tr> <th rowspan="2" class="vertical-middle">立项时间</th> <th rowspan="2" class="vertical-middle">项目名称</th> <th rowspan="2" class="vertical-middle">立项组织</th> <th rowspan="2" class="vertical-middle">项目状态</th> <th colspan="2" class="text-center">合作设计费</th> <th colspan="2" class="text-center">技术审查费</th> <th colspan="2" class="text-center">其他支出</th> <th colspan="3" class="text-center">合计</th> <th rowspan="2" class="vertical-middle">应付</th> </tr> <tr> <th>计划金额</th> <th>付款金额</th> <th>计划金额</th> <th>付款金额</th> <th>计划金额</th> <th>付款金额</th> <th>计划金额</th> <th>付款申请金额</th> <th>付款金额</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' ';
if(d!=null){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" class="curp"> <td > ';
if(i==dataList.length-1){
$out+=' 合计 ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(d.projectCreateDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </td> <td> ';
$out+=$escape(d.projectName);
$out+=' </td> <td>';
$out+=$escape(d.createCompany);
$out+='</td> <td > ';
$out+=$escape(d.statusName);
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.cooperatePay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.cooperatePayReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.technicalPay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.technicalPayReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.otherPay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.otherPayReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumPlanFee));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumStartFee));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumFee));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumNeedFee));
$out+=' </td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="14" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_project_cost/m_project_cost_table3','<div class="m-project-cost"> <form role="form" class="form-inline m-b-sm"> <div class="row"> <div class="col-md-12"> <div class="z-index-1"> <label class="inline">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> </div> <div class="col-md-12" id="timeSelect"> </div> <div class="col-md-12" id="statusSelect"> </div> <div class="col-md-12" id="signDateStatusSelect"> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-primary btn-sm" data-action="collectionPlan">收款计划</button> <button class="btn btn-white btn-sm" data-action="paymentPlan">付款计划</button> <button class="btn btn-white btn-sm roleControl" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box"> <div class="data-list-container"></div>  </div> </div>');/*v:1*/
template('m_project_cost/m_project_cost_table3_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-hover table-responsive text-nowrap"> <thead> <tr> <th rowspan="2" class="vertical-middle">组织名称</th> <th colspan="2" class="text-center">合同回款</th> <th colspan="2" class="text-center">合作设计费</th> <th colspan="2" class="text-center">技术审查费</th> <th colspan="2" class="text-center">其他收入</th> <th colspan="2" class="text-center">合作设计费</th> <th colspan="2" class="text-center">技术审查费</th> <th colspan="2" class="text-center">其他支出</th> </tr> <tr> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>付款金额</th> <th>计划金额</th> <th>付款金额</th> <th>计划金额</th> <th>付款金额</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" class="curp"> <td> ';
$out+=$escape(d.createCompany);
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.contract));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.contractReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.cooperateGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.cooperateGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.technicalGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.technicalGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.otherGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.otherGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.cooperatePay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.cooperatePayReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.technicalPay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.technicalPayReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.otherPay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.otherPayReal));
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="15" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_project_cost/m_project_cost_table3_list1',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="table table-striped table-bordered table-hover text-nowrap" id="cost3_list" style="width:100%;"> <thead> <tr> <th rowspan="2" class="vertical-middle">组织名称</th> <th colspan="2" class="text-center">合同回款</th> <th colspan="2" class="text-center">合作设计费</th> <th colspan="2" class="text-center">技术审查费</th> <th colspan="2" class="text-center">其他收入</th> <th colspan="3" class="text-center">合计</th> <th rowspan="2" class="vertical-middle">应收</th> </tr> <tr> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>到账金额</th> <th>计划金额</th> <th>发起金额</th> <th>到账金额</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' ';
if(d!=null){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" class="curp"> <td>';
$out+=$escape(d.createCompany);
$out+='</td> <td> ';
$out+=$escape(_expNumberFilter(d.contract));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.contractReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.cooperateGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.cooperateGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.technicalGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.technicalGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.otherGain));
$out+=' </td> <td class="fc-v2-green"> ';
$out+=$escape(_expNumberFilter(d.otherGainReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumPlanFee));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumStartFee));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumFee));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumNeedFee));
$out+=' </td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="13" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_project_cost/m_project_cost_table3_list2',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="table table-striped table-bordered table-hover text-nowrap" id="cost3_list" style="width:100%;"> <thead> <tr> <th rowspan="2" class="vertical-middle">组织名称</th> <th colspan="2" class="text-center">合作设计费</th> <th colspan="2" class="text-center">技术审查费</th> <th colspan="2" class="text-center">其他支出</th> <th colspan="3" class="text-center">合计</th> <th rowspan="2" class="vertical-middle">应付</th> </tr> <tr> <th>计划金额</th> <th>付款金额</th> <th>计划金额</th> <th>付款金额</th> <th>计划金额</th> <th>付款金额</th> <th>计划金额</th> <th>付款申请金额</th> <th>付款金额</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' ';
if(d!=null){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" class="curp"> <td>';
$out+=$escape(d.createCompany);
$out+='</td> <td> ';
$out+=$escape(_expNumberFilter(d.cooperatePay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.cooperatePayReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.technicalPay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.technicalPayReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.otherPay));
$out+=' </td> <td class="fc-v1-red"> ';
$out+=$escape(_expNumberFilter(d.otherPayReal));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumPlanFee));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumStartFee));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumFee));
$out+=' </td> <td> ';
$out+=$escape(_expNumberFilter(d.sumNeedFee));
$out+=' </td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="11" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_project_cost/m_project_cost_table4','<div class="m_payments_ledger"> <form role="form" class="form-inline m-b-sm"> <div class="row"> <div class="col-md-12"> <div class="z-index-1"> <label class="inline">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> </div> <div class="col-md-12" id="timeSelect"> </div> <div class="col-md-12" id="statusSelect"> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-b-sm m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-white btn-sm pull-right roleControl" roleCode="40001302" flag="2" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box"> <div class="data-list-container of-auto"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div>');/*v:1*/
template('m_project_cost/m_project_cost_table4_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,d=$data.d,i=$data.i,$escape=$utils.$escape,_expNumberFilterPoint2=$helpers._expNumberFilterPoint2,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-hover table-responsive text-nowrap"> <thead> <tr> <th></th> <th>收入</th> <th>其他业务收入</th> <th>支出</th> <th>房屋物业费用</th> <th>行政费用</th> <th>经营费用</th> <th>软件、不动产购置</th> <th>合计</th> </tr> </thead> <tbody> ';
$each(dataList,function(d,i){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" class="curp"> <td> ';
$out+=$escape(d.projectName);
$out+=' </td> <td>';
$out+=$escape(_expNumberFilterPoint2(d.mainIncome));
$out+='</td> <td>';
$out+=$escape(_expNumberFilterPoint2(d.otherIncome));
$out+='</td> <td>';
$out+=$escape(_expNumberFilterPoint2(d.directProjectCost));
$out+='</td> <td>';
$out+=$escape(_expNumberFilterPoint2(d.propertyManagementFee));
$out+='</td> <td>';
$out+=$escape(_expNumberFilterPoint2(d.administrativeCost));
$out+='</td> <td>';
$out+=$escape(_expNumberFilterPoint2(d.manageFee));
$out+='</td> <td>';
$out+=$escape(_expNumberFilterPoint2(d.realEstateFee));
$out+='</td> <td>';
$out+=$escape(_expNumberFilterPoint2(d.total));
$out+='</td> </tr> ';
});
$out+=' ';
if(!(dataList && dataList.length>0)){
$out+=' <tr class="no-data"> <td colspan="9" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_role/m_role',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,doType=$data.doType,$out='';$out+='<div class="row"> <div class="col-24-sm-5 of-auto border-right p-r-none" id="role-out-box" style="height: 500px;"> <div> ';
if(doType==1){
$out+=' <button href="javascript:void(0)" class="btn btn-link roleControl" roleCode="10000401" flag="2" data-action="addGroup" > <i class="fa fa-plus"></i>&nbsp;新建分组 </button> <button href="javascript:void(0)" class="btn btn-link roleControl" roleCode="10000401" flag="2" data-action="addRole"> <i class="fa fa-plus"></i>&nbsp;新建角色 </button> ';
}
$out+=' </div> <div id="role-box"> </div> </div> <div class="col-24-sm-19 p-r-lg" id="view-box"> </div> </div>  ';
return new String($out);
});/*v:1*/
template('m_role/m_role_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,doType=$data.doType,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-md-2 text-right m-t-xs">角色名<span class="color-red">*</span>：</label> <div class="col-md-9"> <input type="text" class="form-control" name="name" id="name" maxlength="50" placeholder="请输入角色名" value="';
$out+=$escape(dataInfo!=null?dataInfo.name:'');
$out+='"> </div> </div> ';
if(doType==1){
$out+=' <div class="form-group"> <label class="col-md-2 text-right m-t-xs">角色组：</label> <div class="col-md-9"> <select class="form-control" name="groupId"> </select> </div> </div> ';
}
$out+=' <div class="form-group"> <label class="col-md-2 text-right m-t-xs">描述：</label> <div class="col-md-9"> <textarea type="text" class="form-control" style="width: 100%;" name="description" >';
$out+=$escape(dataInfo!=null?dataInfo.description:'');
$out+='</textarea> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_role/m_role_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,selectedRole=$data.selectedRole,doType=$data.doType,$out='';$out+='<h3 class="p-t p-b-none" id="roleTitle">';
$out+=$escape(selectedRole.name);
$out+='</h3> <span id="roleDescription">';
$out+=$escape(selectedRole.description);
$out+='</span> <div class="tabs-container m-t-sm"> <ul class="nav nav-tabs"> <li class="active"> <a data-toggle="tab" href="#tab-1" aria-expanded="true">';
$out+=$escape(doType==2?'部门成员':'角色成员');
$out+='</a> </li> ';
if(selectedRole.id!='0'){
$out+=' <li class=""> <a data-toggle="tab" href="#tab-2" aria-expanded="false">';
$out+=$escape(doType==2?'部门权限':'功能权限');
$out+='</a> </li> ';
}
$out+=' <li class="pull-right"> <!--';
if(selectedRole.name=='商务秘书'){
$out+=' <button class="btn btn-primary" data-action="setRule" data-type="1">规则设置</button> ';
}else if(selectedRole.name=='设计负责人'){
$out+=' <button class="btn btn-primary" data-action="setRule" data-type="2">规则设置</button> ';
}
$out+='--> </li> </ul> <div class="tab-content p-b-md"> <div id="tab-1" class="tab-pane active"> <div class="panel-body" id="role-users-box"> </div> </div> ';
if(selectedRole.id!='0'){
$out+=' <div id="tab-2" class="tab-pane"> <div class="panel-body" id="role-view-box"> </div> </div> ';
}
$out+=' </div> </div>';
return new String($out);
});/*v:1*/
template('m_role/m_role_group_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-md-2 text-right m-t-xs">分组名称<span class="color-red">*</span>：</label> <div class="col-md-9"> <input type="text" class="form-control" name="groupName" maxlength="50" placeholder="请输入分组名称" value="';
$out+=$escape(dataInfo!=null?dataInfo.groupName:'');
$out+='"> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_role/m_role_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,roleList=$data.roleList,$each=$utils.$each,o=$data.o,i=$data.i,$escape=$utils.$escape,doType=$data.doType,r=$data.r,ri=$data.ri,$out='';$out+='<ul class="list-group role-list"> ';
if(roleList!=null && roleList.length>0){
$out+=' ';
$each(roleList,function(o,i){
$out+=' <li class="list-group-item no-borders"> <div class="dp-block group-item ';
$out+=$escape((o.roleList!=null && o.roleList.length>0)?'':'p-l-l');
$out+='" data-id="';
$out+=$escape(o.id);
$out+='"> ';
if(o.roleList!=null && o.roleList.length>0){
$out+=' <a href="javascript:void(0);" data-action="expand"><i class="fa fa-caret-down f-s-lg"></i></a> ';
}
$out+=' &nbsp;<a>';
$out+=$escape(o.groupName);
$out+='</a> ';
if(o.groupName!='默认' && doType!=2){
$out+=' <div class="btn-group roleControl" style="display: none;" > <a type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-expanded="false"> <i class="fa fa-angle-double-down"></i> </a> <ul class="dropdown-menu dropdown-menu-v1" role="menu" style="top: 75%;"> <li> <a href="javascript:void(0)" data-action="editRoleGroup">';
$out+=$escape(doType==1?'修改分组':'修改部门分组');
$out+='</a> </li> ';
if(o.roleList==null || o.roleList.length==0){
$out+=' <li> <a href="javascript:void(0)" data-action="delRoleGroup">';
$out+=$escape(doType==1?'删除分组':'删除部门分组');
$out+='</a> </li> ';
}
$out+=' </ul> </div> ';
}
$out+=' </div> ';
if(o.roleList!=null && o.roleList.length>0){
$out+=' <ul class="list-group" role="menu"> ';
$each(o.roleList,function(r,ri){
$out+=' <li class="list-group-item no-borders" > <div class="dp-block role-item" data-id="';
$out+=$escape(r.id);
$out+='" > <a href="javascript:void(0);" class="role-name" data-action="selectedRole" data-container="body" data-toggle="tooltip" data-original-title="';
$out+=$escape(r.description);
$out+='">';
$out+=$escape(r.name);
$out+='</a> ';
if(r.isSystem!=1){
$out+=' <div class="btn-group" style="display: none;"> <a type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-expanded="false"> <i class="fa fa-angle-double-down"></i> </a> <ul class="dropdown-menu dropdown-menu-v1" style="top: 75%;"> <li> <a href="javascript:void(0)" data-action="editRole">';
$out+=$escape(doType==1?'修改角色':'修改部门类型');
$out+='</a> </li> <li> <a href="javascript:void(0)" data-action="delRole">';
$out+=$escape(doType==1?'删除角色':'删除部门类型');
$out+='</a> </li> </ul> </div> ';
}
$out+=' </div> </li> ';
});
$out+=' </ul> ';
}
$out+=' </li > ';
});
$out+=' ';
}
$out+=' </ul> ';
return new String($out);
});/*v:1*/
template('m_role/m_role_manager_settings',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataList=$data.dataList,$each=$utils.$each,t=$data.t,ti=$data.ti,$string=$utils.$string,_include=$helpers._include,userList=$data.userList,role=$data.role,currentCompanyUserId=$data.currentCompanyUserId,_url=$helpers._url,$out='';$out+='<div class="p-t p-l p-r m-role-manager-settings"> <table class="tree table table-bordered "> <thead> <tr> <th width="30%" class="b-l-none"> ';
$out+=$escape(dataList && dataList.length>0?dataList[0].text:'组织名称');
$out+=' </th> <th>部门主管</th> <th>部门财务主管</th> <th>部门行政主管</th> <th>部门项目主管</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(t,ti){
$out+=' <tr class="m-production-content-row tree-box-tr treegrid-';
$out+=$escape(t.id);
$out+=' ';
if(t.pid!=null && t.pid!=''){
$out+=' treegrid-parent-';
$out+=$escape(t.pid);
$out+=' ';
}
$out+=' " data-id="';
$out+=$escape(t.id);
$out+='" data-pid="';
$out+=$escape(t.pid);
$out+='" > <td class="vertical-middle"> <span class="dp-inline-block">';
$out+=$escape(t.text);
$out+='</span> </td> <td> ';
if(t.type=='4'){
$out+=' -- ';
}else{
$out+=' <span class="show-span"> ';
$out+=$string(_include('m_role/m_role_users_display',{userList:t.departManagerList,role:1,currentCompanyUserId:currentCompanyUserId}));
$out+=' </span> <a href="javascript:void(0);" data-action="addUsers" data-key="departManagerList" data-role="departManager" data-title="部门主管" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> ';
if(t.type=='4'){
$out+=' -- ';
}else{
$out+=' <span class="show-span"> ';
$out+=$string(_include('m_role/m_role_users_display',{userList:t.financeManagerList,role:1,currentCompanyUserId:currentCompanyUserId}));
$out+=' </span> <a href="javascript:void(0);" data-action="addUsers" data-key="financeManagerList" data-role="financeManager" data-title="部门财务主管" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> ';
if(t.type=='4'){
$out+=' -- ';
}else{
$out+=' <span class="show-span"> ';
$out+=$string(_include('m_role/m_role_users_display',{userList:t.adminManagerList,role:1,currentCompanyUserId:currentCompanyUserId}));
$out+=' </span> <a href="javascript:void(0);" data-action="addUsers" data-key="adminManagerList" data-role="adminManager" data-title="部门行政主管" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> ';
if(t.type=='4'){
$out+=' -- ';
}else{
$out+=' <span class="show-span"> ';
$out+=$string(_include('m_role/m_role_users_display',{userList:t.projectManagerList,role:1,currentCompanyUserId:currentCompanyUserId}));
$out+=' </span> <a href="javascript:void(0);" data-action="addUsers" data-key="projectManagerList" data-role="projectManager" data-title="部门项目主管" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
if(dataList.length==1){
$out+=' <tr class="no-data-tr"> <td colspan="5" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="5" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_role/m_role_org',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,role=$data.role,_url=$helpers._url,$out='';$out+='<div class="row m-b-xs"> <div class="col-md-6"> <span>全部成员，共';
$out+=$escape(dataList?dataList.length:0);
$out+='个</span> </div> <div class="col-md-6 text-right"> </div> </div> <table class="table table-hover table-bordered table-responsive" id="table-role-users"> <thead> <tr> <th>部门名称</th> <th>权限类型</th> <th>负责人</th> <th>手机号码</th> <th>操作</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <tr data-id="';
$out+=$escape(p.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='"> <td>';
$out+=$escape(p.orgName);
$out+='</td> <td>';
$out+=$escape(p.roleName);
$out+='</td> <td> <span class="show-span"> ';
if(p.systemManager){
$out+=' ';
$out+=$escape(p.systemManager);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">--</span> ';
}
$out+=' </span> </td> <td>';
$out+=$escape(p.cellphone);
$out+='</td> <td> <!--<button class="btn btn-primary btn-xs" data-action="setDirectDepart">设置成直属部门</button> <button class="btn btn-default btn-xs" data-action="setManager" data-id="';
$out+=$escape(p.systemManagerId);
$out+='" data-name="';
$out+=$escape(p.systemManager);
$out+='">设置负责人</button> <button class="btn btn-info btn-xs" data-action="setIndependentOrg">设置成独立机构</button>--> <button class="btn btn-primary btn-xs" data-action="changeRole">变更权限</button> </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="';
$out+=$escape(role.id!='10001' && role.id!='departManager'?5:4);
$out+='" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_role/m_role_org_change',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,roleData=$data.roleData,$each=$utils.$each,o=$data.o,i=$data.i,p=$data.p,$index=$data.$index,dataInfo=$data.dataInfo,$escape=$utils.$escape,$out='';$out+='<form class="form-horizontal m-role-org-change m"> <div class="form-group"> <label class="col-sm-3 control-label">权限类型<span class="fc-red">*</span>：</label> <div class="col-sm-9 p-t-7"> <div class="row"> ';
if(roleData.listRoleGroup && roleData.listRoleGroup.length>0){
$out+=' ';
$each(roleData.listRoleGroup,function(o,i){
$out+=' ';
$each(o.roleList,function(p,$index){
$out+=' <div class="col-sm-3 p-r-none"> <label class="i-checks i-checks-label fw-normal"> ';
if(dataInfo && dataInfo.roleType==p.id){
$out+=' <input type="radio" name="roleType" value="';
$out+=$escape(p.id);
$out+='" title="';
$out+=$escape(p.description);
$out+='" checked/> ';
}else{
$out+=' <input type="radio" name="roleType" value="';
$out+=$escape(p.id);
$out+='" title="';
$out+=$escape(p.description);
$out+='"/> ';
}
$out+=' <span class="i-checks-span text-ellipsis">';
$out+=$escape(p.name);
$out+='</span> </label> </div> ';
});
$out+=' ';
});
$out+=' ';
}
$out+=' </div> </div> </div> <div class="form-group ';
$out+=$escape(dataInfo.roleType==0?'hide':'');
$out+='" data-type="orgType"> <label class="col-sm-3 control-label">部门分组<span class="fc-red">*</span>：</label> <div class="col-sm-9 p-t-7"> <div class="row"> ';
if(roleData.listOrgGroup && roleData.listOrgGroup.length>0){
$out+=' ';
$each(roleData.listOrgGroup,function(p,$index){
$out+=' <div class="col-sm-3 p-r-none"> <label class="i-checks i-checks-label fw-normal"> ';
if(dataInfo && dataInfo.orgGroupId==p.id){
$out+=' <input type="radio" name="orgGroupId" value="';
$out+=$escape(p.id);
$out+='" checked/> ';
}else{
$out+=' <input type="radio" name="orgGroupId" value="';
$out+=$escape(p.id);
$out+='"/> ';
}
$out+=' <span class="i-checks-span text-ellipsis">';
$out+=$escape(p.orgName);
$out+='</span> </label> </div> ';
});
$out+=' ';
}
$out+=' </div> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">负责人姓名<span class="fc-red">*</span>：</label> <div class="col-sm-9"> <input placeholder="请输入负责人姓名" class="form-control" type="text" name="userName" value="';
$out+=$escape(dataInfo?dataInfo.systemManager:'');
$out+='"> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">负责人手机号<span class="fc-red">*</span>：</label> <div class="col-sm-9"> <input placeholder="请输入负责人手机号" class="form-control" type="text" name="cellphone" maxlength="11" value="';
$out+=$escape(dataInfo?dataInfo.cellphone:'');
$out+='"> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_role/m_role_preview','<div class="m"> <div class="row"> <div class="col-md-12"> <div class="radio radio-inline m-t-none "> <input id="t1" class="curp" value="1" name="roleType" type="radio" checked> <label class="r-blue-bg" for="t1">类型一</label> </div> <div class="radio radio-inline curp"> <input id="t2" class="curp" value="2" name="roleType" type="radio"> <label class="r-green-bg" for="t2">类型二</label> </div> <div class="radio radio-inline curp hide"> <input id="t3" class="curp" value="3" name="roleType" type="radio"> <label class="r-red-bg" for="t3">类型三</label> </div> </div> </div> <div id="rolePreview" class="m-t-xs"> </div> </div> ');/*v:1*/
template('m_role/m_role_select_user',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,type=$data.type,$each=$utils.$each,orgUserList=$data.orgUserList,p=$data.p,$index=$data.$index,selectedUserList=$data.selectedUserList,$out='';$out+='<form class="form-horizontal rounded-bottom taskProgressOBox noborder"> <div class="ibox"> <div class="ibox-content"> <div class="userListBox"> <table class="table table-striped table-hover table-responsive m-b-none" > <thead> <tr> <th>';
$out+=$escape(type==1?'姓名':'名称');
$out+='</th> ';
if(type==1){
$out+='<th>手机号</th>';
}
$out+=' <th></th> </tr> </thead> <tbody> ';
$each(orgUserList,function(p,$index){
$out+=' <tr data-id="';
$out+=$escape(p.id);
$out+='"> <td> ';
$out+=$escape(type==1?p.userName:p.name);
$out+=' </td> ';
if(type==1){
$out+=' <td> ';
$out+=$escape(p.cellphone);
$out+=' </td> ';
}
$out+=' <td> ';
if(selectedUserList.indexOf(p.id) > -1){
$out+=' <a href="javascript:void(0)" data-company-user-id="';
$out+=$escape(p.id);
$out+='" data-user-id="';
$out+=$escape(p.userId);
$out+='" class="btn-u btn-u-default btn-u-xs rounded ';
$out+=$escape(type==1?'no-hover':'');
$out+='" data-action="';
$out+=$escape(type==1?'':'choseUser');
$out+='">选择</a> ';
}else{
$out+=' <a href="javascript:void(0)" data-action="choseUser" data-company-user-id="';
$out+=$escape(p.id);
$out+='" data-user-id="';
$out+=$escape(p.userId);
$out+='" class="btn-u btn-u-primany btn-u-xs rounded">选择</a> ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
if(orgUserList==null || orgUserList.length==0){
$out+=' <tr> <td colspan="';
$out+=$escape(type==1?3:2);
$out+='" align="center">暂无数据</td> </tr> ';
}
$out+=' </tbody> <tfoot><tr><td colspan="3" id="userList"></td></tr></tfoot> </table> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_role/m_role_set_operator_rule',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,ruleType=$data.ruleType,$escape=$utils.$escape,title=$data.title,$out='';$out+='<form class="form-horizontal m"> ';
if(ruleType==1){
$out+=' <p class="f-s-m">负责项目费用管理的商务秘书由系统指定时按以下规则处理：</p> ';
}else{
$out+=' <p class="f-s-m">负责项目订单/生产管理的设计负责人由系统指定时按以下规则处理：</p> ';
}
$out+=' <div> <label class="i-checks i-checks-label"> <input class="ck" name="iCheck" type="radio" data-type="1" checked /> <span class="i-checks-span-default">固定人员</span> </label> <span class="fc-v1-grey dp-inline-block vertical-top"><!--（固定一个';
$out+=$escape(title);
$out+='负责人，当有新项目产生时，固定该人员为新项目的';
$out+=$escape(title);
$out+='负责人）--></span> </div> <div class="panel panel-default" data-type="1"> <div class="panel-body" > <select class="form-control" name="companyUser1" ></select> </div> </div> <div class="m-t-xs"> <label class="i-checks i-checks-label"> <input class="ck" name="iCheck" type="radio" data-type="2" /> <span class="i-checks-span-default">轮流处理</span> </label> <span class="fc-v1-grey dp-inline-block vertical-top"><!--（';
$out+=$escape(title);
$out+='负责人有多个时，新项目产生时，由系统根据规则进行轮流分配处理）--></span> </div> <div class="panel panel-default" data-type="2" style="display: none;"> <div class="panel-body" > <select class="form-control" name="companyUser2" multiple ></select> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_role/m_role_tab',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,companyVersion=$data.companyVersion,$out='';$out+='<div class="row">          <!--';
if(companyVersion=='01' || companyVersion=='01-1' || companyVersion=='02' || companyVersion=='02-1' ){
$out+='-->  <!--';
}
$out+='-->     <div class="clearfix"></div> <div class="col-md-12" id="roleContentBox"> </div> </div>';
return new String($out);
});/*v:1*/
template('m_role/m_role_users',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,userList=$data.userList,role=$data.role,companyUserId=$data.companyUserId,$each=$utils.$each,u=$data.u,ui=$data.ui,_url=$helpers._url,$out='';$out+='<div class="row m-b-xs"> <div class="col-md-6"> <span>全部成员，共';
$out+=$escape(userList?userList.length:0);
$out+='人</span> </div> <div class="col-md-6 text-right"> ';
if(role.id!='10001'){
$out+=' <a href="javascript:void(0);" class="btn btn-link no-padding roleControl" roleCode="10000401" flag="2" data-action="delRoleUser">批量删除</a> <a href="javascript:void(0);" class="btn btn-link no-padding roleControl" roleCode="10000401" flag="2" data-action="addRoleUser">添加人员</a> ';
}else if(userList!=null && userList.length>0  && userList[0].companyUserId==companyUserId && role.id=='10001'){
$out+=' <a href="javascript:void(0);" class="btn btn-link no-padding" data-action="transferSys">移交负责人</a> ';
}
$out+=' </div> </div> <table class="table table-hover table-bordered table-responsive" id="table-role-users"> <thead> <tr> ';
if(role.id!='10001' && role.id!='departManager'){
$out+=' <th width="6%"> <label class="i-checks fw-normal m-b-none"> <input name="userAllCK" type="checkbox" /> <span class="i-checks-span"></span> </label> </th> ';
}
$out+=' <th width="29%">姓名</th> <th width="20%">手机号码</th>   </tr> </thead> <tbody> ';
if(userList!=null && userList.length>0){
$out+=' ';
$each(userList,function(u,ui){
$out+=' <tr data-id="';
$out+=$escape(u.companyUserId);
$out+='" data-name="';
$out+=$escape(u.userName);
$out+='"> ';
if(role.id!='10001' && role.id!='departManager'){
$out+=' <td> <label class="i-checks fw-normal m-b-none"> <input name="userCK" type="checkbox" /> <span class="i-checks-span"></span> </label> </td> ';
}
$out+=' <td>';
$out+=$escape(u.userName);
$out+='</td> <td>';
$out+=$escape(u.cellphone);
$out+='</td> <!--<td>';
$out+=$escape(u.phone);
$out+='</td>--> <!--<td>';
$out+=$escape(u.email);
$out+='</td>--> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="';
$out+=$escape(role.id!='10001' && role.id!='departManager'?5:4);
$out+='" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关人员</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_role/m_role_users_display',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,userList=$data.userList,user=$data.user,$escape=$utils.$escape,currentCompanyUserId=$data.currentCompanyUserId,$each=$utils.$each,u=$data.u,ui=$data.ui,role=$data.role,$out='';if(userList!=null && userList.length>0){
$out+=' ';
if(user){
$out+=' <span class="';
$out+=$escape(user.companyUserId == currentCompanyUserId?'text-navy':'');
$out+='">';
$out+=$escape(user.name);
$out+='</span> ';
}
$out+=' ';
$each(userList,function(u,ui){
$out+=' ';
if(user ){
$out+=' ';
if(u.id!=user.id){
$out+=' ,<span>';
$out+=$escape(u.name);
$out+='</span> ';
}
$out+=' ';
}else{
$out+=' ';
if(ui>0){
$out+=' ,<span>';
$out+=$escape(u.name);
$out+='</span> ';
}else{
$out+=' <span>';
$out+=$escape(u.name);
$out+='</span> ';
}
$out+=' ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' ';
if(role && role==1){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' <span class="fc-v1-grey">--</span> ';
}
$out+=' ';
}
return new String($out);
});/*v:1*/
template('m_role/m_role_view',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,isDialog=$data.isDialog,isView=$data.isView,formType=$data.formType,role=$data.role,viewList=$data.viewList,$each=$utils.$each,v=$data.v,vi=$data.vi,c=$data.c,ci=$data.ci,$out='';$out+='<div class="m-role-view pt-relative ';
$out+=$escape(isDialog?'m':'');
$out+=' ';
$out+=$escape(isView?'role-view':'');
$out+='" data-from-type="';
$out+=$escape(formType);
$out+='"> ';
if(!isView){
$out+=' <div class="row m-b-xs">  <div class="col-md-12 text-right"> <label class="i-checks i-checks-label fw-normal m-b-none" id="roleViewAllCkLabel"> ';
if(role.isEdit==1){
$out+=' <input name="roleViewAllCk" type="checkbox" /> ';
}else{
$out+=' <input name="roleViewAllCk" type="checkbox" disabled/> ';
}
$out+=' <span class="i-checks-span">全选</span> </label> </div> </div> ';
}
$out+=' <table class="table table-bordered table-responsive permission-table m-b-none"> <thead> <tr> <th width="17%">功能模块</th> <th width="42%">数据查看权限</th> <th width="*">功能操作权限</th> </tr> </thead> <tbody> ';
if(viewList!=null && viewList.length>0){
$out+=' ';
$each(viewList,function(v,vi){
$out+=' <tr data-id="';
$out+=$escape(v.id);
$out+='" data-i="';
$out+=$escape(vi);
$out+='"> <td class="v-middle" rowspan="';
$out+=$escape((v.viewOne.childList.length>0 && v.viewTwo.childList.length>0) || (v.operatorOne.childList.length>0 && v.operatorTwo.childList.length>0)?'2':'');
$out+='"> <label class="i-checks i-checks-label fw-normal m-b-none"> ';
if(role.isEdit == 0 || v.permissionType == 1){
$out+=' ';
if(v.isSelect==1){
$out+=' <input name="viewCK" type="checkbox" value="';
$out+=$escape(v.id);
$out+='" data-relation-id="';
$out+=$escape(v.relationId);
$out+='" disabled checked/> ';
}else{
$out+=' <input name="viewCK" type="checkbox" value="';
$out+=$escape(v.id);
$out+='" data-relation-id="';
$out+=$escape(v.relationId);
$out+='" disabled/> ';
}
$out+=' ';
}else{
$out+=' ';
if(v.isSelect==1){
$out+=' <input name="viewCK" type="checkbox" value="';
$out+=$escape(v.id);
$out+='" data-relation-id="';
$out+=$escape(v.relationId);
$out+='" checked/> ';
}else{
$out+=' <input name="viewCK" type="checkbox" value="';
$out+=$escape(v.id);
$out+='" data-relation-id="';
$out+=$escape(v.relationId);
$out+='" /> ';
}
$out+=' ';
}
$out+=' <span class="i-checks-span" title="';
$out+=$escape(v.name);
$out+='">';
$out+=$escape(v.name);
$out+='</span> </label> </td> <td rowspan="';
$out+=$escape((!(v.viewOne.childList.length>0 && v.viewTwo.childList.length>0) && v.operatorOne.childList.length>0 && v.operatorTwo.childList.length>0)?'2':'');
$out+='"> ';
if(v.viewOne.childList.length>0){
$out+=' <div class="row no-margin" data-group-id="';
$out+=$escape(v.viewOne.groupId);
$out+='"> ';
$each(v.viewOne.childList,function(c,ci){
$out+=' <div class="';
$out+=$escape(c.name.length>12 && !isView?'col-sm-12 col-xl-6':'col-sm-12 col-lg-6');
$out+=' no-padding"> <label class="i-checks i-checks-label fw-normal no-margins dp-inline-block v-middle" data-code="';
$out+=$escape(c.code);
$out+='"> ';
if(role.isEdit == 0 || c.permissionType == 1){
$out+=' ';
if(c.isSelect==1){
$out+=' <input name="viewCK1';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" checked disabled/> ';
}else{
$out+=' <input name="viewCK1';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" disabled/> ';
}
$out+=' ';
}else{
$out+=' ';
if(c.isSelect==1){
$out+=' <input name="viewCK1';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" checked/> ';
}else{
$out+=' <input name="viewCK1';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='"/> ';
}
$out+=' ';
}
$out+=' <span class="i-checks-span" title="';
$out+=$escape(c.name);
$out+='">';
$out+=$escape(c.name);
$out+='</span> </label> </div> ';
});
$out+=' </div> ';
}else if(v.viewTwo.childList.length>0){
$out+=' <div class="row no-margin" data-group-id="';
$out+=$escape(v.viewTwo.groupId);
$out+='"> ';
$each(v.viewTwo.childList,function(c,ci){
$out+=' <div class="';
$out+=$escape(c.name.length>12 && !isView?'col-sm-12 col-xl-6':'col-sm-12 col-lg-6');
$out+=' no-padding"> <label class="i-checks i-checks-label fw-normal no-margins dp-inline-block v-middle" data-code="';
$out+=$escape(c.code);
$out+='"> ';
if(role.isEdit == 0 || c.permissionType == 1){
$out+=' ';
if(c.isSelect==1){
$out+=' <input name="viewCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" checked disabled/> ';
}else{
$out+=' <input name="viewCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" disabled/> ';
}
$out+=' ';
}else{
$out+=' ';
if(c.isSelect==1){
$out+=' <input name="viewCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" checked/> ';
}else{
$out+=' <input name="viewCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='"/> ';
}
$out+=' ';
}
$out+=' <span class="i-checks-span" title="';
$out+=$escape(c.name);
$out+='">';
$out+=$escape(c.name);
$out+='</span> </label> </div> ';
});
$out+=' </div> ';
}
$out+=' </td> <td rowspan="';
$out+=$escape((!(v.operatorOne.childList.length>0 && v.operatorTwo.childList.length>0) && v.viewOne.childList.length>0 && v.viewTwo.childList.length>0)?'2':'');
$out+='"> ';
if(v.operatorOne.childList.length>0){
$out+=' <div class="row no-margin" data-group-id="';
$out+=$escape(v.operatorOne.groupId);
$out+='"> ';
$each(v.operatorOne.childList,function(c,ci){
$out+=' <div class=" ';
$out+=$escape(c.name.length>12 && !isView?'col-sm-12 col-xl-6':'col-sm-12 col-lg-6');
$out+=' no-padding"> <label class="i-checks i-checks-label fw-normal no-margins dp-inline-block v-middle" data-code="';
$out+=$escape(c.code);
$out+='"> ';
if(role.isEdit == 0 || c.permissionType == 1){
$out+=' ';
if(c.isSelect==1){
$out+=' <input name="operatorCK1';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" checked disabled/> ';
}else{
$out+=' <input name="operatorCK1';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" disabled/> ';
}
$out+=' ';
}else{
$out+=' ';
if(c.isSelect==1){
$out+=' <input name="operatorCK1';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" checked/> ';
}else{
$out+=' <input name="operatorCK1';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='"/> ';
}
$out+=' ';
}
$out+=' <span class="i-checks-span" title="';
$out+=$escape(c.name);
$out+='">';
$out+=$escape(c.name);
$out+='</span> </label> </div> ';
});
$out+=' </div> ';
}else if(v.operatorTwo.childList.length>0){
$out+=' <div class="row no-margin" data-group-id="';
$out+=$escape(v.operatorTwo.groupId);
$out+='"> ';
$each(v.operatorTwo.childList,function(c,ci){
$out+=' <div class="';
$out+=$escape(c.name.length>12 && !isView?'col-sm-12 col-xl-6':'col-sm-12 col-lg-6');
$out+=' no-padding"> <label class="i-checks i-checks-label fw-normal no-margins dp-inline-block v-middle" data-code="';
$out+=$escape(c.code);
$out+='"> ';
if(role.isEdit == 0 || c.permissionType == 1){
$out+=' ';
if(c.isSelect==1){
$out+=' <input name="operatorCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" checked disabled/> ';
}else{
$out+=' <input name="operatorCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" disabled/> ';
}
$out+=' ';
}else{
$out+=' ';
if(c.isSelect==1){
$out+=' <input name="operatorCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" checked/> ';
}else{
$out+=' <input name="operatorCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='"/> ';
}
$out+=' ';
}
$out+=' <span class="i-checks-span" title="';
$out+=$escape(c.name);
$out+='">';
$out+=$escape(c.name);
$out+='</span> </label> </div> ';
});
$out+=' </div> ';
}
$out+=' </td> </tr> ';
if(( v.viewOne.childList.length>0 && v.viewTwo.childList.length>0) || (v.operatorOne.childList.length>0 && v.operatorTwo.childList.length>0)){
$out+=' <tr data-id="';
$out+=$escape(v.id);
$out+='"> ';
if(v.viewOne.childList.length>0 && v.viewTwo.childList.length>0){
$out+=' <td> <div class="row no-margin" data-group-id="';
$out+=$escape(v.viewTwo.groupId);
$out+='"> ';
$each(v.viewTwo.childList,function(c,ci){
$out+=' <div class="';
$out+=$escape(c.name.length>12 && !isView?'col-sm-12 col-xl-6':'col-sm-12 col-lg-6');
$out+=' no-padding"> <label class="i-checks i-checks-label fw-normal no-margins dp-inline-block v-middle" data-code="';
$out+=$escape(c.code);
$out+='"> ';
if(role.isEdit == 0 || c.permissionType == 1){
$out+=' ';
if(c.isSelect==1){
$out+=' <input name="viewCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" checked disabled/> ';
}else{
$out+=' <input name="viewCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" disabled/> ';
}
$out+=' ';
}else{
$out+=' ';
if(c.isSelect==1){
$out+=' <input name="viewCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" checked/> ';
}else{
$out+=' <input name="viewCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='"/> ';
}
$out+=' ';
}
$out+=' <span class="i-checks-span" title="';
$out+=$escape(c.name);
$out+='">';
$out+=$escape(c.name);
$out+='</span> </label> </div> ';
});
$out+=' </div> </td> ';
}
$out+=' ';
if(v.operatorOne.childList.length>0 && v.operatorTwo.childList.length>0){
$out+=' <td> <div class="row no-margin" data-group-id="';
$out+=$escape(v.operatorTwo.groupId);
$out+='"> ';
$each(v.operatorTwo.childList,function(c,ci){
$out+=' <div class="';
$out+=$escape(c.name.length>12 && !isView?'col-sm-12 col-xl-6':'col-sm-12 col-lg-6');
$out+=' no-padding"> <label class="i-checks i-checks-label fw-normal no-margins dp-inline-block v-middle" data-code="';
$out+=$escape(c.code);
$out+='"> ';
if(role.isEdit == 0 || c.permissionType == 1){
$out+=' ';
if(c.isSelect==1){
$out+=' <input name="operatorCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" checked disabled/> ';
}else{
$out+=' <input name="operatorCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" disabled/> ';
}
$out+=' ';
}else{
$out+=' ';
if(c.isSelect==1){
$out+=' <input name="operatorCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='" checked/> ';
}else{
$out+=' <input name="operatorCK2';
$out+=$escape(vi);
$out+='" type="checkbox" value="';
$out+=$escape(c.id);
$out+='" data-relation-id="';
$out+=$escape(c.relationId);
$out+='"/> ';
}
$out+=' ';
}
$out+=' <span class="i-checks-span" title="';
$out+=$escape(c.name);
$out+='">';
$out+=$escape(c.name);
$out+='</span> </label> </div> ';
});
$out+=' </div> </td> ';
}
$out+=' </tr> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </tbody> </table> </div>';
return new String($out);
});/*v:1*/
template('m_project_process/m_production_process_info',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fromType=$data.fromType,$escape=$utils.$escape,query=$data.query,process=$data.process,_momentFormat=$helpers._momentFormat,$each=$utils.$each,routeList=$data.routeList,r=$data.r,ri=$data.ri,$out='';$out+='<!--<h4 class="font-normal">查看工作流</h4> <div class="row"> <div class="col-md-12"> ';
if(fromType==1){
$out+=' <a class="btn btn-default btn-sm" href="#/project/production?id=';
$out+=$escape(query.id);
$out+='&projectName=';
$out+=$escape(query.projectName);
$out+='&dataCompanyId=';
$out+=$escape(query.dataCompanyId);
$out+='">返回生产安排</a> ';
}else{
$out+=' <button class="btn btn-primary btn-sm" data-action="editWorkflow">编辑</button> <button class="btn btn-default btn-sm" data-action="backWorkflowList">返回流程列表</button> ';
}
$out+=' </div> </div> <h4 class="title-line m-t-sm">基本信息</h4> <div class="panel panel-default m-b-sm"> <div class="panel-body"> <div class="row m-b-sm"> <div class="col-24-xs-3 col-24-lg-2 text-bold text-right">工作流名称：</div> <div class="col-24-xs-5 col-24-lg-6">';
$out+=$escape(process.processName);
$out+='</div> <div class="col-24-xs-3 col-24-lg-2 text-bold text-right">创建人：</div> <div class="col-24-xs-5 col-24-lg-6">';
$out+=$escape(process.createUserName);
$out+='</div> <div class="col-24-xs-3 col-24-lg-2 text-bold text-right">创建时间：</div> <div class="col-24-xs-5 col-24-lg-6">';
$out+=$escape(_momentFormat(process.updateDate,'YYYY/MM/DD'));
$out+='</div> </div> </div> </div> <h4 class="title-line">流程图</h4>--> <div class=""> <div id="flowPaper" class="flow-paper full-width" ></div> <!--<div class="col-sm-6"> <h4>步骤</h4> <table class="table table-striped table-bordered"> <tbody> ';
$each(routeList,function(r,ri){
$out+=' <tr> <td>';
$out+=$escape(r.currentNodeName);
$out+='>';
$out+=$escape(r.nextNodeName);
$out+='</td> </tr> ';
});
$out+=' </tbody> </table> </div>--> </div> ';
return new String($out);
});/*v:1*/
template('m_project_process/m_production_process_settings',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,_momentFormat=$helpers._momentFormat,query=$data.query,$out='';$out+='<div class="ibox m-production-process-settings"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-12" id="breadcrumb"></div> </div> </div> <div class="ibox-content"> <div class="bg-v2-grey p-sm m-b-sm"> <h3>';
$out+=$escape(dataInfo.projectName);
$out+='</h3> <p>立项时间：';
$out+=$escape(_momentFormat(dataInfo.projectCreateDate,'YYYY/MM/DD'));
$out+='</p> <p>项目状态：';
$out+=$escape(dataInfo.projectStatus.content);
$out+='</p> </div> <h4 class="title-line">常用设置</h4> <div class="row m-sm"> <div class="item-box p-t-sm"> <div class="col-sm-3"><i class="icon iconfont icon-houtaigunli f-s-xl-v1 fc-v1-grey"></i></div> <div class="col-sm-9 fc-dark-grey p-t-xs">应用设置</div> <div class="col-sm-9 col-sm-offset-3 p-t-xs"><a class="fc-v2-blue" href="#/project/production/processSettings/list?id=';
$out+=$escape(query.id);
$out+='&projectName=';
$out+=$escape(query.projectName);
$out+='&dataCompanyId=';
$out+=$escape(query.dataCompanyId);
$out+='&processType=1">生产任务</a></div> <div class="col-sm-9 col-sm-offset-3 p-t-sm"><a class="fc-v2-blue" href="#/project/production/processSettings/list?id=';
$out+=$escape(query.id);
$out+='&projectName=';
$out+=$escape(query.projectName);
$out+='&dataCompanyId=';
$out+=$escape(query.dataCompanyId);
$out+='&processType=2">项目图纸</a></div> <div class="col-sm-9 col-sm-offset-3 p-t-sm"><a class="fc-v2-blue" href="#/project/production/processSettings/list?id=';
$out+=$escape(query.id);
$out+='&projectName=';
$out+=$escape(query.projectName);
$out+='&dataCompanyId=';
$out+=$escape(query.dataCompanyId);
$out+='&processType=3">校审意见</a></div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project_process/m_production_process_settings_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fromType=$data.fromType,$escape=$utils.$escape,processInfo=$data.processInfo,$out='';$out+='<div class="ibox"> ';
if(fromType==1){
$out+=' <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-12" id="breadcrumb"></div> </div> </div> ';
}
$out+=' <div class="ibox-content ';
$out+=$escape(fromType==1?'':'no-borders no-padding');
$out+='"> <h4 class="font-normal"> ';
if(processInfo && processInfo.id){
$out+=' 编辑工作流 ';
}else{
$out+=' 创建工作流 ';
}
$out+=' </h4> <form class="form-horizontal m-t"> <div class="form-group p-l"> <label class="pull-left control-label f-s-m-v1">工作流名称<span class="fc-red">*</span>：</label> <div class="pull-left"> <input type="text" class="form-control width-600" name="processName" placeholder="请输入工作流名称" value="';
$out+=$escape(processInfo?processInfo.processName:'');
$out+='"> </div> </div> <div id="processNodeList"> </div> <div class="form-group p-l"> <button class="btn btn-primary" data-action="save">保存&下一步</button> <button class="btn btn-default" data-action="cancel">取消</button> </div> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project_process/m_production_process_settings_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fromType=$data.fromType,$escape=$utils.$escape,$out='';$out+='<div class="ibox m-production-process-settings-list">  ';
if(fromType==1){
$out+=' <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-12" id="breadcrumb"></div> </div> </div> <div class="ibox-content ';
$out+=$escape(fromType==1?'':'no-borders no-padding');
$out+='"> <h4 class="font-normal">工作流设置</h4> <p class="fc-v1-grey">定义任务流转的状态变更，用户可以为每个状态配置不同的需求显示字段，并且可以设置流转时的效果。</p> <div id="tableBox"> </div> </div>  ';
}else{
$out+=' <div class="row"> <div class="col-sm-12 text-right m-b-sm"> <button class="btn btn-primary btn-sm roleControl" roleCode="10000602" flag="2" data-action="addWorkflow"><i class="fa fa-plus f-s-m" ></i>&nbsp;增加工作流</button> </div> <div class="col-sm-12" id="tableBox"> </div> </div> ';
}
$out+=' </div> ';
return new String($out);
});/*v:1*/
template('m_project_process/m_production_process_settings_list_table',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fromType=$data.fromType,query=$data.query,dataList=$data.dataList,$each=$utils.$each,t=$data.t,ti=$data.ti,$escape=$utils.$escape,currentRoleCodes=$data.currentRoleCodes,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-hover"> <thead> <tr> ';
if(fromType==1 || (fromType==2 && query.processType==2)){
$out+=' <th>启用</th> ';
}
$out+=' <th width="50%">工作流名称</th> <th>操作</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(t,ti){
$out+=' <tr class="curp" data-id="';
$out+=$escape(t.id);
$out+='" data-template-process-id="';
$out+=$escape(t.templateProcessId);
$out+='" data-i="';
$out+=$escape(ti);
$out+='" > ';
if(fromType==1 || (fromType==2 && query.processType==2)){
$out+=' <td> <label class="i-checks fw-normal m-b-none"> ';
if(currentRoleCodes.indexOf('10000602')>-1){
$out+=' ';
if(t.startFlag && t.startFlag==1){
$out+=' <input name="itemCk" type="radio" value="';
$out+=$escape(t.id);
$out+='" checked/> ';
}else{
$out+=' <input name="itemCk" type="radio" value="';
$out+=$escape(t.id);
$out+='"/> ';
}
$out+=' ';
}else{
$out+=' ';
if(t.startFlag && t.startFlag==1){
$out+=' <input name="itemCk" type="radio" value="';
$out+=$escape(t.id);
$out+='" checked disabled/> ';
}else{
$out+=' <input name="itemCk" type="radio" value="';
$out+=$escape(t.id);
$out+='" disabled/> ';
}
$out+=' ';
}
$out+=' <span class="i-checks-span"></span> </label> </td> ';
}
$out+=' <td>';
$out+=$escape(t.processName);
$out+='</td> <td> ';
if(fromType==2){
$out+=' ';
if(t.isDelete && t.isDelete==1){
$out+=' <button class="btn btn-primary btn-xs roleControl" roleCode="10000602" flag="2" data-action="editWorkflow">编辑</button> <button class="btn btn-danger btn-xs roleControl" roleCode="10000602" flag="2" data-action="delWorkflow">删除</button> ';
}else{
$out+=' <button class="btn btn-primary btn-xs disabled roleControl" roleCode="10000602" flag="2" >编辑</button> <button class="btn btn-danger btn-xs disabled roleControl" roleCode="10000602" flag="2" >删除</button> ';
}
$out+=' <button class="btn btn-primary btn-xs roleControl" roleCode="10000602" flag="2" data-action="copyProcess">复制</button> ';
}
$out+=' <button class="btn btn-info btn-xs" data-action="viewWorkflow">查看</button> </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="';
$out+=$escape((fromType==1 || (fromType==2 && query.processType==2))?'3':'2');
$out+='" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_project_process/m_production_process_set_range',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,treeList=$data.treeList,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="m-production-process-set-range p-sm "> ';
if(treeList && treeList.length>0){
$out+=' <div class="row no-margin" data-i=""> <div class="col-sm-12 bg-v5-grey p-t-xs p-b-xs p-l-md border-top border-right border-left"> <span>设计分类</span>  </div> <div class="col-sm-12 border content" > <div class="tree-box"></div> </div> </div> ';
}else{
$out+=' <div class="row no-data-tr"> <div class="text-center col-md-12"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='" width="100"> <span class="fc-dark-blue dp-block">请设置设计分类！</span> </div> </div> </div> ';
}
$out+=' </div> ';
return new String($out);
});/*v:1*/
template('m_project_process/m_production_process_template_preview',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="m text-center"> <img src="';
$out+=$escape(_url('/img/project/process_temp.png'));
$out+='" /> </div> ';
return new String($out);
});/*v:1*/
template('m_project_process/m_production_process_workflow_route',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fromType=$data.fromType,$escape=$utils.$escape,$each=$utils.$each,dataList=$data.dataList,t=$data.t,ti=$data.ti,doType=$data.doType,r=$data.r,ri=$data.ri,$out='';$out+='<div class="ibox m-production-process-workflow-route"> ';
if(fromType==1){
$out+=' <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-12" id="breadcrumb"></div> </div> </div> ';
}
$out+=' <div class="ibox-content ';
$out+=$escape(fromType==1?'':'no-borders no-padding');
$out+='"> <h4 class="font-normal">流转设置</h4> <p class="fc-v1-grey">工作流流转设置，是设置工作流各状态间的先后流转关系。如果需要设置该流转，请在两个状态间的复选框内打勾。</p> <div class="row no-margin dp-flex border m-b-sm" id="contentRow"> <div class="pull-left" id="contentLeft"> <table class="table table-hover text-nowrap"> <thead> <tr> <th></th> ';
$each(dataList,function(t,ti){
$out+=' <th>';
$out+=$escape(t.nodeName);
$out+='</th> ';
});
$out+=' </tr> </thead> <tbody id="sortTr"> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(t,ti){
$out+=' <tr class="';
$out+=$escape(doType==1?'curp':'');
$out+='" data-id="';
$out+=$escape(t.id);
$out+='" data-sort-id="';
$out+=$escape(ti);
$out+='"> <td> 从【';
$out+=$escape(t.nodeName);
$out+='】可流转到 </td> ';
$each(t.routeList,function(r,ri){
$out+=' <td> ';
if(doType==1){
$out+=' <label class="i-checks fw-normal m-b-none"> ';
if(r.isSelect==1){
$out+=' ';
if(r.currentNodeId==r.nextNodeId){
$out+=' <input name="itemCk" type="checkbox" value="" data-key="';
$out+=$escape(ti);
$out+='_';
$out+=$escape(ri);
$out+='" data-current-node="';
$out+=$escape(r.currentNodeId);
$out+='" data-next-node="';
$out+=$escape(r.nextNodeId);
$out+='" data-current-text="';
$out+=$escape(r.currentNodeName);
$out+='" data-next-text="';
$out+=$escape(r.nextNodeName);
$out+='" checked disabled/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" value="" data-key="';
$out+=$escape(ti);
$out+='_';
$out+=$escape(ri);
$out+='" data-current-node="';
$out+=$escape(r.currentNodeId);
$out+='" data-next-node="';
$out+=$escape(r.nextNodeId);
$out+='" data-current-text="';
$out+=$escape(r.currentNodeName);
$out+='" data-next-text="';
$out+=$escape(r.nextNodeName);
$out+='" checked/> ';
}
$out+=' ';
}else{
$out+=' <input name="itemCk" type="checkbox" value="" data-key="';
$out+=$escape(ti);
$out+='_';
$out+=$escape(ri);
$out+='" data-current-node="';
$out+=$escape(r.currentNodeId);
$out+='" data-next-node="';
$out+=$escape(r.nextNodeId);
$out+='" data-current-text="';
$out+=$escape(r.currentNodeName);
$out+='" data-next-text="';
$out+=$escape(r.nextNodeName);
$out+='"/> ';
}
$out+=' <span class="i-checks-span v-middle"></span> </label> ';
}else{
$out+=' ';
if(r.isSelect==1){
$out+=' ';
if(r.currentNodeId==r.nextNodeId){
$out+=' <i class="fa fa-check-square-o fc-v2-blue f-s-xl" name="itemCk" data-key="';
$out+=$escape(ti);
$out+='_';
$out+=$escape(ri);
$out+='" data-current-node="';
$out+=$escape(r.currentNodeId);
$out+='" data-next-node="';
$out+=$escape(r.nextNodeId);
$out+='" data-current-text="';
$out+=$escape(r.currentNodeName);
$out+='" data-next-text="';
$out+=$escape(r.nextNodeName);
$out+='"></i> ';
}else{
$out+=' <i class="fa fa-check-square-o fc-dark-blue f-s-xl" name="itemCk" data-key="';
$out+=$escape(ti);
$out+='_';
$out+=$escape(ri);
$out+='" data-current-node="';
$out+=$escape(r.currentNodeId);
$out+='" data-next-node="';
$out+=$escape(r.nextNodeId);
$out+='" data-current-text="';
$out+=$escape(r.currentNodeName);
$out+='" data-next-text="';
$out+=$escape(r.nextNodeName);
$out+='"></i> ';
}
$out+=' ';
}else{
$out+=' <i class="fa fa-square-o fc-v1-grey f-s-xl"></i> ';
}
$out+=' ';
}
$out+=' </td> ';
});
$out+=' </tr> ';
});
$out+=' ';
}
$out+=' </tbody> </table> </div> <div class="pull-left" id="contentResize"> </div> <div class="pull-left" id="contentRight"> </div> </div> <div> ';
if(fromType==1){
$out+=' <button class="btn btn-default" data-action="back">返回生产安排</button> ';
}else if(doType==1){
$out+=' <button class="btn btn-primary" data-action="save">保存</button> <button class="btn btn-default" data-action="cancel">取消</button> ';
}else if(doType==2){
$out+=' <button class="btn btn-default" data-action="cancel">返回流程列表</button> ';
}
$out+=' </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project_process/m_production_process_workflow_select','<form class="form-horizontal m"> <div class="form-group"> <label class="col-sm-2 control-label p-r-none">负责的项目<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <select class="form-control" name="projectId"></select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label p-r-none">工作流选择<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <select class="form-control" name="processId"></select> </div> </div> </form> ');/*v:1*/
template('m_project_process/m_production_process_workflow_start',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,isAllAgree=$data.isAllAgree,_url=$helpers._url,$out='';$out+='<div class="m-production-process-workflow-start m"> <div> <span>子未完成父任务是否可以完成：</span> <button class="btn btn-link btn-xs " data-action="whetherEnable" data-status="';
$out+=$escape(isAllAgree);
$out+='"> <i class="icon iconfont ';
$out+=$escape(isAllAgree==0?'icon-kaiguanguan1 fc-v1-grey':'icon-kaiguanguan fc-dark-blue');
$out+='"></i> </button> </div> <p>示例： 当子任务没有全部处于结束状态时，父任务是否可以处于结束状态</p> <div class="row"> <!--<img src="';
$out+=$escape(_url('/img/project/process_flow_example.png'));
$out+='" />--> <div class="col-sm-6"> <p class="m-b-none"> 父任务可以处于结束状态 <button class="btn btn-link btn-xs" disabled> <i class="icon iconfont icon-kaiguanguan fc-dark-blue"></i> </button> </p> <table class="table table-bordered"> <thead> <tr> <th>生产任务</th> <th>任务状态</th> </tr> </thead> <tbody> <tr> <td><span class="ic-open vertical-text-bottom m-l-sm m-r-sm"></span>结构施工图</td> <td class="fc-dark-blue">已完成</td> </tr> <tr> <td class="p-l-58">地下室平面</td> <td class="fc-v1-grey">未完成</td> </tr> <tr> <td class="p-l-58">地下室BIM建模</td> <td class="fc-v1-grey">未完成</td> </tr> <tr> <td class="p-l-58">地下室梁</td> <td class="fc-v1-grey">未完成</td> </tr> <tr> <td class="p-l-58">地下室基础</td> <td class="fc-v1-grey">未完成</td> </tr> <tr> <td class="p-l-58">地下室坡道图</td> <td class="fc-v1-grey">未完成</td> </tr> <tr> <td class="p-l-58">楼梯</td> <td class="fc-dark-blue">设计中</td> </tr> </tbody> </table> </div> <div class="col-sm-6"> <p class="m-b-none"> 父任务不可以处于结束状态 <button class="btn btn-link btn-xs" disabled> <i class="icon iconfont icon-kaiguanguan1 fc-v1-grey"></i> </button> </p> <table class="table table-bordered"> <thead> <tr> <th>生产任务</th> <th>任务状态</th> </tr> </thead> <tbody> <tr> <td><span class="ic-open vertical-text-bottom m-l-sm m-r-sm"></span>结构施工图</td> <td class="fc-dark-blue">已完成</td> </tr> <tr> <td class="p-l-58">地下室平面</td> <td class="fc-dark-blue">已完成</td> </tr> <tr> <td class="p-l-58">地下室BIM建模</td> <td class="fc-dark-blue">已完成</td> </tr> <tr> <td class="p-l-58">地下室梁</td> <td class="fc-dark-blue">已完成</td> </tr> <tr> <td class="p-l-58">地下室基础</td> <td class="fc-dark-blue">已完成</td> </tr> <tr> <td class="p-l-58">地下室坡道图</td> <td class="fc-dark-blue">已完成</td> </tr> <tr> <td class="p-l-58">楼梯</td> <td class="fc-dark-blue">已完成</td> </tr> </tbody> </table> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project_process/m_production_process_workflow_status',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,t=$data.t,ti=$data.ti,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="m-production-process-workflow-status">  <div class="row"> <div class="col-md-12"> <button class="btn btn-primary" data-action="addWorkflowStatus"><i class="fa fa-plus f-s-m" ></i>&nbsp;增加状态</button> </div> </div> <table class="table table-hover"> <thead> <tr> <th width="55%">状态名称</th>  <th width="15%">起始状态</th> <th width="15%">结束状态</th>  <th width="15%">操作</th> </tr> </thead> <tbody id="sortTr"> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(t,ti){
$out+=' <tr class="curp list-tr-item" data-id="';
$out+=$escape(t.id);
$out+='" data-sort-id="';
$out+=$escape(ti);
$out+='"> <td> ';
$out+=$escape(t.nodeName);
$out+=' </td> <!--<td>';
$out+=$escape(t.description);
$out+='</td>--> <td> <label class="i-checks fw-normal m-b-none"> ';
if(t.isStartNode==1){
$out+=' <input name="staCk" type="radio" value="" checked/> ';
}else{
$out+=' <input name="staCk" type="radio" value=""/> ';
}
$out+=' <span class="i-checks-span v-middle"></span> </label> </td> <td> <label class="i-checks fw-normal m-b-none"> ';
if(t.isEndNode==1){
$out+=' <input name="endCk" type="checkbox" value="" checked/> ';
}else{
$out+=' <input name="endCk" type="checkbox" value=""/> ';
}
$out+=' <span class="i-checks-span v-middle"></span> </label> <button class="btn btn-link ';
$out+=$escape(t.isEndNode==1?'':'hide');
$out+='" data-action="setFlowProcessStart"><i class="fa fa-wrench"></i></button> </td> <!-- <td> ';
if(t.roleType==4){
$out+=' 设计人 ';
}else if(t.roleType==5){
$out+=' 校对人 ';
}else if(t.roleType==6){
$out+=' 审核人 ';
}else if(t.roleType==14){
$out+=' 审定人 ';
}
$out+=' </td>--> <td> <button class="btn btn-primary btn-xs" data-action="editWorkflowStatus">编辑</button> <button class="btn btn-danger btn-xs" data-action="delWorkflowStatus">删除</button> </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="4" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">当前工作流还没有任何状态，请为工作流&nbsp;<button class="btn btn-link fw-bold" data-action="addWorkflowStatus">添加状态</button></span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>  </div>  ';
return new String($out);
});/*v:1*/
template('m_project_process/m_production_process_workflow_status_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-sm-2 control-label p-r-none">系统命名<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <select class="form-control" name="nodeValue"></select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label p-r-none">自定义<span class="fc-red">*</span>：</label> <div class="col-sm-10"> <input class="form-control" name="stateName" /> </div> </div>  <!--<div class="form-group"> <label class="col-sm-2 control-label p-r-none">状态说明：</label> <div class="col-sm-10"> <textarea class="form-control" rows="5" name="description">';
$out+=$escape(dataInfo?dataInfo.description:'');
$out+='</textarea> </div> </div>--> </form> ';
return new String($out);
});/*v:1*/
template('m_project_process/m_project_process_nav',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,type=$data.type,$out='';$out+='<div class="panel panel-default" data-type="1" data-key="projectTypeList"> <div class="panel-heading"> <h4 class="no-margins"> 筛选分类 </h4> </div> <div class="panel-body of-auto no-borders no-padding"> <form> <div class="row dp-flex no-margin border-bottom l-h-50"> <label class="col-sm-4 text-right no-margin border-right">设计分类：</label> <div class="col-sm-8"> <select class="form-control" name="projectType" data-searchplaceholder="搜索设计分类"> </select> </div> </div> ';
if(type==1){
$out+=' <div class="row dp-flex no-margin border-bottom l-h-50"> <label class="col-sm-4 text-right no-margin border-right">功能分类：</label> <div class="col-sm-8 no-padding"> <div class="col-sm-12"> <select class="form-control" name="functionType"> </select> </div> ';
if(type==1){
$out+=' <div class="col-sm-12 border-top"> <select class="form-control" name="functionTypeChild"> </select> </div> ';
}
$out+=' </div> </div> <div class="row dp-flex no-margin border-bottom l-h-50"> <label class="col-sm-4 text-right no-margin border-right">阶段设置：</label> <div class="col-sm-8"> <select class="form-control" name="stageDesign"> </select> </div> </div> <div class="row dp-flex no-margin l-h-50"> <label class="col-sm-4 text-right no-margin border-right">专业设置：</label> <div class="col-sm-8"> <select class="form-control" name="majorDesign"> </select> </div> </div> ';
}
$out+=' </form> </div> </div>';
return new String($out);
});/*v:1*/
template('m_project_section/m_departIntroductionShow',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_isNullOrBlank=$helpers._isNullOrBlank,fileFullPath=$data.fileFullPath,_url=$helpers._url,$string=$utils.$string,explainDesc=$data.explainDesc,businessType=$data.businessType,projectList=$data.projectList,$each=$utils.$each,p=$data.p,$index=$data.$index,$out='';$out+='<div class="ibox m_organizational no-margins">  <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-8" id="breadcrumb"></div> <div class="col-md-4 text-right" style="padding: 9px 15px;"> <a class="btn btn-u-default btn-sm" href="javascript:void(0);" data-action="backToLast">返回</a> </div> </div> </div> <div class="col-md-12"> <div class="row"> <div class="col-md-8 " style="width:73%; padding: 1% 15% 1% 1%;" > <div id="js-bg" class="pt-relative" > <img alt="image" src="';
$out+=$escape(_isNullOrBlank(fileFullPath)?_url('/img/depart_introduction_default_img.png'):fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/depart_introduction_default_img.png'));
$out+='" style="width: 50vw; height: 25vw;"> </div> <div style="width: 50vw;padding:0px;margin:0px; line-height: 25px;letter-spacing: 0px;word-break: break-all;"> <div> <p> ';
$out+=$string(explainDesc);
$out+=' </p> </div> </div> </div> <div class="col-md-4 " style="width:27%; padding: 0px;" > <div class="middleLine" style="width:1px;height:750px;background:#e2e2e2;float:left;position:relative"></div> <div class="right-panel "> <div class="panel-heading"> ';
if(businessType==1){
$out+=' 项目名称 ';
}else{
$out+=' 课题名称 ';
}
$out+=' </div> <div > ';
if(projectList && projectList.length>0){
$out+=' ';
$each(projectList,function(p,$index){
$out+=' <div style=" padding: 10px 10px 0px 15px;border-bottom: 1px solid #e2e2e2;"> <p> <a href="javascript:void(0);" data-action="projectAction" data-key="';
$out+=$escape(p.id);
$out+='" data-value="';
$out+=$escape(p.projectName);
$out+='">';
$out+=$escape(p.projectName);
$out+='</a> </p> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="notice-row"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </div> ';
}
$out+=' </div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project_section/m_departSubjectShow',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,editFlag=$data.editFlag,$escape=$utils.$escape,_styleType=$helpers._styleType,styleType=$data.styleType,$string=$utils.$string,leftExplainDesc=$data.leftExplainDesc,_styleTypeEdit=$helpers._styleTypeEdit,data=$data.data,$out='';$out+='<div class="ibox m_organizational no-margins">  <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-8" id="breadcrumb"></div> <div class="col-md-4 text-right" style="padding: 9px 15px;"> ';
if(editFlag=='1'){
$out+=' <a class="btn btn-u-default btn-sm" href="javascript:void(0);" data-action="editIntroduction">编辑</a> ';
}
$out+=' <a class="btn btn-u-default btn-sm" href="javascript:void(0);" data-action="backToLast">返回</a> </div> </div> </div> <div class="col-md-12"> <div class="row"> <div class="';
$out+=$escape(_styleType(styleType,'1'));
$out+='"> <div style="padding:0px;margin:0px; line-height: 25px;letter-spacing: 0px;word-break: break-all;"> ';
$out+=$string(leftExplainDesc);
$out+=' </div> </div> <div class="middleLine" style="width:1px;height:750px;background:#e2e2e2;float:left;position:relative"></div> <div class="';
$out+=$escape(_styleTypeEdit(styleType,'2'));
$out+=' p-l-none l-h-18"> <div class="form-group"> <label class="col-sm-12 control-label m-t-xs f-s-m-v1">课题名称</label> <div class="col-sm-12"> <p class="line-feed f-s-m-v1">';
$out+=$escape(data.projectName);
$out+='</p> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1">课题目标</label> <div class="col-sm-12"> <p class="line-feed f-s-m-v1">';
$out+=$escape(data.projectTarget);
$out+='</p> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1">课题内容</label> <div class="col-sm-12"> <p class="line-feed f-s-m-v1">';
$out+=$escape(data.projectContent);
$out+='</p> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1">课题成果</label> <div class="col-sm-12"> <p class="line-feed f-s-m-v1">';
$out+=$escape(data.projectResult);
$out+='</p> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1">荣&nbsp; &nbsp; &nbsp; &nbsp;誉</label> <div class="col-sm-12"> <p class="line-feed f-s-m-v1">';
$out+=$escape(data.projectHonour);
$out+='</p> </div> </div> <div class="form-group"> <label class="col-sm-12 control-label m-t-xl f-s-m-v1">团队成员</label> <div class="col-sm-12"> <p class="line-feed f-s-m-v1">';
$out+=$escape(data.projectMember);
$out+='</p> </div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project_section/m_project_section','<div class="ibox no-margins m_project_section_list"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-6" id="breadcrumb"></div> <div class="col-md-6 text-right" style="padding: 9px 15px;"> </div> </div> </div> <div class="ibox-content p-xl"> <div id="cbp-projects" class="cbp full-width"> </div> <div class="clearfix"></div> </div> </div> ');/*v:1*/
template('m_project_section/m_project_section_list_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,i=$data.i,$escape=$utils.$escape,businessType=$data.businessType,_url=$helpers._url,$out='';$each(dataList,function(p,i){
$out+=' <div class="cbp-item" data-i="';
$out+=$escape(i);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='" data-type="';
$out+=$escape(p.type);
$out+='" data-action="departAction" data-value="';
$out+=$escape(businessType==1?p.fieldName:p.departName);
$out+='" data-key="';
$out+=$escape(p.id);
$out+='" > <div class="cbp-caption"> <div class="cbp-caption-defaultWrap" > ';
if(p.fileFullPath!=null && p.fileFullPath!=''){
$out+=' <img src="';
$out+=$escape(p.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/depart_introduction_default_img.png'));
$out+='" > <!--<div class="cbp-l-caption-title" style="position: absolute;bottom: 10px;left: 10px;">';
$out+=$escape(p.supportTypeName);
$out+='</div>--> ';
}else{
$out+=' <div class="img-group"> <img src="';
$out+=$escape(_url('/img/depart_introduction_default_img.png'));
$out+='" > <div class="img-tip">';
$out+=$escape(businessType==1?p.fieldName:p.departName);
$out+='</div></div> ';
}
$out+=' </div> </div> </div> ';
});
$out+=' ';
return new String($out);
});/*v:1*/
template('m_share/m_share_register',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,companyInfo=$data.companyInfo,userInfo=$data.userInfo,_serverUrl=$helpers._serverUrl,$out='';$out+='<div class="middle-box text-center loginscreen animated fadeInDown"> <div> <div> <img alt="" src="';
$out+=$escape(_url('/img/withoutLogo.png'));
$out+='" class="img-responsive filePath" style="margin: 0 auto;"> </div> <h4 style="word-break:break-all">';
$out+=$escape(companyInfo.companyName);
$out+='</h4> <p>';
$out+=$escape(userInfo!=null?userInfo.userName:"");
$out+='诚邀您加入</p>  <form class="m-t" id="showViewType1" role="form" action="login.html"> <div class="form-group"> <input class="form-control" type="text" placeholder="手机号" name="cellphone" id="cellphone" maxlength="11"> </div> <div class="form-group"> <div class="input-group"> <input placeholder="验证码" class="input form-control" type="text" id="verifcationCode" name="verifcationCode" placeholder="验证码"> <span class="input-group-btn"> <a type="button" class="btn btn-u" id="getCode" data-action="getCode" style="width:96px;">获取验证码</a> </span> </div> </div> <div class="form-group"> <input class="form-control" type="text" placeholder="姓名" id="userName" name="userName"> </div> <p class="text-muted text-center" style="margin-bottom: 18px;"> </p> <a type="submit" class="btn btn-primary block full-width m-b" href="javascript:void(0)" data-action="submitRegister">加入</a> <p class="text-muted text-center"> <small>已有账号？</small> <a href="';
$out+=$escape(_serverUrl('/#/login'));
$out+='">立即登录</a> </p> </form> <form class="m-t hide" id="showViewType2" role="form" action="login.html"> <div class="row"> <div class="col-md-12 col-sm-12 margin-bottom-30"> <span> <img alt="" src="';
$out+=$escape(_url('/img/submitSuccesed.png'));
$out+='" class="img-responsive" style="margin: 0 auto"> </span> </div> <div class="col-md-12 col-sm-12 text-center margin-bottom-40"> <p>你的申请已提交，正在等待管理员审核</p> </div> <div class="col-md-12 col-sm-12 text-center"> <label class="label" style="text-align: center"> <a class="btn-u btn-u-primany btn-u-lg downloadBtn" data-action="toDownload" href="javascript:void(0)" type="button" >下载卯丁APP</a> </label> </div> </div> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_stats/m_stats_dean_bill','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 统计管理 </li> <li class="active fa fa-angle-right"> <strong>经营收入</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <form role="form" class="form-horizontal"> <div class="row" id="filterBox"> <div class="col-md-12 m-b-sm"> <label class="inline">所属年度：</label> <div class="input-group input-group-inline"> <input type="text" class="form-control" name="year" placeholder="请选择所属年度" readonly="" onfocus="WdatePicker({dateFmt:\'yyyy\'})" value=""> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"> 年 </span> </div> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> </div> </div> </form> <div class="data-list-box m-t-sm"> <div class="data-list-container of-auto"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> ');/*v:1*/
template('m_stats/m_stats_dean_bill_detail',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,userName=$data.userName,type=$data.type,year=$data.year,_expNumberFilter=$helpers._expNumberFilter,fee=$data.fee,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,_url=$helpers._url,$out='';$out+='<div class="m min-h-500"> <div class="row"> <div class="col-md-12" style="font-size: 15px;font-weight: bold;"> <span > 院领导：';
$out+=$escape(userName);
$out+='</span> </div> <div class="col-md-12" style=" margin-top: 10px;font-size: 15px; font-weight: bold;"> <span> ';
if(type==1){
$out+=' ';
$out+=$escape(year);
$out+='年合同总额： ';
}else{
$out+=' ';
$out+=$escape(year);
$out+='年收入： ';
}
$out+=' ';
$out+=$escape(_expNumberFilter(fee));
$out+='元</span> <a class="btn btn-outline no-padding" data-action="addFee" data-edit-type="2" data-placeholder="请输入备注内容" data-key="fee" data-type="14" title="新增修正记录" data-valid="6"><i class="fa fa-plus color-dark-blue f-s-xl" ></i></a> </div> </div> <table class="tree table table-bordered m-b-none m-t-xs"> <thead> <tr> <th>修正金额</th> <th>合同编号</th> <th>修正日期</th> <th>操作人</th> <th width="30%">备注</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <tr class="curp" data-id="';
$out+=$escape(p.id);
$out+='" data-user-id="';
$out+=$escape(p.companyUserId);
$out+='" > <td> ';
$out+=$escape(_expNumberFilter(p.fee));
$out+=' </td> <td>';
$out+=$escape(p.contractNo);
$out+='</td> <td>';
$out+=$escape(p.modifyDate);
$out+='</td> <td>';
$out+=$escape(p.userName);
$out+='<a href="javascript:void(0);" class="editable-click roleControl" roleCode="40000105" flag="5" data-action="editFee" data-edit-type="2" data-id="';
$out+=$escape(p.id);
$out+='" data-placeholder="请输入备注内容" data-fee="';
$out+=$escape(p.fee);
$out+='" data-type="14" data-contract-no="';
$out+=$escape(p.contractNo);
$out+='" data-modify-date="';
$out+=$escape(p.modifyDate);
$out+='" data-remark="';
$out+=$escape(p.remark);
$out+='" title="编辑修正记录" data-valid="6"> <i class=" fa fa-pencil fc-dark-blue"></i> </a> </td> <td>';
$out+=$escape(p.remark);
$out+=' <a class="curp pt-absolute m-l-xs" href="javascript:void(0)" data-id="';
$out+=$escape(p.id);
$out+='" data-action="delFee" title="删除修正记录"> <i class="fa fa-times fc-red"></i> </a></td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="5" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_stats/m_stats_dean_bill_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,year=$data.year,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="tree table table-bordered m-b-none"> <thead> <tr> <th>院领导</th> <th>';
$out+=$escape(year);
$out+='年合同总额</th> <th>';
$out+=$escape(year);
$out+='年收入</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <tr class="curp"> <td>';
$out+=$escape(p.userName);
$out+='</td> <td> ';
if(p.userName=='合计'){
$out+=' ';
$out+=$escape(_expNumberFilter(p.targetFee+p.contractFee));
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click roleControl" roleCode="40000105" flag="5" data-action="editFee" data-type="1" data-id="';
$out+=$escape(p.id);
$out+='" data-user-id="';
$out+=$escape(p.companyUserId);
$out+='" data-year="';
$out+=$escape(p.year);
$out+='"> ';
$out+=$escape(_expNumberFilter(p.targetFee+p.contractFee));
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(p.userName=='合计'){
$out+=' ';
$out+=$escape(_expNumberFilter(p.backFee+p.planReceiveFee));
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click roleControl" roleCode="40000105" flag="5" data-action="editFee" data-type="2" data-id="';
$out+=$escape(p.id);
$out+='" data-user-id="';
$out+=$escape(p.companyUserId);
$out+='" data-year="';
$out+=$escape(p.year);
$out+='"> ';
$out+=$escape(_expNumberFilter(p.backFee+p.planReceiveFee));
$out+=' </a> ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="3" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_stats/m_stats_dean_output','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 产值统计 </li> <li class="active fa fa-angle-right"> <strong>院长产值统计</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <form role="form" class="form-horizontal"> <div class="row" id="filterBox"> <div class="col-md-12 m-b-sm"> <label class="inline">所属年度：</label> <div class="input-group input-group-inline"> <input type="text" class="form-control" name="year" placeholder="请选择所属年度" readonly="" onfocus="WdatePicker({dateFmt:\'yyyy\'})" value=""> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"> 年 </span> </div> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> </div> </div> </form> <div class="data-list-box m-t-sm"> <div class="data-list-container of-auto"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> ');/*v:1*/
template('m_stats/m_stats_dean_output_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="tree table table-bordered m-b-none"> <thead> <tr> <th>姓名</th> <th>参与项目数</th> <th>产值金额</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <tr class="curp" data-id="';
$out+=$escape(p.id);
$out+='"> <td>';
$out+=$escape(p.userName);
$out+='</td> <td>';
$out+=$escape(p.projectCount);
$out+='</td> <td>';
$out+=$escape(_expNumberFilter(p.outPutValue));
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="3" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_stats/m_stats_pro_process',' <div class="ibox-content m-stats-pro-process"> <div class="row"> <div class="col-sm-12 list-container"> <form role="form" class="form-horizontal filter-form"> <div class="row" id="filterBox"> <div class="col-md-12"> <div class=""> <label class="inline">分管院长：</label> <select class="from-control inline" name="deanName"></select> </div> </div> <div class="col-md-12 m-t-xs"> <div class=""> <label class="inline">所属公司：</label> <select class="from-control inline" name="orgId"></select> </div> </div> <div class="col-md-12 m-t-xs" id="timeSelect"> </div> <div class="col-md-12 m-t-xs"> <div class=" "> <label class="inline">搜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;索：</label> <input class="form-control input-sm width-300 inline v-middle" type="text" name="keyword" placeholder="请输入关键字"> </div> </div> <div class="col-md-12 m-t"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-white roleControl" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box m-t-sm"> <div class="data-list-container of-auto"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> <div class="col-sm-8 pro-process-info p-l-none" style="display: none;"> <div class="panel panel-default b-r-none"> <div class="panel-heading">  <a class="fc-dark-blue " data-action="taskAssignment">任务分配</a> <a class="curp pull-right" href="javascript:void(0)" data-action="closeInfo"> <i class="fa fa-times"></i> </a> </div> <div class="panel-body p-xs"> <div class="tabs-container" data-type="revenueMgt"> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-1">收款计划</a></li> <li class=""><a data-toggle="tab" href="#tab-2">付款计划</a></li> </ul> <div class="tab-content"> <div id="tab-1" class="tab-pane active"> <div class="panel-body" data-type="collectionPlan"> </div> </div> <div id="tab-2" class="tab-pane"> <div class="panel-body" data-type="paymentPlan"> </div> </div> </div> </div> <div data-type="taskAssignment" style="display: none;"> </div> </div> </div> </div> </div> </div> ');/*v:1*/
template('m_stats/m_stats_pro_process_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,businessType=$data.businessType,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-hover m-b-none m-stats-pro-process-list dataTable"> <thead> ';
if(businessType==1){
$out+=' <tr class="project"> <th width="200px" data-type="1" rowspan="2" style="padding-top: 25px" class="sorting_desc w-100" data-action="sort" data-code="projectNo">项目编号</th> <th data-type="2" rowspan="2" style="padding-top: 25px">委托单位</th> <th data-type="1" rowspan="2" style="padding-top: 25px">项目名称</th> <th rowspan="2" style="padding-top: 25px">类型</th> <th data-type="1" colspan="2" style="text-align: center; width: 40%">项目进度</th> </tr> <tr> <th data-type="1" style="width: 20%">回款率</th> <th data-type="1" style="width: 20%">工作完成率</th> </tr> ';
}else{
$out+=' <tr> <th width="200px" data-type="1" class="sorting_desc w-100" data-action="sort" data-code="projectNo">课题编号</th> <th data-type="1">课题名称</th> <th>类型</th> <th data-type="1">项目进度（工作完成率）</th> </tr> ';
}
$out+=' </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <tr class="curp" data-id="';
$out+=$escape(p.id);
$out+='"> <td data-type="1">';
$out+=$escape(p.projectNo);
$out+='</td> ';
if(businessType==1){
$out+=' <td data-type="2">';
$out+=$escape(p.constructCompany);
$out+='</td> ';
}
$out+=' <td data-type="1">';
$out+=$escape(p.projectName);
$out+='</td> <td>';
$out+=$escape(p.projectType);
$out+='</td> ';
if(businessType==1){
$out+=' <td data-type="1">';
$out+=$escape(p.taskProgressRatio?p.progressRate+'%':'');
$out+='</td> ';
}
$out+=' <td data-type="1">';
$out+=$escape(p.taskProgressRatio?p.taskProgressRatio+'%':'');
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="10" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_stats/m_stats_pro_process_menu','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right"> <ul class="secondary-menu-ul" > <li class="active" id="researchType" ><a href="#/proProgressStats/researchType">创新研究</a></li> <li id="businessType" ><a href="#/proProgressStats/businessType">业务类型</a></li> </ul> </div> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content no-padding" id="content-box"/> </div> ');/*v:1*/
template('m_stats/m_stats_pro_type','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 统计管理 </li> <li class="active fa fa-angle-right"> <strong>类型分析</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <form role="form" class="form-horizontal filter-form"> <div class="row" id="filterBox"> <div class="col-md-12 m-b-xs"> <div class=""> <label class="inline">分管院长：</label> <select class="from-control inline" name="deanName"></select> </div> </div> <div class="col-md-12 m-b-xs"> <div class=""> <label class="inline">所属公司：</label> <select class="from-control inline" name="orgId"></select> </div> </div> <div class="col-md-12 m-b-xs"> <label class="inline">所属年度：</label> <div class="input-group input-group-inline"> <input type="text" class="form-control" name="year" placeholder="请选择所属年度" readonly="" onfocus="WdatePicker({dateFmt:\'yyyy\'})" value=""> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"> 年 </span> </div> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> </div> </div> </form> <div class="data-list-box m-t-sm"> <div class="data-list-container of-auto"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> ');/*v:1*/
template('m_stats/m_stats_pro_type_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,s=$data.s,$index=$data.$index,$escape=$utils.$escape,p=$data.p,i=$data.i,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="tree table table-bordered m-b-none dataTable"> <thead> <tr> <th>类型</th> <th class="sorting_desc w-100" data-action="sort" data-code="projectCount">合同数量</th> <th class="sorting_desc w-100" data-action="sort" data-code="projectCountRatio">合同数量占比</th> <th class="sorting_desc w-100" data-action="sort" data-code="totalContractAmount">合同总额</th> <th class="sorting_desc w-100" data-action="sort" data-code="contractAmountRatio">合同额占比</th> <th class="sorting_desc w-100" data-action="sort" data-code="investmentEstimation">外协预算</th> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList[0].receiveList,function(s,$index){
$out+=' <th>';
$out+=$escape(s.id);
$out+='年回款</th> ';
});
$out+=' ';
}
$out+=' <th class="sorting_desc w-100" data-action="sort" data-code="receiveRatio">回款率</th> <th class="sorting_desc w-100" data-action="sort" data-code="investmentEstimationRatio">外协率</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <tr> <td>';
$out+=$escape(p.zoneName);
$out+='</td> <td>';
$out+=$escape(p.projectCount);
$out+='</td> <td>';
$out+=$escape(p.projectCountRatio?p.projectCountRatio+'%':'');
$out+='</td> <td>';
$out+=$escape(_expNumberFilter(p.totalContractAmount));
$out+='</td> <td>';
$out+=$escape(p.contractAmountRatio?p.contractAmountRatio+'%':'');
$out+='</td> <td>';
$out+=$escape(_expNumberFilter(p.investmentEstimation));
$out+='</td> ';
$each(p.receiveList,function(s,$index){
$out+=' <td>';
$out+=$escape(_expNumberFilter(s.name));
$out+='</td> ';
});
$out+=' <td>';
$out+=$escape(p.receiveRatio?p.receiveRatio+'%':'');
$out+='</td> <td>';
$out+=$escape(p.investmentEstimationRatio?p.investmentEstimationRatio+'%':'');
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="13" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_stats/m_stats_theater_ranking','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 统计管理 </li> <li class="active fa fa-angle-right"> <strong>服务公司</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <form role="form" class="form-horizontal"> <div class="row" id="filterBox"> <div class="col-md-12 m-b-sm"> <label class="inline">所属年度：</label> <div class="input-group input-group-inline"> <input type="text" class="form-control" name="year" placeholder="请选择所属年度" readonly="" onfocus="WdatePicker({dateFmt:\'yyyy\'})" value=""> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"> 年 </span> </div> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-white roleControl" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box m-t-sm"> <div class="data-list-container of-auto"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> ');/*v:1*/
template('m_stats/m_stats_theater_ranking_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,_url=$helpers._url,$out='';$out+='<table class="tree table table-hover table-bordered m-b-none dataTable"> <thead> <tr> <th>单位</th> <th class="sorting_desc w-100" data-action="sort" data-code="projectCount">合同数量</th> <th class="sorting_desc w-100" data-action="sort" data-code="projectCountRatio">合同数量占比</th> <th class="sorting_desc w-100" data-action="sort" data-code="totalContractAmount">合同总额</th> <th class="sorting_desc w-100" data-action="sort" data-code="contractAmountRatio">合同额占比</th> <th class="sorting_desc w-100" data-action="sort" data-code="investmentEstimation">外协预算</th> <th class="sorting_desc w-100" data-action="sort" data-code="receiveRatio">回款率</th> <th class="sorting_desc w-100" data-action="sort" data-code="investmentEstimationRatio">外协率</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <tr data-member-type="';
$out+=$escape(p.memberType);
$out+='"> <td>';
$out+=$escape(p.zoneName);
$out+='</td> <td>';
$out+=$escape(p.projectCount);
$out+='</td> <td>';
$out+=$escape(p.projectCountRatio?p.projectCountRatio+'%':'');
$out+='</td> <td>';
$out+=$escape(_expNumberFilter(p.totalContractAmount));
$out+='</td> <td>';
$out+=$escape(p.contractAmountRatio?p.contractAmountRatio+'%':'');
$out+='</td> <td>';
$out+=$escape(_expNumberFilter(p.investmentEstimation));
$out+='</td> <td>';
$out+=$escape(p.receiveRatio?p.receiveRatio+'%':'');
$out+='</td> <td>';
$out+=$escape(p.investmentEstimationRatio?p.investmentEstimationRatio+'%':'');
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="8" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_stats/m_stats_user_output','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 统计管理 </li> <li class="active fa fa-angle-right"> <strong>个人效能</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <form role="form" class="form-horizontal"> <div class="row" id="filterBox"> <div class="col-md-12 "> <label class="inline">所属年度：</label> <div class="input-group input-group-inline"> <input type="text" class="form-control" name="year" placeholder="请选择所属年度" readonly="" onfocus="WdatePicker({dateFmt:\'yyyy\'})" value=""> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"> 年 </span> </div> </div> <div class="col-md-12 m-t m-b-sm"> <div class=" "> <label class="inline">搜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;索：</label> <input class="form-control input-sm width-300 inline v-middle" type="text" name="keyword" placeholder="请输入关键字"> </div> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> <button class="btn btn-white roleControl" data-action="exportDetails">导出</button> </div> </div> </form> <div class="data-list-box m-t-sm"> <div class="data-list-container of-auto"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> ');/*v:1*/
template('m_stats/m_stats_user_output_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,_expNumberFilterPoint2=$helpers._expNumberFilterPoint2,$each=$utils.$each,p=$data.p,i=$data.i,doType=$data.doType,t=$data.t,ti=$data.ti,tIndex=$data.tIndex,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-sm-3 control-label">姓名： </label> <div class="col-sm-3 p-t-7"> ';
$out+=$escape(dataInfo.userName);
$out+=' </div> <label class="col-sm-2 control-label">工作占比：</label> <div class="col-sm-3 p-t-7"> ';
$out+=$escape(dataInfo.personalRatio+'%');
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">参与项目数：</label> <div class="col-sm-3 p-t-7"> ';
$out+=$escape(dataInfo.projectCount);
$out+=' </div> <label class="col-sm-2 control-label">最高项目效能值为：</label> <div class="col-sm-3 p-t-7"> ';
$out+=$escape(_expNumberFilterPoint2(dataInfo.maxOutPutValue/100));
$out+=' </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">累计效能值为：</label> <div class="col-sm-3 p-t-7"> ';
$out+=$escape(_expNumberFilterPoint2(dataInfo.outPutValue/100));
$out+=' </div> <label class="col-sm-2 control-label">最低项目效能值为：</label> <div class="col-sm-3 p-t-7"> ';
$out+=$escape(_expNumberFilterPoint2(dataInfo.minOutPutValue/100));
$out+=' </div> </div> </form> <form class="task-list-box p-w-sm"> ';
if(dataInfo.personList && dataInfo.personList.length>0){
$out+=' ';
$each(dataInfo.personList,function(p,i){
$out+=' <div class="panel panel-default"> <div class="panel-heading"> <div class="row"> <div class="col-24-sm-14 p-l-4 p-r-none"> <a href="javascript:void(0);" data-action="expander"><span class="ic-open vertical-middle m-l-7 m-r-sm"></span></a> <span class="p-task-name" > <a href="javascript:void(0);" data-action="projectDetail" data-project-id="';
$out+=$escape(p.projectId);
$out+='" data-project-name="';
$out+=$escape(p.projectName);
$out+='" businessType = "';
$out+=$escape(p.businessType);
$out+='"> <span class="show-span pt-relative font-bold text-ellipsis width-600 vertical-middle" data-container="body" data-toggle="tooltip" data-original-title="';
$out+=$escape(p.taskName);
$out+='" style="width: 600px"> ';
$out+=$escape(p.projectName);
$out+=' </span> </a> </span> </div> <div class="col-24-sm-10 text-right"> <span class="m-r-sm">项目类型：';
$out+=$escape(p.businessType==1?'业务':'课题');
$out+='</span> <span class="m-r-sm">业务类型：';
$out+=$escape(p.projectType);
$out+='</span> <span class="m-r-sm">占比计算：';
$out+=$escape(p.personalRatio?p.personalRatio+'%':'');
$out+='</span> <span class="m-r-sm">效能值：';
$out+=$escape(_expNumberFilterPoint2(p.personalRatio/100));
$out+='</span> </div> </div> </div> <div class="panel-body no-padding"> <table class="table table-striped m-b-none"> <thead> <tr> <th width="24%" class="b-l-none">任务分配</th> <th width="10%">工作占比</th> ';
if(doType==2){
$out+=' <th width="10%" >所属组</th> ';
}
$out+=' <th width="12%" >开始时间</th> <th width="12%" >结束时间</th> <th width="12%" >完成时间</th> <th width="10%">任务占比</th> ';
if(doType==1){
$out+=' <th>占比计算</th> ';
}
$out+=' <th width="10%">效能值</th> </tr> </thead> <tbody> ';
if(p.taskList!=null && p.taskList.length>0){
$out+=' ';
$each(p.taskList,function(t,ti){
$out+=' <tr class="content-row ';
$out+=$escape(t.taskState=='3'||t.taskState=='4'?'complete-date-tr':'');
$out+='" data-id="';
$out+=$escape(t.id);
$out+='" data-i="';
$out+=$escape(tIndex);
$out+='" data-task-name="';
$out+=$escape(t.taskName);
$out+='"> <td>';
$out+=$escape(t.taskName);
$out+='</td> <td>';
$out+=$escape(t.contentRatio?t.contentRatio+'%':'');
$out+='</td> ';
if(doType==2){
$out+=' <td>';
$out+=$escape(t.departName);
$out+='</td> ';
}
$out+=' <td>';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' <!-- ';
if(t.delayDesc){
$out+=' <span class="color-red">(';
$out+=$escape(t.delayDesc);
$out+=')</span> ';
}
$out+='--> </td> <td>';
$out+=$escape(_momentFormat(t.completeDate,'YYYY/MM/DD'));
$out+='</td> <td>';
$out+=$escape(t.taskRatio?t.taskRatio+'%':'');
$out+='</td> ';
if(doType==1){
$out+=' <td>';
$out+=$escape(t.personalRatio?_expNumberFilterPoint2((t.totalRatio==null||t.totalRatio==''||t.totalRatio=='0'?1:t.totalRatio)*t.personalRatio)+'%':'');
$out+='</td> ';
}
$out+=' <td>';
$out+=$escape(_expNumberFilterPoint2((t.totalRatio==null||t.totalRatio==''||t.totalRatio=='0'?1:t.totalRatio)*t.personalRatio/100));
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="7" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="row no-data-tr" style="padding-left: 50px;padding-right: 50px"> <div class="text-center col-md-12 border" > <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无相关效能</span> </div> </div> </div> ';
}
$out+=' </form> ';
return new String($out);
});/*v:1*/
template('m_stats/m_stats_user_output_details_charts',' <div > <div id="chartArea3" class="chartjs-render-monitor " style="height: 200px"> </div> </div> ');/*v:1*/
template('m_stats/m_stats_user_output_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,_expNumberFilterPoint2=$helpers._expNumberFilterPoint2,_url=$helpers._url,$out='';$out+='<table class="tree table table-hover table-bordered m-b-none m-stats-pro-process-list dataTable"> <thead> <tr> <th width="12%">姓名</th> <th width="13%"> 所属组</th>  <th width="25%" data-type="1" class="sorting_desc w-100" data-action="sort" data-code="projectCount">参与项目数</th> <th width="25%" data-type="1" class="sorting_desc w-100" data-action="sort" data-code="outPutValue">个人工作量</th> <th width="25%" data-type="1" class="sorting_desc w-100" data-action="sort" data-code="personalRatio">效能值</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <tr class="curp" data-id="';
$out+=$escape(p.id);
$out+='"> <td>';
$out+=$escape(p.userName);
$out+='</td> <td>';
$out+=$escape(p.departName);
$out+='</td> <!-- <td>';
$out+=$escape(p.projectCount);
if(p.delayCount>0){
$out+='<span class="color-red">(';
$out+=$escape(p.delayCount);
$out+=')</span>';
}
$out+='</td>--> <td>';
$out+=$escape(p.projectCount);
$out+='</td> <td>';
$out+=$escape(_expNumberFilter(p.outPutValue));
$out+='</td> <td>';
$out+=$escape(_expNumberFilterPoint2(p.personalRatio/100));
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="5" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_task_temp','<div class="m-project-task-temp"> <div class="row"> <div class="col-sm-12 text-right m-b-xs"> <button class="btn btn-primary btn-sm roleControl" roleCode="10000602" flag="2" data-action="addTaskTemp"><i class="fa fa-plus f-s-m" ></i>&nbsp;增加任务模版</button> </div> <div class="col-sm-4 col-xl-3" id="processNav"> </div> <div class="col-sm-8 col-xl-9"> <div class="panel panel-default"> <div class="panel-heading"> <h4 class="no-margins"> 任务模板列表 </h4> </div> <div class="panel-body of-auto no-borders"> <div id="tableBox"> </div> </div> </div> </div> </div> </div>');/*v:1*/
template('m_project_temp/m_project_task_temp_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,doType=$data.doType,dataInfo=$data.dataInfo,$escape=$utils.$escape,$out='';$out+='<div class="m-project-task-temp-add"> ';
if(doType==1){
$out+=' <h4 class="font-normal"> ';
if(dataInfo && dataInfo.id){
$out+=' 编辑任务模版 ';
}else{
$out+=' 创建任务模版 ';
}
$out+=' </h4> <form class="form-horizontal m-t"> <div class="form-group p-l"> <label class="pull-left control-label f-s-m-v1">任务模版名称<span class="fc-red">*</span>：</label> <div class="pull-left"> <input type="text" class="form-control width-600" name="templateName" placeholder="请输入任务模版名称" value="';
$out+=$escape(dataInfo?dataInfo.templateName:'');
$out+='"> </div> </div> <div class="form-group p-l"> <button class="btn btn-primary" data-action="addTaskTempItem"><i class="fa fa-plus f-s-m" ></i>&nbsp;增加/编辑任务</button>  </div> <div id="taskTempItemList"> </div> <div class="form-group p-l"> <button class="btn btn-primary" data-action="save">保存</button> <button class="btn btn-default" data-action="cancel">取消</button> </div> </form> ';
}else{
$out+=' <h4 class="font-normal">查看任务模版</h4> <form class="form-horizontal m-t"> <div class="form-group p-l"> <label class="pull-left f-s-m-v1">任务模版名称：</label> <div class="pull-left l-h-22"> ';
$out+=$escape(dataInfo?dataInfo.templateName:'');
$out+=' </div> </div> <div id="taskTempItemList"> </div> <div class="form-group p-l"> <button class="btn btn-default" data-action="cancel">返回任务模板列表</button> </div> </form> ';
}
$out+=' </div> ';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_task_temp_add_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,t=$data.t,ti=$data.ti,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="panel panel-default"> <div class="panel-heading"> 任务模版 </div> <div class="panel-body max-h-300 of-auto no-borders"> <table class="table table-bordered table-hover"> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(t,ti){
$out+=' <tr> <td>';
$out+=$escape(t.fieldName);
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_task_temp_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,type=$data.type,dataList=$data.dataList,$each=$utils.$each,p=$data.p,$index=$data.$index,$out='';$out+='<div class="m-project-temp-edit" data-type="';
$out+=$escape(type);
$out+='"> <div class="col-md-6"> <div class="ibox"> <div class="ibox-title no-borders p-h-sm min-h-50">数据模板</div> <div class="ibox-content border-darker-grey box-left"> <div class="row p-w-sm"> <label class="pull-left control-label f-s-m-v1">任务模版名称：</label> <div class="pull-left m-t-n-3"> <select class="form-control" name="selectTemp"></select> </div> </div> <div id="libraryBox"> </div> ';
if(dataList && dataList.length>0){
$out+=' <h4>模板标签库</h4> <div class="m-b-sm"> <label class="i-checks i-checks-label fw-normal"> <input name="allItemCK" type="checkbox" value="0"/> <span class="i-checks-span">全选</span> </label> </div> <div class="row"> ';
$each(dataList,function(p,$index){
$out+=' <div class="col-md-4 p-r-none"> <label class="i-checks i-checks-label fw-normal"> <input name="itemCk" type="checkbox" value="';
$out+=$escape(p.fieldName);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='"/> <span class="i-checks-span text-ellipsis" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(p.fieldName);
$out+='"> ';
$out+=$escape(p.fieldName);
$out+=' </span> </label> </div> ';
});
$out+=' </div> ';
}
$out+=' <h4>自定义库</h4> <div class="row"> <form id="addItemForm"> <div class="col-md-6"> <input class="form-control input-sm p-r-none" type="text" name="fieldName" placeholder="请输入名称"> </div> <div class="col-md-2"> <button type="button" class="btn btn-primary btn-sm" data-action="addItem">添加</button> </div> <div class="col-md-12"></div> <div class="clearfix"></div> </form> </div> <div class="row m-t-sm" id="customItemBox"> </div> </div> </div> </div> <div class="col-md-6"> <div class="ibox"> <div class="ibox-title no-borders p-h-sm min-h-50">已选择项 (拖拽进行调整顺序)</div> <div class="ibox-content border-darker-grey box-right"> <div class="row list-group" id="selectItemBox"> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_task_temp_edit_library',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,$index=$data.$index,$escape=$utils.$escape,$out='';if(dataList && dataList.length>0){
$out+=' <h4>模板标签库</h4> <div class="m-b-sm"> <label class="i-checks i-checks-label fw-normal"> <input name="allItemCK" type="checkbox" value="0"/> <span class="i-checks-span">全选</span> </label> </div> <div class="row"> ';
$each(dataList,function(p,$index){
$out+=' <div class="col-md-4 p-r-none"> <label class="i-checks i-checks-label fw-normal"> <input name="itemCk" type="checkbox" value="';
$out+=$escape(p.fieldName);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='" data-relation-id="';
$out+=$escape(p.relationId);
$out+='"/> <span class="i-checks-span text-ellipsis" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(p.fieldName);
$out+='"> ';
$out+=$escape(p.fieldName);
$out+=' </span> </label> </div> ';
});
$out+=' </div> ';
}
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_task_temp_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,t=$data.t,ti=$data.ti,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-hover"> <thead> <tr> <th width="50%">任务模版名称</th> <th>适用范围</th> <th>操作</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(t,ti){
$out+=' <tr class="" data-id="';
$out+=$escape(t.id);
$out+='" data-i="';
$out+=$escape(ti);
$out+='" > <td>';
$out+=$escape(t.templateName);
$out+='</td> <td> <button class="btn btn-link no-padding" data-action="setRange"> ';
if(t.isDesign==1){
$out+=' <span class="fc-dark-blue">已设置</span> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </button> </td> <td> ';
if(t.companyId!=0){
$out+=' <button class="btn btn-primary btn-xs roleControl" roleCode="10000602" flag="2" data-action="editTaskTemp">编辑</button> <button class="btn btn-danger btn-xs roleControl" roleCode="10000602" flag="2" data-action="delTaskTemp">删除</button> ';
}
$out+=' <button class="btn btn-info btn-xs" data-action="viewTaskTemp">查看</button> </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="3" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_temp','<div class="m-project-temp"> <div class="row"> <div class="col-sm-4 col-xl-3"> <div class="panel panel-default" data-type="2"> <div class="panel-heading"> <h4 class="no-margins"> 项目类型 - 创新研究 <a href="javascript:void(0);" class="roleControl" roleCode="10000602" flag="2" data-action="addProjectTemp" title="编辑项目类型"> <i class="fa fa-pencil text-navy"></i> </a> </h4> </div> <div class="panel-body of-auto no-borders no-padding"> </div> </div> </div> <div class="col-sm-4 col-xl-3"> <div class="panel panel-default" data-type="1"> <div class="panel-heading"> <h4 class="no-margins"> 项目类型 - 业务服务 <a href="javascript:void(0);" class="roleControl" roleCode="10000602" flag="2" data-action="addProjectTemp" title="编辑项目类型"> <i class="fa fa-pencil text-navy"></i> </a> </h4> </div> <div class="panel-body of-auto no-borders no-padding"> </div> </div> </div> </div> </div> ');/*v:1*/
template('m_project_temp/m_project_temp_drawing_num',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,projectTypeList=$data.projectTypeList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="m-project-temp"> <div class="row"> <div class="col-sm-3 col-xl-2"> <div class="panel panel-default" data-type="1"> <div class="panel-heading"> <h4 class="no-margins"> 设计分类 </h4> </div> <div class="panel-body of-auto no-borders"> <div class="list-group"> ';
if(projectTypeList && projectTypeList.length>0){
$out+=' ';
$each(projectTypeList,function(p,i){
$out+=' <li class="list-group-item no-borders p-xxs ';
$out+=$escape(i==0?'active':'');
$out+='" data-id="';
$out+=$escape(p.id);
$out+='" data-relation-id="';
$out+=$escape(p.relationId);
$out+='"> <a href="javascript:void(0);" class="text-ellipsis item-name" data-action="selectItem" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(p.fieldName);
$out+='">';
$out+=$escape(p.fieldName);
$out+='</a> </li> ';
});
$out+=' ';
}else{
$out+=' <div class="row no-data-tr"> <div class="text-center col-md-12"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='" width="100"> <span class="fc-dark-blue dp-block">请设置设计分类！</span> </div> </div> </div> ';
}
$out+=' </div> </div> </div> </div> <div class="col-sm-9 col-xl-10"> <div class="panel panel-default" > <div class="panel-heading"> <h4 class="no-margins"> 图纸编号列表 <a href="javascript:;" class="btn btn-primary btn-xs pull-right m-t-n-3" data-action="addDrawingNum"><i class="fa fa-plus f-s-m"></i>&nbsp;增加图纸编号规则</a> </h4> </div> <div class="panel-body of-auto no-borders" data-type="drawingNumberList"> </div> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_temp_drawing_num_add','<form class="form-horizontal m-project-temp-drawing-num-add m min-h-50"> <div class="form-group"> <label class="col-sm-2 text-right m-t-xs p-r-none p-l-none">编号规则名称<span class="color-red">*</span>：</label> <div class="col-sm-10"> <input type="text" class="form-control" name="templateName" maxlength="50" placeholder="请输入编号规则名称" value=""> </div> </div> </form> ');/*v:1*/
template('m_project_temp/m_project_temp_drawing_num_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,isView=$data.isView,$escape=$utils.$escape,dataInfo=$data.dataInfo,$each=$utils.$each,p=$data.p,$index=$data.$index,i=$data.i,c=$data.c,ci=$data.ci,$out='';$out+='<div class="m-project-temp-drawing-num-add"> <div class=""> <form class="form-horizontal m-t"> <div class="form-group p-l"> <label class="pull-left control-label f-s-m-v1">编号规则名称<span class="fc-red">*</span>：</label> <div class="pull-left"> ';
if(isView){
$out+=' <span class="p-t-7 dp-block">';
$out+=$escape(dataInfo?dataInfo.templateName:'');
$out+='</span> ';
}else{
$out+=' <input type="text" class="form-control width-600" name="templateName" placeholder="请输入编号规则名称" value="';
$out+=$escape(dataInfo?dataInfo.templateName:'');
$out+='"> ';
}
$out+=' </div> </div> <div id="processNodeList"> <table class="table table-bordered"> <thead> <tr> <th></th> ';
$each(dataInfo.stageDesignList,function(p,$index){
$out+=' <th>';
$out+=$escape(p.fieldName);
$out+='</th> ';
});
$out+=' </tr> </thead> <tbody> ';
$each(dataInfo.majorList,function(p,i){
$out+=' <tr> <td class="v-middle">';
$out+=$escape(p.fieldName);
$out+='</td> ';
$each(p.routeList,function(c,ci){
$out+=' <td> ';
if(isView){
$out+=' <span>';
$out+=$escape(c.name);
$out+='</span> ';
}else{
$out+=' <input class="form-control input-sm" name="itemName" value="';
$out+=$escape(c.name);
$out+='" data-id="';
$out+=$escape(c.id);
$out+='" data-stage-design="';
$out+=$escape(c.stageDesignRelationId);
$out+='" data-major-design="';
$out+=$escape(c.majorDesignRelationId);
$out+='"/> ';
}
$out+=' </td> ';
});
$out+=' </tr> ';
});
$out+=' </tbody> </table> </div> <div class="form-group"> <div class="col-sm-6 f-s-xs fc-dark-gray"> 注释：图纸编号规则使用在项目-生产安排-图纸目录中完整展示方式为：子项号+图纸编号+图纸序号。例如：01JC-001 </div> ';
if(!isView){
$out+=' <div class="col-sm-6 text-right p-r"> <button class="btn btn-default" data-action="cancel">取消</button> <button class="btn btn-primary" data-action="save">保存</button> </div> ';
}
$out+=' </div> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_temp_drawing_num_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,t=$data.t,ti=$data.ti,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-hover"> <thead> <tr> <th width="8%">启用</th> <th width="60%">编号规则名称</th> <th>操作</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(t,ti){
$out+=' <tr class="" data-id="';
$out+=$escape(t.id);
$out+='" data-i="';
$out+=$escape(ti);
$out+='" > <td> <label class="i-checks fw-normal m-b-none"> ';
if(t.isDesign==1){
$out+=' <input name="itemCk" type="radio" value="';
$out+=$escape(t.id);
$out+='" checked/> ';
}else{
$out+=' <input name="itemCk" type="radio" value="';
$out+=$escape(t.id);
$out+='"/> ';
}
$out+=' <span class="i-checks-span"></span> </label> </td> <td>';
$out+=$escape(t.templateName);
$out+='</td> <td> ';
if(t.companyId!=0){
$out+=' <button class="btn btn-primary btn-xs roleControl" roleCode="10000602" flag="2" data-action="editDrawingNum">编辑</button> <button class="btn btn-danger btn-xs roleControl" roleCode="10000602" flag="2" data-action="delDrawingNum">删除</button> ';
}
$out+=' <button class="btn btn-info btn-xs" data-action="viewDrawingNum">查看</button> </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="3" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_temp_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,type=$data.type,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$index=$data.$index,doType=$data.doType,u=$data.u,$out='';$out+='<div class="m-project-temp-edit" data-type="';
$out+=$escape(type);
$out+='"> <div class="col-md-6"> <div class="ibox"> <div class="ibox-title no-borders p-h-sm min-h-50">数据模板</div> <div class="ibox-content border-darker-grey box-left"> ';
if(dataList){
$out+=' <h4>模板标签库</h4> <div class="m-b-sm"> <label class="i-checks i-checks-label fw-normal"> <input name="allItemCK" type="checkbox" value="0"/> <span class="i-checks-span">全选</span> </label> </div> <div class="row"> ';
if(type=='3'){
$out+=' <div class="col-group"> ';
$each(dataList.majorList,function(p,i){
$out+=' <div class="col-md-4 p-r-none"> <label class="i-checks i-checks-label fw-normal"> <input name="itemCk" type="checkbox" value="';
$out+=$escape(p.fieldName);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='" data-unit="';
$out+=$escape(p.unitName);
$out+='"/> <span class="i-checks-span text-ellipsis" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(p.fieldName);
$out+='"> ';
$out+=$escape(p.fieldName);
$out+=' </span> </label> </div> ';
});
$out+=' </div> <div class="col-group more-item hide"> ';
$each(dataList.moreMajorList,function(p,i){
$out+=' <div class="col-md-4 p-r-none"> <label class="i-checks i-checks-label fw-normal"> <input name="itemCk" type="checkbox" value="';
$out+=$escape(p.fieldName);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='" data-unit="';
$out+=$escape(p.unitName);
$out+='"/> <span class="i-checks-span text-ellipsis" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(p.fieldName);
$out+='"> ';
$out+=$escape(p.fieldName);
$out+=' </span> </label> </div> ';
});
$out+=' </div> ';
if(dataList.moreMajorList && dataList.moreMajorList.length>0){
$out+=' <div class="col-md-4 p-r-none"> <button class="btn btn-default btn-xs" data-action="moreItem"><span>更多</span>&nbsp;<i class="fa fa-angle-down"></i></button> </div> ';
}
$out+=' ';
}else{
$out+=' ';
$each(dataList,function(p,$index){
$out+=' <div class="col-md-4 p-r-none"> <label class="i-checks i-checks-label fw-normal"> <input name="itemCk" type="checkbox" value="';
$out+=$escape(p.fieldName);
$out+='" data-id="';
$out+=$escape(p.id);
$out+='" data-unit="';
$out+=$escape(p.unitName);
$out+='"/> <span class="i-checks-span text-ellipsis" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(p.fieldName);
$out+=' ';
$out+=$escape(p.unitName!=null&& p.unitName!=''?'('+p.unitName+')':'');
$out+='"> ';
$out+=$escape(p.fieldName);
$out+='&nbsp; ';
if(type==5 && p.unitName!=null && p.unitName!=''){
$out+=' (';
$out+=$escape(p.unitName);
$out+=') ';
}
$out+=' </span> </label> </div> ';
});
$out+=' ';
}
$out+=' </div> ';
}
$out+=' ';
if((type!=3 && type!=7 && doType!=6)){
$out+=' <h4>自定义库</h4> <div class="row"> <form id="addItemForm"> <div class="col-md-6"> <input class="form-control input-sm p-r-none" type="text" name="fieldName" placeholder="请输入名称"> </div> ';
if(type==5){
$out+=' <div class="col-md-4 p-r-none p-l-none"> <div class="input-group"> <input type="text" class="form-control input-sm" name="unitName" placeholder="请输入或选择" maxlength="8"> <div class="input-group-btn"> <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button> <ul class="dropdown-menu dropdown-menu-right" style="right: 0;left: inherit;max-height: 110px;overflow: auto;" id="unitList"> <!--<li><a href="javascript:void(0);" style="padding:0px 20px;">';
$out+=$escape(u);
$out+='</a></li>--> </ul> </div> </div> </div> ';
}
$out+=' <div class="col-md-2"> <button type="button" class="btn btn-primary btn-sm" data-action="addItem">添加</button> </div> <div class="col-md-12"></div> <div class="clearfix"></div> </form> </div> <div class="row m-t-sm" id="customItemBox"> </div> ';
}
$out+=' </div> </div> </div> <div class="col-md-6"> <div class="ibox"> <div class="ibox-title no-borders p-h-sm min-h-50">已选择项 (拖拽进行调整顺序)</div> <div class="ibox-content border-darker-grey box-right"> <div class="row list-group" id="selectItemBox"> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_temp_edit_customize',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,customItemList=$data.customItemList,$each=$utils.$each,s=$data.s,si=$data.si,$escape=$utils.$escape,$out='';if(customItemList!=null && customItemList.length>0 ){
$out+=' ';
$each(customItemList,function(s,si){
$out+=' <div class="col-md-6 p-r-none m-b-xs"> <label class="i-checks i-checks-label fw-normal"> <input name="cusItemCk" type="checkbox" value="';
$out+=$escape(s.fieldName);
$out+='" data-unit="';
$out+=$escape(s.unitName);
$out+='" data-id="';
$out+=$escape(s.id);
$out+='"/> <span class="i-checks-span"> <span class=" item-span m-r-xs bg-muted f-s-xs" > <span class="field-name text-ellipsis" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(s.fieldName);
$out+=' ';
$out+=$escape(s.unitName!=null&& s.unitName!=''?'('+s.unitName+')':'');
$out+='"> ';
$out+=$escape(s.fieldName);
$out+='&nbsp; ';
$out+=$escape(s.unitName!=null&& s.unitName!=''?'('+s.unitName+')':'');
$out+=' </span> <a class="curp" href="javascript:void(0)" data-id="';
$out+=$escape(s.id);
$out+='" data-action="delCusItem"> <i class="fa fa-times fc-red"></i></a> </span> </span> </label> </div> ';
});
$out+=' ';
}
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_temp_edit_select',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,selectedItemList=$data.selectedItemList,$each=$utils.$each,s=$data.s,si=$data.si,$escape=$utils.$escape,$out='';if(selectedItemList!=null && selectedItemList.length>0 ){
$out+=' ';
$each(selectedItemList,function(s,si){
$out+=' <div class="col-md-6 p-r-none m-b list-group-item" data-sortId="';
$out+=$escape(si);
$out+='"> <span class="item-span m-r-xs bg-muted p-xxs f-s-xs" > <span class="field-name text-ellipsis" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(s.fieldName);
$out+=' ';
$out+=$escape(s.unitName!=null&& s.unitName!=''?'('+s.unitName+')':'');
$out+='" data-field-name="';
$out+=$escape(s.fieldName);
$out+='" data-unit-name="';
$out+=$escape(s.unitName);
$out+='" data-id="';
$out+=$escape(s.id);
$out+='" data-relation-id="';
$out+=$escape(s.relationId);
$out+='"> ';
$out+=$escape(s.fieldName);
$out+='&nbsp; ';
$out+=$escape(s.unitName!=null&& s.unitName!=''?'('+s.unitName+')':'');
$out+=' </span> <a class="curp" href="javascript:void(0)" data-action="delSelectedItem"> <i class="fa fa-times fc-red"></i></a> </span> </div> ';
});
$out+=' ';
}
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_temp_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,type=$data.type,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,c=$data.c,ci=$data.ci,_url=$helpers._url,$out='';if(type==6){
$out+=' ';
if(dataList && dataList.length>0){
$out+=' <table class="table no-margin"> ';
$each(dataList,function(p,i){
$out+=' <tr> <td width="15%" class="vertical-middle border-right"> ';
$out+=$escape(p.fieldName);
$out+=' <a href="javascript:void(0);" class="roleControl" roleCode="10000602" flag="2" data-action="editTemp" data-type="6" data-type-path="6-1" data-index="';
$out+=$escape(i);
$out+='" data-pid="';
$out+=$escape(p.id);
$out+='" data-relation-id="';
$out+=$escape(p.relationId);
$out+='" title="编辑功能分类子项"> <i class="fa fa-pencil text-navy"></i> </a> </td> <td> ';
if(p.childList && p.childList.length>0){
$out+=' ';
$each(p.childList,function(c,ci){
$out+=' <span class="label label-info-v1 p-xxs dp-inline-block m-xs"> ';
$out+=$escape(c.fieldName);
$out+=' </span> ';
});
$out+=' ';
}
$out+=' </td> </tr> ';
});
$out+=' </table> ';
}else{
$out+=' <div class="row no-margin no-data-tr border-top"> <div class="text-center col-md-12"> <div class="m-b-sm"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='" width="80"> <span class="fc-dark-blue dp-block"> 请设置功能分类！ </span> </div> </div> </div> ';
}
$out+=' ';
}else{
$out+=' ';
if(dataList && dataList.length>0){
$out+=' <div class="m"> ';
$each(dataList,function(p,i){
$out+=' <span class="label label-info-v1 p-xxs dp-inline-block m-xs"> ';
$out+=$escape(p.fieldName);
$out+=' ';
$out+=$escape(p.unitName!=null&& p.unitName!=''?'('+p.unitName+')':'');
$out+=' </span> ';
});
$out+=' </div> ';
}else{
$out+=' <div class="row no-margin no-data-tr"> <div class="text-center col-md-12"> <div class="m-b-sm"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='" width="80"> <span class="fc-dark-blue dp-block"> ';
if(type==2){
$out+=' 请设置阶段设置！ ';
}else if(type==3){
$out+=' 请设置专业设置！ ';
}else{
$out+=' 请设置 ';
}
$out+=' </span> </div> </div> </div> ';
}
$out+=' ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_temp_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,type=$data.type,_url=$helpers._url,$out='';$out+='<div class="list-group list-hover"> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <li class="list-group-item " data-id="';
$out+=$escape(p.id);
$out+='" data-relation-id="';
$out+=$escape(p.relationId);
$out+='"> <span class="show-span pt-relative text-ellipsis"> ';
$out+=$escape(p.fieldName);
$out+='</span> ';
if(type==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(p.fieldName);
$out+='" data-key="fieldName" data-placeholder="编辑项目类型" data-type="1" data-valid="1" data-max-length="50" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </li> ';
});
$out+=' ';
}else{
$out+=' <div class="row no-margin"> <div class="text-center col-md-12"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='" width="100"> <span class="fc-dark-blue dp-block">请设置项目类型！</span> </div> </div> </div> ';
}
$out+=' </div> ';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_temp_name_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,type=$data.type,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<form class="form-horizontal m min-h-50"> <div class="form-group"> <label class="col-sm-2 text-right m-t-xs">名称<span class="color-red">*</span>：</label> <div class="col-sm-10"> ';
if(type==3){
$out+=' <select class="form-control" name="fieldName"></select> ';
}else{
$out+=' <input type="text" class="form-control" name="fieldName" maxlength="50" placeholder="请输入名称" value="';
$out+=$escape(dataInfo!=null?dataInfo.fieldName:'');
$out+='"> ';
}
$out+=' </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_temp_tab',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,companyVersion=$data.companyVersion,$out='';$out+='<div class="m-project-temp-tab m"> <div class="tabs-container"> <ul class="nav nav-tabs"> <li class="active"><a class="" data-toggle="tab" href="#tab-1" data-type="orgZone">公司关系配置</a></li> <li class=""><a class="" data-toggle="tab" href="#tab-2" data-type="projectSettings">项目基础信息设置</a></li> ';
if(companyVersion!='03'){
$out+=' <li class=""><a class="" data-toggle="tab" href="#tab-3" data-type="productionProcess">设计任务流程设置</a></li> ';
}
$out+=' </ul> <div class="tab-content"> <div id="tab-1" class="tab-pane active" data-type="orgZone"> <div class="panel-body"> </div> </div> <div id="tab-2" class="tab-pane " data-type="projectSettings"> <div class="panel-body"> </div> </div> <div id="tab-3" class="tab-pane " data-type="productionProcess"> <div class="panel-body"> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_temp_zone',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="m-project-theater-config"> <div class="row m-b-sm"> <div class="col-sm-12 text-right"> <button class="btn btn-primary roleControl" roleCode="10000602" flag="2" data-action="add">添加单位</button> </div> </div> <table class="table table-hover table-bordered m-b-xs" > <thead> <tr> <th width="80%">单位</th> <th>操作</th> </tr> </thead> <tbody> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(p,$index){
$out+=' <tr data-id="';
$out+=$escape(p.id);
$out+='"> <td>';
$out+=$escape(p.orgName);
$out+='</td> <td> <button class="btn btn-primary btn-xs roleControl" roleCode="10000602" flag="2" data-action="edit">编辑</button> <button class="btn btn-danger btn-xs roleControl" roleCode="10000602" flag="2" data-action="delete">删除</button> </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="2" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div>';
return new String($out);
});/*v:1*/
template('m_project_temp/m_project_temp_zone_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$out='';$out+='<div class="m-form-template-generate-edit p-sm"> <form class="form-horizontal" id="fieldForm"> <div class="form-group"> <label class="col-sm-2 control-label"> 单位<span class="fc-red">*</span>： </label> <div class="col-sm-10"> <input placeholder="请输入单位" class="form-control" type="text" name="orgName" value="';
$out+=$escape(dataInfo?dataInfo.orgName:'');
$out+='"> </div> </div> </form> </div> ';
return new String($out);
});/*v:1*/
template('m_salary/m_salary_calculation_table','<div class="m m-salary m-salary-calculation-table"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> <div class="form-group"> <button class="btn btn-primary btn-sm" data-action="exportDetails">导出表格</button> <a href="javascript:void(0);" class="btn btn-primary btn-sm web-uploader" data-action="importDetails">导入表格</a> </div> <div class="form-group pull-right"> <button class="btn btn-link btn-sm" data-action="generateReport">生成综合报表</button> <button class="btn btn-primary btn-sm" data-action="saveReport">保存综合报表</button> </div> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> ');/*v:1*/
template('m_salary/m_salary_calculation_table_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,doType=$data.doType,isCreateSalaryReport=$data.isCreateSalaryReport,dataList=$data.dataList,_momentFormat=$helpers._momentFormat,month=$data.month,$each=$utils.$each,d=$data.d,i=$data.i,pageIndex=$data.pageIndex,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-responsive"> <thead> <tr> <th colspan="22" class=""> <div class="col-sm-6 text-left ';
$out+=$escape(doType==1?'':'p-t-7');
$out+='"> ';
if(doType!=1){
$out+=' <span class="glyphicon glyphicon-star-empty fc-v1-grey"></span> <span>未生成</span> <span class="glyphicon glyphicon-star-empty fc-v1-yellow"></span> <span>已生成</span> <span class="glyphicon glyphicon-star-empty fc-v2-blue"></span> <span>已生成有修改</span> <span class="glyphicon glyphicon-star-empty fc-v2-green"></span> <span>已保存</span> ';
}
$out+=' </div> <div class="col-sm-6 text-left"> ';
if(isCreateSalaryReport==0){
$out+=' <span class="glyphicon glyphicon-star-empty fc-v1-grey" title="未生成"></span> ';
}else if(isCreateSalaryReport==2){
$out+=' <span class="glyphicon glyphicon-star-empty fc-v1-yellow" title="已生成"></span> ';
}else if(isCreateSalaryReport==3){
$out+=' <span class="glyphicon glyphicon-star-empty fc-v2-blue" title="已生成有修改"></span> ';
}else if(isCreateSalaryReport==1){
$out+=' <span class="glyphicon glyphicon-star-empty fc-v2-green" title="已保存"></span> ';
}
$out+='  ';
if(doType==1){
$out+=' ';
$out+=$escape(dataList && dataList.length>0 && dataList[0].month?_momentFormat(dataList[0].month,'YYYY年'):'');
$out+='工资数据录入综合表 ';
}else{
$out+=' <input type="text" class="form-control time-span" id="d12" readonly> <span class="time-span curp" data-action="timeSelect">';
$out+=$escape(month);
$out+='</span> <span class="caret curp" data-action="timeSelect"></span> <button class="btn btn-link btn-sm pull-right" data-action="changeHistory">变更记录</button> ';
}
$out+=' </div> </th> </tr> <tr> <th rowspan="2"> ';
if(doType==1){
$out+=' 月份 ';
}else{
$out+=' 序号 ';
}
$out+=' </th> <th rowspan="2"> 姓名 ';
if(doType!=1){
$out+=' <a class="icon-filter pull-right" id="filter_userName"><i class="icon iconfont icon-shaixuan"></i></a> ';
}
$out+=' </th> <th rowspan="2">本月工资</th> <th rowspan="2">本月奖金</th> <th rowspan="2">扣考勤</th> <th rowspan="2"></th> <th rowspan="3">公积金</th> <th rowspan="3">养老金</th> <th rowspan="3">医疗险</th> <th rowspan="3">失业险</th> <th rowspan="3">工伤险</th> <th rowspan="3">生育险</th> <th colspan="6">专项附加扣除</th> <th rowspan="2">企业年金</th> <th rowspan="2">商业健康险</th> <th rowspan="2">准予扣除的捐赠额</th> <th rowspan="2">其他</th> </tr> <tr> <th>子女教育</th> <th>住房贷款利息</th> <th>住房租金</th> <th>赡养老人</th> <th>继续教育</th> <th>大病医疗</th> </tr> </thead> <tbody> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='" data-company-user-id="';
$out+=$escape(d.companyUserId);
$out+='" data-cellphone="';
$out+=$escape(d.cellphone);
$out+='"> <td rowspan="3"> ';
if(doType==1){
$out+=' ';
$out+=$escape(_momentFormat(d.month,'MM')-0);
$out+='月 ';
}else{
$out+=' ';
$out+=$escape(i+1+pageIndex*10);
$out+=' ';
}
$out+=' </td> <td rowspan="3">';
$out+=$escape(d.userName);
$out+='</td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.salary);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.salary);
$out+='" data-key="salary" data-type="1" data-valid="6" > ';
if(d.salary==null||d.salary==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.salary);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.bonus);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.bonus);
$out+='" data-key="bonus" data-type="1" data-valid="6" > ';
if(d.bonus==null||d.bonus==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.bonus);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.deductAttendance);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.deductAttendance);
$out+='" data-key="deductAttendance" data-type="1" data-valid="6" > ';
if(d.deductAttendance==null||d.deductAttendance==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.deductAttendance);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td>缴费基数</td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.providentFundBase);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.providentFundBase);
$out+='" data-key="providentFundBase" data-type="1" data-valid="6" > ';
if(d.providentFundBase==null||d.providentFundBase==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.providentFundBase);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.endowmentInsuranceBase);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.endowmentInsuranceBase);
$out+='" data-key="endowmentInsuranceBase" data-type="1" data-valid="6" > ';
if(d.endowmentInsuranceBase==null||d.endowmentInsuranceBase==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.endowmentInsuranceBase);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.medicalInsuranceBase);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.medicalInsuranceBase);
$out+='" data-key="medicalInsuranceBase" data-type="1" data-valid="6" > ';
if(d.medicalInsuranceBase==null||d.medicalInsuranceBase==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.medicalInsuranceBase);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.unemploymentInsuranceBase);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.unemploymentInsuranceBase);
$out+='" data-key="unemploymentInsuranceBase" data-type="1" data-valid="6" > ';
if(d.unemploymentInsuranceBase==null||d.unemploymentInsuranceBase==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.unemploymentInsuranceBase);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.workingInjuryInsuranceBase);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.workingInjuryInsuranceBase);
$out+='" data-key="workingInjuryInsuranceBase" data-type="1" data-valid="6" > ';
if(d.workingInjuryInsuranceBase==null||d.workingInjuryInsuranceBase==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.workingInjuryInsuranceBase);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.maternityInsuranceBase);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.maternityInsuranceBase);
$out+='" data-key="maternityInsuranceBase" data-type="1" data-valid="6" > ';
if(d.maternityInsuranceBase==null||d.maternityInsuranceBase==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.maternityInsuranceBase);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.specialDeductChildrenEducation);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.specialDeductChildrenEducation);
$out+='" data-key="specialDeductChildrenEducation" data-type="1" data-valid="6" > ';
if(d.specialDeductChildrenEducation==null||d.specialDeductChildrenEducation==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.specialDeductChildrenEducation);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.specialDeductHomeLoanTax);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.specialDeductHomeLoanTax);
$out+='" data-key="specialDeductHomeLoanTax" data-type="1" data-valid="6" > ';
if(d.specialDeductHomeLoanTax==null||d.specialDeductHomeLoanTax==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.specialDeductHomeLoanTax);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.specialDeductHouseRent);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.specialDeductHouseRent);
$out+='" data-key="specialDeductHouseRent" data-type="1" data-valid="6" > ';
if(d.specialDeductHouseRent==null||d.specialDeductHouseRent==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.specialDeductHouseRent);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.specialDeductSupportOld);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.specialDeductSupportOld);
$out+='" data-key="specialDeductSupportOld" data-type="1" data-valid="6" > ';
if(d.specialDeductSupportOld==null||d.specialDeductSupportOld==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.specialDeductSupportOld);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.specialDeductContinueEducation);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.specialDeductContinueEducation);
$out+='" data-key="specialDeductContinueEducation" data-type="1" data-valid="6" > ';
if(d.specialDeductContinueEducation==null||d.specialDeductContinueEducation==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.specialDeductContinueEducation);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.specialDeductSeriousDisease);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.specialDeductSeriousDisease);
$out+='" data-key="specialDeductSeriousDisease" data-type="1" data-valid="6" > ';
if(d.specialDeductSeriousDisease==null||d.specialDeductSeriousDisease==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.specialDeductSeriousDisease);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.enterpriseInRisk);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.enterpriseInRisk);
$out+='" data-key="enterpriseInRisk" data-type="1" data-valid="6" > ';
if(d.enterpriseInRisk==null||d.enterpriseInRisk==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.enterpriseInRisk);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.commercialHealthInsurance);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.commercialHealthInsurance);
$out+='" data-key="commercialHealthInsurance" data-type="1" data-valid="6" > ';
if(d.commercialHealthInsurance==null||d.commercialHealthInsurance==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.commercialHealthInsurance);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.allowDeductDonate);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.allowDeductDonate);
$out+='" data-key="allowDeductDonate" data-type="1" data-valid="6" > ';
if(d.allowDeductDonate==null||d.allowDeductDonate==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.allowDeductDonate);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> <td rowspan="3"> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.other);
$out+=' ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.other);
$out+='" data-key="other" data-type="1" data-valid="6" > ';
if(d.other==null||d.other==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.other);
$out+=' ';
}
$out+=' </a> ';
}
$out+=' </td> </tr> <tr data-id="';
$out+=$escape(d.id);
$out+='" data-company-user-id="';
$out+=$escape(d.companyUserId);
$out+='" data-cellphone="';
$out+=$escape(d.cellphone);
$out+='"> <td>单位比例</td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.providentFundOrgRatio);
$out+='% ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.providentFundOrgRatio);
$out+='" data-key="providentFundOrgRatio" data-type="1" data-valid="7" data-unit="%" data-valid-title="比例"> ';
if(d.providentFundOrgRatio==null||d.providentFundOrgRatio==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.providentFundOrgRatio);
$out+='% ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.endowmentInsuranceOrgRatio);
$out+='% ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.endowmentInsuranceOrgRatio);
$out+='" data-key="endowmentInsuranceOrgRatio" data-type="1" data-valid="7" data-unit="%" data-valid-title="比例"> ';
if(d.endowmentInsuranceOrgRatio==null||d.endowmentInsuranceOrgRatio==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.endowmentInsuranceOrgRatio);
$out+='% ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.medicalInsuranceOrgRatio);
$out+='% ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.medicalInsuranceOrgRatio);
$out+='" data-key="medicalInsuranceOrgRatio" data-type="1" data-valid="7" data-unit="%" data-valid-title="比例"> ';
if(d.medicalInsuranceOrgRatio==null||d.medicalInsuranceOrgRatio==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.medicalInsuranceOrgRatio);
$out+='% ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.unemploymentInsuranceOrgRatio);
$out+='% ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.unemploymentInsuranceOrgRatio);
$out+='" data-key="unemploymentInsuranceOrgRatio" data-type="1" data-valid="7" data-unit="%" data-valid-title="比例"> ';
if(d.unemploymentInsuranceOrgRatio==null||d.unemploymentInsuranceOrgRatio==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.unemploymentInsuranceOrgRatio);
$out+='% ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.workingInjuryInsuranceOrgRatio);
$out+='% ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.workingInjuryInsuranceOrgRatio);
$out+='" data-key="workingInjuryInsuranceOrgRatio" data-type="1" data-valid="7" data-unit="%" data-valid-title="比例"> ';
if(d.workingInjuryInsuranceOrgRatio==null||d.workingInjuryInsuranceOrgRatio==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.workingInjuryInsuranceOrgRatio);
$out+='% ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.maternityInsuranceOrgRatio);
$out+='% ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.maternityInsuranceOrgRatio);
$out+='" data-key="maternityInsuranceOrgRatio" data-type="1" data-valid="7" data-unit="%" data-valid-title="比例"> ';
if(d.maternityInsuranceOrgRatio==null||d.maternityInsuranceOrgRatio==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.maternityInsuranceOrgRatio);
$out+='% ';
}
$out+=' </a> ';
}
$out+=' </td> </tr> <tr data-id="';
$out+=$escape(d.id);
$out+='" data-company-user-id="';
$out+=$escape(d.companyUserId);
$out+='" data-cellphone="';
$out+=$escape(d.cellphone);
$out+='"> <td>个人比例</td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.providentFundPersonRatio);
$out+='% ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.providentFundPersonRatio);
$out+='" data-key="providentFundPersonRatio" data-type="1" data-valid="7" data-unit="%" data-valid-title="比例"> ';
if(d.providentFundPersonRatio==null||d.providentFundPersonRatio==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.providentFundPersonRatio);
$out+='% ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.endowmentInsurancePersonRatio);
$out+='% ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.endowmentInsurancePersonRatio);
$out+='" data-key="endowmentInsurancePersonRatio" data-type="1" data-valid="7" data-unit="%" data-valid-title="比例"> ';
if(d.endowmentInsurancePersonRatio==null||d.endowmentInsurancePersonRatio==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.endowmentInsurancePersonRatio);
$out+='% ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.medicalInsurancePersonRatio);
$out+='% ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.medicalInsurancePersonRatio);
$out+='" data-key="medicalInsurancePersonRatio" data-type="1" data-valid="7" data-unit="%" data-valid-title="比例"> ';
if(d.medicalInsurancePersonRatio==null||d.medicalInsurancePersonRatio==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.medicalInsurancePersonRatio);
$out+='% ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.unemploymentInsurancePersonRatio);
$out+='% ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.unemploymentInsurancePersonRatio);
$out+='" data-key="unemploymentInsurancePersonRatio" data-type="1" data-valid="7" data-unit="%" data-valid-title="比例"> ';
if(d.unemploymentInsurancePersonRatio==null||d.unemploymentInsurancePersonRatio==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.unemploymentInsurancePersonRatio);
$out+='% ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.workingInjuryInsurancePersonRatio);
$out+='% ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.workingInjuryInsurancePersonRatio);
$out+='" data-key="workingInjuryInsurancePersonRatio" data-type="1" data-valid="7" data-unit="%" data-valid-title="比例"> ';
if(d.workingInjuryInsurancePersonRatio==null||d.workingInjuryInsurancePersonRatio==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.workingInjuryInsurancePersonRatio);
$out+='% ';
}
$out+=' </a> ';
}
$out+=' </td> <td> ';
if(doType==1 || isCreateSalaryReport==1){
$out+=' ';
$out+=$escape(d.maternityInsurancePersonRatio);
$out+='% ';
}else{
$out+=' <a href="javascript:void(0);" class="editable-click" data-action="edit" data-value="';
$out+=$escape(d.maternityInsurancePersonRatio);
$out+='" data-key="maternityInsurancePersonRatio" data-type="1" data-valid="7" data-unit="%" data-valid-title="比例"> ';
if(d.maternityInsurancePersonRatio==null||d.maternityInsurancePersonRatio==''){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(d.maternityInsurancePersonRatio);
$out+='% ';
}
$out+=' </a> ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="22" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_salary/m_salary_history','<div class="m m-salary m-salary-history"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> ');/*v:1*/
template('m_salary/m_salary_history_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,pageIndex=$data.pageIndex,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-responsive"> <thead> <tr> <th>序号</th> <th>变更时间</th> <th>变更人</th> <th>变更字段</th> <th>变更前</th> <th>变更后</th> </tr> </thead> <tbody> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' <tr> <th>';
$out+=$escape(i+1+pageIndex*10);
$out+='</th> <th>';
$out+=$escape(_momentFormat(d.createDate,'YYYY/MM/DD'));
$out+='</th> <th>';
$out+=$escape(d.userName);
$out+='</th> <th>';
$out+=$escape(d.fieldNameDesc);
$out+='</th> <th>';
$out+=$escape(d.oldValue);
$out+='</th> <th>';
$out+=$escape(d.newValue);
$out+='</th> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="6" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_salary/m_salary_menu','<div class="ibox no-margins"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right"> <ul class="secondary-menu-ul"> <li class="active" id="employeeSalary" class="roleControl" roleCode="40001701" flag="2"> <a href="#/salary/employeeSalary">职工薪酬</a> </li> <li id="salaryCalculationTable" class="roleControl" roleCode="40001702,40001703" flag="2"> <a href="#/salary/salaryCalculationTable">工资数据录入表</a> </li> <li id="salaryTaxTable" class="roleControl" roleCode="40001704" flag="2"> <a href="#/salary/salaryTaxTable">个税计算查询表</a> </li> <li id="salaryReport" class="roleControl" roleCode="40001705" flag="2"> <a href="#/salary/salaryReport">工资总表</a> </li> </ul> </div> </div> </div> </div> <div class="ibox-content no-padding" id="content-box"> </div> </div>');/*v:1*/
template('m_salary/m_salary_mgt',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,month=$data.month,$out='';$out+='<div class="m-salary"> <div class="row border-bottom p-t p-l"> <div class="col-md-12"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">时间：</label> <input type="text" class="form-control time-span" id="d12" readonly> <span class="time-span curp" data-action="timeSelect">';
$out+=$escape(month);
$out+='</span> <span class="caret curp" data-action="timeSelect"></span> </div> </form> </div> </div> <div class="row p-l"> <div class="col-24-sm-8 col-24-md-8 col-24-lg-6 border-right of-auto" id="orgTreeBox"> <div class="clearfix margin-bottom-10"></div> <div id="selectOrg"> <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </div> <div class="col-24-sm-16 col-24-md-16 col-24-lg-18 no-padding" id="orgUserListBox"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-m"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_salary/m_salary_mgt_user_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,$index=$data.$index,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-responsive m-salary-mgt-user-list"> <thead> <tr> <th width="16%">姓名</th> <th width="15%">手机号</th> <th width="17%">岗位</th> <th width="13%">工资</th> <th width="13%">奖金</th> <th width="13%">五险一金</th> <th width="13%">合计</th> </tr> </thead> <tbody> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(d,$index){
$out+=' <tr class="curp" data-id="';
$out+=$escape(d.id);
$out+='" data-company-id="';
$out+=$escape(d.companyId);
$out+='"> <td>';
$out+=$escape(d.userName);
$out+='</td> <td>';
$out+=$escape(d.cellphone);
$out+='</td> <td> ';
if(d.positionType == '1'){
$out+=' 管理人员 ';
}else if(d.positionType == '2'){
$out+=' 技术人员 ';
}
$out+=' </td> <td>';
$out+=$escape(d.salaryOrg);
$out+='</td> <td>';
$out+=$escape(d.bonusOrg);
$out+='</td> <td>';
$out+=$escape(d.fiveInsuranceAndFundOrg);
$out+='</td> <td>';
$out+=$escape(d.total);
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="7" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_salary/m_salary_payroll',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,year=$data.year,$out='';$out+='<form class="form-horizontal m m-salary"> <div class="row"> <div class="col-sm-12"> <input type="text" class="form-control time-span" id="d12" readonly> <span class="time-span curp" data-action="timeSelect">';
$out+=$escape(year);
$out+='</span> <span class="caret curp" data-action="timeSelect"></span> </div> </div> <div class="row"> <div class="col-sm-12" id="payrollBox"> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_salary/m_salary_person_details','<div class="m m-salary m-salary-table"> <div class="row m-b-sm"> <div class="col-md-6"> <h4 class="title-line fc-dark-grey">薪酬详情</h4> </div> <div class="col-md-6 text-right"> </div> </div> <div class="row"> <div class="col-md-12" id="salaryTable"> </div> </div> <div class="row"> <div class="col-md-12" id="salaryTaxTable"> </div> </div> </div> ');/*v:1*/
template('m_salary/m_salary_report','<div class="m m-salary m-salary-report"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> <div class="form-group"> <button class="btn btn-primary btn-sm" data-action="exportDetails">导出表格</button> </div> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div>');/*v:1*/
template('m_salary/m_salary_report_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,month=$data.month,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,pageIndex=$data.pageIndex,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-responsive"> <thead> <tr> <th colspan="21" class="text-center"> <input type="text" class="form-control time-span" id="d12" readonly> <span class="time-span curp" data-action="timeSelect">';
$out+=$escape(month);
$out+='</span> <span class="caret curp" data-action="timeSelect"></span> <span>工资表</span> </th> </tr> <tr> <th rowspan="2">序号</th> <th rowspan="2">姓名<a class="icon-filter pull-right" id="filter_userName"><i class="icon iconfont icon-shaixuan"></i></a></th> <th rowspan="2">本月收入</th> <th rowspan="2">考勤</th> <th rowspan="2">应发金额</th> <th rowspan="2">养老险</th> <th rowspan="2">医疗险</th> <th rowspan="2">失业险</th> <th rowspan="2">住房公积金</th> <th colspan="6">累计专项附加扣除</th> <th colspan="4">依法准予扣除项目</th> <th rowspan="2">本月实际预扣预缴个税</th> <th rowspan="2">实际发放</th> </tr> <tr> <th>子女教育</th> <th>住房贷款利息</th> <th>住房租金</th> <th>赡养老人</th> <th>继续教育</th> <th>大病医疗</th> <th>企业年金</th> <th>商业健康险</th> <th>准予扣除的捐赠</th> <th>其他</th> </tr> </thead> <tbody> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' <tr class="detailTr"> <td>';
$out+=$escape(i+1+pageIndex*10);
$out+='</td> <td>';
$out+=$escape(d.userName);
$out+='</td> <td>';
$out+=$escape(d.income);
$out+='</td> <td>';
$out+=$escape(d.deductAttendance);
$out+='</td> <td>';
$out+=$escape(d.totalPayAmount);
$out+='</td> <td>';
$out+=$escape(d.deductEndowmentInsurance);
$out+='</td> <td>';
$out+=$escape(d.deductMedicalInsurance);
$out+='</td> <td>';
$out+=$escape(d.deductUnemploymentInsurance);
$out+='</td> <td>';
$out+=$escape(d.deductWorkingInjuryInsurance);
$out+='</td> <td>';
$out+=$escape(d.sumSpecialDeductChildrenEducation);
$out+='</td> <td>';
$out+=$escape(d.sumSpecialDeductHomeLoanTax);
$out+='</td> <td>';
$out+=$escape(d.sumSpecialDeductHouseRent);
$out+='</td> <td>';
$out+=$escape(d.sumSpecialDeductSupportOld);
$out+='</td> <td>';
$out+=$escape(d.sumSpecialDeductContinueEducation);
$out+='</td> <td>';
$out+=$escape(d.sumSpecialDeductSeriousDisease);
$out+='</td> <td>';
$out+=$escape(d.enterpriseInRisk);
$out+='</td> <td>';
$out+=$escape(d.commercialHealthInsurance);
$out+='</td> <td>';
$out+=$escape(d.allowDeductDonate);
$out+='</td> <td>';
$out+=$escape(d.other);
$out+='</td> <td>';
$out+=$escape(d.actualPayTax);
$out+='</td> <td>';
$out+=$escape(d.actualIncome);
$out+='</td> </tr> ';
});
$out+=' <tr class="sumTr"> <td></td> <td>合计</td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> </tr> ';
}else{
$out+=' <tr class="no-data"> <td colspan="21" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_salary/m_salary_tax_calculation_table','<div class="m m-salary m-salary-table"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> <div class="form-group"> <button class="btn btn-primary btn-sm roleControl" roleCode="40001706" flag="2" data-action="exportDetails">导出表格</button> <a href="javascript:void(0);" class="btn btn-primary btn-sm web-uploader roleControl" roleCode="40001706" flag="2" data-action="importDetails">导入表格</a> </div> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> ');/*v:1*/
template('m_salary/m_salary_tax_calculation_table_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,doType=$data.doType,$escape=$utils.$escape,dataList=$data.dataList,_momentFormat=$helpers._momentFormat,month=$data.month,$each=$utils.$each,d=$data.d,i=$data.i,pageIndex=$data.pageIndex,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-responsive"> <thead> <tr> <th colspan="24" class="text-center">  ';
if(doType==1){
$out+=' ';
$out+=$escape(dataList && dataList.length>0 && dataList[0].month?_momentFormat(dataList[0].month,'YYYY年'):'');
$out+='个税计算及职工薪酬综合表 ';
}else{
$out+=' <input type="text" class="form-control time-span" id="d12" readonly> <span class="time-span curp" data-action="timeSelect">';
$out+=$escape(month);
$out+='</span> <span class="caret curp" data-action="timeSelect"></span> <span>个税扣除预缴计算综合报表</span> ';
}
$out+=' </th> </tr> <tr> <th rowspan="2"> ';
if(doType==1){
$out+=' 月份 ';
}else{
$out+=' 序号 ';
}
$out+=' </th> <th rowspan="2"> 姓名 ';
if(doType!=1){
$out+=' <a class="icon-filter pull-right" id="filter_userName"><i class="icon iconfont icon-shaixuan"></i></a> ';
}
$out+=' </th> <th rowspan="2">本月收入</th> <th rowspan="2">扣考勤</th> <th rowspan="2" width="60">累计收入</th> <th colspan="2" width="60">本月专项扣除</th> <th colspan="2" width="60">累计专项扣除</th> <th rowspan="2" width="60">累计基本减除费用</th> <th rowspan="2" width="60">本月专项附加扣除</th> <th rowspan="2" width="60">累计专项附加扣除</th> <th rowspan="2" width="70">累计依法可扣除的其他项目</th> <th rowspan="2" width="70">累计预扣预缴应纳税所得额</th> <th rowspan="2">适用税率</th> <th rowspan="2">速算扣除数</th> <th rowspan="2" width="70">累计应预扣预缴税额</th> <th rowspan="2" width="60">已预扣预缴税额</th> <th rowspan="2" width="70">本期实际应预扣预缴税额</th> <th rowspan="2">实际到账</th> <th colspan="4">公司实际支出</th> </tr> <tr> <th>社保</th> <th>公积金</th> <th>社保</th> <th>公积金</th> <th>工资</th> <th>奖金</th> <th>五险一金</th> <th>合计</th> </tr> </thead> <tbody> ';
if(dataList && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' <tr class="detailTr"> <td> ';
if(doType==1){
$out+=' ';
$out+=$escape(_momentFormat(d.month,'MM')-0);
$out+='月 ';
}else{
$out+=' ';
$out+=$escape(i+1+pageIndex*10);
$out+=' ';
}
$out+=' </td> <td>';
$out+=$escape(d.userName);
$out+='</td> <td>';
$out+=$escape(d.income);
$out+='</td> <td>';
$out+=$escape(d.deductAttendance);
$out+='</td> <td>';
$out+=$escape(d.sumSalaryIncome);
$out+='</td> <td>';
$out+=$escape(d.socialInsurance);
$out+='</td> <td>';
$out+=$escape(d.providentFund);
$out+='</td> <td>';
$out+=$escape(d.sumSocialInsurance);
$out+='</td> <td>';
$out+=$escape(d.sumProvidentFund);
$out+='</td> <td>';
$out+=$escape(d.sumBaseDeduct);
$out+='</td> <td>';
$out+=$escape(d.specialDeduct);
$out+='</td> <td>';
$out+=$escape(d.sumSpecialDeduct);
$out+='</td> <td>';
$out+=$escape(d.sumOtherDeduct);
$out+='</td> <td>';
$out+=$escape(d.sumTaxableIncome);
$out+='</td> <td>';
$out+=$escape(d.taxRate?d.taxRate+'%':'');
$out+='</td> <td>';
$out+=$escape(d.quickDeduction);
$out+='</td> <td>';
$out+=$escape(d.prepayTax);
$out+='</td> <td>';
$out+=$escape(d.payTax);
$out+='</td> <td>';
$out+=$escape(d.actualPayTax);
$out+='</td> <td>';
$out+=$escape(d.actualIncome);
$out+='</td> <td>';
$out+=$escape(d.salaryOrg);
$out+='</td> <td>';
$out+=$escape(d.bonusOrg);
$out+='</td> <td>';
$out+=$escape(d.fiveInsuranceAndFundOrg);
$out+='</td> <td>';
$out+=$escape(d.total);
$out+='</td> </tr> ';
});
$out+=' <tr class="sumTr"> <td></td> <td>合计</td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td class="notSum"></td> <td class="notSum"></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> <td ></td> </tr> ';
}else{
$out+=' <tr class="no-data"> <td colspan="24" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_summary/m_summary_invoice','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-6">  <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 费用管理 </li> <li class="active fa fa-angle-right"> <strong>发票汇总</strong> </li> </ol> </div> </div> <div class="col-md-6 text-right p-w-sm"> </div> <div class="clearfix"></div> </div> </div> <div class="ibox-content" > </div> </div> ');/*v:1*/
template('m_summary/m_summary_invoice_amount',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_expNumberFilter=$helpers._expNumberFilter,totalInvoiceAmount=$data.totalInvoiceAmount,totalMakeOutInvoiceAmount=$data.totalMakeOutInvoiceAmount,totalNotMakeOutInvoiceAmount=$data.totalNotMakeOutInvoiceAmount,totalCancellationInvoiceAmount=$data.totalCancellationInvoiceAmount,$out='';$out+='<div class="pt-absolute m-t-sm" id="totalAmount"> &nbsp;&nbsp;总申请金额：<span>';
$out+=$escape(_expNumberFilter(totalInvoiceAmount));
$out+='</span>元 &nbsp;&nbsp;总开票金额：<span>';
$out+=$escape(_expNumberFilter(totalMakeOutInvoiceAmount));
$out+='</span>元 &nbsp;&nbsp;待开票金额：<span>';
$out+=$escape(_expNumberFilter(totalNotMakeOutInvoiceAmount));
$out+='</span>元 &nbsp;&nbsp;累计作废发票金额：<span class="color-red">';
$out+=$escape(_expNumberFilter(totalCancellationInvoiceAmount));
$out+='</span>元 </div>';
return new String($out);
});/*v:1*/
template('m_summary/m_summary_invoice_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,doType=$data.doType,$out='';$out+='<div class="';
$out+=$escape(doType==2?'m':'');
$out+='"> <form role="form" class="form-inline m-b-sm"> <div class="form-group z-index-1"> <label class="">当前组织：</label> <div class="btn-group" id="selectOrg"> </div> </div> <div class="time-combination form-group"> </div> <button class="btn btn-white btn-sm" data-action="refreshBtn">刷新数据</button> <button type="button" class="btn btn-primary pull-right" data-action="setField" title="设置字段"> <span><i class="fa fa-list"></i> <span class="caret m-t-n-xs"></span></span> </button> </form> <div class="data-list-box"> <div class="data-list-container"> <table class="table table-bordered table-hover cell-border dataTable"> <thead></thead> <tbody></tbody> </table> </div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_summary/m_summary_invoice_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,invoiceInfo=$data.invoiceInfo,pointDetailInfo=$data.pointDetailInfo,_expNumberFilter=$helpers._expNumberFilter,cost=$data.cost,point=$data.point,$out='';$out+='<form class="form-horizontal p-sm overflow-y-auto m-dialog-resize"> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">日期：</label> <div class="col-md-10"> ';
$out+=$escape(_momentFormat(invoiceInfo.applyDate,'YYYY/MM/DD'));
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">申请人：</label> <div class="col-md-10">';
$out+=$escape(pointDetailInfo.userName);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">开票金额：</label> <div class="col-md-10">';
$out+=$escape(_expNumberFilter(invoiceInfo.invoiceAmount));
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">到账金额：</label> <div class="col-md-10">';
$out+=$escape(_expNumberFilter(pointDetailInfo.sumPaidFee));
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">应收金额：</label> <div class="col-md-10">';
$out+=$escape(_expNumberFilter(pointDetailInfo.notPaidFee));
$out+='</div> </div> <div class="hr-line-dashed m-t-none m-b-sm" ></div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">关联项目：</label> <div class="col-md-10">';
$out+=$escape(cost.projectName);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">收款方：</label> <div class="col-md-10"> ';
if(cost.toCompanyName!=null && cost.toCompanyName!=''){
$out+=' ';
$out+=$escape(cost.toCompanyName);
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">收款节点：</label> <div class="col-md-10">';
$out+=$escape(point.feeDescription);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">比例：</label> <div class="col-md-10">';
$out+=$escape(point.feeProportion);
$out+='%</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">节点金额：</label> <div class="col-md-10">';
$out+=$escape(_expNumberFilter(point.fee));
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">申请人：</label> <div class="col-md-10">';
$out+=$escape(pointDetailInfo.userName);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">申请金额：</label> <div class="col-md-10">';
$out+=$escape(_expNumberFilter(pointDetailInfo.fee));
$out+='</div> </div> <div class="hr-line-dashed m-t-none m-b-sm" ></div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">发票类型：</label> <div class="col-md-10"> ';
if(invoiceInfo.invoiceType==1){
$out+=' 普票 ';
}else if(invoiceInfo.invoiceType==2){
$out+=' 专票 ';
}
$out+=' </div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">发票号码：</label> <div class="col-md-10">';
$out+=$escape(invoiceInfo.invoiceNo?invoiceInfo.invoiceNo:'--');
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">收票方名称：</label> <div class="col-md-10">';
$out+=$escape(invoiceInfo.relationCompanyName);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">纳税人识别号：</label> <div class="col-md-10">';
$out+=$escape(invoiceInfo.taxIdNumber);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">开票内容：</label> <div class="col-md-10">';
$out+=$escape(invoiceInfo.invoiceContent);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">备注：</label> <div class="col-md-10">';
$out+=$escape(invoiceInfo.invoiceRemark);
$out+='</div> </div> ';
if(invoiceInfo.invoiceType==2){
$out+=' <div class="form-group m-b-xs"> <label class="col-md-2 text-right">地址：</label> <div class="col-md-10">';
$out+=$escape(invoiceInfo.address);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">电话：</label> <div class="col-md-10">';
$out+=$escape(invoiceInfo.cellphone);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">开户行：</label> <div class="col-md-10">';
$out+=$escape(invoiceInfo.accountBank);
$out+='</div> </div> <div class="form-group m-b-xs"> <label class="col-md-2 text-right">账号：</label> <div class="col-md-10">';
$out+=$escape(invoiceInfo.bankNo);
$out+='</div> </div> ';
}
$out+=' </form> ';
return new String($out);
});/*v:1*/
template('m_summary/m_summary_workingHours','<div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div>');/*v:1*/
template('m_summary/m_summary_workingHours_detail','<div class="data-list-box"> <div class="row"> <div class="data-list-container"></div> <div class="p-w-xs"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div>');/*v:1*/
template('m_summary/m_summary_workingHours_detail_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,d=$data.d,$index=$data.$index,$escape=$utils.$escape,_url=$helpers._url,sum=$data.sum,$out='';$out+='<table class="table table-bordered table-responsive"> <thead> <tr> <th width="20%">姓名</th> <th width="30%">角色</th> <th width="15%">联系电话</th> <th width="20%">邮箱</th> <th width="15%">工时（小时）</th> </tr> </thead> <tbody> ';
$each(dataList,function(d,$index){
$out+=' <tr> <td> <img class="img-circle" src="';
$out+=$escape(d.headImg);
$out+='" width="30"/>&nbsp;&nbsp;';
$out+=$escape(d.companyUserName);
$out+=' </td> <td>';
$out+=$escape(d.nodeName==null||d.nodeName==''?'--':d.nodeName);
$out+='</td> <td>';
$out+=$escape(d.cellphone==null||d.cellphone==''?'--':d.cellphone);
$out+='</td> <td>';
$out+=$escape(d.email==null||d.email==''?'--':d.email);
$out+='</td> <td>';
$out+=$escape(d.hours==null?'--':d.hours);
$out+='</td> </tr> ';
});
$out+=' ';
if(!(dataList && dataList.length>0)){
$out+=' <tr class="no-data"> <td colspan="6" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> <div class="pt-absolute "> <div class="m-l-xs"> ';
if(sum!=null){
$out+=' <span>总工时：';
$out+=$escape(sum);
$out+='小时</span> ';
}
$out+=' </div> </div>';
return new String($out);
});/*v:1*/
template('m_summary/m_summary_workingHours_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,d=$data.d,$index=$data.$index,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-responsive"> <thead> <tr> <th width="20%">项目编号</th> <th width="30%">项目名称</th> <th width="25%">参与人数</th> <th width="25%">累计工时</th> </tr> </thead> <tbody> ';
$each(dataList,function(d,$index){
$out+=' <tr> <td>';
$out+=$escape(d.projectNo==null?'--':d.projectNo);
$out+='</td> <td> <a class="p-r" href="javascript:void(0);" data-action="viewDetail" data-id="';
$out+=$escape(d.id);
$out+='">';
$out+=$escape(d.projectName);
$out+='</a> </td> <td>';
$out+=$escape(d.num==null?'--':d.num);
$out+='</td> <td>';
$out+=$escape(d.hours==null?'--':d.hours);
$out+='</td> </tr> ';
});
$out+=' ';
if(!(dataList && dataList.length>0)){
$out+=' <tr class="no-data"> <td colspan="4" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_changeOperator',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,orgUserList=$data.orgUserList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,selectedUserList=$data.selectedUserList,s=$data.s,$out='';$out+='<form class="form-horizontal rounded-bottom taskProgressOBox noborder" style="max-height: 200px;overflow: auto;"> <div class="ibox"> <div class="ibox-content"> <div class="userListBox"> <table class="table table-striped table-hover table-responsive m-b-none" > <thead> <tr> <th>姓名</th> <th>手机号</th> <th></th> </tr> </thead> <tbody> ';
$each(orgUserList,function(p,$index){
$out+=' <tr> <td>';
$out+=$escape(p.userName);
$out+='</td> <td>';
$out+=$escape(p.cellphone);
$out+='</td> <td> ';
if(selectedUserList!=null && selectedUserList.length>0){
$out+=' ';
$each(selectedUserList,function(s,$index){
$out+=' ';
if(s.id == p.id){
$out+=' <a href="javascript:void(0)" data-companyUserId="';
$out+=$escape(p.id);
$out+='" data-userId="';
$out+=$escape(p.userId);
$out+='" class="btn-u btn-u-default btn-u-xs rounded no-hover">选择</a> ';
}else{
$out+=' <a href="javascript:void(0)" data-action="choseUser" data-companyUserId="';
$out+=$escape(p.id);
$out+='" data-userId="';
$out+=$escape(p.userId);
$out+='" class="btn-u btn-u-primany btn-u-xs rounded">选择</a> ';
}
$out+=' ';
});
$out+=' ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
if(orgUserList==null || orgUserList.length==0){
$out+=' <tr> <td colspan="3" align="center">暂无数据</td> </tr> ';
}
$out+=' </tbody> <tfoot><tr><td colspan="3" id="userList"></td></tr></tfoot> </table> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_choice_mytask_handler',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,orgUserList=$data.orgUserList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,$out='';$out+='<form class="form-horizontal rounded-bottom taskProgressOBox noborder" style="max-height: 200px;overflow: auto;"> <div class="ibox"> <div class="ibox-content"> <div class="userListBox"> <table class="table table-striped table-hover table-responsive m-b-none" > <thead> <tr> <th>姓名</th> <th></th> </tr> </thead> <tbody> ';
$each(orgUserList,function(p,$index){
$out+=' <tr> <td>';
$out+=$escape(p.userName);
$out+='</td> <td class="text-right"> <a href="javascript:void(0)" data-action="choseUser" data-companyUserId="';
$out+=$escape(p.id);
$out+='" data-userId="';
$out+=$escape(p.userId);
$out+='" class="btn-u btn-u-primany btn-u-xs rounded">选择</a> </td> </tr> ';
});
$out+=' ';
if(orgUserList==null || orgUserList.length==0){
$out+=' <tr> <td colspan="2" align="center">暂无数据</td> </tr> ';
}
$out+=' </tbody> <tfoot><tr><td colspan="2" id="userList"></td></tr></tfoot> </table> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,businessType=$data.businessType,projectName=$data.projectName,projectStatus=$data.projectStatus,updateProjectStatus=$data.updateProjectStatus,addRootTask=$data.addRootTask,$out='';$out+='<div class="ibox m-task-issue"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-9" id="breadcrumb"></div> <div class="col-md-3 text-right" style="padding: 15px 15px 0;"> <span id="designManagerBox"> </span> <span class="icon-separation-line"></span> <a href="javascript:void(0);" data-action="viewProjectInfo"> ';
$out+=$escape(businessType==1?'项目基本信息':'课题基本信息');
$out+=' &nbsp;<i class="icon iconfont icon-jibenxinxi"></i> </a> </div> </div> </div> <div class="ibox-content"> <div class="panel panel-default"> <div class="panel-heading"> <div class="row"> <div class="col-md-4"> <a href="javascript:void(0)" data-action="toProjectDetails" class="f-s-lg l-h-28 fw-bold">';
$out+=$escape(projectName);
$out+='</a> </div> <div class="col-md-2 no-padding"> <span class="xeditable-hover"> <span class="l-h-28"> ';
$out+=$escape(businessType==1?'项目状态':'课题状态');
$out+=' ：</span> <span class="text-bold l-h-28 editable-status"> ';
if(projectStatus == 1){
$out+=' <span class="show-span text-danger">已暂停</span> ';
}else if(projectStatus == 2){
$out+=' <span class="show-span text-success">已完成</span> ';
}else if(projectStatus == 3){
$out+=' <span class="show-span text-danger">已终止</span> ';
}else{
$out+=' <span class="show-span text-navy">进行中</span> ';
}
$out+=' ';
if(updateProjectStatus == 1){
$out+=' <a href="javascript:void(0);" data-action="xeditable-status" data-key="status" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </span> </span> </div> <div class="col-md-3 no-padding"> </div> <div class="col-md-3 text-right"> ';
if(addRootTask==1){
$out+=' <a href="javascript:void(0);" class="btn btn-primary" data-action="addTaskIssue">';
$out+=$escape(businessType==1?'添加项目/子项':'添加课题/子项');
$out+=' </a> <a href="javascript:void(0);" class="btn btn-primary" data-action="distributionRatio">分配工作内容占比</a> ';
}
$out+=' </div> </div> </div> <div class="panel-body"> <div id="dataList" class="list-box"> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,businessType=$data.businessType,appointmentStartTime=$data.appointmentStartTime,appointmentEndTime=$data.appointmentEndTime,$out='';$out+='<form class="form-horizontal m-task-issue-add m"> <div class="form-group "> <label class="col-sm-2 control-label">';
$out+=$escape(businessType==1?'项目/子项':'课题');
$out+=' <span class="fc-red">*</span></label> <div class="col-sm-10"> <input placeholder="';
$out+=$escape(businessType==1?'请输入项目/子项名称':'请输入课题');
$out+=' " class="form-control" type="text" name="taskName" style="width: 80%;display: inline-block;"> <span><span class="wordCount">0</span>/<span>50</span></span> </div> </div> <div class="form-group "> <label class="col-sm-2 control-label">所属年度<span class="fc-red">*</span></label> <div class="col-sm-10 m-b-xs"> <div class="input-group"> <input type="text" class="form-control" name="year" placeholder="请选择所属年度" readonly="" onfocus="WdatePicker({dateFmt:\'yyyy\'})" value=""> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"> 年 </span> </div> </div> <div class="col-sm-offset-2 f-s-xs fc-dark-gray p-l">注释：所属年度用于最终统计相关时间内的产值情况</div> </div> <div class="form-group"> <label class="col-sm-2 control-label">开始时间</label> <div class="col-sm-10"> <div class="input-group"> <input type="text" class="form-control timeInput startTime" id="ipt_startTime" name="startTime" data-appointmentStartTime = "" placeholder="开始日期" readonly onFocus="startTimeLimitFun(this,m_inputProcessTime_onpicked)" value="';
$out+=$escape(appointmentStartTime);
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar" ></i> </span> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">结束时间</label> <div class="col-sm-10"> <div class="input-group"> <input type="text" class="form-control timeInput endTime" id="ipt_endTime" name="endTime" data-appointmentEndTime = "" placeholder="结束日期" readonly onFocus="endTimeLimitFun(this,m_inputProcessTime_onpicked)" value="';
$out+=$escape(appointmentEndTime);
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-calendar"></i> </span> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_add_mult',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,stageDesignList=$data.stageDesignList,$each=$utils.$each,p=$data.p,$index=$data.$index,$escape=$utils.$escape,$out='';$out+='<div class="m-task-issue-add-mult"> <div class="col-sm-6"> <div class="ibox"> <div class="ibox-title no-borders p-h-sm min-h-50">项目模板</div> <div class="ibox-content border-darker-grey box-left"> <div class="design-phase"> ';
if(stageDesignList!=null && stageDesignList.length>0){
$out+=' <h4>阶段设置</h4> <div class="row temp-item-box"> ';
$each(stageDesignList,function(p,$index){
$out+=' <div class="col-sm-4 p-r-none"> <label class="i-checks i-checks-label fw-normal"> <input name="designPhaseCk" type="radio" value="';
$out+=$escape(p.relationId);
$out+='" data-name="';
$out+=$escape(p.name);
$out+='" data-is-custom="0"/> <span class="i-checks-span">';
$out+=$escape(p.name);
$out+='</span> </label> </div> ';
});
$out+=' <div class="clearfix"></div> </div> ';
}
$out+=' <h4>自定义添加</h4> <div class="row"> <form class="addItemForm"> <div class="col-md-10"> <input class="form-control input-sm p-r-none" type="text" name="itemName"> </div> <div class="col-md-2"> <button type="button" class="btn btn-primary btn-sm" data-action="addItemBtn" data-type="1">添加</button> </div> <div class="col-md-12"></div> <div class="clearfix"></div> </form> </div> <div class="row m-t-sm cus-item-box"> </div> </div> <div class="design-profession"> </div> </div> </div> </div> <div class="col-sm-6"> <div class="ibox"> <div class="ibox-title no-borders p-h-sm min-h-50">已选择项 (拖拽进行调整顺序)</div> <div class="ibox-content border-darker-grey box-right"> <div class="row list-group" id="selectedItemBox"> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_add_mult_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,type=$data.type,$escape=$utils.$escape,id=$data.id,name=$data.name,isCustom=$data.isCustom,$out='';$out+='<div class="col-sm-4 p-r-none m-b-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(type==1){
$out+=' <input name="designPhaseCk" type="radio" value="';
$out+=$escape(id);
$out+='" data-name="';
$out+=$escape(name);
$out+='" data-is-custom="';
$out+=$escape(isCustom);
$out+='"/> ';
}else{
$out+=' <input name="itemCk" type="checkbox" value="';
$out+=$escape(id);
$out+='" data-name="';
$out+=$escape(name);
$out+='" data-is-custom="';
$out+=$escape(isCustom);
$out+='"/> ';
}
$out+=' <span class="i-checks-span"> <span class="item-span m-r-xs bg-muted p-xxs f-s-xs" > <span class="item-name" data-toggle="tooltip" data-original-title="';
$out+=$escape(name);
$out+='"> ';
$out+=$escape(name);
$out+=' </span> <a class="curp" href="javascript:void(0)" data-id="';
$out+=$escape(id);
$out+='" data-action="delCusItem"> <i class="fa fa-times fc-red"></i> </a> </span> </span> </label> </div>';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_add_mult_profession',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,$index=$data.$index,$escape=$utils.$escape,$out='';$out+='<h4>专业设置</h4> ';
if(dataList && dataList.length>0){
$out+=' <div class="m-b-sm"> <label class="i-checks i-checks-label fw-normal"> <input name="itemCk" type="checkbox" value=""/> <span class="i-checks-span">全选</span> </label> </div> <div class="row temp-item-box"> ';
$each(dataList,function(p,$index){
$out+=' <div class="col-sm-4 p-r-none"> <label class="i-checks i-checks-label fw-normal"> <input name="itemCk" type="checkbox" value="';
$out+=$escape(p.relationId);
$out+='" data-name="';
$out+=$escape(p.name);
$out+='" data-is-custom="0"/> <span class="i-checks-span">';
$out+=$escape(p.name);
$out+='</span> </label> </div> ';
});
$out+=' <div class="clearfix"></div> </div> ';
}
$out+=' <h4>自定义添加</h4> <div class="row"> <form class="addItemForm"> <div class="col-md-10"> <input class="form-control input-sm p-r-none" type="text" name="itemName"> </div> <div class="col-md-2"> <button type="button" class="btn btn-primary btn-sm" data-action="addItemBtn" data-type="2">添加</button> </div> <div class="col-md-12"></div> <div class="clearfix"></div> </form> </div> <div class="row m-t-sm cus-item-box"> </div>';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_add_mult_select',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,isCustom=$data.isCustom,name=$data.name,designId=$data.designId,designIsCustom=$data.designIsCustom,designName=$data.designName,key=$data.key,$out='';$out+='<div class="col-sm-6 p-r-none m-b list-group-item" data-sort-id="';
$out+=$escape(id);
$out+='" data-id="';
$out+=$escape(id);
$out+='" data-is-custom="';
$out+=$escape(isCustom);
$out+='" data-name="';
$out+=$escape(name);
$out+='" data-design-id="';
$out+=$escape(designId);
$out+='" data-design-is-custom="';
$out+=$escape(designIsCustom);
$out+='" data-design-name="';
$out+=$escape(designName);
$out+='" data-key="';
$out+=$escape(key);
$out+='"> <span class="item-span m-r-xs bg-muted p-xxs f-s-xs" > <span class="item-name" data-toggle="tooltip" data-original-title="';
$out+=$escape(designName);
$out+='-';
$out+=$escape(name);
$out+='"> ';
$out+=$escape(designName);
$out+='-';
$out+=$escape(name);
$out+=' </span> <a class="curp" href="javascript:void(0)" data-id="';
$out+=$escape(id);
$out+='" data-action="delSelectedItem"> <i class="fa fa-times fc-red"></i> </a> </span> </div> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_add_row',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,key=$data.key,colspan=$data.colspan,$out='';$out+='<tr class="task-add-row content-row-edit" data-key="';
$out+=$escape(key);
$out+='"> <td colspan="';
$out+=$escape(colspan?colspan:'11');
$out+='"> <form> <div class="pull-left row-edit-item p-r-xs"> <textarea placeholder="请输入工作内容" class="form-control" type="text" name="taskName" style="width: 88%;display: inline-block;"></textarea> <span><span class="wordCount">0</span>/<span>50</span></span> </div> <div class="pull-left row-edit-item p-r-xs"> <div class="input-group"> <input type="text" class="form-control" name="orgId" readonly placeholder="请选择团队"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"> <i class="icon-append fa fa-caret-down"></i> </span> </div> </div> <div class="pull-left row-edit-item p-r-xs" id="orderDeanId"> <select class="form-control" name="orderDeanId" data-placeholder="请选择分管院长"></select> </div> <div class="pull-left row-edit-item p-r-xs" id="designerId"> <select class="form-control" name="designerId" data-placeholder="请选择负责人"></select> </div> <div class="pull-left row-edit-item"> <button class="btn btn-primary" data-action="submit">创建</button> <button class="btn btn-default" data-action="cancel">取消</button> </div> </form> </td> </tr> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_add_tips',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<div class="m"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/project/project_approval_1.png'));
$out+='" width="60"/> </div> <div class="p-sm"> 工作内容填写完成后，需发布以便进行下一步的工作。 </div> <div class="row"> <div class="col-sm-6"> <label class="i-checks i-checks-label m-l"> <input name="itemCk" type="checkbox"/> <span class="i-checks-span fc-dark-gray">以后不再提示</span> </label> </div> <div class="col-sm-6 text-center"> <button class="btn btn-primary" data-action="knowIt">知道了</button> </div> </div> <div style="position: absolute;top: 0px;left:-80px;"> <span class="ic-tip-arrow-right"></span> </div> </div> <script> $(\'.i-checks\').iCheck({ checkboxClass: \'icheckbox_square-green\', radioClass: \'iradio_square-green\' }); </script> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_approval',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,audit=$data.audit,$escape=$utils.$escape,auditList=$data.auditList,_momentFormat=$helpers._momentFormat,task=$data.task,attachList=$data.attachList,$each=$utils.$each,a=$data.a,i=$data.i,s=$data.s,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,typeStr=$data.typeStr,ccCompanyUserList=$data.ccCompanyUserList,u=$data.u,ui=$data.ui,isView=$data.isView,auditFlag=$data.auditFlag,currentCompanyUserId=$data.currentCompanyUserId,approveStatus=$data.approveStatus,$out='';$out+='<form class="form-horizontal p-sm overflow-y-auto m-dialog-resize"> ';
if(audit && audit.expNo){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">审批编号：</label> <div class="col-24-xs-21"> ';
$out+=$escape(audit.expNo);
$out+=' </div> </div> ';
}
$out+=' ';
if(auditList && auditList.length>0){
$out+=' <div class="form-group"> <label class="col-24-xs-3 text-right">发起人：</label> <div class="col-24-xs-21"> ';
$out+=$escape(auditList[0].userName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">发起时间：</label> <div class="col-24-xs-21"> ';
$out+=$escape(_momentFormat(auditList[0].approveDate,'YYYY/MM/DD'));
$out+=' </div> </div> ';
}
$out+=' <h4 class="title-line m-l-sm">审批详情</h4> <div class="hr-line-dashed m-t-none m-b-sm"></div> <div class="form-group"> <label class="col-24-xs-3 text-right">验收组织：</label> <div class="col-24-xs-21"> ';
$out+=$escape(task.fromCompanyName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">设计组织：</label> <div class="col-24-xs-21"> ';
$out+=$escape(task.toCompanyName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">当前项目：</label> <div class="col-24-xs-21"> ';
$out+=$escape(task.projectName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">设计任务：</label> <div class="col-24-xs-21"> ';
$out+=$escape(task.taskName);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">描述：</label> <div class="col-24-xs-21"> ';
$out+=$escape(task.remark);
$out+=' </div> </div> <div class="form-group"> <label class="col-24-xs-3 text-right">成果文件：</label> <div class="col-24-xs-21"> ';
if(attachList!=null && attachList.length>0){
$out+=' ';
$each(attachList,function(a,i){
$out+=' <span class="label m-r-xs" style="background: #ecf0f1;padding: 5px 10px;"> <a href="javascript:void(0)" data-action="preview" data-file-ext="';
$out+=$escape(a.fileExtName);
$out+='" data-net-file-id="';
$out+=$escape(a.id);
$out+='" data-src="';
$out+=$escape(a.fileFullPath);
$out+='" data-name="';
$out+=$escape(a.fileName);
$out+='"> ';
$out+=$escape(a.fileName);
$out+=' </a> </span> ';
});
$out+=' ';
}
$out+=' </div> </div> <h4 class="title-line m-l-sm">审批流程</h4> <div class="hr-line-dashed m-t-none m-b-sm" ></div> <div class="form-group"> <div class="col-sm-12 p-w-md"> <table class="table table-hover table-bordered m-b-xs" > <thead> <tr> <th width="40%">审批</th> <th width="40%">操作</th> <th width="20%">审批时间</th> </tr> </thead> <tbody> ';
if(auditList!=null && auditList.length>0){
$out+=' ';
$each(auditList,function(s,i){
$out+=' <tr> <td> ';
if(_isNullOrBlank(s.fileFullPath)){
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30"/> ';
}else{
$out+=' <img alt="image" class="img-circle img-responsive dp-inline-block vertical-top" src="';
$out+=$escape(s.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" > ';
}
$out+=' <span class="dp-inline-block"> <p class="m-b-none">';
$out+=$escape(s.userName);
$out+='</p> <p class="m-b-none fc-v1-grey">';
$out+=$escape(s.companyName);
$out+='</p> </span> </td> <td> ';
if(s.approveStatus=='1'){
$out+=' <p class="text-success m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}else if(s.approveStatus=='2' || s.approveStatus=='3'){
$out+=' <p class="text-danger m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}else{
$out+=' <p class="m-b-none">';
$out+=$escape(s.approveStatusName);
$out+='</p> ';
}
$out+=' ';
if(s.approveStatusName=='发起申请' && !_isNullOrBlank(s.remark)){
$out+=' <p class="fc-v1-grey m-b-none">';
$out+=$escape(typeStr);
$out+='备注：';
$out+=$escape(s.remark);
$out+='</p> ';
}
$out+=' ';
if(s.approveStatusName=='退回'  && !_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">退回原因：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}else if(!_isNullOrBlank(s.auditMessage)){
$out+=' <p class="fc-v1-grey m-b-none">审批意见：';
$out+=$escape(s.auditMessage);
$out+='</p> ';
}
$out+=' </td> <td> ';
$out+=$escape(_momentFormat(s.approveDate,'YYYY/MM/DD'));
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr> <td colspan="3" class="text-center">暂无数据</td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
if(ccCompanyUserList!=null && ccCompanyUserList.length>0){
$out+=' <h4 class="title-line m-l-sm">抄送人</h4> <div class="hr-line-dashed m-t-none m-b-sm"></div> <div class="form-group"> <div class="col-sm-12 p-w-md approval-out-box"> ';
$each(ccCompanyUserList,function(u,ui){
$out+=' <div class="approver-outbox"> <div class="approver-box "> <div class="img-circle"> <img alt="image" class="img-circle" src="';
$out+=$escape(_isNullOrBlank(u.fileFullPath)?_url('/img/head_default.png'):u.fileFullPath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/head_default.png'));
$out+='" width="30" height="30"> </div> <div class="m-t-xs">';
$out+=$escape(u.userName);
$out+='</div> </div> </div> ';
});
$out+=' </div> </div> ';
}
$out+=' </form> <div class="footer border-b-radius text-right"> ';
if(isView){
$out+=' <button class="btn btn-default" data-action="cancel">关闭</button> ';
}else{
$out+=' <button class="btn btn-default" data-action="cancel">';
$out+=$escape(auditFlag=='1'?'取消':'关闭');
$out+='</button> ';
if(auditFlag=='1'){
$out+=' <button class="btn btn-danger" data-action="returnBack">退回</button> <button class="btn btn-primary" data-action="agree">确认完成</button> ';
}
$out+=' ';
if(currentCompanyUserId==audit.companyUserId && (approveStatus=='0' || approveStatus=='5')){
$out+=' <button class="btn btn-warning" data-action="remind">提醒</button> ';
}
$out+=' ';
}
$out+=' </div> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,taskIssueList=$data.taskIssueList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,updateProjectStatus=$data.updateProjectStatus,_isNullOrBlank=$helpers._isNullOrBlank,_momentFormat=$helpers._momentFormat,delTitle=$data.delTitle,_url=$helpers._url,$out='';$out+='<form class="task-list-box"> ';
if(taskIssueList!=null && taskIssueList.length>0){
$out+=' ';
$each(taskIssueList,function(p,i){
$out+=' <div class="panel panel-default" data-id="';
$out+=$escape(p.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='" data-company-id="';
$out+=$escape(p.companyId);
$out+='" data-designtaskid="';
$out+=$escape(p.designTaskId);
$out+='"> <div class="panel-heading"> <div class="row"> <div class="col-24-sm-7 p-l-4 p-r-none"> <a href="javascript:void(0);" data-action="expander"><span class="ic-open vertical-middle m-l-7 m-r-sm"></span></a> <span class="p-task-name"> <span class="show-span pt-relative font-bold text-ellipsis" data-container="body" data-toggle="tooltip" data-original-title="';
$out+=$escape(p.taskName);
$out+='"> ';
$out+=$escape(p.taskName);
$out+=' </span> ';
if(p.role && p.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditableTaskName" data-value="';
$out+=$escape(p.taskName);
$out+='" data-key="taskName" data-placeholder="请输入任务名称" data-type="2" data-valid="1" data-max-length="50" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </span> </div> <div class="col-24-sm-4 no-padding"> <span class="xeditable-hover"> <span class="l-h-28">子项状态：</span> <span class="text-bold l-h-28">  ';
if(p.endStatus == 3){
$out+=' <span class="show-span text-danger">已暂停</span> ';
}else if(p.endStatus == 2){
$out+=' <span class="show-span text-success">已完成</span> ';
}else if(p.endStatus == 4){
$out+=' <span class="show-span text-danger">已终止</span> ';
}else{
$out+=' <span class="show-span text-navy">进行中</span> ';
}
$out+=' ';
if(updateProjectStatus==1){
$out+='  <a href="javascript:void(0);" data-action="xeditable-status" data-key="endStatus" data-value="';
$out+=$escape(p.endStatus);
$out+='" data-type="5" data-container-class="select-sm" data-id="';
$out+=$escape(p.id);
$out+='" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </span> </span> </div> <div class="col-24-sm-10 text-right"> <span class="xeditable-hover"> <span class="l-h-28">所属年度：</span> <span class="show-span"> ';
if(_isNullOrBlank(p.year)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(p.year);
$out+=' ';
}
$out+=' </span> ';
if(p.role && p.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditableTime" id="pYearTime';
$out+=$escape(p.id);
$out+='" data-value="';
$out+=$escape(p.year);
$out+='" data-type="10" data-key="year" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </span> <span class="p-time-show"> 开始时间： ';
if(!_isNullOrBlank(p.startTime)){
$out+=' ';
$out+=$escape(_momentFormat(p.startTime,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' ';
if(p.role && p.role.edit==1){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' -- ';
}
$out+=' ';
}
$out+=' ';
if(p.role && p.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditableTime" id="pStartTime';
$out+=$escape(p.id);
$out+='" data-value="';
$out+=$escape(p.startTime);
$out+='" data-type="10" data-key="startTime" data-max-date="';
$out+=$escape(p.endTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </span> &nbsp;&nbsp; <span class="p-time-show"> 结束时间： ';
if(!_isNullOrBlank(p.endTime)){
$out+=' ';
$out+=$escape(_momentFormat(p.endTime,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' ';
if(p.role && p.role.edit==1){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' -- ';
}
$out+=' ';
}
$out+=' ';
if(p.role && p.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditableTime" id="pEndTime';
$out+=$escape(p.id);
$out+='" data-value="';
$out+=$escape(p.endTime);
$out+='" data-type="10" data-key="endTime" data-min-date="';
$out+=$escape(p.startTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </span> </div> <div class="col-24-sm-3 text-right"> ';
if(p.role && p.role.delete==1){
$out+=' <a href="javascript:void(0)" class="btn btn-default btn-sm m-r-none m-t-n-xs fc-red" data-toggle="tooltip" data-placement="top" data-action="delChildItem" title="';
$out+=$escape(delTitle);
$out+='"><span> 删除 </span> </a> ';
}
$out+=' </div> </div> </div> <div class="panel-body no-padding"> </div> </div> ';
});
$out+=' ';
}else{
$out+=' <div class="row no-data-tr"> <div class="text-center col-md-12"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关工作内容</span> </div> </div> </div> ';
}
$out+=' </form> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_content_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,p=$data.p,$each=$utils.$each,t=$data.t,ti=$data.ti,$string=$utils.$string,_include=$helpers._include,tIndex=$data.tIndex,tLength=$data.tLength,projectId=$data.projectId,projectNameCode=$data.projectNameCode,doType=$data.doType,dataCompanyId=$data.dataCompanyId,currentCompanyId=$data.currentCompanyId,currentCompanyUserId=$data.currentCompanyUserId,managerInfo=$data.managerInfo,businessType=$data.businessType,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<table class="table table-bordered no-borders m-b-none table-layout-fix" > <thead> <tr> <th width="3%" class="b-r-none"> <div class="list-check-box vertical-text-bottom"> <label class="i-checks fw-normal m-b-none"> <input name="taskAllCk" type="checkbox" /> <span class="i-checks-span"></span> </label> </div> </th> <th width="3%" class="b-l-none"> <div class="list-action-box"> <div class="btn-group batchOperation" id="batchAllOperation"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="批量操作"> <span class="ic-operation-batch"></span> </button> <ul class="dropdown-menu"> <li> <a href="javascript:void(0);" data-action="batchPublishTask" class="">批量发布</a> </li> <li> <a href="javascript:void(0);" class="" data-action="batchDelTask" data-canbedelete="">批量删除</a> </li> </ul> </div> </div> </th> <th width="20%" class="b-l-none"> <span>工作内容</span> ';
if(p.role && p.role.add==1){
$out+=' <button class="btn btn-link" data-action="addSubTask" title="添加工作内容"><i class="fa fa-plus"></i></button> ';
}
$out+=' </th> <th width="8%">工作占比</th> <th width="9%" >任务状态</th> <th width="12%" >团队</th> <th width="9%">分管院长</th> <th width="9%">任务负责人</th> <th width="9%" >开始时间</th> <th width="9%" >结束时间</th> <th width="9%" >完成时间</th> </tr> </thead> <tbody> ';
if(p.childList!=null && p.childList.length>0){
$out+=' ';
$each(p.childList,function(t,ti){
$out+=' ';
$out+=$string(_include('m_task_issue/m_task_issue_content_row',{t:t,tIndex:ti,tLength:p.childList.length,p:p,projectId:projectId,projectNameCode:projectNameCode,doType:doType,dataCompanyId:dataCompanyId,currentCompanyId:currentCompanyId,currentCompanyUserId:currentCompanyUserId,managerInfo:managerInfo,businessType:businessType}));
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="11" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关工作内容</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_content_row',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,t=$data.t,tIndex=$data.tIndex,tLength=$data.tLength,_isNullOrBlank=$helpers._isNullOrBlank,projectId=$data.projectId,projectNameCode=$data.projectNameCode,dataCompanyId=$data.dataCompanyId,businessType=$data.businessType,currentCompanyId=$data.currentCompanyId,p=$data.p,_momentFormat=$helpers._momentFormat,$out='';$out+='<tr class="content-row ';
$out+=$escape(t.taskState=='3'||t.taskState=='4'?'complete-date-tr':'');
$out+='" data-id="';
$out+=$escape(t.id);
$out+='" data-i="';
$out+=$escape(tIndex);
$out+='" data-task-name="';
$out+=$escape(t.taskName);
$out+='"> <td class=" b-r-none "> <div class="list-check-box"> <label class="i-checks fw-normal m-b-none"> <input name="taskCk" type="checkbox" data-is-can2="';
$out+=$escape(t.role.delete);
$out+='" data-is-can1="';
$out+=$escape(t.role.publishTask);
$out+='" /> <span class="i-checks-span"></span> </label> </div> </td> <td class="b-r-none b-l-none" > <div class="list-action-box" data-id="';
$out+=$escape(t.id);
$out+='"> ';
if(t.role && (t.role.publishTask==1 || t.role.delete==1 || (t.role.edit==1 && tIndex > 0) || (t.role.edit==1 && tIndex < (tLength-1)) )){
$out+=' <div class="btn-group singleOperation" style="display: none;"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <span class="ic-operation"></span> </button> <ul class="dropdown-menu"> ';
if(t.role && t.role.publishTask==1){
$out+=' <li> <a href="javascript:void(0);" data-action="publishTask">发布任务</a> </li> ';
}
$out+=' ';
if(t.role && t.role.delete==1){
$out+=' <li> <a href="javascript:void(0);" data-action="delTask" data-canbedelete="';
$out+=$escape(t.canBeDelete?'1':'0');
$out+='">删除</a> </li> ';
}
$out+='  ';
if(t.role && t.role.edit==1 && tIndex > 0){
$out+=' <li> <a href="javascript:void(0);" data-action="moveUp">向上移动</a> </li> ';
}
$out+='  ';
if(t.role && t.role.edit==1 && tIndex < (tLength-1) ){
$out+=' <li> <a href="javascript:void(0);" data-action="moveDown">向下移动</a> </li> ';
}
$out+=' </ul> </div> ';
}
$out+=' <div class="btn-group batchOperation" style="display: none;"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <span class="ic-operation-batch"></span> </button> <ul class="dropdown-menu"> ';
if(t.role && t.role.publishTask==1){
$out+=' <li> <a href="javascript:void(0);" data-action="batchPublishTask" >批量发布任务</a> </li> ';
}
$out+=' ';
if(t.role && t.role.delete==1){
$out+=' <li> <a href="javascript:void(0);" data-action="batchDelTask" data-canbedelete="';
$out+=$escape(t.canBeDelete?'1':'0');
$out+='">批量删除</a> </li> ';
}
$out+=' </ul> </div> </div> </td> <td> <span class="show-span text-ellipsis"> ';
if(_isNullOrBlank(t.taskName)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' <a href="#/project/taskIssue/details?type=1&id=';
$out+=$escape(projectId);
$out+='&projectName=';
$out+=$escape(projectNameCode);
$out+='&taskId=';
$out+=$escape(t.id);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='&businessType=';
$out+=$escape(businessType);
$out+='" title="';
$out+=$escape(t.taskName);
$out+='"> ';
$out+=$escape(t.taskName);
$out+=' </a> ';
}
$out+=' </span> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.taskName);
$out+='" data-key="taskName" data-placeholder="请输入工作内容" data-type="2" data-valid="1" data-max-length="50" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(_isNullOrBlank(t.ratio)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(t.ratio);
$out+='% ';
}
$out+=' </span> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.ratio);
$out+='" data-key="ratio" data-placeholder="请输入占比" data-unit="%" data-type="1" data-valid="7" data-valid-title="工作占比" data-limit-min="0" data-limit-max="';
$out+=$escape(t.lessRatio);
$out+='" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td>  ';
if(t.endStatus ==3 || t.endStatus ==4){
$out+=' <span class="text-danger show-span">';
$out+=$escape(t.stateHtml);
$out+='</span> ';
}else if(t.endStatus ==2){
$out+=' <span class="text-success show-span">';
$out+=$escape(t.stateHtml);
$out+='</span> ';
}else{
$out+=' <span class="show-span">';
$out+=$escape(t.stateHtml);
$out+='</span> ';
}
$out+=' ';
if(t.role && t.role.changeStatus==1 && t.fromCompanyId == currentCompanyId){
$out+=' <a href="javascript:void(0);" data-action="xeditable-child-status" data-key="endStatus" data-value="';
$out+=$escape(t.endStatus);
$out+='" data-type="5" data-container-class="select-sm" data-id="';
$out+=$escape(p.id);
$out+='" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span text-ellipsis"> ';
if(_isNullOrBlank(t.departName)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(t.departName);
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.changeOrg==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.departName);
$out+='" data-id="';
$out+=$escape(t.departId);
$out+='" data-key="orgId" data-type="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(t.orderDean==null){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(t.orderDean.userName);
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.changeOrg==1 && t.companyId==currentCompanyId){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-type="12" data-url-type="4" data-key="orderDeanId" data-do-type="2" data-multiple="0" data-cookies="0" data-value="';
$out+=$escape(t.orderDean?t.orderDean.companyUserId:'');
$out+='" data-name="';
$out+=$escape(t.orderDean?t.orderDean.userName:'');
$out+='" data-task-id="';
$out+=$escape(t.id);
$out+='" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span person-in-charge"> ';
if(t.designer==null){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(t.designer.userName);
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.changeOrg==1 && t.companyId==currentCompanyId){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-type="12" data-url-type="5" data-key="personInCharge" data-do-type="2" data-multiple="0" data-cookies="0" data-value="';
$out+=$escape(t.designer?t.designer.companyUserId:'');
$out+='" data-name="';
$out+=$escape(t.designer?t.designer.userName:'');
$out+='" data-task-id="';
$out+=$escape(t.id);
$out+='" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(t.role && t.role.changeTime==1){
$out+=' ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.changeTime==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.startTime);
$out+='" data-type="10" data-key="startTime" data-max-date="';
$out+=$escape(t.endTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(t.role && t.role.changeTime==1){
$out+=' ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.changeTime==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.endTime);
$out+='" data-type="10" data-key="endTime" data-min-date="';
$out+=$escape(t.startTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span>';
$out+=$escape(_momentFormat(t.completeDate,'YYYY/MM/DD'));
$out+='</span> ';
if(t.role && t.role.changeStatus==1 &&t.endStatus ==2){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.completeDate);
$out+='" data-type="10" data-key="completeDate" data-complete-date="';
$out+=$escape(t.completeDate);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> </tr> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,_isNullOrBlank=$helpers._isNullOrBlank,$string=$utils.$string,_momentFormat=$helpers._momentFormat,$out='';$out+='<div class="ibox no-margins m-production-details"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-12" id="breadcrumb"></div> </div> </div> <div class="ibox-content no-padding"> <div class="row no-margins p-t-xs"> <div class="col-sm-8 p-t-xs"> <span class="font-bold"> ';
$out+=$escape(dataInfo.task.taskFullName);
$out+=' ';
if(!_isNullOrBlank(dataInfo.task.groupNo) && dataInfo.task.taskType!=3){
$out+=' (';
$out+=$escape(dataInfo.task.groupNo);
$out+=') ';
}
$out+=' </span> <span class="m-l-lg"> ';
if(dataInfo.task.taskType==1){
$out+=' 子项状态： <a href="javascript:void(0);" class="font-bold ';
$out+=$escape(dataInfo.task.role && dataInfo.task.role.changeStatus==1?'':'a-span');
$out+='" data-action="';
$out+=$escape(dataInfo.task.role && dataInfo.task.role.changeStatus==1?'xeditable-status':'');
$out+='" data-key="endStatus" data-value="';
$out+=$escape(dataInfo.task.endStatus);
$out+='" data-type="5" data-id="';
$out+=$escape(dataInfo.task.id);
$out+='">  ';
if(dataInfo.task.endStatus ==3 || dataInfo.task.endStatus ==4){
$out+=' <span class="text-danger">';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}else if(dataInfo.task.endStatus ==2){
$out+=' <span class="text-success">';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}else{
$out+=' <span>';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}
$out+=' </a> ';
}else{
$out+=' 任务状态： <a href="javascript:void(0);" class="font-bold ';
$out+=$escape(dataInfo.task.role && dataInfo.task.role.changeStatus==1?'':'a-span');
$out+='" data-action="';
$out+=$escape(dataInfo.task.role && dataInfo.task.role.changeStatus==1?'taskStateFlow':'');
$out+='" data-end-status="';
$out+=$escape(dataInfo.task.endStatus);
$out+='">  ';
if(dataInfo.task.endStatus ==3 || dataInfo.task.endStatus ==4){
$out+=' <span class="text-danger">';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}else if(dataInfo.task.endStatus ==2){
$out+=' <span class="text-success">';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}else{
$out+=' <span>';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}
$out+=' </a> ';
}
$out+=' </span> </div> <div class="col-sm-4 text-right"> ';
if(dataInfo.task.role && dataInfo.task.role.publishTask==1){
$out+=' <button class="btn btn-primary btn-sm" data-action="publishingTasks">发布</button> ';
}
$out+=' ';
if(dataInfo.task.role && dataInfo.task.role.delete==1){
$out+=' <button class="btn btn-danger btn-sm" data-action="delTaskIssue">删除</button> ';
}
$out+=' <a href="javascript:;" data-action="returnBack" class="btn btn-default btn-sm">返回</a> </div> </div> <div class="border-bottom m-t-xs"></div> <div class=""> <div class="col-md-9 p-t-sm p-l p-r-none border-right" id="leftBox"> <div class="tabs-container m-t"> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-4" aria-expanded="false">详细信息</a></li> <li class=""><a data-toggle="tab" href="#tab-3" aria-expanded="false">变更历史</a></li> </ul> <div class="tab-content"> <div id="tab-4" class="tab-pane active"> <div class="panel-body"> <form class="form-horizontal details-edit"> <div class="form-group "> <label class="col-sm-12"> 描 述： <a href="javascript:void(0);" data-action="xeditable" data-type="11" data-key="taskRemark" data-target-ele="#task-remark-edit" data-is-picture="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </label> <div class="col-sm-12"> <div class="show-span">';
$out+=$string(dataInfo.task.taskRemark);
$out+='</div> <div id="task-remark-edit"></div> </div> </div> </form> </div> </div> <div id="tab-3" class="tab-pane" data-type="changeHistory"> <div class="panel-body"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> </div> </div> </div> <div class="col-md-3 p-t-sm" id="rightBox"> <h4 class="title-line m-b-sm">基本信息</h4> <div class="row m-b-sm"> <label class="col-sm-5">任务状态：</label> <div class="col-sm-7"> ';
if(dataInfo.task.endStatus ==3 || dataInfo.task.endStatus ==4){
$out+=' <span class="text-danger">';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}else if(dataInfo.task.endStatus ==2){
$out+=' <span class="text-success">';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}else{
$out+=' <span>';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">所属子项：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.rootTask.taskName);
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">所属年度：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.rootTask.year);
$out+='年 </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">占比：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.task.ratio?dataInfo.task.ratio+'%':'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">团队：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.task.departName?dataInfo.task.departName:'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">分管院长：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.task.orderDean?dataInfo.task.orderDean.userName:'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">任务负责人：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.task.designer?dataInfo.task.designer.userName:'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">发布时间：</label> <div class="col-sm-7"> ';
if(_isNullOrBlank(dataInfo.task.issueTime)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.issueTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">开始时间：</label> <div class="col-sm-7"> ';
if(_isNullOrBlank(dataInfo.task.startTime)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">结束时间：</label> <div class="col-sm-7"> ';
if(_isNullOrBlank(dataInfo.task.endTime)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">完成时间：</label> <div class="col-sm-7"> ';
if(_isNullOrBlank(dataInfo.task.completeDate)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.completeDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> </div> <div class="clearfix"></div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_details_history',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,h=$data.h,hi=$data.hi,$escape=$utils.$escape,pageIndex=$data.pageIndex,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<table class="table table-striped m-task-issue-details-history"> <thead> <tr> <th width="6%">序号</th> <th width="16%">变更时间</th> <th width="12%">变更人</th> <th width="12%">变更字段</th> <th width="27%">变更前</th> <th width="27%">变更后</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(h,hi){
$out+=' <tr data-id="';
$out+=$escape(h.id);
$out+='"> <td>';
$out+=$escape(hi+1+pageIndex*10);
$out+='</td> <td>';
$out+=$escape(_momentFormat(h.createDate,'YYYY/MM/DD HH:mm:ss'));
$out+='</td> <td>';
$out+=$escape(h.userName);
$out+='</td> <td>';
$out+=$escape(h.fieldNameDesc);
$out+='</td> <td> ';
if(h.fieldNameDesc=='任务描述' || h.fieldNameDesc=='项目详情'){
$out+=' <a href="javascript:void(0);" class="btn btn-link no-padding" data-action="viewTaskRemark" data-key="oldValue">点击查看变更前';
$out+=$escape(h.fieldNameDesc);
$out+='</a> ';
}else if(h.fieldNameDesc=='结束时间' || h.fieldNameDesc=='开始时间' ){
$out+=' ';
$out+=$escape(_momentFormat(h.oldValue,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' ';
$out+=$escape(h.oldValue);
$out+=' ';
}
$out+=' </td> <td> ';
if(h.fieldNameDesc=='任务描述' || h.fieldNameDesc=='项目详情'){
$out+=' <a href="javascript:void(0);" class="btn btn-link no-padding" data-action="viewTaskRemark" data-key="newValue">点击查看变更后';
$out+=$escape(h.fieldNameDesc);
$out+='</a> ';
}else if(h.fieldNameDesc=='结束时间' || h.fieldNameDesc=='开始时间' ){
$out+=' ';
$out+=$escape(_momentFormat(h.newValue,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' ';
$out+=$escape(h.newValue);
$out+=' ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="6" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_details_nav',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fromType=$data.fromType,$escape=$utils.$escape,projectId=$data.projectId,projectNameCode=$data.projectNameCode,dataCompanyId=$data.dataCompanyId,dataList=$data.dataList,$each=$utils.$each,t=$data.t,ti=$data.ti,createCompanyId=$data.createCompanyId,currentCompanyId=$data.currentCompanyId,_url=$helpers._url,$out='';$out+='<div class="m-task-issue-details-nav"> <table class="tree table table-bordered m-b-none text-nowrap"> <thead> <tr> <th width="80%" class="th-btn border-no-b border-no-r">  ';
if(fromType==3){
$out+=' <a href="#/myTask" class="btn btn-default btn-sm">返回</a> ';
}else{
$out+=' <a href="#/project/production?id=';
$out+=$escape(projectId);
$out+='&projectName=';
$out+=$escape(projectNameCode);
$out+='&dataCompanyId=';
$out+=$escape(dataCompanyId);
$out+='" class="btn btn-default btn-sm">返回</a> ';
}
$out+=' </th> <th width="20%" class="vertical-middle border-no-b border-no-l p-l-none">任务状态</th> </tr> </thead> </table> <div class="full-width of-auto max-h-500"> <table class="tree table table-striped m-b-none text-nowrap"> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(t,ti){
$out+=' <tr class="tree-box-tr treegrid-';
$out+=$escape(t.id);
$out+=' ';
if(t.pid!=null && t.pid!=''){
$out+=' treegrid-parent-';
$out+=$escape(t.pid);
$out+=' ';
}
$out+='" data-id="';
$out+=$escape(t.id);
$out+='" data-pid="';
$out+=$escape(t.pid);
$out+='" data-isoperatertask="';
$out+=$escape(t.isOperaterTask);
$out+='" data-isonoff="';
$out+=$escape(t.isOnOff);
$out+='"> <td width="80%" class="tree-td pt-relative p-r-none p-l-none ';
$out+=$escape(ti==0?'border-no-t':'');
$out+='" > ';
if(createCompanyId!=currentCompanyId && ti==0){
$out+=' <span class="task-name" data-string="';
$out+=$escape(t.text);
$out+='">';
$out+=$escape(t.text);
$out+='</span> ';
}else{
$out+=' <a class="task-name" data-string="';
$out+=$escape(t.text);
$out+='">';
$out+=$escape(t.text);
$out+='</a> ';
}
$out+=' </td> <td width="20%" class="';
$out+=$escape(ti==0?'border-no-t':'');
$out+='"> ';
$out+=$escape(t.stateName);
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="9" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_distribution_ratio','<div class="m-task-issue-add m"> <div class="row select-item"> <label class="col-sm-2 control-label p-t-7">项目/子项<span class="fc-red">*</span></label> <div class="col-sm-10"> <select class="form-control" name="contentTaskList"></select> </div> </div> <div class="m-t-sm" id="ratioList"> </div> </div> ');/*v:1*/
template('m_task_issue/m_task_issue_distribution_ratio_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,d=$data.d,i=$data.i,$escape=$utils.$escape,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-hover table-responsive"> <thead> <tr> <th>工作内容</th> <th>占比</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(d,i){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='" data-i="';
$out+=$escape(i);
$out+='"> <td>';
$out+=$escape(d.taskName);
$out+='</td> <td> <form class="ratio-form"> <div class="input-group"> <input type="text" class="form-control input-sm" name="ratio" placeholder="请输入占比" value="';
$out+=$escape(d.ratio);
$out+='"> <span class="input-group-addon"> % </span> </div> </form> </td> </tr> ';
});
$out+=' <tr> <td>合计</td> <td ><span id="ratioTotal">0</span>%</td> </tr> ';
}else{
$out+=' <tr class="no-data"> <td colspan="2" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,title=$data.title,dataInfo=$data.dataInfo,$out='';$out+='<div class="row"> <div class="col-md-9"> <form class="form-horizontal m-task-issue-edit m"> <div class="form-group "> <div class="col-sm-12 row-edit-item"> <input placeholder="请输入';
$out+=$escape(title);
$out+='名称" class="form-control" type="text" name="taskName" value="';
$out+=$escape(dataInfo?dataInfo.taskName:'');
$out+='"> </div> </div> <div class="form-group"> <div class="col-sm-12" id="remarkEditor"> </div> </div> <div class="form-group bg-v2-grey p-h-m no-margins"> <div class="col-sm-6"> <label class="pull-left control-label">开始时间</label> <div class="col-sm-6 row-edit-item"> <div class="input-group pull-left"> <input type="text" class="form-control timeInput startTime" id="ipt_startTime" name="startTime" placeholder="开始日期" readonly onFocus="startTimeFun(this)" data-appointmentStartTime = "" value="';
$out+=$escape(dataInfo?dataInfo.startTime:'');
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar" ></i></span> </div> </div> </div> <div class="col-sm-6"> <label class="pull-left control-label">结束时间</label> <div class="col-sm-6 row-edit-item"> <div class="input-group"> <input type="text" class="form-control timeInput endTime" id="ipt_endTime" name="endTime" placeholder="结束日期" readonly onFocus="endTimeFun(this)" data-appointmentEndTime="" value="';
$out+=$escape(dataInfo?dataInfo.endTime:'');
$out+='"> <span class="input-group-addon" onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> </div> <div class="clearfix"></div> </div> <div class="form-group m-t-sm"> <div class="col-sm-12"> <button class="btn btn-primary" data-action="submit">提交</button> <button class="btn btn-default" data-action="cancel">取消</button> </div> </div> </form> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_nav',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,renderType=$data.renderType,$escape=$utils.$escape,buttonStyle=$data.buttonStyle,spanStyle=$data.spanStyle,taskList=$data.taskList,$out='';$out+='<style> .m-task-issue-nav #orgTreeH{ display: block; padding: 10px; border-radius: 4px; height: 300px; overflow: auto; z-index: 9; background-color: #fff; } </style> ';
if(renderType==0){
$out+=' <div class="btn-group m-task-issue-nav"> <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-action="selectOrg" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-stopPropagation="true" style="';
$out+=$escape(buttonStyle==null?'':buttonStyle);
$out+='"> <span class="task-name" style="';
$out+=$escape(spanStyle==null?'':spanStyle);
$out+='">';
$out+=$escape(taskList.text);
$out+='</span> <span class="caret"></span> </button> <ul class="dropdown-menu" style="left: inherit;right: 0;"> <li> <div id="orgTreeH" > <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> </li> </ul> </div> ';
}else{
$out+=' <div id="orgTreeH" > <ul class="sidebar-nav list-group sidebar-nav-v1"> </ul> </div> ';
}
$out+=' ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_status_flow',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,isPanel=$data.isPanel,doType=$data.doType,dataInfo=$data.dataInfo,currentCompanyId=$data.currentCompanyId,$escape=$utils.$escape,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-sm-2 control-label">任务状态：</label> <div class="col-sm-10"> ';
if(((isPanel==1 && doType==1) || doType==2) && (dataInfo.endStatus!=2 && dataInfo.companyId == currentCompanyId)){
$out+=' <!-- <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(dataInfo && dataInfo.endStatus==5){
$out+=' <input type="radio" name="endStatus" value="5" checked/> ';
}else{
$out+=' <input type="radio" name="endStatus" value="5"/> ';
}
$out+=' <span class="i-checks-span">提交验收</span> </label> </div>--> <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(dataInfo && dataInfo.endStatus==2){
$out+=' <input type="radio" name="endStatus" value="2" checked/> ';
}else{
$out+=' <input type="radio" name="endStatus" value="2"/> ';
}
$out+=' <span class="i-checks-span">已完成</span> </label> </div> ';
}
$out+=' ';
if((doType==2 || doType==1 ) && (dataInfo.endStatus==2 || dataInfo.endStatus==3  || dataInfo.endStatus==4)){
$out+=' <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(dataInfo && dataInfo.endStatus==1){
$out+=' <input type="radio" name="endStatus" value="1" checked/> ';
}else{
$out+=' <input type="radio" name="endStatus" value="1"/> ';
}
$out+=' <span class="i-checks-span">进行中</span> </label> </div> ';
}
$out+=' <!-- ';
if(doType==2){
$out+=' <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(dataInfo && dataInfo.endStatus==2){
$out+=' <input type="radio" name="endStatus" value="2" checked/> ';
}else{
$out+=' <input type="radio" name="endStatus" value="2"/> ';
}
$out+=' <span class="i-checks-span">已完成</span> </label> </div> ';
}
$out+='--> ';
if((doType==1 || doType==2) && dataInfo.fromCompanyId == currentCompanyId){
$out+=' <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(dataInfo && dataInfo.endStatus==3){
$out+=' <input type="radio" name="endStatus" value="3" checked/> ';
}else{
$out+=' <input type="radio" name="endStatus" value="3"/> ';
}
$out+=' <span class="i-checks-span">已暂停</span> </label> </div> <div class="pull-left m-r-xs m-t-xs"> <label class="i-checks i-checks-label fw-normal"> ';
if(dataInfo && dataInfo.endStatus==4){
$out+=' <input type="radio" name="endStatus" value="4" checked/> ';
}else{
$out+=' <input type="radio" name="endStatus" value="4"/> ';
}
$out+=' <span class="i-checks-span">已终止</span> </label> </div> ';
}
$out+=' <div class="row"><div class="col-sm-10"></div></div> </div> </div> <div class="form-group ';
$out+=$escape(dataInfo && dataInfo.endStatus==5?'':'hide');
$out+=' " data-type="5"> <label class="col-sm-2 control-label">描述：</label> <div class="col-sm-10"> <textarea placeholder="请输入描述" class="form-control" type="text" name="remark" rows="5"></textarea> </div> </div> <div class="form-group ';
$out+=$escape(dataInfo && dataInfo.endStatus==5?'':'hide');
$out+='" data-type="5"> <label class="col-sm-2 control-label">成果文件：</label> <div class="col-sm-10"> <div class="row"> <div class="col-md-12 m-t-xs"> <span id="showFileLoading"> </span> </div> <div class="col-md-12 m-b-sm"> <span class="uploadmgrContainer"></span> </div> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_task_issue/m_task_issue_view_remark',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$string=$utils.$string,remark=$data.remark,$out='';$out+='<div class="m"> ';
$out+=$string(remark);
$out+=' </div>';
return new String($out);
});/*v:1*/
template('m_teamInfo/m_teamDissolution',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,teamInfo=$data.teamInfo,$out='';$out+='<form class="sky-form rounded-bottom teamDissolutionOBox p-lg" style="border-bottom: none;"> <input type="password" class="dp-none"> <div class="space-md-hor content-xs"> <div class="col-md-12 margin-bottom-20"> <h5 >请校验以下信息，如确认无误请输入当前账户密码解散组织。</h5> <h3 class="text-center margin-top-20">';
$out+=$escape(teamInfo.companyName);
$out+='</h3> </div> <div class="form-group col-md-6"> <label>管理员姓名： <b>';
$out+=$escape(teamInfo.userName);
$out+='</b></label> </div> <div class="form-group col-md-6"> <label>手机号码： <b>';
$out+=$escape(teamInfo.cellphone);
$out+='</b></label> </div> <div class="form-group col-md-12"> <label>当前用户密码：</label> <input type="password" class="form-control password" name="password"> </div> <div class="clearfix"></div> </div> </form>';
return new String($out);
});/*v:1*/
template('m_teamInfo/m_teamInfoShow',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,teamInfo=$data.teamInfo,$out='';$out+='<form class="form-horizontal m_teamInfoShow"> <div class="form-group m-b-l"> <label class="col-xs-3 col-xl-2 text-right">组织名称：</label> <div class="col-xs-9 col-xl-10 "> <span class="pt-relative"> <a href="javascript:void(0)" class="editable-click" data-action="companyName" data-placeholder="请输入组织名称" data-key="companyName" data-valid="3" data-type="1" data-max-length="100"> ';
$out+=$escape(teamInfo.companyName);
$out+=' </a> </span> </div> </div> <div class="form-group m-b-l"> <label class="col-xs-3 col-xl-2 text-right">公司地址：</label> <div class="col-xs-9 col-xl-10 " id="city_1"> <a href="javascript:void(0);" class="editable-click" data-action="address" data-placeholder="请输入组织名称" data-key="address" data-type="4" data-valid="8" data-max-length="50"> ';
if(teamInfo.province && teamInfo.province!=''){
$out+=' ';
$out+=$escape(teamInfo.province);
$out+='&nbsp; ';
}
$out+=' ';
if(teamInfo.city && teamInfo.city!=''){
$out+=' ';
$out+=$escape(teamInfo.city);
$out+='&nbsp; ';
}
$out+=' ';
if(teamInfo.county && teamInfo.county!=''){
$out+=' ';
$out+=$escape(teamInfo.county);
$out+='&nbsp; ';
}
$out+=' ';
$out+=$escape(teamInfo.companyAddress);
$out+=' </a> </div> </div> <div class="form-group m-b-l"> <label class="col-xs-3 col-xl-2 text-right">经营范围：</label> <div class="col-xs-9 col-xl-10 "> <a href="javascript:void(0)" data-action="serverTypeList" data-key="serverType" data-type="3"> ';
$out+=$escape(teamInfo.serverType);
$out+=' </a> </div> </div> <div class="form-group m-b-l"> <label class="col-xs-3 col-xl-2 text-right">联系电话：</label> <div class="col-xs-9 col-xl-10 "> <a href="javascript:void(0)" class="editable-click" data-action="companyPhone" data-placeholder="请输入联系电话" data-key="companyPhone" data-type="1" data-valid="8" data-max-length="50"> ';
$out+=$escape(teamInfo.companyPhone);
$out+=' </a> </div> </div> <div class="form-group m-b-l"> <label class="col-xs-3 col-xl-2 text-right">传真号码：</label> <div class="col-xs-9 col-xl-10 "> <a href="javascript:void(0)" class="editable-click" data-action="companyFax" data-placeholder="请输入传真号码" data-key="companyFax" data-type="1" data-valid="8" data-max-length="50"> ';
$out+=$escape(teamInfo.companyFax);
$out+=' </a> </div> </div> <div class="form-group m-b-l"> <label class="col-xs-3 col-xl-2 text-right">电子邮箱：</label> <div class="col-xs-9 col-xl-10 "> <a href="javascript:void(0)" class="editable-click" data-action="companyEmail" data-placeholder="请输入电子邮箱" data-key="companyEmail" data-type="1" data-valid="8" data-max-length="50"> ';
$out+=$escape(teamInfo.companyEmail);
$out+=' </a> </div> </div> <!--<div class="form-group m-b-l" > <label class="col-xs-3 col-xl-2 text-right">组织简介：</label> <div class="col-xs-9 col-xl-10"> <a href="javascript:void(0)" class="editable-click" data-action="companyComment" data-placeholder="请输入组织简介" data-key="companyComment" data-type="2"> ';
$out+=$escape(teamInfo.companyComment);
$out+=' </a> </div> </div>--> </form>';
return new String($out);
});/*v:1*/
template('m_teamInfo/m_teamPicUpload',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,filePath=$data.filePath,_url=$helpers._url,isEdit=$data.isEdit,$out='';$out+='<div class="row cube-portfolio pull-right"> <div class="col-md-12 cbp-l-grid-agency cbp-caption-active cbp-caption-zoom cbp-ready"> <div class="thumbnails thumbnail-style cbp-item-wrapper text-center" style="box-sizing:border-box;padding:9px;width: 240px;height: 240px; border: solid 1px #eee;"> <div class="cbp-caption text-center" style="min-height: 220px;"> <img src="';
$out+=$escape(filePath);
$out+='" onerror=javascript:this.src="';
$out+=$escape(_url('/img/default/org_default_headPic.png'));
$out+='" class="img-logo" alt="组织logo" style="width: 220px;height: 220px;"> ';
if(isEdit){
$out+=' <div class="cbp-caption-activeWrap"> <div class="cbp-l-caption-alignCenter"> <div class="cbp-l-caption-body"> <ul class="link-captions no-bottom-space"> <li> <a href="javascript:void(0)" id="btnUploadImg" title="点击设置LOGO"></a> </li> </ul> </div> </div> </div> ';
}
$out+=' </div> </div> </div> </div> ';
if(isEdit){
$out+=' <div class="clearfix"></div> <div class="row caption pull-right" style="width: 240px;margin-top: 10px;"> <h3>组织LOGO</h3> <p>LOGO用于组织展示，最佳展示像素为200*200，建议上传png、jpg、bmp、jpeg格式的图像文件.</p> </div> ';
}
return new String($out);
});/*v:1*/
template('m_task/m_child_task_production',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,isShow=$data.isShow,p=$data.p,$each=$utils.$each,t=$data.t,ti=$data.ti,$escape=$utils.$escape,_isNullOrBlank=$helpers._isNullOrBlank,_getStatusColor=$helpers._getStatusColor,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<table class="tree table table-bordered m-b-none m-task-production"> <thead> <tr> ';
if(!isShow){
$out+=' <th width="3%" class="b-r-none"> <div class="list-check-box"> <label class="i-checks fw-normal m-b-none"> <input name="taskAllCk" type="checkbox" /> <span class="i-checks-span"></span> </label> </div> </th> <th width="3%" class="b-r-none b-l-none"> <div class="list-action-box"> <div class="btn-group batchOperation" id="batchAllOperation"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="批量操作"> <span class="ic-operation-batch"></span> </button> <ul class="dropdown-menu"> <li> <a href="javascript:void(0);" class="" data-action="batchTaskStateFlow">批量变更状态</a> </li> </ul> </div> </div> </th> ';
}
$out+=' <th width="25%" class="b-l-none"> <span>子任务</span> ';
if(!isShow){
$out+=' <a href="javascript:void(0);" data-action="addChildTask" data-placeholder="分解任务" title="分解任务" > <i class="fa fa-plus color-dark-blue"></i> </a> ';
}
$out+=' </th> <th width="" class="w-100">任务状态</th> <th width="10%" >处理人</th> <th width="" >任务占比</th> <th width="" class="w-100">开始时间</th> <th width="" class="w-100">结束时间</th> <th width="" >完成时间</th> </tr> </thead> <tbody> ';
if(p.childList!=null && p.childList.length>0){
$out+=' ';
$each(p.childList,function(t,ti){
$out+=' ';
if(!isShow){
$out+=' <tr class="m-production-content-row ';
$out+=$escape(t.completeDate==null?'':'complete-date-tr');
$out+=' " data-id="';
$out+=$escape(t.id);
$out+='" data-pid="';
$out+=$escape(t.taskPid);
$out+='" data-i="';
$out+=$escape(ti);
$out+='" data-path="';
$out+=$escape(t.taskPath);
$out+='"> <td class=" b-r-none p-t-9"> <div class="list-check-box"> <label class="i-checks fw-normal m-b-none" title="';
$out+=$escape(t.taskType==3?'订单任务不参与批量变更状态':'');
$out+='">  ';
if(t.taskType==3){
$out+=' <input name="taskCk" type="checkbox" data-is-can1="';
$out+=$escape(t.role.delete);
$out+='" value="';
$out+=$escape(t.id);
$out+='" data-end-status="';
$out+=$escape(t.endStatus);
$out+='" disabled /> ';
}else{
$out+=' <input name="taskCk" type="checkbox" data-is-can1="';
$out+=$escape(t.role.delete);
$out+='" value="';
$out+=$escape(t.id);
$out+='" data-end-status="';
$out+=$escape(t.endStatus);
$out+='"/> ';
}
$out+=' <span class="i-checks-span"></span> </label> </div> </td> <td class="b-r-none b-l-none v-middle"> <div class="list-action-box"> <div class="btn-group singleOperation" style="display: none;"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"> <span class="ic-operation"></span> </button> <ul class="dropdown-menu pt-relative hide">  <li><a href="javascript:void(0);" data-action="moveUp">向上移动</a></li>  <li><a href="javascript:void(0);" data-action="moveDown">向下移动</a></li> <li><a href="javascript:void(0);" data-action="delTask" data-canbedelete="">删除</a></li> </ul> </div> </div> </td> ';
}
$out+=' <td class="tree-td pt-relative p-r-none b-l-none" > <a href="javascript:void(0);" class="show-span task-name pt-relative text-ellipsis " data-string="';
$out+=$escape(t.taskName);
$out+='"> ';
$out+=$escape(t.taskName);
$out+=' </a> ';
if(!isShow){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.taskName);
$out+='" data-key="taskName" data-placeholder="请输入子任务名称" title="编辑子任务名称" data-type="2" data-valid="1" data-max-length="50" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(!_isNullOrBlank(t.endStatusName)){
$out+=' <button class="btn ';
$out+=$escape(_getStatusColor(t.endStatus));
$out+=' btn-rounded btn-status no-hover">';
$out+=$escape(t.endStatusName);
$out+='</button> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span>  ';
if(!isShow){
$out+=' <a href="javascript:void(0);" data-action="xeditableByClick" data-key="endStatus" data-value="';
$out+=$escape(t.endStatus);
$out+='" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td > <span class="show-span"> ';
if(t.handler){
$out+=' ';
$out+=$escape(t.handler.userName);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> ';
if(!isShow){
$out+=' <a href="javascript:void(0);" data-action="xeditableUser" data-key="handlerUser" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(_isNullOrBlank(t.ratio)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(t.ratio);
$out+='% ';
}
$out+=' </span> ';
if(!isShow){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.ratio);
$out+='" data-type="15" data-key="ratio" data-limit-min="0" data-limit-max="';
$out+=$escape(100-(t.totalRatio-0-t.ratio));
$out+='" data-init-show="1" style="visibility: hidden;" data-valid="7" data-valid-title="占比"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </span> ';
if(!isShow){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.startTime);
$out+='" data-type="10" data-key="startTime" data-max-date="';
$out+=$escape(t.endTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td class=""> <span class="show-span"> ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </span> ';
if(!isShow){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.endTime);
$out+='" data-type="10" data-key="endTime" data-min-date="';
$out+=$escape(t.startTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td class=""> <span> ';
if(t.completeDate!=null &&  t.completeDate!=''){
$out+=' ';
$out+=$escape(_momentFormat(t.completeDate,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </span> ';
if((!isShow)&&t.endStatus=='status_complete'){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.completeDate);
$out+='" data-type="10" data-key="completeDate" data-min-date="';
$out+=$escape(t.startTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="9" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关子任务</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_task/m_task','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box"> <ol class="breadcrumb"> <li> <strong>我的任务</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <div class="m-task"> <div class="p-w-sm m-b-sm" id="taskHeader"> </div> <div data-type="productionTask"> <div class="data-list-box task-list-box" id="productionTaskBox"> <div class="data-list-container"></div> <div class="p-w-sm"> <div class="m-pagination pull-right"></div> </div> </div> </div> </div> </div> </div> ');/*v:1*/
template('m_task/m_task_approval_opinion',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,p1=$data.p1,i1=$data.i1,p2=$data.p2,i2=$data.i2,$escape=$utils.$escape,_allChildrenLen=$helpers._allChildrenLen,_isNullOrBlank=$helpers._isNullOrBlank,e=$data.e,ei=$data.ei,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<div class="m-task-approval-opinion task-list-box"> <table class="table table-bordered "> <thead> <tr> <th>任务名称</th> <th>图名</th> <th> <label class="i-checks fw-normal m-b-none dp-inline-block"> <input name="approvalOpinionCk" type="checkbox" value="" /> <span class="i-checks-span"></span> </label> <div class="list-action-box dp-inline-block"> <div class="btn-group batchOperation" id="batchAllOperation"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="批量操作"> <span class="ic-operation-batch"></span> </button> <ul class="dropdown-menu"> <li> <a href="javascript:void(0);" class="" data-action="batchStateFlow" data-canbedelete="">批量流转</a> </li> </ul> </div> </div> <span>缺陷</span> </th> <th>缺陷状态</th> <th>处理人</th> <th>严重程度</th> <th>创建时间</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' ';
if(p.childList && p.childList.length>0){
$out+=' ';
$each(p.childList,function(p1,i1){
$out+=' ';
if(p1.childList && p1.childList.length>0){
$out+=' ';
$each(p1.childList,function(p2,i2){
$out+=' <tr class="curp" data-id="';
$out+=$escape(p2.id);
$out+='" data-pid="';
$out+=$escape(p1.id);
$out+='" data-ppid="';
$out+=$escape(p.id);
$out+='" data-i="';
$out+=$escape(i2);
$out+='" data-pi="';
$out+=$escape(i1);
$out+='" data-ppi="';
$out+=$escape(i);
$out+='" data-file-id="';
$out+=$escape(p2.fileId);
$out+='"> ';
if(i1==0 && i2==0){
$out+=' <td rowspan="';
$out+=$escape(_allChildrenLen(p.childList,'childList'));
$out+='">';
$out+=$escape(p.taskName);
$out+='</td> ';
}
$out+=' ';
if(i2==0){
$out+=' <td rowspan="';
$out+=$escape(p1.childList&&p1.childList.length?p1.childList.length:1);
$out+='">';
$out+=$escape(p1.fileName);
$out+='</td> ';
}
$out+=' <td data-type="1"> <label class="i-checks fw-normal m-b-none dp-inline-block"> <input name="approvalOpinionCk" type="checkbox" value="';
$out+=$escape(p2.id);
$out+='" data-status="';
$out+=$escape(p2.status);
$out+='"/> <span class="i-checks-span"></span> </label> <span class="audit-name">';
$out+=$escape(p2.auditName);
$out+='</span> </td> <td> <span class="show-span"> ';
if(!_isNullOrBlank(p2.statusName)){
$out+=' <button class="btn btn-white btn-rounded btn-status no-hover selected"> ';
$out+=$escape(p2.statusName);
$out+=' </button> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" class="btn-edit" data-action="xeditableStatusByApprovalOpinion" data-key="status" data-value="';
$out+=$escape(p2.status);
$out+='" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> <span class="show-span"> ';
if(p2.executers && p2.executers.length>0){
$out+=' ';
$each(p2.executers,function(e,ei){
$out+=' ';
if(ei>0){
$out+=' ,';
$out+=$escape(e.userName);
$out+=' ';
}else{
$out+=' ';
$out+=$escape(e.userName);
$out+=' ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" class="btn-edit" data-action="xeditableUserByApprovalOpinion" data-key="handler" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> <span class="show-span ';
$out+=$escape(p2.severity==1||p2.severity==2?'fc-red':'');
$out+='"> <!--';
$out+=$escape(p2.severityName);
$out+='--> ';
if(p2.severity==0){
$out+=' 空 ';
}else if(p2.severity==1){
$out+=' 致命 ';
}else if(p2.severity==2){
$out+=' 严重 ';
}else if(p2.severity==3){
$out+=' 一般 ';
}else if(p2.severity==4){
$out+=' 提示 ';
}else if(p2.severity==5){
$out+=' 建议 ';
}
$out+=' </span> <a href="javascript:void(0);" class="btn-edit" data-action="xeditableByApprovalOpinion" data-key="severity" data-value="';
$out+=$escape(p2.severity);
$out+='" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> ';
$out+=$escape(_momentFormat(p2.createTime,'YYYY/MM/DD HH:mm:ss'));
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr> ';
if(i1==0){
$out+=' <td rowspan="';
$out+=$escape(p.childList&&p.childList.length?p.childList.length:1);
$out+='">';
$out+=$escape(p.taskName);
$out+='</td> ';
}
$out+=' <td data-type="2">';
$out+=$escape(p1.fileName);
$out+='</td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr> <td>';
$out+=$escape(p.taskName);
$out+='</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="8" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_task/m_task_by_project','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 我的任务 </li> <li class="active fa fa-angle-right"> <strong>项目任务</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <form role="form" class="form-horizontal"> <div class="row" id="filterBox"> <div class="col-md-12"> <div class=""> <label class="inline">我的项目：</label> <select class="from-control inline" name="projectList"></select> </div> </div> <div class="col-md-12" id="statusSelect"> </div> <div class="col-md-12"> <div class="border-bottom p-b-sm"> <button class="btn btn-primary" data-action="search">查询</button> <button class="btn btn-default" data-action="refreshBtn">重置条件</button> </div> </div> </div> <div class="row m-t-xs p-t-sm"> <div class="col-md-9 filter-result-col"> <span>筛选条件： 共 <span id="totalBySearch">0</span> 项 &nbsp;</span> </div> <div class="col-md-3 text-right"> </div> </div> </form> <div class="data-list-box m-t-sm"> <div class="data-list-container of-auto"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> ');/*v:1*/
template('m_task/m_task_by_project_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,$escape=$utils.$escape,_emptyDisplay=$helpers._emptyDisplay,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<table class="tree table table-bordered m-b-none"> <thead> <tr> <th width="5%">序号</th> <th>项目</th> <th>子项</th> <th>设计阶段</th> <th>设计专业</th>  <th>角色</th> <th>任务状态</th> <th>开始时间</th> <th>结束时间</th> <th>完成时间</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' <tr class="curp" data-member-type="';
$out+=$escape(p.memberType);
$out+='"> <td>';
$out+=$escape(i+1);
$out+='</td> <td>';
$out+=$escape(p.projectName);
$out+='</td> <td>';
$out+=$escape(p.childName);
$out+='</td> <td>';
$out+=$escape(p.designName);
$out+='</td> <td>';
$out+=$escape(p.taskName);
$out+='</td> <!--<td>';
$out+=$escape();
$out+='</td>--> <td>';
$out+=$escape(p.role);
$out+='</td> <td>';
$out+=$escape(p.statusName);
$out+='</td> <td>';
$out+=$escape(_emptyDisplay(_momentFormat(p.startTime,'YYYY/MM/DD')));
$out+='</td> <td>';
$out+=$escape(_emptyDisplay(_momentFormat(p.endTime,'YYYY/MM/DD')));
$out+='</td> <td>';
$out+=$escape(_emptyDisplay(_momentFormat(p.completeDate,'YYYY/MM/DD')));
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="10" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关任务</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table>';
return new String($out);
});/*v:1*/
template('m_task/m_task_cost','<div class=""> <form role="form" class="form-inline "> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div>');/*v:1*/
template('m_task/m_task_cost_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,d=$data.d,i=$data.i,$escape=$utils.$escape,pageIndex=$data.pageIndex,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-responsive"> <thead> <tr> <th width="5%">序号</th> <th width="25%"> 设计任务 </th> <th width="15%"> 类型 </th> <th width="25%"> 项目 <a class="icon-filter pull-right" id="filter_projectName"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th width="30%">描述</th> </tr> </thead> <tbody> ';
$each(dataList,function(d,i){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='"> <td>';
$out+=$escape(i+1+pageIndex*10);
$out+='</td> <td> <a href="javascript:void(0);" data-action="toTaskContent">';
$out+=$escape(d.taskContent);
$out+='</a> </td> <td>';
$out+=$escape(d.taskTypeText);
$out+='</td> <td>';
$out+=$escape(d.projectName);
$out+='</td> <td> ';
$out+=$escape(d.description);
$out+=' </td> </tr> ';
});
$out+=' ';
if(!(dataList && dataList.length>0)){
$out+=' <tr class="no-data"> <td colspan="5" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_task/m_task_design','<div class=""> <form role="form" class="form-inline "> </form> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div>');/*v:1*/
template('m_task/m_task_design_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,d=$data.d,i=$data.i,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<table class="table table-bordered table-responsive"> <thead> <tr> <th width="5%">序号</th> <th width="20%"> 设计任务 </th> <th width="10%">角色</th> <th width="10%"> 状态 </th> <th width="20%"> 项目 <a class="icon-filter pull-right" id="filter_projectName"><i class="icon iconfont icon-shaixuan"></i></a> </th> <th width="12%">开始时间</th> <th width="12%"> 结束时间 </th> <th width="11%"> 完成时间 </th> </tr> </thead> <tbody> ';
$each(dataList,function(d,i){
$out+=' <tr data-id="';
$out+=$escape(d.id);
$out+='"> <td>';
$out+=$escape(i+1);
$out+='</td> <td> <a href="javascript:void(0);" data-action="toTaskContent">';
$out+=$escape(d.taskName);
$out+='</a> </td> <td>';
$out+=$escape(d.role);
$out+='</td> <td>';
$out+=$escape(d.stateHtml);
$out+='</td> <td>';
$out+=$escape(d.projectName);
$out+='</td> <td> ';
$out+=$escape(_momentFormat(d.startTime,'YYYY/MM/DD'));
$out+=' </td> <td> ';
$out+=$escape(_momentFormat(d.endTime,'YYYY/MM/DD'));
$out+=' </td> <td>';
$out+=$escape(_momentFormat(d.completeDate,'YYYY/MM/DD'));
$out+='</td> </tr> ';
});
$out+=' ';
if(!(dataList && dataList.length>0)){
$out+=' <tr class="no-data"> <td colspan="8" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_task/m_task_design_file',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,p=$data.p,i=$data.i,d=$data.d,di=$data.di,$escape=$utils.$escape,_isNullOrBlank=$helpers._isNullOrBlank,u=$data.u,ui=$data.ui,_momentFormat=$helpers._momentFormat,_fileSizeFormat=$helpers._fileSizeFormat,_url=$helpers._url,$out='';$out+='<div class="m-task-design-file task-list-box"> <table class="table table-bordered"> <thead> <tr> <th>任务</th> <th> <label class="i-checks fw-normal m-b-none dp-inline-block"> <input name="taskFileCk" type="checkbox" value="" /> <span class="i-checks-span"></span> </label> <div class="list-action-box dp-inline-block"> <div class="btn-group batchOperation" id="batchAllOperation"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="批量操作"> <span class="ic-operation-batch"></span> </button> <ul class="dropdown-menu"> <li> <a href="javascript:void(0);" class="" data-action="batchStateFlow" data-canbedelete="">批量流转</a> </li> </ul> </div> </div> <span>图名</span> </th> <th>状态</th> <th>处理人</th> <th>创建时间</th> <th>修改时间</th> <th>大小</th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(p,i){
$out+=' ';
if(p.fileList && p.fileList.length>0){
$out+=' ';
$each(p.fileList,function(d,di){
$out+=' <tr data-i="';
$out+=$escape(di);
$out+='" data-pi="';
$out+=$escape(i);
$out+='" data-id="';
$out+=$escape(d.id);
$out+='" data-pid="';
$out+=$escape(p.id);
$out+='"> ';
if(di==0){
$out+=' <td rowspan="';
$out+=$escape(p.fileList&&p.fileList.length>1?p.fileList.length:'1');
$out+='" class="v-middle"> ';
$out+=$escape(p.taskName);
$out+=' </td> ';
}
$out+=' <td> <label class="i-checks fw-normal m-b-none dp-inline-block"> <input name="taskFileCk" type="checkbox" value="';
$out+=$escape(d.id);
$out+='" data-status="';
$out+=$escape(d.fileStatus);
$out+='"/> <span class="i-checks-span"></span> </label> <span class="file-name"> <a href="javascript:void(0);" data-action="filePreview" class="btn btn-link fc-dark-blue no-padding">';
$out+=$escape(d.fileName);
$out+='</a> </span> </td> <td> <span class="show-span"> ';
if(!_isNullOrBlank(d.fileStatusName)){
$out+=' <button class="btn btn-white btn-rounded btn-status no-hover selected">';
$out+=$escape(d.fileStatusName);
$out+='</button> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" class="btn-edit" data-action="xeditableByDesignClick" data-key="fileStatus" data-value="';
$out+=$escape(d.fileStatus);
$out+='" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td> <span class="show-span"> ';
if(d.handlerUser && d.handlerUser.userList && d.handlerUser.userList.length>0){
$out+=' ';
$each(d.handlerUser.userList,function(u,ui){
$out+=' ';
if(ui < d.handlerUser.userList.length-1){
$out+=' ';
$out+=$escape(u.userName);
$out+=', ';
}else{
$out+=' ';
$out+=$escape(u.userName);
$out+=' ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> <a href="javascript:void(0);" class="btn-edit" data-action="xeditableUserByDesign" data-key="handler" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </td> <td>';
$out+=$escape(_momentFormat(d.createTime,'YYYY/MM/DD HH:ss'));
$out+='</td> <td>';
$out+=$escape(_momentFormat(d.updateDate,'YYYY/MM/DD HH:ss'));
$out+='</td> <td>';
$out+=$escape(_fileSizeFormat(d.fileSize));
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr> <td>';
$out+=$escape(p.taskName);
$out+='</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> </tr> ';
}
$out+=' ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="7" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_task/m_task_details',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$string=$utils.$string,_isNullOrBlank=$helpers._isNullOrBlank,_getStatusColor=$helpers._getStatusColor,_momentFormat=$helpers._momentFormat,$out='';$out+='<div class="ibox no-margins m-production-details"> <div class="ibox-title secondary-menu-outbox"> <div class="row">  <div class="col-md-12" id="breadcrumb"></div> </div> </div> <div class="ibox-content no-padding"> <div class="row no-margins p-t-xs"> <div class="col-md-8 p-t-xs"> <span class="font-bold"> ';
$out+=$escape(dataInfo.task.taskFullName);
$out+=' </span> </div> <div class="col-md-4 text-right"> <a href="javascript:;" data-action="returnBack" class="btn btn-default">返回</a> </div> </div> <div class="border-bottom m-t-xs"></div> <div class=""> <div class="col-md-9 p-t-sm p-l p-r-none border-right" id="leftBox"> <div class="tabs-container m-t"> <ul class="nav nav-tabs">  <li class="active"><a data-toggle="tab" href="#tab-5" aria-expanded="false">分解任务</a></li> <li class=""><a data-toggle="tab" href="#tab-4" aria-expanded="false">变更历史</a></li> </ul> <div class="tab-content"> <!-- <div id="tab-3" class="tab-pane active"> <div class="panel-body"> <form class="form-horizontal details-edit"> <div class="form-group "> <label class="col-sm-12"> 描 述： <a href="javascript:void(0);" data-action="xeditable" data-type="11" data-key="taskRemark" data-target-ele="#task-remark-edit" data-is-picture="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </label> <div class="col-sm-12"> <div class="show-span">';
$out+=$string(dataInfo.task.taskRemark);
$out+='</div> <div id="task-remark-edit"></div> </div> </div> </form> </div> </div>--> <div id="tab-4" class="tab-pane " data-type="changeHistory"> <div class="panel-body"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> <div id="tab-5" class="tab-pane active" data-type="subTask"> <div class="panel-body"> <div class="data-list-box"> <div class="data-list-container2"></div> <div class="p-w-sm"> <div id="data-pagination-container2" class="m-pagination pull-right "></div> </div> </div> </div> </div> </div> </div> </div> <div class="col-md-3 p-t-sm" id="rightBox"> <h4 class="title-line m-b-sm">基本信息</h4> <div class="row m-b-sm"> <label class="col-sm-5">任务状态：</label> <div class="col-sm-7"> ';
if(!_isNullOrBlank(dataInfo.task.endStatusName)){
$out+=' <button class="btn ';
$out+=$escape(_getStatusColor(dataInfo.task.endStatus));
$out+=' btn-rounded btn-status no-hover">';
$out+=$escape(dataInfo.task.endStatusName);
$out+='</button> ';
}else{
$out+=' -- ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">占比：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.task.ratio?dataInfo.task.ratio+'%':'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">团队：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.task.departName?dataInfo.task.departName:'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">任务负责人：</label> <div class="col-sm-7"> ';
$out+=$escape(dataInfo.task.designer?dataInfo.task.designer.userName:'--');
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">开始时间：</label> <div class="col-sm-7"> ';
if(_isNullOrBlank(dataInfo.task.startTime)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">结束时间：</label> <div class="col-sm-7"> ';
if(_isNullOrBlank(dataInfo.task.endTime)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> <div class="row m-b-sm"> <label class="col-sm-5">完成时间：</label> <div class="col-sm-7"> ';
if(_isNullOrBlank(dataInfo.task.completeDate)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(dataInfo.task.completeDate,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' </div> </div> </div> <div class="clearfix"></div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_task/m_task_details_content',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$string=$utils.$string,_include=$helpers._include,userList=$data.userList,role=$data.role,currentCompanyUserId=$data.currentCompanyUserId,value=$data.value,type=$data.type,$each=$utils.$each,t=$data.t,ti=$data.ti,_momentFormat=$helpers._momentFormat,_url=$helpers._url,i=$data.i,$out='';$out+='<div class="m-task-details-content"> <span class="font-bold"> ';
$out+=$escape(dataInfo.task.taskName);
$out+=' </span> <span class="m-l-lg"> 任务状态： ';
if((dataInfo.task.taskType==2||dataInfo.task.taskType==3) && dataInfo.task.isOperaterTask==0){
$out+=' <a id="taskStateFlow" href="javascript:void(0);" class="font-bold ';
$out+=$escape(dataInfo.task.role && dataInfo.task.role.changeStatus==1?'':'a-span');
$out+='" data-end-status="';
$out+=$escape(dataInfo.task.endStatus);
$out+='" data-action="';
$out+=$escape(dataInfo.task.role && dataInfo.task.role.changeStatus==1?'taskStateFlow':'');
$out+='" >  ';
if(dataInfo.task.endStatus ==3 || dataInfo.task.endStatus ==4){
$out+=' <span class="text-danger">';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}else if(dataInfo.task.endStatus ==2){
$out+=' <span class="text-success">';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}else{
$out+=' <span>';
$out+=$escape(dataInfo.task.stateHtml);
$out+='</span> ';
}
$out+=' </a> ';
}else{
$out+=' <button id="taskStateFlowBtn" class="btn btn-white btn-rounded btn-status no-hover selected">';
$out+=$escape(dataInfo.task.endStatusName);
$out+='</button> ';
}
$out+=' </span> <div class="tabs-container m-t"> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="false">设计文件</a></li> <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">校审意见</a></li> <li class=""><a data-toggle="tab" href="#tab-4" aria-expanded="false">变更历史</a></li> <li class=""><a data-toggle="tab" href="#tab-3" aria-expanded="false">任务描述</a></li> ';
if((dataInfo.task.taskType==2||dataInfo.task.taskType==3) && dataInfo.task.isOperaterTask==0){
$out+=' <li class=""><a data-toggle="tab" href="#tab-5" aria-expanded="false">审批记录</a></li> ';
}
$out+=' </ul> <div class="tab-content"> <div id="tab-1" class="tab-pane active" data-type="designFile"> <div class="panel-body"> ';
if(dataInfo.task.endStatus!='0' && dataInfo.filePid!=null){
$out+=' <button class="btn btn-primary btn-sm" data-action="uploadFile">上传设计文件</button> ';
}
$out+='  <div class="design-file-list"> </div> </div> </div> <div id="tab-2" class="tab-pane" data-type="approvalOpinion"> <div class="panel-body"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container-approvalOpinion" class="m-pagination pull-right "></div> </div> </div> </div> </div> <div id="tab-3" class="tab-pane"> <div class="panel-body"> <form class="form-horizontal details-edit"> <div class="form-group "> <div class="col-sm-4"> <label class="pull-left p-t-xs">处理人：</label> <div class="pull-left l-h-28 details-dataInfo-box"> <span class="show-span"> ';
$out+=$string(_include('m_production/m_production_users_display',{userList:dataInfo.task.handlerUser.userList,role:dataInfo.task.role.changeDesigner,currentCompanyUserId:currentCompanyUserId}));
$out+=' </span> ';
if(dataInfo.task.role && dataInfo.task.role.changeDesigner==1){
$out+=' <a href="javascript:void(0);" data-action="xeditableUser" data-key="handlerUser" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </div> </div> <div class="col-sm-4"> <label class="pull-left p-t-xs">开始时间：</label> <div class="pull-left l-h-28 details-dataInfo-box"> <span class="show-span"> ';
$out+=$string(_include('m_common/m_display_by_role_value',{role:dataInfo.task.role.edit,value:dataInfo.task.startTime,type:1}));
$out+=' </span> ';
if(dataInfo.task.role && dataInfo.task.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(dataInfo.task.startTime);
$out+='" data-type="10" data-key="startTime" data-max-date="';
$out+=$escape(dataInfo.task.endTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </div> </div> <div class="col-sm-4"> <label class="pull-left p-t-xs">结束时间：</label> <div class="pull-left l-h-28 details-dataInfo-box"> <span class="show-span"> ';
$out+=$string(_include('m_common/m_display_by_role_value',{role:dataInfo.task.role.edit,value:dataInfo.task.endTime,type:1}));
$out+=' </span> ';
if(dataInfo.task.role && dataInfo.task.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(dataInfo.task.endTime);
$out+='" data-type="10" data-key="endTime" data-min-date="';
$out+=$escape(dataInfo.task.startTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </div> </div> </div> <div class="form-group "> <div class="col-sm-4"> <label class="pull-left p-t-xs">完成时间：</label> <div class="pull-left l-h-28 details-dataInfo-box"> ';
$out+=$string(_include('m_common/m_display_by_role_value',{value:dataInfo.task.completeDate,type:1}));
$out+=' </div> </div> </div> <div class="form-group "> <label class="col-sm-12"> 描 述： <a href="javascript:void(0);" data-action="xeditable" data-type="11" data-key="taskRemark" data-target-ele="#task-remark-edit" data-is-picture="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> </label> <div class="col-sm-12"> <div class="show-span">';
$out+=$string(dataInfo.task.taskRemark);
$out+='</div> <div id="task-remark-edit"></div> </div> </div> </form> </div> </div> <div id="tab-4" class="tab-pane" data-type="changeHistory"> <div class="panel-body"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div id="data-pagination-container" class="m-pagination pull-right "></div> </div> </div> </div> </div> ';
if((dataInfo.task.taskType==2||dataInfo.task.taskType==3) && dataInfo.task.isOperaterTask==0){
$out+=' <div id="tab-5" class="tab-pane" data-type="approvalRecord"> <div class="panel-body"> <table class="table table-striped"> <thead> <tr> <th width="6%">序号</th> <th width="19%">提交时间</th> <th width="30%">设计组织</th>  <th width="15%">审批前状态</th> <th width="15%">审批后状态</th> <th width="15%">审批时间</th> </tr> </thead> <tbody> ';
if(dataInfo.taskCheckAuditList!=null && dataInfo.taskCheckAuditList.length>0){
$out+=' ';
$each(dataInfo.taskCheckAuditList,function(t,ti){
$out+=' <tr class="curp" data-id="';
$out+=$escape(t.id);
$out+='"> <td>';
$out+=$escape(ti+1);
$out+='</td> <td>';
$out+=$escape(_momentFormat(t.submitDate,'YYYY/MM/DD HH:mm:ss'));
$out+='</td> <td>';
$out+=$escape(t.companyName);
$out+='</td> <!--<td>';
$out+=$escape(t.taskName);
$out+='</td>--> <td>';
$out+=$escape(t.beforeStatus);
$out+='</td> <td>';
$out+=$escape(t.afterStatus);
$out+='</td> <td>';
$out+=$escape(_momentFormat(t.auditDate,'YYYY/MM/DD'));
$out+='</td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="6" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">暂无相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> </div> ';
}
$out+=' </div> </div> ';
if(!((dataInfo.task.taskType==2||dataInfo.task.taskType==3) && dataInfo.task.isOperaterTask==0)){
$out+=' <div class="row m-t-sm"> <form class="form-horizontal m-r-lg" id="commentForm"> <div class="col-md-12 m-b-sm f-s-lg">下一状态</div> <div class="col-md-12"> ';
$each(dataInfo.nodeList,function(t,i){
$out+=' <button class="btn btn-white btn-rounded btn-status ';
$out+=$escape(i==0?'selected':'fc-v1-grey');
$out+='" data-node-type="1" data-status="';
$out+=$escape(t.nodeValue);
$out+='"> ';
if(i==0){
$out+=' ';
$out+=$escape(dataInfo.task.endStatus==t.nodeValue?'保持为':'');
$out+=$escape(t.nodeName);
$out+=' ';
}else{
$out+=' ';
$out+=$escape(t.nodeName);
$out+=' ';
}
$out+=' </button> ';
});
$out+=' </div> <div class="col-xs-12 bg-v2-grey p-m m"> <div class="form-group"> <label class="col-24-xs-3 fw-normal fc-v2-grey p-t-xs">处理人：</label> <div class="col-24-xs-21"> <div data-action="handler"></div> </div> </div> </div> <div class="col-xs-12"> <div class="form-group"> <div class="col-24-xs-21"> <button class="btn btn-primary btn-w-m" data-action="submitWorkflow">流转</button> </div> </div> </div> <div class="clearfix"></div> </form> </div> ';
}
$out+=' </div>';
return new String($out);
});/*v:1*/
template('m_task/m_task_details_menu','<div class="tabs-container tabs-new-container"> <ul class="nav nav-tabs"> <li class="active"><a data-toggle="tab" href="#tab-menu-1" aria-expanded="true">工作安排</a></li> <li class="disabled" title="暂未开放"><a href="javascript:void(0);" aria-expanded="false" >设计文件</a></li> <li class="disabled" title="暂未开放"><a href="javascript:void(0);" aria-expanded="false">校审意见</a></li> </ul> <div class="tab-content"> <div id="tab-menu-1" class="tab-pane active" data-type="versionPurchase"> <div class="panel-body" data-type="productionTask"> </div> </div>  </div> </div> ');/*v:1*/
template('m_task/m_task_details_menu_production',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,dataList=$data.dataList,$each=$utils.$each,t=$data.t,ti=$data.ti,$escape=$utils.$escape,targetId=$data.targetId,tIndex=$data.tIndex,_url=$helpers._url,$out='';$out+='<div class="task-list-box"> <table class="table"> <thead> <tr> <th width="9%" class="b-r-none"> <div class="list-check-box"> <label class="i-checks fw-normal m-b-none"> <input name="taskCk" type="checkbox" value="" /> <span class="i-checks-span"></span> </label> </div> </th> <th width="9%" class="b-r-none b-l-none"> <div class="list-action-box"> <div class="btn-group batchOperation" id="batchAllOperation"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="批量操作"> <span class="ic-operation-batch"></span> </button> <ul class="dropdown-menu"> <li> <a href="javascript:void(0);" class="" data-action="batchTaskStateFlow" data-canbedelete="">批量流转</a> </li> </ul> </div> </div> </th> <th width="82%" class="b-l-none"> <span>任务</span> </th> </tr> </thead> <tbody> ';
if(dataList!=null && dataList.length>0){
$out+=' ';
$each(dataList,function(t,ti){
$out+=' <tr class="production-content-row curp ';
$out+=$escape(t.id==targetId?'bg-v2-gray':'');
$out+='" data-id="';
$out+=$escape(t.id);
$out+='" data-pid="';
$out+=$escape(t.taskPid);
$out+='" data-i="';
$out+=$escape(tIndex);
$out+='"> <td class="b-r-none p-t-xs"> <div class="list-check-box"> <label class="i-checks fw-normal m-b-none" title="';
$out+=$escape(t.taskType==3?'订单任务不参与批量流转':'');
$out+='" >  ';
if(t.taskType==3){
$out+=' <input name="taskCk" type="checkbox" value="';
$out+=$escape(t.id);
$out+='" data-end-status="';
$out+=$escape(t.endStatus);
$out+='" disabled /> ';
}else{
$out+=' <input name="taskCk" type="checkbox" value="';
$out+=$escape(t.id);
$out+='" data-end-status="';
$out+=$escape(t.endStatus);
$out+='"/> ';
}
$out+=' <span class="i-checks-span"></span> </label> </div> </td> <td class="b-r-none b-l-none v-middle"> </td> <td class="" > <span class="text-ellipsis l-h-inherit" data-toggle="tooltip" data-container="body" data-original-title="';
$out+=$escape(t.taskName);
$out+='">';
$out+=$escape(t.taskName);
$out+='</span> </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data"> <td colspan="3" class="text-center"> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关任务</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> </div> ';
return new String($out);
});/*v:1*/
template('m_task/m_task_header',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,status=$data.status,$escape=$utils.$escape,doType=$data.doType,$out='';$out+='<div class="row m-task-header border"> <div class="col-24-xs-3 height-60 border-right bg-v2-grey"> <div class="btn-group btn-group-new text-center" id="taskStatus"> <button data-toggle="dropdown" class="bg-v2-grey" aria-expanded="true"> ';
if(status==0){
$out+=' <span>待处理';
$out+=$escape(doType==2?'工作项':'任务');
$out+='</span> ';
}else{
$out+=' <span>已处理';
$out+=$escape(doType==2?'工作项':'任务');
$out+='</span> ';
}
$out+=' <span class="caret"></span> </button> <ul class="dropdown-menu"> <li><a href="javascript:void(0);" data-status="0">待处理';
$out+=$escape(doType==2?'工作项':'任务');
$out+='</a></li> <li><a href="javascript:void(0);" data-status="1">已处理';
$out+=$escape(doType==2?'工作项':'任务');
$out+='</a></li> </ul> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_task/m_task_light','<div class="ibox"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 我的任务 </li> <li class="active fa fa-angle-right"> <strong>协同任务</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <div class="m-task"> <div class="p-w-sm" id="taskHeader"> </div> <div class="m-t" id="taskContent"> <div class="data-list-box"> <div class="data-list-container"></div> <div class="p-w-sm"> <div class="m-pagination pull-right"></div> </div> </div> </div> </div> </div> </div> ');/*v:1*/
template('m_task/m_task_light_list',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,p=$data.p,$index=$data.$index,$escape=$utils.$escape,_isNullOrBlank=$helpers._isNullOrBlank,_url=$helpers._url,$out='';$out+='<table class="table table-hover table-bordered table-responsive" > <thead> <tr> <th>标题</th> <th>状态</th> <th>优先级</th> </tr> </thead> <tbody> ';
$each(dataList,function(p,$index){
$out+=' <tr class="curp" data-id="';
$out+=$escape(p.id);
$out+='" data-project-id="';
$out+=$escape(p.lightProjectId);
$out+='"> <td>';
$out+=$escape(p.taskName);
$out+='</td> <td> ';
if(!_isNullOrBlank(p.completeDate)){
$out+=' 已完成 ';
}else{
$out+=' 进行中 ';
}
$out+=' </td> <td> ';
if(p.severity=='1'){
$out+=' <span>高</span> ';
}else if(p.severity=='2'){
$out+=' <span>中</span> ';
}else if(p.severity=='3'){
$out+=' <span>低</span> ';
}
$out+=' </td> </tr> ';
});
$out+=' ';
if(dataList==null || dataList.length==0){
$out+=' <tr class="no-data"> <td colspan="3" class="text-center v-middle"> <div class="m-b-xl m-t-md"> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">您还没有相关数据</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_task/m_task_menu',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,companyVersion=$data.companyVersion,$out='';$out+='<div class="ibox m-task-menu"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"></div> <div class="pull-right"> ';
if(companyVersion.indexOf("01")>-1){
$out+=' <ul class="secondary-menu-ul"> <li class="active" id="design" > <a href="#/myTask/design">设计任务</a> </li> <li id="light" > <a href="#/myTask/light">协同工作项</a> </li> </ul> ';
}
$out+=' </div> </div> </div> </div> <div class="ibox-content"> <div class="row"> <div class="col-md-12" id="content-box"> </div> </div> </div> </div>';
return new String($out);
});/*v:1*/
template('m_task/m_task_production',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,p=$data.p,$each=$utils.$each,t=$data.t,ti=$data.ti,$escape=$utils.$escape,tIndex=$data.tIndex,companyUserId=$data.companyUserId,currentCompanyId=$data.currentCompanyId,businessType=$data.businessType,userId=$data.userId,_isNullOrBlank=$helpers._isNullOrBlank,_getStatusColor=$helpers._getStatusColor,_momentFormat=$helpers._momentFormat,_url=$helpers._url,$out='';$out+='<table class="tree table table-bordered m-b-none m-task-production"> <thead> <tr> <th width="3%" class="b-r-none"> <div class="list-check-box"> <label class="i-checks fw-normal m-b-none"> <input name="taskAllCk" type="checkbox" /> <span class="i-checks-span"></span> </label> </div> </th> <th width="3%" class="b-r-none b-l-none"> <div class="list-action-box"> <div class="btn-group batchOperation" id="batchAllOperation"> <button type="button" class="btn btn-default btn-xs dropdown-toggle action-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="批量操作"> <span class="ic-operation-batch"></span> </button> <ul class="dropdown-menu"> <li> <a href="javascript:void(0);" class="" data-action="batchTaskStateFlow">批量变更状态</a> </li> </ul> </div> </div> </th> <th width="25%" class="b-l-none"> <span>我的任务</span> </th> <th width="25%" class="b-l-none"> <span>所属项目</span> </th> <th width="" class="w-100">任务状态</th> <th width="10%" >处理人</th> <th width="" >任务占比</th> <th width="" class="w-100">开始时间</th> <th width="" class="w-100">结束时间</th> <th width="" >完成时间</th> </tr> </thead> <tbody> ';
if(p.childList!=null && p.childList.length>0){
$out+=' ';
$each(p.childList,function(t,ti){
$out+=' <tr class="m-production-content-row ';
$out+=$escape(t.completeDate==null?'':'complete-date-tr');
$out+=' " data-id="';
$out+=$escape(t.id);
$out+='" data-pid="';
$out+=$escape(t.taskPid);
$out+='" data-i="';
$out+=$escape(tIndex);
$out+='" data-path="';
$out+=$escape(t.taskPath);
$out+='"> <td class=" b-r-none p-t-9"> <div class="list-check-box"> <label class="i-checks fw-normal m-b-none" title="';
$out+=$escape(t.taskType==3?'订单任务不参与批量变更状态':'');
$out+='">  ';
if(t.taskType==3){
$out+=' <input name="taskCk" type="checkbox" data-is-can1="';
$out+=$escape(t.role.delete);
$out+='" value="';
$out+=$escape(t.id);
$out+='" data-end-status="';
$out+=$escape(t.endStatus);
$out+='" disabled /> ';
}else{
$out+=' <input name="taskCk" type="checkbox" data-is-can1="';
$out+=$escape(t.role.delete);
$out+='" value="';
$out+=$escape(t.id);
$out+='" data-end-status="';
$out+=$escape(t.endStatus);
$out+='"/> ';
}
$out+=' <span class="i-checks-span"></span> </label> </div> </td> <td class="b-r-none b-l-none v-middle"> <div class="list-action-box"> </div> </td> <td class="tree-td pt-relative p-r-none b-l-none" > ';
if( companyUserId == null){
$out+=' <a href="#/myTask/details?id=';
$out+=$escape(t.projectId);
$out+='&projectName=';
$out+=$escape(t.projectName);
$out+='&taskId=';
$out+=$escape(t.id);
$out+='&dataCompanyId=';
$out+=$escape(currentCompanyId);
$out+='&businessType=';
$out+=$escape(businessType);
$out+='" class="show-span task-name pt-relative text-ellipsis " data-string="';
$out+=$escape(t.taskName);
$out+='"> ';
$out+=$escape(t.taskName);
$out+=' </a> ';
}else{
$out+=' <a href="#/myTask/details?id=';
$out+=$escape(t.projectId);
$out+='&companyUserId=';
$out+=$escape(companyUserId);
$out+='&userId=';
$out+=$escape(userId);
$out+='&projectName=';
$out+=$escape(t.projectName);
$out+='&taskId=';
$out+=$escape(t.id);
$out+='&dataCompanyId=';
$out+=$escape(currentCompanyId);
$out+='&businessType=';
$out+=$escape(businessType);
$out+='" class="show-span task-name pt-relative text-ellipsis " data-string="';
$out+=$escape(t.taskName);
$out+='"> ';
$out+=$escape(t.taskName);
$out+=' </a> ';
}
$out+=' </td> ';
if((ti>=0 &&(ti+1)<(p.childList.length) && p.childList[ti+1].projectName==t.projectName)){
$out+=' <td class="tree-td pt-relative p-r-none b-l-none b-t-none" style="border-bottom: 1px #00000000 solid !important;"> ';
if(!(ti-1>=0 && p.childList[ti-1].projectName==t.projectName)){
$out+=' ';
$out+=$escape(t.projectName);
$out+=' ';
}
$out+=' </td> ';
}else{
$out+=' <td class="tree-td pt-relative p-r-none b-l-none b-t-none" > ';
if(!(ti-1>=0 && p.childList[ti-1].projectName==t.projectName)){
$out+=' ';
$out+=$escape(t.projectName);
$out+=' ';
}
$out+=' </td> ';
}
$out+=' <td> <span class="show-span"> ';
if(!_isNullOrBlank(t.endStatusName)){
$out+=' <button class="btn ';
$out+=$escape(_getStatusColor(t.endStatus));
$out+=' btn-rounded btn-status no-hover">';
$out+=$escape(t.endStatusName);
$out+='</button> ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span>  ';
if(t.taskType==0 && t.role && t.role.changeStatus==1){
$out+=' <a href="javascript:void(0);" data-action="xeditableByClick" data-key="endStatus" data-value="';
$out+=$escape(t.endStatus);
$out+='" data-type="5" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td > <span class="show-span"> ';
if(t.handler){
$out+=' ';
$out+=$escape(t.handler.userName);
$out+=' ';
}else{
$out+=' <span class="fc-v1-grey">未设置</span> ';
}
$out+=' </span> ';
if(t.role && t.role.changeDesigner==1){
$out+=' <a href="javascript:void(0);" data-action="xeditableUser" data-key="handlerUser" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td> <span class="show-span"> ';
if(_isNullOrBlank(t.ratio)){
$out+=' -- ';
}else{
$out+=' ';
$out+=$escape(t.ratio);
$out+='% ';
}
$out+=' </span> </td> <td> <span class="show-span"> ';
if(t.role && t.role.edit==1){
$out+=' ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(t.startTime)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.startTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.startTime);
$out+='" data-type="10" data-key="startTime" data-max-date="';
$out+=$escape(t.endTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td class=""> <span class="show-span"> ';
if(t.role && t.role.edit==1){
$out+=' ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">未设置</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}else{
$out+=' ';
if(_isNullOrBlank(t.endTime)){
$out+=' <span class="fc-v1-grey">--</span> ';
}else{
$out+=' ';
$out+=$escape(_momentFormat(t.endTime,'YYYY/MM/DD'));
$out+=' ';
}
$out+=' ';
}
$out+=' </span> ';
if(t.role && t.role.edit==1){
$out+=' <a href="javascript:void(0);" data-action="xeditable" data-value="';
$out+=$escape(t.endTime);
$out+='" data-type="10" data-key="endTime" data-min-date="';
$out+=$escape(t.startTime);
$out+='" data-init-show="1" data-onpicked-save="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> ';
}
$out+=' </td> <td class=""> <span> ';
if(t.completeDate!=null &&  t.completeDate!=''){
$out+=' ';
$out+=$escape(_momentFormat(t.completeDate,'YYYY/MM/DD'));
$out+=' ';
}else{
$out+=' -- ';
}
$out+=' </span> </td> </tr> ';
});
$out+=' ';
}else{
$out+=' <tr class="no-data-tr"> <td colspan="10" class="text-center "> <div> <img src="';
$out+=$escape(_url('/img/default/without_data.png'));
$out+='"> <span class="fc-dark-blue dp-block">没有相关子任务</span> </div> </td> </tr> ';
}
$out+=' </tbody> </table> ';
return new String($out);
});/*v:1*/
template('m_technology_sync/m_technology_add',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,fileName=$data.fileName,$escape=$utils.$escape,fileId=$data.fileId,fileFullPath=$data.fileFullPath,$out='';$out+='<form class="form-horizontal m_cost_collectionPlan_add m "> <div class="form-group "> <label class="col-sm-2 control-label">会议纪要名称 <span class="fc-red">*</span></label> <div class="col-sm-10"> <input placeholder="请输入会议纪要名称" class="form-control" type="text" name="remark" style="width: 100%;display: inline-block;"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">会议纪要文件 <span class="fc-red">*</span></label> <div class="col-sm-10"> <div class="row" > <div class="col-md-12 m-t-xs"> <span id="showFileLoading"> ';
if(fileName){
$out+=' <span class="label m-r-xs m-b-xs" style="background: #ecf0f1;padding: 5px 10px;display: inline-block;"> <a href="javascript:void(0)" data-action="preview" data-net-file-id="';
$out+=$escape(fileId);
$out+='" data-src="';
$out+=$escape(fileFullPath);
$out+='" data-name="';
$out+=$escape(fileName);
$out+='" name="fileName" data-type=""> ';
$out+=$escape(fileName);
$out+=' </a> </span> ';
}
$out+=' </span> </div> <div class="col-md-12"> <a href="javascript:void(0)" id="filePicker" data-action="recordAttach" class="upload-icon vertical-top m-t-xxs dp-inline-block" title="请上传会议纪要文件"></a> </div> </div> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_technology_sync/m_technology_dynamics_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,title=$data.title,_momentFormat=$helpers._momentFormat,publishDate=$data.publishDate,content=$data.content,$out='';$out+='<form class="form-horizontal m"> <div class="form-group"> <label class="col-md-2 control-label">标题:</label> <div class="col-md-10"> <input class="form-control" name="title" maxlength="300" value="';
$out+=$escape(title);
$out+='" type="text"> </div> </div> <div class="form-group"> <label class="col-md-2 control-label">时间:</label> <div class="col-md-10"> <div class="input-group"> <input type="text" class="form-control" name="publishDate" placeholder="请选择日期" readonly onfocus="WdatePicker({dateFmt:\'yyyy-MM-dd\'})" value="';
$out+=$escape(_momentFormat(publishDate,'YYYY-MM-DD'));
$out+='"> <span class="input-group-addon " onclick="javascript:$(this).prev().focus();"><i class="icon-append fa fa-calendar"></i></span> </div> </div> </div> <div class="form-group"> <label class="col-md-2 control-label">内容:</label> <div class="col-md-10"> <textarea class="form-control" rows="5" name="content">';
$out+=$escape(content);
$out+='</textarea> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_technology_sync/m_technology_edit',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,placeholderTitle=$data.placeholderTitle,tempData=$data.tempData,$out='';$out+='<form class="form-horizontal m-task-issue-add m"> <div class="form-group "> <div class="col-sm-12"> <textarea placeholder="';
$out+=$escape(placeholderTitle);
$out+='" class="form-control" type="text" name="remark" style="width: 100%;padding:0px; height:150px;display: inline-block;">';
$out+=$escape(tempData);
$out+='</textarea> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_technology_sync/m_technology_show',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,title2=$data.title2,$escape=$utils.$escape,content=$data.content,date=$data.date,$out='';$out+='<form class="form-horizontal m_technology_sync m"> <div class="form-group " style="font-size: 16px;"> ';
if(title2){
$out+=' <div class="col-sm-12"> <h4>';
$out+=$escape(title2);
$out+='</h4> </div> ';
}
$out+=' <div class="col-sm-12"> <span class="line-feed" > ';
$out+=$escape(content);
$out+=' </span> </div> <div class="col-sm-12 text-right m-t-md"> <span> ';
$out+=$escape(date);
$out+=' </span> </div> </div> </form> ';
return new String($out);
});/*v:1*/
template('m_technology_sync/m_technology_show_more',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,title=$data.title,$out='';$out+='<div class="ibox m_technology_sync"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box" > <ol class="breadcrumb"> <li> 技术协同 </li> <li class="active fa fa-angle-right"> <strong>';
$out+=$escape(title);
$out+='</strong> </li> </ol> </div> </div> <a type="button" class="btn btn-w-m btn-link btn-u-sm m-t-sm pull-right " data-action="back"> 返回 </a> </div> </div> </div> <div class="ibox-content no-padding"> <div class="row"> <div class="col-md-12" id="content-box"> <div class="messageList m-l m-r" style="min-height: 690px"> </div> <div class="row margin-bottom-30"> <div class="col-md-12 text-center m-t-sm"> <div class="m-page" ></div> <a class="btnPageNext btn btn-default btn-xs" href="javascript:void(0)" style="display: none;" data-action="btnPageNext">加载更多</a> </div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_technology_sync/m_technology_show_more_item',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,dataList=$data.dataList,t=$data.t,ti=$data.ti,$escape=$utils.$escape,_momentFormat=$helpers._momentFormat,$out='';$each(dataList,function(t,ti){
$out+=' <div class="row"> <div class="col-24-md-24 col-xl-12 notice-list-content m-t"> <div class="feed-element" data-action="fileAction" data-src="';
$out+=$escape(t.fileFullPath);
$out+='" > <div class="media-body "> <div class="col-24-md-22 msg-content-box"> <div class="msg-content">';
$out+=$escape(t.content);
$out+=' <a href="javascript:void(0);" class="roleControl" roleCode="10000603" data-action="xDelete" data-value="';
$out+=$escape(t.id);
$out+='" data-placeholder="删除" data-type="1" data-valid="1" style="visibility: hidden;"> <i class="fa fa-times fc-red"></i> </a> </div> </div> <div class="col-24-md-2 text-right m-t" > ';
$out+=$escape(_momentFormat(t.createDate,'YYYY/MM/DD'));
$out+=' </div> </div> </div> </div> </div> ';
});
$out+=' ';
return new String($out);
});/*v:1*/
template('m_technology_sync/m_technology_sync',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dataInfo=$data.dataInfo,$each=$utils.$each,f=$data.f,ti=$data.ti,_momentFormat=$helpers._momentFormat,p=$data.p,t=$data.t,$out='';$out+='<div class="ibox m_technology_sync"> <div class="ibox-title secondary-menu-outbox"> <div class="row"> <div class="col-md-12" id="secondary-menu">  <div class="pull-left" id="breadcrumb"> <div class="no-margin p-h-sm breadcrumb-box"> <ol class="breadcrumb"> <li> 信息动态 </li> <li class="active fa fa-angle-right"> <strong>技术协同</strong> </li> </ol> </div> </div> </div> </div> </div> <div class="ibox-content"> <div class="col-md-12"> <div class="row"> <div class="col-md-6 p-r-xl p-l-0" > <div class="panel panel-success"> <div class="panel-heading"> <div class="row"> <div class="head-row-item"> <span>华侨城创新研究院创新技术委员会</span> </div> <div class="head-row-item text-right"> <a href="javascript:void(0);" class="roleControl" roleCode="10000603" flag = \'2\' data-action="committeeDesc" data-placeholder="编辑" data-type="13" data-valid="1" select-type="4" data-max-length="50" data-container-class="select-sm" > <i class="icon iconfont color-light icon-bianji"></i> </a> </div> </div> </div> <div class="panel-body"> <span class="line-feed">';
$out+=$escape(dataInfo.committee.content);
$out+='</span> </div> </div> <div class="panel panel-success"> <div class="panel-heading"> <div class="row"> <div class="head-row-item"> <span>委员成员</span> </div> <div class="head-row-item text-right"> <a href="javascript:void(0);" class="roleControl" roleCode="10000603" flag = \'2\' data-action="committeeMember" data-placeholder="编辑" data-type="13" data-valid="1" select-type="4" data-max-length="50" data-container-class="select-sm" > <i class="icon iconfont color-light icon-bianji"></i> </a> </div> </div> </div> <div class="panel-body"> <span class="line-feed">';
$out+=$escape(dataInfo.member.content);
$out+='</span> </div> </div> <div class="panel panel-default"> <div class="panel-heading"> <div class="row"> <div class="head-row-item"> <span>创新技术业务工作会会议纪要</span> </div> <div class="head-row-item text-right"> <a href="javascript:void(0);" class="roleControl" roleCode="10000603" flag = \'2\' data-action="addCommitteeRecord" data-placeholder="添加" data-type="13" data-valid="1" select-type="4" data-max-length="50" data-container-class="select-sm" > <i class="fa fa-plus color-light f-s-xl" ></i> </a> </div> </div> </div> <div class="panel-body"> ';
if(dataInfo.summaryFiles!=null &&dataInfo.summaryFiles.length>0){
$out+=' ';
$each(dataInfo.summaryFiles,function(f,ti){
$out+=' <div class="row" data-action="fileAction" data-src="';
$out+=$escape(f.fileFullPath);
$out+='"> <div class="col-md-12"> <div class="content-row-item-left "> <span class="show-span pt-relative text-ellipsis" > ';
$out+=$escape(f.content);
$out+='</span> <a href="javascript:void(0);" class="roleControl text-ellipsis" roleCode="10000603" flag = \'2\' data-action="xEdit" data-key="summaryFile" data-value="';
$out+=$escape(f.id);
$out+='" data-placeholder="编辑" data-type="1" data-valid="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> <a href="javascript:void(0);" class="roleControl text-ellipsis" roleCode="10000603" flag = \'2\' data-action="xDelete" data-key="summaryFile" data-value="';
$out+=$escape(f.id);
$out+='" data-placeholder="删除" data-type="1" data-valid="1" style="visibility: hidden;"> <i class="fa fa-times fc-red"></i> </a> </div> <div class="content-row-item-right text-right" STYLE="color:#AEAEAE"> ';
$out+=$escape(_momentFormat(f.createDate,'YYYY/MM/DD'));
$out+=' </div> </div> </div> ';
});
$out+=' ';
}
$out+=' </div> </div> </div> <div class="col-md-6 p-l-xl" > <div class="panel panel-default"> <div class="panel-heading" style="margin-top:0px"> <div class="row"> <div class="head-row-item"> <span>创新技术委员会信息动态</span> </div> <div class="head-row-item text-right"> <a href="javascript:void(0);" class="roleControl" roleCode="10000603" flag = \'2\' data-action="addDynamics" data-placeholder="添加" data-type="13" data-valid="1" select-type="4" data-max-length="50" data-container-class="select-sm" > <i class="fa fa-plus color-light f-s-xl" ></i> </a> </div> </div> </div> <div class="panel-body"> ';
if(dataInfo.dynamicsList!=null &&dataInfo.dynamicsList.length>0){
$out+=' ';
$each(dataInfo.dynamicsList,function(p,ti){
$out+=' <div class="vertical-timeline-block" data-id="';
$out+=$escape(p.id);
$out+='"> <div class="vertical-timeline-icon navy-bg"> <i class="fa fa-comments"></i> </div> <div class="vertical-timeline-content" data-action="dynamicsAction" data-content="';
$out+=$escape(p.content);
$out+='" data-title="';
$out+=$escape(p.title);
$out+='" data-date="';
$out+=$escape(_momentFormat(p.publishDate,'YYYY/MM/DD'));
$out+='"> <h4 data-value="';
$out+=$escape(p.title);
$out+='" style="text-overflow: ellipsis;overflow: hidden;"> ';
$out+=$escape(p.title);
$out+=' <a href="javascript:void(0);" class="roleControl pull-right" data-action="editProjectNotice" roleCode="10000603" flag = \'2\' title="编辑动态" style="display: none;"> <i class="fa fa-pencil"></i> </a> <a href="javascript:void(0);" class="roleControl pull-right m-r-xs" data-action="delProjectNotice" roleCode="10000603" flag = \'2\' title="删除动态" style="display: none;"> <i class="fa fa-times"></i> </a> </h4> <p class="noticeContent" style="text-overflow: ellipsis;overflow: hidden;"> ';
$out+=$escape(p.content);
$out+=' </p> <p class="noticePublishdate" data-value="';
$out+=$escape(p.publishDate);
$out+='">';
$out+=$escape(_momentFormat(p.publishDate,'YYYY/MM/DD'));
$out+='</p> </div> </div> ';
});
$out+=' ';
}
$out+=' </div> </div> <div class="panel panel-default"> <div class="panel-heading"> <div class="row"> <div class="head-row-item"> <span>获奖情况</span> </div> <div class="head-row-item text-right"> <a href="javascript:void(0);" class="roleControl" roleCode="10000603" flag = \'2\' data-action="addAward" data-placeholder="添加" data-type="13" data-valid="1" select-type="4" data-max-length="50" data-container-class="select-sm" > <i class="fa fa-plus color-light f-s-xl" ></i> </a> </div> </div> </div> <div class="panel-body"> ';
if(dataInfo.awardsList!=null &&dataInfo.awardsList.length>0){
$out+=' ';
$each(dataInfo.awardsList,function(t,ti){
$out+=' <div class="row" data-action="dynamicsAction" data-content="';
$out+=$escape(t.content);
$out+='" data-type="4" data-date="';
$out+=$escape(_momentFormat(t.createDate,'YYYY/MM/DD'));
$out+='"> <div class="col-md-12"> <div class="content-row-item-left "> <span class="show-span pt-relative text-ellipsis" > ';
$out+=$escape(t.content);
$out+='</span> <a href="javascript:void(0);" class="roleControl text-ellipsis" roleCode="10000603" flag = \'2\' data-action="xEdit" data-key="awards" data-value="';
$out+=$escape(t.id);
$out+='" data-placeholder="编辑" data-type="1" data-valid="1" style="visibility: hidden;"> <i class="icon iconfont icon-bianji"></i> </a> <a href="javascript:void(0);" class="roleControl text-ellipsis" roleCode="10000603" flag = \'2\' data-action="xDelete" data-key="awards" data-value="';
$out+=$escape(t.id);
$out+='" data-placeholder="删除" data-type="1" data-valid="1" style="visibility: hidden;"> <i class="fa fa-times fc-red"></i> </a> </div> <div class="content-row-item-right text-right" STYLE="color:#AEAEAE"> ';
$out+=$escape(_momentFormat(t.createDate,'YYYY/MM/DD'));
$out+=' </div> </div> </div> ';
});
$out+=' ';
}
$out+=' </div> </div> </div> </div> </div> </div> </div> ';
return new String($out);
});/*v:1*/
template('m_tips/m_tips_anniversary_card',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,companyInfo=$data.companyInfo,yearNum=$data.yearNum,userInfo=$data.userInfo,$out='';$out+='<div class="m-tips-anniversary-card"> <p class="text-center f-s-35 text-v1 text-shadow m-t-xxl">感谢您加入<span class="text-underline ">';
$out+=$escape(companyInfo.companyName);
$out+='</span>大家庭</p> <p class="text-center f-s-40 text-v1 text-shadow">';
$out+=$escape(yearNum);
$out+='&nbsp;周年</p> <p class="text-center f-s-m m-t-md">亲爱的<span class="text-underline">';
$out+=$escape(userInfo.userName);
$out+='</span>，缘分让我们相遇在<span class="text-underline">';
$out+=$escape(companyInfo.companyName);
$out+='</span>，</p> <p class="text-center f-s-m">时光飞逝，您已经入职';
$out+=$escape(companyInfo.companyName);
$out+=$escape(yearNum);
$out+='周年了。</p> <p class="text-center f-s-m">希望在未来的日子里';
$out+=$escape(companyInfo.companyName);
$out+='与</p> <p class="text-center f-s-m">您携手共创辉煌，勇攀高峰，感谢有您！</p> </div> ';
return new String($out);
});/*v:1*/
template('m_tips/m_tips_common',function($data,$filename
/**/) {
'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,_url=$helpers._url,$string=$utils.$string,option=$data.option,$out='';$out+='<div class="m"> <div class="text-center"> <img src="';
$out+=$escape(_url('/img/project/project_approval_1.png'));
$out+='" width="60"/> </div> <div class="p-sm"> ';
$out+=$string(option.tipsContent);
$out+=' </div> <div class="row"> <div class="col-sm-6"> ';
if(option.isShowCheck){
$out+=' <label class="i-checks i-checks-label m-l"> <input name="itemCk" type="checkbox"/> <span class="i-checks-span fc-dark-gray">以后不再提示</span> </label> ';
}
$out+=' </div> <div class="col-sm-6 text-right no-padding" data-type="';
$out+=$escape(option.isShowCancel);
$out+='"> ';
if(option.isShowCancel==true){
$out+=' <a class="btn btn-link" data-action="cancel">';
$out+=$escape(option.cancelText?option.cancelText:'关闭');
$out+='</a> ';
}
$out+=' <button class="btn btn-primary m-r-md" data-action="ok">';
$out+=$escape(option.okText?option.okText:'关闭');
$out+='</button> </div> </div> <div style="position: absolute;top: 20px;right: -100px;"> <span class="ic-tip-arrow"></span> </div> </div> <script> $(\'.i-checks\').iCheck({ checkboxClass: \'icheckbox_square-green\', radioClass: \'iradio_square-green\' }); </script> ';
return new String($out);
});

}()