function Router(){this.routes={},this.currentUrl="",this.before=null,this.after=null}function getParamsUrl(){for(var t=location.hash.split("?"),e=t[0].split("#")[1],n=t[1]?t[1].split("&"):[],o={},i=0;i<n.length;i++){var r=n[i].split("=");o[r[0]]=r[1]}return{path:e,query:o}}Router.prototype.route=function(t,e){this.routes[t]=e||function(){}},Router.prototype.refresh=function(){var n=this;new Promise(function(t,e){null!=n.before&&n.before(t)}).then(function(t){console.log(t+"-end");t=getParamsUrl();if(null!=t.path){n.currentUrl=t.path;try{n.routes[n.currentUrl](t.query)}catch(t){console.log(t),n.routes["/error/404"]({})}}else location.hash="/";null!=n.after&&n.after()})},Router.prototype.afterCallback=function(t){"[object Function]"===Object.prototype.toString.call(t)?this.after=t:console.trace("路由切换后回调函数不正确")},Router.prototype.beforeCallback=function(t){"[object Function]"===Object.prototype.toString.call(t)?this.before=t:console.trace("路由切换后回调函数不正确")},Router.prototype.init=function(){window.addEventListener("load",this.refresh.bind(this),!1),window.addEventListener("hashchange",this.refresh.bind(this),!1)},window.Router=new Router,window.Router.init();var preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stopPropagation=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},shortTime=function(t){return moment(t).format("HH:mm")},dateSpecFormat=function(t,e){var n=moment(new Date,"YYYY-MM-DD HH:mm:ss"),o=moment(new Date,"YYYY-MM-DD HH:mm:ss").subtract(1,"days"),i=moment(moment(t).toDate(),"YYYY-MM-DD HH:mm:ss"),r=n.format("YYYY-MM-DD"),t=o.format("YYYY-MM-DD"),n=i.format("YYYY-MM-DD"),o="",o=r==n?"今天":t==n?"昨天":n;return e&&!_.isBlank(e)?_.sprintf(e,o,i.format("HH:mm")):_.sprintf("%s %s",o,i.format("HH:mm"))},dateSpecShortFormat=function(t){var e=moment(new Date,"YYYY-MM-DD HH:mm:ss"),n=moment(new Date,"YYYY-MM-DD HH:mm:ss").subtract(1,"days"),t=moment(moment(t).toDate(),"YYYY-MM-DD HH:mm:ss"),e=e.format("YYYY-MM-DD"),n=n.format("YYYY-MM-DD"),t=t.format("YYYY-MM-DD");return e==t?"今天":n==t?"昨天":t},isNullOrBlank=function(t){return null==t||_.isBlank(t)},isNull=function(t){return void 0===t||null==t||""==t},isArrayCustom=function(t){return!!$.isArray(t)&&!(t.length<1)};function dateDiff(t,e){return t&&null!=t&&""!=t&&e&&null!=e&&""!=e?Date.parse(t.toString().replace(/-/g,"/"))-Date.parse(e.toString().replace(/-/g,"/")):0}function getNowDate(){var t=new Date;return t.getFullYear()+"-"+(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())}function getLastDay(t,e){var n=t,t=e++;12<e&&(t-=12,n++);n=new Date(n,t,1),t=new Date(n.getTime()-864e5).getDate(),new Date(n.getTime()-864e5);return t}function diffDays(t,e){t=this.dateDiff(e,t);return Math.floor(t/864e5)}!function(){function t(){}for(var e,n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],o=n.length,i=window.console=window.console||{};o--;)i[e=n[o]]||(i[e]=t)}(),$.fn.serializeObject=function(e){var n={},t=this.serializeArray();return $.each(t,function(){var t=0==e?this.value:$.trim(this.value);void 0!==n[this.name]?(n[this.name].push||(n[this.name]=[n[this.name]]),n[this.name].push(t||"")):n[this.name]=t||""}),n},String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"gm"),e)};var getPrevDateByDays=function(t,e){t=+(t=new Date(t))-864e5*e;var n=(t=new Date(t)).getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,e=t.getDate()<10?"0"+t.getDate():t.getDate();return t.getFullYear()+"-"+n+"-"+e};function getStringLength(t){for(var e=0,n=0;n<t.length;n++){var o=t.charCodeAt(n);1<=o&&o<=126||65376<=o&&o<=65439?e++:e+=2}return e}var cutString=function(t,e,n){if(isNullOrBlank(t))return"";for(var o=0,i="",r=0;r<t.length;r++){var a=t.charCodeAt(r);if(1<=a&&a<=126||65376<=a&&a<=65439?o++:o+=2,i+=t.charAt(r),e<=o)return i+n}return t};function handlePostJsonError(t){404==t.status?S_layer.error("当前请求地址未找到！"):0==t.status?S_layer.error("网络请求超时！"):S_layer.error("网络请求出现错误！status："+t.status+"，statusText："+t.statusText)}function handleResponse(t){var e=!1;return"401"==t.code?(S_layer.error("当前用户状态信息已超时!点击“确定”后返回登录界面。","提示",function(){window.location.href=window.serverPath+"/#/login"}),e=!0):"500"==t.code&&(S_layer.error("出现异常错误 !详细信息："+t.info),e=!0),e}var S_layer={dialog:function(o,i){var r=[];o.okText&&"function"==typeof o.ok&&r.push(o.okText),o.cancelText&&"function"==typeof o.cancel&&r.push(o.cancelText),o.btn&&(r=o.btn),void 0===o.btn&&0==r.length&&(r=["确定","取消"]),!1===o.btn&&(r=!1);var n={type:o.type||1,id:o.id,title:o.title||!1,skin:o.skin||"layer-new",area:o.area||"auto",maxHeight:o.maxHeight,maxWidth:o.maxWidth,offset:o.offset||"auto",icon:o.icon||null,closeBtn:null==o.closeBtn?1:o.closeBtn,shade:null==o.shade?.4:o.shade,shadeClose:o.shadeClose||!1,time:o.time||0,anim:o.anim||5,maxmin:o.maxmin||!1,fixed:o.fixed||!1,resize:o.resize||!1,scrollbar:o.scrollbar,btn:r,btn2:o.btn2||o.cancel||null,yes:function(t,e){var n=!0;!1!==(n=o.ok?o.ok():n)&&layer.close(t),1==r.length&&"function"==typeof o.cancel&&o.cancel()},cancel:function(){o.cancel&&o.cancel()},end:o.end||null,resizing:o.resizing||null,success:function(t,e){r&&1<r.length&&t.find(".layui-layer-btn .layui-layer-btn0").addClass("pull-right"),!r||1!=r.length||"关闭"!=r[0]&&"取消"!=r[0]||t.find(".layui-layer-btn .layui-layer-btn0").addClass("btn-default");var n="div.layui-layer"+t.selector+" .layui-layer-content";return i(t,e,n)},min:function(){o.min&&o.min()},full:function(){o.full&&o.full()},restore:function(){o.restore&&o.restore()}};r&&2<r.length&&$.each(r,function(t,e){if(t<2)return!0;t="btn"+(t+1);n[t]=o[t]}),o.url?$.get(o.url,{cache:!0}).success(function(t){n.content=t,layer.open(n)}).error(function(){alert("操作异常\n网络错误")}):(n.content=o.content||"",layer.open(n))},alert:function(t,e){t='<div class="text-center">'+t+"</div>",layer.alert(t,{title:e||"提示",skin:"layer-new",resize:!1})},success:function(t,e,n){t='<div style="min-width: 300px;max-width: 800px;"><div class="text-center"><i class="icon-custom icon-color-light rounded-x fa fa-check"  style="background: cadetblue"></i> <p style="font-size: 16px; padding-top: 12px">'+t+"</p></div> </div>",layer.alert(t,{title:e||"提示",skin:"layer-new",resize:!1,yes:function(t,e){n&&n(),layer.close(t)}})},error:function(t,e,n){t='<div style="min-width: 300px;max-width: 800px;"><div class="text-center"><i class="icon-custom icon-color-light rounded-x fa fa-times"  style="background: brown"></i> <p style="line-height: 3">'+t+"</p></div> </div>",layer.alert(t,{title:e||"提示",skin:"layer-new",resize:!1,yes:function(t,e){n&&n(),layer.close(t)}})},warning:function(t,e,n){t='<div style="min-width: 300px;max-width: 800px;"><div class="text-center"><i class="icon-custom icon-color-light rounded-x fa fa-exclamation-triangle" style="background: darkgoldenrod"></i> <p style="line-height: 3">'+t+"</p></div> </div>",layer.alert(t,{title:e||"提示",skin:"layer-new",resize:!1,yes:function(t,e){n&&n(),layer.close(t)}})},info:function(t,e){t='<div style="min-width: 300px;max-width: 800px;"><div class="text-center"><i class="icon-custom icon-color-light rounded-x fa fa-info" style="background: cornflowerblue"></i> <p style="line-height: 3">'+t+"</p></div> </div>",layer.alert(t,{title:e||"提示",skin:"layer-new",resize:!1})},tips:function(t){layer.msg(t)},confirm:function(t,e,n){t='<div class="text-center p-sm">'+(t||"您确定要操作吗?")+"</div>",layer.confirm(t,{title:"提示",skin:"layer-new",resize:!1,success:function(t,e){t.find(".layui-layer-btn .layui-layer-btn0").addClass("pull-right")}},function(t){e&&e(),layer.close(t)},function(t){n&&n(),layer.close(t)})},close:function(t,e){null==t?layer.closeAll():(t=t.parents(".layui-layer").attr("times"),layer.close(t)),e&&e()},resize:function(t,c,e,l){var n=$(e).closest(".layui-layer"),o=$(e).find(".m-dialog-resize").eq(0);0==o.length&&(o=$(e).children().eq(0)),isNullOrBlank(l)&&(l=0),o.off("resize.m-dialog-resize");function i(t,e){var n=$(window).height(),o=e.outerHeight();e.scrollTop(10),0<e.scrollTop()&&(o=e[0].scrollHeight),e.scrollTop(0);var i,r,a=n,s=o;0<t.find(".layui-layer-title").length&&(s+=42,a-=42),0<t.find(".layui-layer-btn").length&&(s+=53,a-=53),e.hasClass("m-dialog-resize")?((i=0)<e.siblings().length&&e.siblings().each(function(){$(this).css("position");i+=$(this).outerHeight()}),a-=i,(s+=i)+l<n?(r=n-s-l,layer.style(c,{top:r/2+"px",height:s+l+"px"}),e.css("height",o+"px"),0<l&&e.parent().css("height",o+i+"px")):n<=s+l&&(layer.style(c,{top:"0px",height:n+"px"}),e.css("height",a-l+"px"),0<l&&e.parent().css("height",a-l+i+"px"))):s<n?(r=n-s,layer.style(c,{top:r/2+"px",height:s+"px"})):n<=s&&layer.style(c,{top:"0px",height:n+"px"})}var r=setTimeout(function(){i(n,o),o.on("resize.m-dialog-resize",function(t){i(n,o)}),clearTimeout(r)},20)},photos:function(t,e,n){layer.photos({photos:{title:"",id:1,start:e,data:t},shift:5,tab:function(t,e){n&&n(t,e)}})}},S_loading={show:function(t,e){null==t&&(t="body"),null!=e&&""!=e||(e="正在请求中..."),$(t).eq(0).block({message:e,baseZ:"19891099"})},close:function(t){$(t).eq(0).unblock()}},S_toastr={success:function(t){toastr.options={closeButton:!1,debug:!1,progressBar:!1,preventDuplicates:!1,positionClass:"toast-top-center",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"2000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success(t)},warning:function(t){toastr.options={closeButton:!1,debug:!1,progressBar:!1,preventDuplicates:!1,positionClass:"toast-top-center",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"2000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.warning(t)},info:function(t){toastr.options={closeButton:!1,debug:!1,progressBar:!1,preventDuplicates:!1,positionClass:"toast-top-center",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"2000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.info(t)},error:function(t){toastr.options={closeButton:!1,debug:!1,progressBar:!1,preventDuplicates:!1,positionClass:"toast-top-center",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"2000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.error(t)}},m_ajax={get:function(e,n,o){$.ajax({type:e.type||"GET",url:e.url,cache:!1,beforeSend:function(){if(e.classId&&S_loading.show(e.classId,"正在请求中..."),e.bindDisabled){var t=$(e.bindDisabled);if(0<t.length){try{t.attr("disabled",!0)}catch(t){}try{t.prop("disabled",!0)}catch(t){}}}},success:function(t){handleResponse(t)||(dealIsCurrentCompany(t),n&&n(t))},error:function(t){o&&o(),handlePostJsonError(t)},complete:function(){e.classId&&S_loading.close(e.classId),e.bindDisabled&&setTimeout(function(){var t=$(e.bindDisabled);if(0<t.length){try{t.attr("disabled",!1)}catch(t){}try{t.prop("disabled",!1)}catch(t){}}},1e3)}})},getNoDialog:function(e,n,o){$.ajax({type:e.type||"GET",url:e.url,cache:!1,beforeSend:function(){if(e.classId&&e.bindDisabled){var t=$(e.bindDisabled);if(0<t.length){try{t.attr("disabled",!0)}catch(t){}try{t.prop("disabled",!0)}catch(t){}}}},success:function(t){handleResponse(t)||n&&n(t)},error:function(t){o&&o()},complete:function(){e.bindDisabled&&setTimeout(function(){var t=$(e.bindDisabled);if(0<t.length){try{t.attr("disabled",!1)}catch(t){}try{t.prop("disabled",!1)}catch(t){}}},1e3)}})},getJson:function(e,n,o){$.ajax({type:"GET",url:e.url,cache:!1,contentType:"application/json",beforeSend:function(){if(e.classId&&S_loading.show(e.classId,"正在请求中..."),e.bindDisabled){var t=$(e.bindDisabled);if(0<t.length){try{t.attr("disabled",!0)}catch(t){}try{t.prop("disabled",!0)}catch(t){}}}},success:function(t){handleResponse(t)||(dealIsCurrentCompany(t),n&&n(t))},error:function(t){o&&o(),handlePostJsonError(t)},complete:function(){e.classId&&S_loading.close(e.classId),e.bindDisabled&&setTimeout(function(){var t=$(e.bindDisabled);if(0<t.length){try{t.attr("disabled",!1)}catch(t){}try{t.prop("disabled",!1)}catch(t){}}},1e3)}})},post:function(e,n,o){$.ajax({type:"POST",url:e.url,data:e.postData,cache:!1,beforeSend:function(){if(e.classId&&S_loading.show(e.classId,"正在请求中..."),e.bindDisabled){var t=$(e.bindDisabled);if(0<t.length){try{t.attr("disabled",!0)}catch(t){}try{t.prop("disabled",!0)}catch(t){}}}},success:function(t){handleResponse(t)||(dealIsCurrentCompany(t),n&&n(t))},error:function(t){o&&o(),handlePostJsonError(t)},complete:function(){e.classId&&S_loading.close(e.classId),e.bindDisabled&&setTimeout(function(){var t=$(e.bindDisabled);if(0<t.length){try{t.attr("disabled",!1)}catch(t){}try{t.prop("disabled",!1)}catch(t){}}},1e3)}})},postJson:function(e,n,o){$.ajax({type:"POST",url:e.url,cache:!1,async:null==e.async||e.async,data:JSON.stringify(e.postData),contentType:"application/json",beforeSend:function(){if(e.classId&&S_loading.show(e.classId,"正在请求中..."),e.bindDisabled){var t=$(e.bindDisabled);if(0<t.length){try{t.attr("disabled",!0)}catch(t){}try{t.prop("disabled",!0)}catch(t){}}}},success:function(t){handleResponse(t)||(dealIsCurrentCompany(t),n&&n(t))},error:function(t){o&&o(),!0!==e.ignoreError&&handlePostJsonError(t)},complete:function(){e.classId&&S_loading.close(e.classId),e.bindDisabled&&setTimeout(function(){var t=$(e.bindDisabled);if(0<t.length){try{t.attr("disabled",!1)}catch(t){}try{t.prop("disabled",!1)}catch(t){}}},1e3)}})},delete:function(e,n,o){$.ajax({type:"DELETE",url:e.url,cache:!1,data:JSON.stringify(e.postData),contentType:"application/json",beforeSend:function(){if(e.classId&&S_loading.show(e.classId,"正在请求中..."),e.bindDisabled){var t=$(e.bindDisabled);if(0<t.length){try{t.attr("disabled",!0)}catch(t){}try{t.prop("disabled",!0)}catch(t){}}}},success:function(t){handleResponse(t)||(dealIsCurrentCompany(t),n&&n(t))},error:function(t){o&&o(),handlePostJsonError(t)},complete:function(){e.classId&&S_loading.close(e.classId),e.bindDisabled&&setTimeout(function(){var t=$(e.bindDisabled);if(0<t.length){try{t.attr("disabled",!1)}catch(t){}try{t.prop("disabled",!1)}catch(t){}}},1e3)}})}};function dealIsCurrentCompany(t){null!=t.extendData&&null!=t.extendData.currentCompanyId&&null!=window.currentCompanyId&&t.extendData.currentCompanyId!=window.currentCompanyId&&1!=t.extendData.switchFlag&&$("#m_top").m_top({})}function paginationFun(n,e){var t=n.$page;(t=null==t||0==t.length?$(n.eleId):t).pagination()&&t.pagination("destroy"),t.pagination({remote:{url:n.url,totalName:"data.total",params:n.params,success:function(t){dealIsCurrentCompany(t),e(t)},remoteWrongFormat:function(t){handleResponse(t)},beforeSend:function(t){S_loading.show(n.loadingId,"正在加载中...")},complete:function(t,e){S_loading.close(n.loadingId),200!=t.status&&S_layer.error("error！status："+t.status),t.responseJSON&&"1"==t.responseJSON.code&&S_layer.error(t.responseJSON.info)}},pageSize:n.pageSize||10,prevBtnText:"上一页",nextBtnText:"下一页",pageIndex:n.params.pageIndex||n.pageIndex||0,debug:!1})}function addNodeByTree(t,e,n,o){null==n&&(n=window.currentCompanyId),null!=t.departName&&""!=t.departName?t.text=t.departName:null!=t.companyName&&""!=t.companyName&&(t.text=t.companyName),t.realId=t.id;var i=$("#organization_treeH").jstree(!0),r=i.get_selected();if(!(r=1==o?e.id.split(","):r).length)return!1;r=r[0],o=e.id,e=0;0<$('li[id="'+o+'"]').children("ul").length?(e=$('li[id="'+o+'"]').children("ul").children("li").length,0<$('li[id="'+o+'"]').children("ul").find('li[id="'+n+'subCompanyId"]').length&&e--,0<$('li[id="'+o+'"]').children("ul").find('li[id="'+n+'partnerId"]').length&&e--,e<0&&(e="last")):e="last",t.parent=r,(r=i.create_node(r,t,e))&&i.edit()}function editNodeByTree(t,e){var n=$("#organization_treeH").jstree(!0),o=n.get_selected(!0)[0];n.set_text(o,t.text),n.set_type(o,t.type),o.original=t,1==e&&$("#organization_treeH li#"+o.id+" a").click()}function delNodeByTree(){var t=$("#organization_treeH").jstree(!0),e=t.get_selected();if(!e.length)return!1;t.delete_node(e)}function addNodeByTreeOfPartner(t,e){var n,o=e;2==t&&0<$('a[id="'+o+'partnerId_anchor"]').length||1==t&&0<$('a[id="'+o+'subCompanyId_anchor"]').length||(e=(n=$("#organization_treeH").jstree(!0)).get_node(o),n.create_node(e,2==t?{text:"事业合伙人",type:"partnerContainer",id:o+"partnerId",realId:o+"partnerId"}:{text:"分支机构",type:"subCompanyContainer",id:o+"subCompanyId",realId:o+"subCompanyId"}))}function addNodeByTreeByRoot(t,e){null!=t.departName&&""!=t.departName?t.text=t.departName:null!=t.companyName&&""!=t.companyName&&(t.text=t.companyName),t.realId=t.id;var n=$("#organization_treeH").jstree(!0),e=n.get_node(e);n.create_node(e,t)}function m_inputProcessTime_onpicked(t){var e=$("form.inputTimeOBox").find(".startTime:eq(0)"),n=$("form.inputTimeOBox").find(".endTime:eq(0)");0<e.length&&0<n.length&&(e=e.val(),n=n.val(),null===e||_.isBlank(e)||null===n||_.isBlank(n)?$("form.inputTimeOBox").find(".dayCount:eq(0)").val(0):$("form.inputTimeOBox").find(".dayCount:eq(0)").val(moment(n).diff(moment(e),"days")+1))}function startTimeFun(t,e){var n=$(t).attr("data-id"),o=$(t).attr("data-appointmentStartTime");null==n&&(n="");var i,r=$(t).closest("form").find("#ipt_endTime"+n).attr("data-appointmentEndTime");""==$(t).closest("form").find("#ipt_endTime"+n).val()&&(i=r),WdatePicker({minDate:o,maxDate:i||"#F{$dp.$D('ipt_endTime"+n+"')||'2099-10-01'}",onpicked:function(t){e&&e(t)}})}function startTimeLimitFun(t,e){var n=$(t).attr("data-id"),o=null==$(t).attr("data-appointmentStartTime")||""==$(t).attr("data-appointmentStartTime")?"2021-01-01":$(t).attr("data-appointmentStartTime");null==n&&(n="");var i,r=$(t).closest("form").find("#ipt_endTime"+n).attr("data-appointmentEndTime");""==$(t).closest("form").find("#ipt_endTime"+n).val()&&(i=r),WdatePicker({minDate:o,maxDate:i||"#F{$dp.$D('ipt_endTime"+n+"')||'2099-10-01'}",onpicked:function(t){e&&e(t)}})}function endTimeFun(t,e){var n=$(t).attr("data-id"),o=$(t).attr("data-appointmentEndTime");null==n&&(n="");var i,r=$(t).closest("form").find("#ipt_startTime"+n).attr("data-appointmentStartTime");""==$(t).closest("form").find("#ipt_startTime"+n).val()&&(i=r),WdatePicker({minDate:i||"#F{$dp.$D('ipt_startTime"+n+"')}",maxDate:o||"2099-10-01",onpicked:function(t){e&&e(t)}})}function endTimeLimitFun(t,e){var n=$(t).attr("data-id"),o=$(t).attr("data-appointmentEndTime");null==n&&(n="");var i,r=$(t).closest("form").find("#ipt_startTime"+n).attr("data-appointmentStartTime");""==$(t).closest("form").find("#ipt_startTime"+n).val()&&(i=null==r||""==r?"2021-01-01":r),WdatePicker({minDate:i||"#F{$dp.$D('ipt_startTime"+n+"')}",maxDate:o||"2099-10-01",onpicked:function(t){e&&e(t)}})}function timeDiffTime(t,e){return moment(e).diff(moment(t),"days")+1}function rolesControl(){var i=window.currentRoleCodes;null==i&&(i=""),i+=",",$(".roleControl[roleCode]").each(function(){var t=$(this),e=t.attr("roleCode").split(","),n=t.attr("flag"),o=!1;$.each(e,function(t,e){if(-1<i.indexOf(e+","))return o=!0}),o||(1==n?t.parent().html("***"):2==n?t.remove():3==n?t.hide():4==n?(t.attr("data-action",""),t.bind("click",function(){return S_toastr.warning("你暂无该操作权限！"),!1})):5==n?(t.removeClass("editable").removeClass("editable-click").removeClass("editable-empty").addClass("a-v1"),t.unbind("click")):6==n?o?t.remove():t.parent().html("***"):7==n?t.parent().html("***"):t.remove())})}function proNumberFilter(t){if(null==t||isNaN(t)||""==t)return t="***"!=t?"0":t;var e=parseFloat(Number(t).toFixed(6));if(0<String(e.toString()).indexOf(".")){t=e.toString().substring(String(e).indexOf("."),e.toString().length);return e.toString().substring(0,String(e).indexOf(".")).replace(/\B(?=(?:\d{3})+$)/g,",")+""+t}return e.toString().substring(0,e.toString().length).replace(/\B(?=(?:\d{3})+$)/g,",")}function expNumberFilter(t){var e,n;return null==t||isNaN(t)||""==t?"***"!=t&&(t="0.00"):(-1<(t=t.toString()).indexOf(".")?(n=t.split(".")[0],e=t.split(".")[1].length<2?t.split(".")[1]+0:t.split(".")[1]):n=t,n=n.replace(/\B(?=(?:\d{3})+$)/g,","),t=e&&""!=e?n+"."+e:n+".00"),t}function stringCtrl(t,e,n){limitString(t,e,n),$(window).resize(function(){limitString(t,e,n)})}function limitString(t,u,d){t.each(function(){var t=$(this),e=null==u?t.parent().width():u,n=t.width(),o=0,i=10,r=t.attr("data-string");if(null==r||""==r)return!0;if(d&&(t.attr({"data-toggle":"tooltip","data-placement":"top","data-original-title":r,"data-container":"body"}),t.tooltip({trigger:"hover"})),0<t.prevAll().length&&t.prevAll().each(function(){o+=$(this).outerWidth()}),0<t.nextAll().length&&t.nextAll().each(function(){0<$(this).outerWidth()&&(i+=$(this).outerWidth()+10)}),e<=n+o+i+10||$.trim(r)!=$.trim(t.text()))for(var a,s="",c=0;c<r.length;c++){var l=r.charCodeAt(c);if(1<=l&&l<=126||65376<=l&&l<=65439?0:0,s+=r.charAt(c),(0<t.find("a").length?t.find("a"):t).text(s),(a=t.outerWidth())&&e-o-i<=a+20||c>=r.length)return(0<t.find("a").length?t.find("a"):t).text(s+"...")}})}function decimal(t,e){e=Math.pow(10,e);return Math.round(t*e)/e}var countDigits=function(t,e){var n=(+t).toString().split("."),t=0;return t=1<n.length?n[1].length<e?n[1].length:e:t},regularExpressions={mobile:/^[1-9]\d{10}$/,phone:/((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/,number:/^[+-]?(\d|[1-9]\d+)(\.\d+)?$/,pnumber:/^\d+(([.]\d{1,6})?)$/,proportionnumber:/^\d+(([.]\d{1,2})?)$/,numberWithPoints_2:/^[+-]?\d+(([.]\d{1,2})?)$/,numberWithPoints_3:/^[+-]?\d+(([.]\d{1,3})?)$/,numberWithPoints_4:/^[+-]?\d+(([.]\d{1,4})?)$/,numberWithPoints_6:/^[+-]?\d+(([.]\d{1,6})?)$/,numberWithPercentagePoints_3:/^(\d|[1-9]\d|100)(\.\d{1,3})?%$/,specialCharacters:/["'<>%;)(&+-,`~!@#$^&*?]/,cleanSpecialChar:function(t){regularExpressions.specialCharacters.test(t.value)&&$(t).val(t.value.replaceAll(regularExpressions.specialCharacters,""))}},doMath={accSub:function(t,e){var n,o;try{n=t.toString().split(".")[1].length}catch(t){n=0}try{o=e.toString().split(".")[1].length}catch(t){o=0}return((t*(t=Math.pow(10,Math.max(n,o)))-e*t)/t).toFixed(o<=n?n:o)},accAdd:function(t,e){var n,o;try{n=t.toString().split(".")[1].length}catch(t){n=0}try{o=e.toString().split(".")[1].length}catch(t){o=0}return(t*(o=Math.pow(10,Math.max(n,o)))+e*o)/o}};Number.prototype.sub=function(t){return parseFloat(doMath.accSub(this,t))},Number.prototype.add=function(t){return parseFloat(doMath.accAdd(this,t))};var formatFileSize=function(t){var e;return null==t?"":t<1024?t+"B":t<1048576?(e=parseFloat(t/1024).toFixed(3)).substring(0,e.length-1)+"KB":t<1073741824?(e=parseFloat(t/1048576).toFixed(3)).substring(0,e.length-1)+"MB":(e=parseFloat(t/1073741824).toFixed(3)).substring(0,e.length-1)+"GB"};String.prototype.getTextWH=function(t){var e=$("<span>"+this+"</span>");e.css($.extend({},t,{display:"none"})),$("body").append(e);t={width:e.width(),height:e.height()};return e.remove(),t};var setDialogWH=function(t,e){return{width:600<t?200:t,height:400<e?200:e}},momentFormat=function(t,e){if("A"!=e)return"B"==e?new Date(Date.parse(t.replace(/\//g,"-"))):moment(t).isValid()?moment(t).locale("zh-cn").format(e):"";t=new Date(Date.parse(t.replace(/-/g,"/")));return t.getHours()<=12?t.getFullYear().toString()+"/"+(t.getMonth()+1).toString()+"/"+t.getDate().toString()+" 上午":t.getFullYear().toString()+"/"+(t.getMonth()+1).toString()+"/"+t.getDate().toString()+" 下午"},getObjectInArray=function(t,n,o){if(isNullOrBlank(t))return null;if(isNullOrBlank(n))return null;null==o&&(o="id");var i=null;return t&&0<t.length&&$.each(t,function(t,e){if(e[o]===n)return i=e,!1}),i},delObjectInArray=function(t,e){var n=e;if("function"==typeof e)for(var o=0;o<t.length;o++)e(t[o],o)&&(n=o);t.splice(n,1)},filterParam=function(t){var n={};return null!=t&&0<Object.getOwnPropertyNames(t).length&&$.each(t,function(t,e){isNullOrBlank(e)||(n[t]=e)}),n},delItemByList=function(n,o,i){return null!=n&&0<n.length&&$.each(n,function(t,e){if(e[o]==i)return n.splice(t,1),!1}),n},replaceItemNameByList=function(t,n,o,i){return null!=t&&0<t.length&&$.each(t,function(t,e){if(e[n]==o)return e.name=i,!1}),t},sortList=function(t,e,n){for(var o=[],i=0;i<n.length;i++)t<e?i<t?o.push(n[i]):t<=i&&i<e?o.push(n[i+1]):i==e?o.push(n[t]):o.push(n[i]):i<e?o.push(n[i]):i==e?o.push(n[t]):e<i&&i<=t?o.push(n[i-1]):o.push(n[i]);return o},downLoadFile=function(t){if(1==t.type){var e,n=$.extend(!0,{method:"post"},t),o=$('<iframe id="down-file-iframe" />'),i=$('<form target="down-file-iframe" method="'+n.method+'" accept-charset="UTF-8" enctype="application/x-www-form-urlencoded" />');for(e in i.attr("action",n.url),n.data)i.append('<input type="hidden" name="'+e+'" value="'+n.data[e]+'" />');o.append(i),$(document.body).append(o),i[0].submit(),o.remove()}else{var r=$("iframe.down-file-iframe").length,o=$("iframe#down-file-iframe"+r),o=$('<iframe class="down-file-iframe" id="down-file-iframe'+r+'" style="display: none;"/>');$(document.body).append(o),o.attr("src",t.url)}},removeParamCookies=function(t){null!=t&&0<t.length&&$.each(t,function(t,e){Cookies.remove("cookiesData_"+e)})},removeCookiesOnLoginOut=function(){removeParamCookies(["myProjectList","projectOverview","metismenu"])},setProjectParamCookies=function(t,e,n,o){var i=null==(i=Cookies.get(t))?[]:$.parseJSON(i),r=getObjectInArray(i,n);isNullOrBlank(r)||delObjectInArray(i,function(t){return t.id==n}),i.push(e),isNullOrBlank(o)&&(o=5),i.length>o&&i.splice(0,1),Cookies.set(t,i)},getProjectParamCookies=function(t,e){if(null==(t=Cookies.get(t)))return null;t=$.parseJSON(t);return getObjectInArray(t,e)},getUrlParamStr=function(t,e){var n="";return $.each(e,function(t,e){null!=e&&(n=n+"&"+t+"="+e)}),t+"?"+n},convertImgToBase64=function(t,e,n){var o=document.createElement("CANVAS"),i=o.getContext("2d"),r=new Image;r.crossOrigin="Anonymous",r.onload=function(){o.height=r.height,o.width=r.width,i.drawImage(r,0,0);var t=o.toDataURL(n||"image/png");e.call(this,t),o=null},r.src=t},checkSupportWebp=function(){try{return 0==document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch(t){return!1}},icon_list_form=[{id:"icon-zidingyibankuai",color:"bg-v1-purple"},{id:"icon-baoxiao",color:"bg-v1-yellow"},{id:"icon-qianbao",color:"bg-v1-yellow"},{id:"icon-rili",color:"bg-v2-blue"},{id:"icon-gongwenbao",color:"bg-v2-blue"},{id:"icon-renyuan",color:"bg-v2-blue"},{id:"icon-gengduogongneng",color:"bg-v1-purple"},{id:"icon-shuju",color:"bg-v1-yellow"},{id:"icon-wenjian",color:"bg-v1-purple"},{id:"icon-zhangdan",color:"bg-v1-yellow"},{id:"icon-hangzheng",color:"bg-v1-purple"},{id:"icon-gongneng",color:"bg-v2-blue"},{id:"icon-zhupiaopiaoicon-",color:"bg-v1-yellow"},{id:"icon-hangzhenghuafen",color:"bg-v1-purple"},{id:"icon-caiwu",color:"bg-v1-yellow"},{id:"icon-caiwu1",color:"bg-v2-blue"},{id:"icon-caiwu2",color:"bg-v1-yellow"},{id:"icon-caiwu3",color:"bg-v1-yellow"},{id:"icon-caiwu4",color:"bg-v1-yellow"},{id:"icon-caiwu5",color:"bg-v2-blue"},{id:"icon-tongji",color:"bg-v1-yellow"},{id:"icon-diannao",color:"bg-v2-blue"},{id:"icon-qiyeyunicon-",color:"bg-v1-purple"},{id:"icon-hangzhengguanli1",color:"bg-v1-purple"},{id:"icon-teshudanwei",color:"bg-v2-blue"},{id:"icon-hangzhengchufa",color:"bg-v2-blue"},{id:"icon-qushi",color:"bg-v1-yellow"},{id:"icon-hangzhengquhua",color:"bg-v1-purple"},{id:"icon-hetong",color:"bg-v2-blue"},{id:"icon-hangzhengguanli",color:"bg-v1-purple"},{id:"icon-hangzheng1",color:"bg-v2-blue"},{id:"icon-icon-power-shield",color:"bg-v1-purple"},{id:"icon-tongji1",color:"bg-v1-yellow"},{id:"icon-xiangmu1",color:"bg-v2-blue"}],leftBoxHeightResize=function(t,e,n,o,i){this.$target=t,this.$left=e,this.$right=n,this.intervalH=o,this.isLeftScroll=i,this.setHeight=function(){var r=this,a=setTimeout(function(){r.$target.removeAttr("style");var t=$(".navbar.navbar-static-top").height(),e=$("nav.navbar-default").height(),n=r.$right.height(),o=r.$left.height(),i=$(window).height()-t-r.intervalH;n<o&&r.$target.css("height",o+"px"),o<=n&&r.$target.css("height",n+10+"px"),o<=i&&n<=i&&r.$target.css("height",i+"px"),o<=e-r.intervalH&&n<=e-r.intervalH&&e>=$(window).height()-t&&r.$target.css("height",e-r.intervalH+"px"),(null==r.isLeftScroll||1==r.isLeftScroll)&&n<o&&o>e-r.intervalH&&i<o&&r.$target.css("height",(i<n?n:i)+"px"),clearTimeout(a)},400)},this.resize=function(){var t=this;$(window).resize(function(){t.setHeight()})},this.init=function(){this.setHeight(),this.resize()}};function Decrypt(t){var e=CryptoJS.enc.Utf8.parse("1234123412ABCDEF"),n=CryptoJS.enc.Utf8.parse("ABCDEF1234123412"),t=CryptoJS.enc.Hex.parse(t),t=CryptoJS.enc.Base64.stringify(t);return CryptoJS.AES.decrypt(t,e,{iv:n,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}).toString(CryptoJS.enc.Utf8).toString()}function Encrypt(t){var e=CryptoJS.enc.Utf8.parse("1234123412ABCDEF"),n=CryptoJS.enc.Utf8.parse("ABCDEF1234123412"),t=CryptoJS.enc.Utf8.parse(t);return CryptoJS.AES.encrypt(t,e,{iv:n,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}).ciphertext.toString().toUpperCase()}function dragBar(i,r,e){var i="."+i,r="."+r,a=!1;function n(t){var e=$(r).offset().left,n=t.pageX,o=$(i).width(),t=n-e;n-e>$(i).width()&&(t=o),$(r).width(t),a=!0}$(i).mousedown(function(t){n(t)}),$(i).mouseup(function(){var t=$(i).width(),t=(100*$(r).width()/t).toFixed(2);return e&&1==a&&e(t),a=!1}),$(i).mousemove(function(t){!0===a&&n(t)})}!function(a,e){var n,o=a([]),i=a.resize=a.extend(a.resize,{}),s="setTimeout",r="resize",c=r+"-special-event",l="throttleWindow";i.delay=250,i[l]=!0,a.event.special[r]={setup:function(){if(!i[l]&&this[s])return!1;var t=a(this);o=o.add(t),a.data(this,c,{w:t.width(),h:t.height()}),1===o.length&&function t(){n=e[s](function(){o.each(function(){var t=a(this),e=t.width(),n=t.height(),o=a.data(this,c);e===o.w&&n===o.h||t.trigger(r,[o.w=e,o.h=n])}),t()},i.delay)}()},teardown:function(){if(!i[l]&&this[s])return!1;var t=a(this);o=o.not(t),t.removeData(c),o.length||clearTimeout(n)},add:function(t){return!(!i[l]&&this[s])&&(a.isFunction(t)?(r=t,e):(r=t.handler,void(t.handler=e)));var r;function e(t,e,n){var o=a(this),i=a.data(this,c);i.w=void 0!==e?e:o.width(),i.h=void 0!==n?n:o.height(),r.apply(this,arguments)}}}}(jQuery,this),function(o){o.fn.extend({getCurPos:function(){var t,e="";return-1<navigator.userAgent.indexOf("MSIE")?("TEXTAREA"==o(this).get(0).tagName?(e=document.body.createTextRange()).moveToElementText(o(this).get(0)):e=o(this).get(0).createTextRange(),o(this).focus(),(t=document.selection.createRange()).moveEnd("character",-t.text.length),t.setEndPoint("StartToStart",e),t.text.length):(o(this).focus(),o(this).get(0).selectionStart)},setCurPos:function(t,e){var n;-1<navigator.userAgent.indexOf("MSIE")?(n="","TEXTAREA"==o(this).get(0).tagName?(n=document.body.createTextRange()).moveToElementText(o(this).get(0)):n=o(this).get(0).createTextRange(),o(this).focus(),n.moveStart("character",t),n.moveEnd("character",-(n.text.length-(e-t))),n.select()):(o(this).focus(),o(this).get(0).setSelectionRange(t,e))}})}(jQuery);var app={contentEle:"#content-right",init:function(){this.initRoute(),math.config({number:"BigNumber"})},renderTop:function(){$("#m_top").m_top()},renderBottom:function(){var t=template("m_common/m_bottom",{});$("#m_bottom").html(t);t={ignoreError:!0,url:restApi.url_getCompanyDiskInfo,postData:{companyId:window.currentCompanyId}};m_ajax.postJson(t,function(t){var e;"0"===t.code&&(e=parseFloat(t.data.totalSize),t=parseFloat(t.data.freeSize),e=_.sprintf("已使用：%s&nbsp;&nbsp;总容量：%s",formatFileSize(e-t),formatFileSize(e)),$("#footDiskInfo").html(e))})},initRoute:function(){var e=this;Router.route("/",function(){e.projectList("projectOverview")}),Router.route("/myProjectList",function(t){e.projectList("myProjectList",t)}),Router.route("/studyProjectList",function(t){e.projectList("myProjectList",t)}),Router.route("/projectOverview",function(t){e.projectList("projectOverview",t)}),Router.route("/studyProjectOverview",function(t){e.projectList("projectOverview",t)}),Router.route("/projectSection",function(t){e.projectSection(t,"projectSection")}),Router.route("/studyProjectSection",function(t){e.projectSection(t,"projectSection")}),Router.route("/studyProjectSection/details",function(t){e.projectSectionDetails(t,"projectSection")}),Router.route("/projectSection/details",function(t){e.projectSectionDetails(t,"projectSection")}),Router.route("/addProject",function(){e.addProject()}),Router.route("/projectDynamics",function(){$(e.contentEle).m_project_dynamics({},!0)}),Router.route("/projectDynamicsAll",function(){$(e.contentEle).m_project_dynamics_all({},!0)}),Router.route("/partyBuild",function(t){$(e.contentEle).m_party_build({},!0)}),Router.route("/myTask",function(t){e.myTask(t)}),Router.route("/myTask/details",function(t){e.myTaskDetails(t)}),Router.route("/myTask/design",function(t){e.myTask(t,"design")}),Router.route("/lightTask",function(t){e.lightTask(t)}),Router.route("/projectTask",function(t){$(e.contentEle).m_task_by_project()}),Router.route("/lightProject",function(t){e.lightProject(t,"lightProject")}),Router.route("/lightProject/detail",function(t){e.lightProject(t,"lightProject/detail")}),Router.route("/lightProject/addTemp",function(t){e.lightProject(t,"lightProject/addTemp")}),Router.route("/technologySync",function(t){e.technologySync(t)}),Router.route("/project/basicInfo",function(t){e.project(t,"basicInfo")}),Router.route("/project/basicInfoFromStats",function(t){e.project(t,"basicInfo")}),Router.route("/project/taskIssue",function(t){e.project(t,"taskIssue")}),Router.route("/project/taskIssue/details",function(t){e.project(t,"taskIssue/details")}),Router.route("/project/taskIssue/projectDetails",function(t){e.project(t,"taskIssue/projectDetails")}),Router.route("/project/production",function(t){e.project(t,"production")}),Router.route("/project/production/details",function(t){e.project(t,"production/details")}),Router.route("/project/production/professionalDetails",function(t){e.project(t,"production/professionalDetails")}),Router.route("/project/production/approvalOpinionDetail",function(t){e.project(t,"production/approvalOpinionDetail")}),Router.route("/project/production/processSettings",function(t){e.project(t,"production/processSettings")}),Router.route("/project/production/processSettings/list",function(t){e.project(t,"production/processSettings/list")}),Router.route("/project/production/processSettings/info",function(t){e.project(t,"production/processSettings/info")}),Router.route("/project/taskIssue/processSettings",function(t){e.project(t,"taskIssue/processSettings")}),Router.route("/project/taskIssue/processSettings/list",function(t){e.project(t,"taskIssue/processSettings/list")}),Router.route("/project/taskIssue/processSettings/info",function(t){e.project(t,"taskIssue/processSettings/info")}),Router.route("/project/production/processSettings/edit",function(t){e.project(t,"production/processSettings/edit")}),Router.route("/project/incomeExpenditure",function(t){e.project(t,"incomeExpenditure")}),Router.route("/project/projectDocumentLib",function(t){e.project(t,"projectDocumentLib")}),Router.route("/project/projectMember",function(t){e.project(t,"projectMember")}),Router.route("/project/externalCooperation",function(t){e.project(t,"externalCooperation")}),Router.route("/project/cost",function(t){e.project(t,"cost")}),Router.route("/paymentsDetail",function(){e.paymentsDetail()}),Router.route("/paymentsDetail/ledger",function(){e.paymentsDetail("ledger")}),Router.route("/paymentsDetail/ledger2",function(){e.paymentsDetail("ledger2")}),Router.route("/paymentsDetail/ledger3",function(){e.paymentsDetail("ledger3")}),Router.route("/paymentsDetail/ledger4",function(){e.paymentsDetail("ledger4")}),Router.route("/receivable",function(){e.receivable("receivable")}),Router.route("/payable",function(){e.payable("payable")}),Router.route("/projectCostDetail",function(){e.projectCostDetail()}),Router.route("/projectCostDetail/table1",function(){e.projectCostDetail("table1")}),Router.route("/projectCostDetail/table2",function(){e.projectCostDetail("table2")}),Router.route("/projectCostDetail/table3",function(){e.projectCostDetail("table3")}),Router.route("/projectCostDetail/table4",function(){e.projectCostDetail("table4")}),Router.route("/paymentsStatistics",function(){e.paymentsStatistics()}),Router.route("/profitStatement",function(){e.profitStatement()}),Router.route("/financeSettings",function(){e.financeSettings()}),Router.route("/financeSettings/costCategory",function(t){e.financeSettings(t,"costCategory")}),Router.route("/financeSettings/costBasic",function(t){e.financeSettings(t,"costBasic")}),Router.route("/financeConfirm",function(){e.financeConfirm()}),Router.route("/financeConfirm/feeEntry",function(t){e.financeConfirm("feeEntry",t)}),Router.route("/financeConfirm/billing",function(t){e.financeConfirm("billing",t)}),Router.route("/financeConfirm/projectReceipt",function(t){e.financeConfirm("projectReceipt",t)}),Router.route("/financeConfirm/projectPayment",function(t){e.financeConfirm("projectPayment",t)}),Router.route("/financeConfirm/approvalPayment",function(t){e.financeConfirm("approvalPayment",t)}),Router.route("/financeConfirm/approvalExp",function(t){e.financeConfirm("approvalExp",t)}),Router.route("/financeConfirm/singleFundChange",function(t){e.financeConfirm("singleFundChange",t)}),Router.route("/invoiceSummary",function(){e.invoiceSummary()}),Router.route("/salary",function(){e.salaryMgt("employeeSalary")}),Router.route("/salary/employeeSalary",function(){e.salaryMgt("employeeSalary")}),Router.route("/salary/employeeSalary/details",function(t){e.salaryMgt("employeeSalary/details",t)}),Router.route("/salary/salaryCalculationTable",function(){e.salaryMgt("salaryCalculationTable")}),Router.route("/salary/salaryTaxTable",function(){e.salaryMgt("salaryTaxTable")}),Router.route("/salary/salaryReport",function(){e.salaryMgt("salaryReport")}),Router.route("/orgInfomationShow",function(){e.orgInfomationShow()}),Router.route("/addressBook",function(){e.addressBook()}),Router.route("/projectArchiving",function(){e.projectArchiving()}),Router.route("/approval",function(){e.approval("applied")}),Router.route("/approvalInitiate",function(t){e.initiateApproval()}),Router.route("/approval/applied",function(t){e.approval("applied",t)}),Router.route("/approval/pending",function(t){e.approval("pending",t)}),Router.route("/approval/approved",function(t){e.approval("approved",t)}),Router.route("/approval/ccMy",function(t){e.approval("ccMy",t)}),Router.route("/approvalReport",function(){e.approvalReport()}),Router.route("/approvalReport/reimbursement",function(){e.approvalReport("reimbursement")}),Router.route("/approvalReport/cost",function(){e.approvalReport("cost")}),Router.route("/approvalReport/nonAmount",function(){e.approvalReport("nonAmount")}),Router.route("/approvalReport/projects",function(){e.approvalReport("projects")}),Router.route("/approvalReport/leave",function(){e.approvalReport("leave")}),Router.route("/approvalReport/business",function(){e.approvalReport("business")}),Router.route("/approvalReport/workingHours",function(){e.approvalReport("workingHours")}),Router.route("/approvalReport/workingHoursDetail",function(t){e.approvalReport("workingHoursDetail",t)}),Router.route("/backstageMgt",function(){e.backstageMgt()}),Router.route("/backstageMgt/index",function(){e.backstageMgt("index")}),Router.route("/backstageMgt/purchase",function(t){e.backstageMgt("purchase",t)}),Router.route("/backstageMgt/purchase/details",function(t){e.backstageMgt("purchase/details",t)}),Router.route("/backstageMgt/orgInfo",function(){e.backstageMgt("orgInfo")}),Router.route("/backstageMgt/organizational",function(){e.backstageMgt("organizational")}),Router.route("/backstageMgt/permissionSettings",function(){e.backstageMgt("permissionSettings")}),Router.route("/backstageMgt/enterpriseCertification",function(){e.backstageMgt("enterpriseCertification")}),Router.route("/backstageMgt/historicalDataImport",function(){e.backstageMgt("historicalDataImport")}),Router.route("/backstageMgt/financeSettingProcess",function(t){e.backstageMgt("financeSettingProcess",t)}),Router.route("/backstageMgt/approvalMgt",function(){e.backstageMgt("approvalMgt")}),Router.route("/backstageMgt/attendance",function(){e.backstageMgt("attendance")}),Router.route("/backstageMgt/attendance/settings",function(){e.backstageMgt("attendance/settings")}),Router.route("/backstageMgt/attendance/report",function(t){e.backstageMgt("attendance/report",t)}),Router.route("/backstageMgt/projectSettings",function(){e.backstageMgt("projectSettings")}),Router.route("/proProgressStats",function(t){e.proProgressStats()}),Router.route("/proProgressStats/researchType",function(t){e.proProgressStats("researchType",t)}),Router.route("/proProgressStats/businessType",function(t){e.proProgressStats("businessType",t)}),Router.route("/proTypeStats",function(t){$(e.contentEle).m_stats_pro_type()}),Router.route("/theaterRanking",function(t){$(e.contentEle).m_stats_theater_ranking()}),Router.route("/userOutputStats",function(t){$(e.contentEle).m_stats_user_output()}),Router.route("/deanOutputStats",function(t){$(e.contentEle).m_stats_dean_output()}),Router.route("/deanBillStatistic",function(t){$(e.contentEle).m_stats_dean_bill()}),Router.route("/personalSettings",function(){e.personalSettings()}),Router.route("/announcement",function(){e.announcement()}),Router.route("/announcement/send",function(){e.announcementSend()}),Router.route("/announcement/detail",function(t){e.announcementDetail(t)}),Router.route("/myTodoList",function(){e.myTodoList()}),Router.route("/createOrg",function(){e.createOrg()}),Router.route("/createOrg/1",function(){$("#content-right").m_createOrg({doType:1,saveOrgCallback:function(t){window.location.href=window.serverPath+"/iWork/home/workbench"}}),$("#page-wrapper").addClass("menu-l-none")}),Router.route("/messageCenter",function(){e.messageCenter()}),Router.route("/error/404",function(){e.errorFun("404")}),Router.beforeCallback(function(t){isNullOrBlank(window.companyVersion)?$("#m_top").m_top({resolve:t,renderCallBack:function(t){$("#left-menu-box").m_metismenu({contentEle:"#content-right"}),messageCenter.init(),window.onbeforeunload=function(t){try{messageCenter.disconnect()}catch(t){}}}}):t("top-have-render")}),Router.afterCallback(function(){$("#left-menu-box").m_metismenu("menuShowOrHide",Router.currentUrl),$("#left-menu-box").m_metismenu("menuDealFun",Router.currentUrl),0<$('.tooltip[role="tooltip"][id^="tooltip"]').length&&$('.tooltip[role="tooltip"][id^="tooltip"]').remove()})},errorFun:function(t){$(this.contentEle).m_error({dataAction:t},!0)},projectList:function(t,e){$(this.contentEle).m_projectList_menu({dataAction:t,query:e})},proProgressStats:function(t,e){$(this.contentEle).m_stats_pro_process_menu({dataAction:t,query:e})},addressBook:function(){$(this.contentEle).m_addressBook()},orgInfomationShow:function(){$(this.contentEle).m_orgInfomation({type:0})},addProject:function(){$(this.contentEle).m_projectAdd({},!0)},backstageMgt:function(t,e){$(this.contentEle).m_backstage_menu({dataAction:t,query:e})},project:function(t,e){var n={};n.dataAction=e,(n.query=t).businessType,$(".m-metismenu .parentProject .projectList").m_projectMenu(n)},messageCenter:function(){$(this.contentEle).m_message({},!0)},personalSettings:function(){var t={};t.url=restApi.url_userInfo,m_ajax.get(t,function(t){"0"==t.code?$("#content-right").m_userInfo({userDto:t.data}):S_layer.error(t.info)})},announcement:function(){$(this.contentEle).m_notice({},!0)},myTodoList:function(){$(this.contentEle).m_todo({},!0)},announcementSend:function(){$(this.contentEle).m_notice_publish()},announcementDetail:function(t){var e={};e.noticeId=t.id,$("#content-right").m_notice_details(e)},myTask:function(t,e){1==t.status&&$("body").addClass("babieniaovisit");var n={};null!=t.companyUserId&&(n.companyUserId=t.companyUserId,n.userId=t.userId),$(this.contentEle).m_task(n,!0)},technologySync:function(t,e){1==t.status&&$("body").addClass("babieniaovisit"),$(this.contentEle).m_technology_sync({},!0)},projectSection:function(t,e){$(this.contentEle).m_project_section({query:t},!0)},projectSectionDetails:function(t,e){$(this.contentEle).m_departIntroductionShow(t,!0)},myTaskDetails:function(t,e){$(this.contentEle).m_task_details(t,!0)},lightTask:function(t,e){$(this.contentEle).m_task_light({},!0)},lightProject:function(t,e){"lightProject/detail"==e?$(this.contentEle).m_light_project_detail({query:t},!0):"lightProject/addTemp"==e?$(this.contentEle).m_light_project_temp_add({}):$(this.contentEle).m_light_project({})},financeSettings:function(t,e){$(this.contentEle).m_finance_settings_menu({dataAction:e,query:t})},financeConfirm:function(t,e){$(this.contentEle).m_finance_confirm_menu({dataAction:t,query:e})},feeEntry:function(){$(this.contentEle).m_feeEntry()},paymentsDetail:function(t){$(this.contentEle).m_payments_detail_menu({dataAction:t})},receivable:function(){$(this.contentEle).m_payments_receivable()},payable:function(){$(this.contentEle).m_payments_payable()},projectCostDetail:function(t){$(this.contentEle).m_project_cost_menu({dataAction:t})},paymentsStatistics:function(){$(this.contentEle).m_payments_statistics()},profitStatement:function(){$(this.contentEle).m_payments_profitStatement()},projectArchiving:function(){$(this.contentEle).m_projectArchiving({},!0)},projectOverview:function(){var t={};t.isAllProject=!0,$(this.contentEle).m_projectList(t,!0)},createOrg:function(){var t={saveOrgCallback:function(t){window.location.href=window.serverPath+"/iWork/home/workbench"}};$("#content-right").m_createOrg(t)},incomeExpenditureByMyTask:function(t){var e={};e.projectId=t.projectId,e.projectName=decodeURI(t.projectName),e.dataAction=t.dataType,e.myTaskId=t.myTaskId,$("#content-right").m_cost_menu(e,!0)},invoiceSummary:function(){$(this.contentEle).m_summary_invoice({status:1,doType:1},!0)},initiateApproval:function(){$(this.contentEle).m_approval_initiate({},!0)},appliedApproval:function(){$(this.contentEle).m_approval_data({doType:1},!0)},approval:function(t,e){$(this.contentEle).m_approval_menu({dataAction:t,query:e})},approvalReport:function(t,e){var n={};n.dataAction=t,n.query=e,$(this.contentEle).m_approvalReport_menu(n,!0)},approveDataList:function(t){var e={};e.doType=t,$(this.contentEle).m_approval_data(e,!0)},salaryMgt:function(t,e){$(this.contentEle).m_salary_menu({dataAction:t,query:e},!0)}};function contextMenu(t){this.opt=this.extend(!0,this.options,t),this.target=this.opt.target,this.opt.classes&&!this.opt.linkClass&&(this.menuBoxClass=this.extend(!0,{position:"absolute"},this.opt.classes.menuBox),this.menuTitleClass=this.extend(!0,{},this.opt.classes.menuTitle.self),this.menuTitleIconClass=this.extend(!0,{display:"inline-block"},this.opt.classes.menuTitle.icon),this.menuTitleConClass=this.extend(!0,{},this.opt.classes.menuTitle.content),this.itemClass=this.extend(!0,{},this.opt.classes.item.self),this.itemIconClass=this.extend(!0,{display:"inline-block"},this.opt.classes.item.icon),this.itemConClass=this.extend(!0,{},this.opt.classes.item.content),this.hoverClass=this.extend(!0,{},this.opt.classes.item.hover),this.separatorClass=this.extend(!0,{},this.opt.classes.separator),this.keymapClass=this.extend(!0,{display:"inline-block",height:"100%","line-height":"30px",float:"right"},this.opt.classes.item.keymap)),this.init()}$(document).ready(function(){function t(){var t=$(".navbar.navbar-static-top").height();null==t&&(t=60);var e=$("body > #wrapper").height()-t-1;$(".sidebar-panel").css("min-height",e+"px");var n=$("nav.navbar-default").height(),o=$("#page-wrapper").height(),e=$(window).height();o<n&&$("#page-wrapper").css("min-height",n+"px"),n<=o&&$("#page-wrapper").css("min-height",e-t+"px"),e-t<n&&o<n&&$("#page-wrapper").css("min-height",n+"px"),n<e-t&&o<e-t&&$("#page-wrapper").css("min-height",e-t+"px"),$("body").hasClass("fixed-nav")&&(o<n?$("#page-wrapper").css("min-height",n+"px"):$("#page-wrapper").css("min-height",$(window).height()-t+"px"))}$(this).width()<769?$("body").addClass("body-small"):$("body").removeClass("body-small"),$(window).bind("load resize scroll",function(){$(this).width()<769?$("body").addClass("body-small"):$("body").removeClass("body-small"),t()}),t()}),contextMenu.prototype.init=function(){var t;this.menuBox=document.createElement("div"),this.attr(this.menuBox,{unselectable:"on"}),this.attr(this.menuBox,{onselectstart:"return false;"}),this.css(this.menuBox,{"-moz-user-select":"none"}),this.css(this.menuBox,{"-webkit-user-select":"none"}),this.opt.linkClass||this.css(this.menuBox,this.menuBoxClass),this.addClass(this.menuBox,"contextMenuBox"),this.addClass(this.menuBox,this.opt.menuClass),this.opt.hasTitle&&(this.menuTitle=document.createElement("h2"),this.addClass(this.menuTitle,"contextMenuTitle"),this.opt.menu.title.icon&&0!=this.opt.menu.title.icon.length?(e=this.opt.hasIcon?"img":"span",t=document.createElement(e),this.addClass(t,"contextMenuTitleIcon"),this.opt.linkClass||this.css(t,this.menuTitleIconClass),this.opt.hasIcon||this.css(t,{width:0}),this.attr(t,{src:this.opt.menu.title.icon})):(t=document.createElement("span"),this.addClass(t,"contextMenuTitleIcon"),this.opt.linkClass||this.css(t,this.menuTitleIconClass),this.opt.hasIcon||this.css(t,{width:0})),this.menuTitle.appendChild(t),t=document.createElement("span"),this.addClass(t,"contextMenuTitleCon"),this.opt.linkClass||(this.css(this.menuTitle,this.menuTitleClass),this.css(t,this.menuTitleConClass)),t.innerHTML=this.opt.menu.title.content,this.menuTitle.appendChild(t),this.menuBox.appendChild(this.menuTitle));var e,n,i,o,r,a,s=0,c=this.opt.menu.items;if(c)for(s=0;s<c.length;s++)"-"===c[s]?(i=document.createElement("div"),this.addClass(i,"contextMenuSeparator"),this.opt.linkClass||this.css(i,this.separatorClass)):(i=document.createElement("div"),this.addClass(i,"contextMenuItem"),c[s].icon&&0!=c[s].icon.length?(e=this.opt.hasIcon?"img":"span",n=document.createElement(e),this.addClass(n,"contextMenuItemIcon"),this.opt.linkClass||this.css(n,this.itemIconClass),this.opt.hasIcon||this.css(n,{width:0}),this.attr(n,{src:c[s].icon})):(n=document.createElement("span"),this.addClass(n,"contextMenuItemIcon"),this.opt.linkClass||this.css(n,this.itemIconClass),this.opt.hasIcon||this.css(n,{width:0})),i.appendChild(n),o=document.createElement("span"),this.addClass(o,"contextMenuItemCon"),this.opt.linkClass||(this.css(i,this.itemClass),this.css(o,this.itemConClass)),o.innerHTML=c[s].content,c[s].keymap&&(r=document.createElement("span"),this.addClass(r,"contextMenuKeyMap"),r.innerHTML=c[s].keymap,this.css(r,this.keymapClass),i.appendChild(r)),a=this,function(n){var o;a.opt.linkClass||(a.on(i,"mouseover",function(){a.css(this,a.hoverClass)}),a.on(i,"mouseout",function(){a.css(this,a.itemClass)})),a.on(i,"mousedown",function(t){a.sb(t),c[n].action.call(a,t,c[n]),a.hide()}),c[n].keymap&&(o=c[n].keymap.split("+"),a.on(document,"keydown",function(t){var e=String.fromCharCode(t.keyCode).toLocaleLowerCase();switch(o[0]){case"alt":t.altKey&&e===o[1].toLocaleLowerCase()&&c[n].action.call(a,t,c[n]);break;case"shift":t.shiftKey&&e===o[1].toLocaleLowerCase()&&c[n].action.call(a,t,c[n]);break;case"ctrl":t.ctrlKey&&e===o[1].toLocaleLowerCase()&&c[n].action.call(a,t,c[n])}}))}(s),i.appendChild(o)),this.menuBox.appendChild(i);this.$("body")[0].appendChild(this.menuBox),this.hide(),this.bind()},contextMenu.prototype.show=function(){var t,e,n;this.opt.beforeShow&&this.opt.beforeShow.call(this,this),this.css(this.menuBox,{display:"block"}),1==arguments.length&&(n=e=0,t=this.opt.target==document?document.documentElement.clientWidth-arguments[0].clientX:this.opt.target.offsetWidth-arguments[0].clientX,this.opt.target==document?(document.documentElement.clientHeight,arguments[0].clientY):(this.opt.target.offsetHeight,arguments[0].clientY),e=t<this.menuBox.offsetWidth?arguments[0].clientX-this.menuBox.offsetWidth:arguments[0].clientX,this.menuBox.offsetHeight,n=arguments[0].clientY,this.css(this.menuBox,{left:e+"px",top:n+"px"}),this.opt.afterShow&&this.opt.afterShow.call(this,this))},contextMenu.prototype.hide=function(){this.opt.beforeHide&&this.opt.beforeHide.call(this,this),this.css(this.menuBox,{display:"none"}),this.opt.afterHide&&this.opt.afterHide.call(this,this)},contextMenu.prototype.bind=function(){var e,n=this;n.on(n.opt.target,"contextmenu",function(t){return function(t){t.preventDefault&&t.preventDefault();t.cancelBubble=!0,t.returnValue=!1,t.stopPropagation()}(t||event),t.stopPropagation(),!1}),n.on(n.opt.target,"mousedown",function(t){return 2==t.button&&(n.show(t),t.stopPropagation()),!1}),n.on(document,"mousedown",function(t){return 2!=t.button&&n.hide(),!1}),n.on(n.menuBox,"click",function(t){n.sb(t)}),n.opt.autoHide&&(e=null,n.on(n.menuBox,"mouseover",function(t){clearTimeout(e)}),n.on(n.menuBox,"mouseout",function(t){e=setTimeout(function(){n.hide()},300)}))},contextMenu.prototype.$=function(t,e){if("string"!=typeof t||""==t)return[t];var n=[],o=null,i=t.split(" "),r="";(s=i[0].split(":")[0])!=i[0]&&(r=i[0].split(":")[1]);var a=(a=s.split("[")[0])!=s?s.split("[")[1].replace(/[",\]]/g,""):"",s=s.split("[")[0];switch(e=e||document,s.charAt(0)){case"#":(o=document.getElementById(s.substr(1)))&&n.push(o);break;case".":for(var c=e.getElementsByTagName("*"),l=s.substr(1),u=0;u<c.length;u++)-1!=c[u].className.search("\\b"+l+"\\b")&&n.push(c[u]);break;default:n=e.getElementsByTagName(s)}if(a){for(var c=[],d=a.split("="),u=0;u<n.length;u++)2==d.length&&n[u][d[0]]==d[1]&&c.push(n[u]);n=c}if(r){for(c=[],u=0;u<n.length;u++)n[u][r]&&c.push(n[u]);n=c}if(1<i.length){for(c=[],u=0;u<n.length;u++){var p=this.$.call(this,t.substr(i[0].length+1),n[u]);if(p.tagName)c.push(p);else for(var h=0;h<p.length;h++)c.push(p[h])}n=c}if(o&&1==i.length)(n=o)&&(n.length=1);else{for(c=[],u=0;u<n.length;u++)n[u].$isAdd=!1;for(u=0;u<n.length;u++)n[u].$isAdd||(n[u].$isAdd=!0,c.push(n[u]));n=c}return n},contextMenu.prototype.on=function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n},contextMenu.prototype.options={target:document,menu:{title:{icon:"imgs/em_1.gif",content:"自定义右键菜单"},items:[{icon:"imgs/em_2.gif",content:"菜单项1",action:function(t){alert(t.content)}},"-",{icon:"imgs/em_2.gif",content:"菜单项2",action:function(t){alert("====>"+t.content)}}]}},contextMenu.prototype.extend=function(t,e,n){if(t){var o={};for(i in e)o[i]=e[i];for(i in n)o[i]=n[i];return o}for(var i in n)e[i]=n[i];return e},contextMenu.prototype.css=function(){var t=arguments,e=0;if(2==t.length){var n=t[0],o=t[1];if(this.isArray(n)){for(e=0;e<n.length;e++)if("string"==typeof o){if(n[e].currentStyle)return this.fixed(n[e].currentStyle[o],1);if(window.getComputedStyle)return o=(o=o.replace(/([A-Z])/g,"-$1")).toLowerCase(),this.fixed(document.defaultView.getComputedStyle(n[e],null)[o],1)}else if("object"==typeof o)for(var i in o)n[e].style[i]=o[i]}else{if("string"==typeof o)return n.currentStyle?this.fixed(n.currentStyle[o],1):window.getComputedStyle?(o=(o=o.replace(/([A-Z])/g,"-$1")).toLowerCase(),this.fixed(document.defaultView.getComputedStyle(n,null)[o],1)):void 0;if("object"==typeof o)for(var i in o)n.style[i]=o[i]}}},contextMenu.prototype.attr=function(){var t=arguments,e=0;if(2==t.length){var n=t[0],o=t[1];if(this.isArray(n))for(e=0;e<n.length;e++){if("string"==typeof o)return 0!=o.length?n[e].getAttribute(o):n[e].attributes;if("object"==typeof o)for(var i in o)n[e].setAttribute(i,o[i])}else if("string"==typeof o){if(0!=o.length)return n.getAttribute(o)}else if("object"==typeof o)for(var i in o)n.setAttribute(i,o[i])}},contextMenu.prototype.isArray=function(e){var n;try{n="[object Array]"===toString.call(e)}catch(t){n=e instanceof Array}return n},contextMenu.prototype.sb=function(t){t&&t.stopPropagation?t.stopPropagation():window.event.cancelBubble=!0},contextMenu.prototype.hasClass=function(t,e){return t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},contextMenu.prototype.addClass=function(t,e){if(this.isArray(t))for(var n=0;n<t.length;n++)this.hasClass(t[n],e)||(t[n].className+=" "+e);else this.hasClass(t,e)||(t.className+=" "+e)},contextMenu.prototype.removeClass=function(t,e){if(this.isArray(t))for(var n,o=0;o<t.length;o++)this.hasClass(t[o],e)&&(n=new RegExp("(\\s|^)"+e+"(\\s|$)"),t[o].className=t[o].className.replace(n," "));else this.hasClass(t,e)&&(n=new RegExp("(\\s|^)"+e+"(\\s|$)"),t.className=t.className.replace(n," "))},contextMenu.prototype.toggleClass=function(t,e){if(this.isArray(t))for(var n=0;n<t.length;n++)this.hasClass(t[n],e)?this.removeClass(t[n],e):this.addClass(t[n],e);else this.hasClass(t,e)?this.removeClass(t,e):this.addClass(t,e)},contextMenu.prototype.isEmptyObject=function(t){for(var e in t)return!1;return!0};var sockClient={eventBus:null,endPointUrl:null,clientSubUrl_topicSpec:null,userId:null,userToken:null,reconnectTime:0,init:function(t,e,n){this.userId=t,this.userToken=e,this.endPointUrl=n,this.clientSubUrl_topicSpec="clientSubUrl.topicSpec."+t},connect:function(){var e=this,n={closeButton:!0,debug:!1,progressBar:!0,preventDuplicates:!1,positionClass:"toast-bottom-right",onclick:function(){location.hash="#/messageCenter"},showDuration:"400",hideDuration:"1000",timeOut:"10000",extendedTimeOut:"10000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},o={closeButton:!0,debug:!1,progressBar:!0,preventDuplicates:!1,positionClass:"toast-bottom-right",onclick:function(){location.hash="#/announcement"},showDuration:"400",hideDuration:"1000",timeOut:"10000",extendedTimeOut:"10000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},i=_.debounce(function(){var t={};t.url=restApi.url_getMessageUnRead,t.classId="",t.postData={},m_ajax.postJson(t,function(t){"0"==t.code?isNullOrBlank(t.data)||0===t.data||$("#unReadMessageCount").html(t.data):S_layer.error(t.info)})},1500),r=_.debounce(function(){var t={};t.url=restApi.url_getNotReadNotice,t.classId="",m_ajax.get(t,function(t){"0"==t.code?isNullOrBlank(t.data)||0===t.data||$("#unReadNoticeCount").html(t.data):S_layer.error(t.info)})},1500),a=_.debounce(function(){var t={};t.url=restApi.url_listMyTaskUnComing,t.classId="",m_ajax.get(t,function(t){"0"==t.code?null!=t.data.total&&0<t.data.total?($("#unReadTodoCount").addClass("unReadTodoCount"),$("#unReadTodoCount").html(t.data.total)):($("#unReadTodoCount").removeClass("unReadTodoCount"),$("#unReadTodoCount").html("")):S_layer.error(t.info)})},1500);e.eventBus=new EventBus(e.endPointUrl),e.eventBus.onopen=function(){var t={userId:e.userId,userToken:e.userToken};e.eventBus.registerHandler(e.clientSubUrl_topicSpec,t,function(t,e){e&&e.body&&!isNullOrBlank(e.body.content)&&("userMessage"===e.body.messageType?(i(),toastr.info(e.body.content,null,n)):"notice"===e.body.messageType?(r(),toastr.info(e.body.content,null,o)):"todo"===e.body.messageType&&(a(),toastr.info(e.body.content,null,o)))})}},disconnect:function(){try{var t=sockClient;null!=t.eventBus&&t.eventBus.close()}catch(t){}},sendAll:function(t){sockClient.eventBus.publish("serverSubUrl_topicAll",{content:t})},sendSpec:function(t,e){sockClient.eventBus.publish("serverSubUrl_topicSpec/"+t,{content:e})}},messageCenter={init:function(){if(-1==window.location.href.indexOf("/register")&&-1==window.location.href.indexOf("/login")){var t=window.currentUserId,e=window.socketUrl;sockClient.init(t,null,e);try{sockClient.connect()}catch(t){console.error(t)}}},randomId:function(t){return parseInt(Math.random()*t+1)},disconnect:function(){sockClient.disconnect()}};$(function(){});